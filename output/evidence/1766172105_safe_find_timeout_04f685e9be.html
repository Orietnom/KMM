<html><!-- Traduzir arquivo: /modulos/cte/emitir/principal.cfm --><head><script language="javascript1.2" src="/_scripts/AC_RunActiveContent.js"></script>
<script language="javascript1.2" src="/_scripts/scripts_db.js"></script>

<script language="javascript1.2" src="/_scripts/engine_ajax.js"></script>
<script language="javascript1.2" src="/_scripts/tablesort.js"></script>

	<script language="javascript1.2" src="/_scripts/reseta_botoes.js"></script>

<script src="/_scripts/dragdrop/popupmenu.js"></script>
<script src="/_scripts/jscalendar-0.9.6/calendar.js" type="text/javascript"></script>
<script src="/_scripts/jscalendar-0.9.6/lang/calendar-br.js" type="text/javascript"></script>
<script src="/_scripts/jscalendar-0.9.6/calendar-setup.js" type="text/javascript"></script>
<link href="/_scripts/jscalendar-0.9.6/calendar-system.css" rel="stylesheet" type="text/css">

<script src="/_scripts/jscalendar-0.9.6/calendar.js" type="text/javascript"></script>
<script src="/_scripts/jscalendar-0.9.6/lang/calendar-br.js" type="text/javascript"></script>
<script src="/_scripts/jscalendar-0.9.6/calendar-setup.js" type="text/javascript"></script>
<link href="/_scripts/jscalendar-0.9.6/calendar-system.css" rel="stylesheet" type="text/css">



<script language="javascript1.2">
var v_variaveis_tabela_frete = 1;/*Controla a busca de tabela de frete para edição de CT-e*/

	parent.f_set_texto( 'titulo_aplicacao', 'Controle de Documentos' );

	parent.f_set_texto( 'titulo_pagina', 'Emitir CTE  de Complemento' );


	parent.f_hidden('barra_botoes_top');
	parent.f_hidden('btn_editar');
	parent.f_hidden('btn_excluir');
	parent.f_hidden('btn_cancelar');
	parent.document.getElementById('btn_voltar').onclick = function() { window.open('/aplicacoes.cfm?menu_inicial=765','_parent',''); }

	// -------------------- //
	var v_emite_tabela_frete = -1;
	var v_quantidade_grupo = 0;
	var v_operacao_id = '';
	var v_operacao_descricao = '';
	var v_inserida = 0;
	var v_departamento = [];
	var v_setor		   = [];
	var v_centro_custo = [];

	//Endereços//
	var v_enderecos_remetente = [];

	function f_confirmar() {
		with(document.forms[0]) {
			//verifica se a composição dos veículos estão OK
			if(PLACA_CONTROLE.value != '' && VEICULOS_OK.value == 0){
				alert('Um ou mais veículos não foram validados para enviar os dados para a Sefaz.');
				return;
			}
			
			//Verifica se exige o Vale Pedágio
			if(PAGTO_VALE_PEDAGIO.value == 1 && VP_OBRIGATORIO_CTE.value == 1){
				v_tot_vale_ped = f_listagem_VALE_PEDAGIO();
				
				if(Number(v_tot_vale_ped.length)  == 0){
					alert('O Vale pedágio é obrigatório conforme definido no campo Exige vale pedágio no CT-e na aba Vale Pedágio da operação ' + OPERACAO_ID.value );
					
					return;
				}
			}
			
			if(v_emite_tabela_frete == -1) {
				if(v_quantidade_grupo == 0) {
					alert('O negociador informando não pertence a nenhum grupo. Entre em contato com o departamento Comercial.');
					return false;
				}
				else {
					alert('O negociador informando pertence a mais de um grupo. Entre em contato com o departamento Comercial.');
					return false;
				}
			}

			if(v_emite_tabela_frete == 0) {
				f_calculos();
			}

			

			REGRA_FISCAL_ID.value = REGRA_FISCAL.value;

			
				PLACA_CONTROLE.obrigatorio = 0;
				MOTORISTA.obrigatorio = 0;
			

			// Para a White Martins não é obrigatória a placa
			if (Number(REGRA_FISCAL_ID.value) == 13) {
				PLACA_CONTROLE.obrigatorio = 0;
			}

			//Valida se possui Notas Fiscais
			v_tot_nf = f_listagem_NOTAS_FISCAIS();
			v_tot_nfe = f_listagem_NFE();
			v_tot_outros = f_listagem_OUTROS();

			if( (Number(v_tot_nf.length) + Number(v_tot_nfe.length) + Number(v_tot_outros.length) ) == 0){
				alert('Nenhuma Nota Fiscal vinculada ao CTE.');
				return;
			}

			/*38303 Incluir NFe ao CT-e
			Valida se o campo pedido shipment esta como obrigatório mas não esta preenchido
			Não valida o tipo Outros, pois nao existe o campo na tela*/
			if(TIPO_DOCUMENTO_ID.value == 0) { //Nota Fiscal
			   v_nfoc = document.getElementById('NOTA_ORDEM_COMPRA');
				v_nfs  = f_listagem_NOTAS_FISCAIS();
			}else if(TIPO_DOCUMENTO_ID.value == 1) { //Nota Fiscal Eletrônica
			   v_nfoc = document.getElementById('NFE_ORDEM_COMPRA');
				v_nfs  = f_listagem_NFE();
			}else if(TIPO_DOCUMENTO_ID.value == 2) { //Outros
			   v_nfoc = document.getElementById('OUTROS_ORDEM_COMPRA');
				v_nfs  = f_listagem_OUTROS();
			}else if(TIPO_DOCUMENTO_ID.value == 3) { //CTe redespacho
			   v_nfoc = document.getElementById('OUTROS_ORDEM_COMPRA');
				v_nfs  = f_listagem_OUTROS();
			}

         v_erro_oc = 0;
			if(v_nfoc.getAttribute('obrigatorio') == 1){
				for(i = 0; i < v_nfs.length; i++){
					if(TIPO_DOCUMENTO_ID.value == 0) { //Nota Fiscal
					   v_nfoc = document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_' + v_nfs[i].id)
						if (v_nfoc.value == ''){
						   v_erro_oc = 1;
							break;
						}
					}else if(TIPO_DOCUMENTO_ID.value == 1) { //Nota Fiscal Eletrônica
						v_nfoc = document.getElementById('NFE_ORDEM_COMPRA_NFE_' + v_nfs[i].id)
						if (v_nfoc.value == ''){
						   v_erro_oc = 1;
							break;
						}
					}else if(TIPO_DOCUMENTO_ID.value == 2) { //Outros
						v_nfoc = document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_' + v_nfs[i].id)
						if (v_nfoc.value == ''){
						   v_erro_oc = 1;
							break;
						}
					}
				}
				if(v_erro_oc == 1){
					alert('Esta operação exige que as notas possuam o campo Pedido/Shipment preenchido.');
					return;
				}
			}

			target = 'consultas';
			
	  		  OPERACAO.value = 11;
			

			IMPRIMIR.value = 1;

			if(TOTAL_CONHECIMENTO.value <= 0 && v_emite_tabela_frete == 0) {
				
					if (Number(TIPO_COMPLEMENTO_ID.options[TIPO_COMPLEMENTO_ID.selectedIndex].value) != 1) {
						alert('Atenção! O valor do conhecimento deve ser maior que ZERO.');
						return false;
					}
				
			}

			f_limpar_engates_brancos();
			

			action = 'confirma.cfm';
			PLACA_REFERENCIA.value 				= f_get_placa_referencia();
			PLACA_REFERENCIA_COMPOSICAO.value 	= f_get_lista_engates();
			if (NOME_MOTORISTA.value.length == 0)
				NOME_MOTORISTA.value = MOTORISTA.value;

			if (document.forms[0].TIPO_COMPLEMENTO_ID && document.forms[0].TIPO_COMPLEMENTO_ID.value == 1) {
				if(COLETA_MUNICIPIO_ID.value == RED_MUNICIPIO_ID.value) {
					// Verifica as regras para complemento municipal
					if(Number(ALIQUOTA_ICMS.value) == 0 && v_emite_tabela_frete == 0) {
						alert('CTRCs municipal de complemento não é permitido para este municipio!');
						return
					}
				}
			}
			NUM_PRODUTO.disabled = false;

			if(TIPO_FRETE.value != ''){
				if(NUM_PRODUTO.value != TIPO_FRETE.value){
					alert('O Tipo de Frete selecionado é diferente do que está definido na operação.');
					return;
				}
			}

			//Verificar Pagador
			if(Number(PAGADOR.value) == 0){
				if(REM_CNPJ_CPF.value != COB_CNPJ_CPF.value){
					alert('O campo "Pago por" está definido como Remetente (CIF), deverá ajustar o Tomador do Serviço para utilizar o mesmo do Remetente ou alterar o campo "Pago por".');
					return;
				}
			}
			
			//Habilitar campo Tipo do Conhecimento
			try {
			CONHECIMENTO_TIPO_ID.disabled = false;
			} catch(e) {}
			

		    if (Number(CONFIRMA.value) == 1) {
				if (f_verifica_form(document.forms[0])) {
					/*Valida se é obrigatorio o preenchimento do campo pedido/shipment
					  das notas ficais e se o campo está preenchido */
					if(!f_valida_notas_fiscais_ps())
						return false;

					if(!f_valida_peso_cte_ref())
						return false;
						
				    f_habilita_todos_campos();
				    CONFIRMA.value = 0;

				    v_pagador_disabled = PAGADOR.disabled;
				    PAGADOR.disabled = false;

				    submit();

					PAGADOR.disabled = v_pagador_disabled;
					ST_ICMS_ID_COMBO.disabled = true;

					
						setReadOnly['complemento'](true);
					


					if(TIPO_FRETE.value != ''){
						NUM_PRODUTO.disabled = true;
					}
				}

				


				if(TIPO_FRETE.value != ''){
					NUM_PRODUTO.disabled = true;
				}
			}else { alert('O formulário já foi confirmado. Aguarde...'); }
		}
	}

	function f_habilita_botao_confirma(){
		with(document.forms[0]) {
			CONFIRMA.value = 1;
			f_habilitar_botao('confirmar', 'f_confirmar()');
		}
	}


	function f_get_lista_engates() {
		f_limpar_engates_brancos();
		v_placas = [];
		for(var i=0;i<v_placas_referencia.length;i++) {
			v_placas.push(v_placas_referencia[i].getValue());
		}
		return v_placas.toString();
	}

	function f_get_placa_referencia() {
		if(v_placas_referencia.length > 0) {
			return v_placas_referencia[0].getValue();
		} else {
			return document.forms[0].PLACA_CONTROLE.value;
		}
	}

	function f_busca_pessoa(p_destino) {
		with(document.forms[0]) {
			NewWindow('../consultas/localizar_pessoa.cfm?DESTINO='+p_destino,'pessoa',0,0,'yes');
		}
	}

	function f_busca_cidade(p_destino) {
		with(document.forms[0]) {
			NewWindow('../consultas/localizar_cidade.cfm?DESTINO='+p_destino,'cidade',0,0,'yes');
		}
	}

	function f_busca_conhecimento() {
		//f_busca_nfs();
		with(document.forms[0]) {
			CONSULTA.value = 5;
			target = 'consultas';
			action = 'consultas.cfm';
			submit();
		}
	}

	function f_busca_nfs() {
		with(document.forms[0]) {
			f_limpar_NOTAS_FISCAIS();
			f_query_wddx("/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_conhecimento_nota_fiscal",
							 'CONHECIMENTO_ID=' + CONHECIMENTO_ID.value
							 ,function(obj) {
								if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
									TIPO_DOCUMENTO_ID.value = obj.struct.tipo_documento_id[0];
									TIPO_DOCUMENTO_ID.onchange();
									v_inserida = 1;

									for(var i=0;i<obj.struct.conhecimento_id.length;i++) {
										switch(Number(obj.struct.tipo_documento_id[i])) {
											case 0:
												f_incluir_NOTAS_FISCAIS();
												NF_CONHECIMENTO_ID.value	  = obj.struct.conhecimento_id[i];
												NOTA_NUMERO.value             = obj.struct.numero[i];
												NOTA_MODELO.value             = obj.struct.modelo[i];
												NOTA_MODELO.onchange();
												NOTA_SERIE.value              = obj.struct.serie[i];
												NOTA_SERIE.onchange();
												NOTA_SUB_SERIE.value          = obj.struct.sub_serie[i];
												NOTA_DATA_EMISSAO.value       = obj.struct.data_emissao_data[i];
												NOTA_VALOR.value              = toCurrency(obj.struct.valor_total[i]);
												NOTA_VALOR_SEGURADO.value     = obj.struct.valor_segurado[i];
												NOTA_ORDEM_COMPRA.value       = obj.struct.ordem_compra_cliente[i];
												NOTA_QTDE_VOLUME.value        = obj.struct.qtde_volume[i];
												NOTA_COD_UNIDADE.value        = obj.struct.cod_unidade[i];
												NOTA_M3.value                 = obj.struct.m3[i];
												NOTA_NUM_NATUREZA.value       = obj.struct.num_natureza[i];
												NOTA_NATUREZA.value           = obj.struct.natureza[i];
												NOTA_COMPLEMENTO.value        = obj.struct.complemento[i];
												NOTA_NUM_ESPECIE.value        = obj.struct.num_especie[i];
												NOTA_ESPECIE.value            = obj.struct.especie[i];
												NOTA_ALTURA.value             = (obj.struct.altura[i] == '')?'0':obj.struct.altura[i];
												NOTA_LARGURA.value            = (obj.struct.largura[i] == '')?'0':obj.struct.largura[i];
												NOTA_COMPRIMENTO.value        = (obj.struct.comprimento[i] == '')?'0':obj.struct.comprimento[i];
												NOTA_CUBAGEM.value            = obj.struct.cubagem[i];
												NOTA_CUBAGEM_SUGERIDA.value   = obj.struct.cubagem_sugerida[i];
												NOTA_CFOP.value               = obj.struct.cfop[i];
												
													NOTA_PESO.value               = 0;
													NOTA_PESO_CUBADO.value        = 0;
													NOTA_PESO_KG_CONVERTIDO.value = 0;
													NOTA_PESO_COBRADO.value       = 0;
												
												f_calcula_cubagem('NOTA');
												f_salvar_NOTAS_FISCAIS();
											break;

											case 1:

												f_incluir_NFE();

												/* Campos */
												NF_CONHECIMENTO_ID.value	= obj.struct.conhecimento_id[i];
												CHAVE_ACESSO_NFE.value      = obj.struct.chave_acesso_nfe[i];
												NFE_VALOR.value             = toCurrency(obj.struct.valor_total[i]);
												NOME_ARQUIVO.value          = '';
												NUMERO_NFE.value            = obj.struct.numero[i];
												MODELO_NFE.value            = obj.struct.modelo[i];
												SERIE_NFE.value             = obj.struct.serie[i];
												DATA_EMISSAO_NFE.value      = obj.struct.data_emissao_data[i];

												REMETENTE_NFE.value			= obj.struct.emitente[i];
												CNPJ_REMETENTE_NFE.value    = obj.struct.cnpj_emitente[i];
												DESTINATARIO_NFE.value      = obj.struct.destinatario[i];
												CNPJ_DESTINATARIO_NFE.value = obj.struct.cnpj_destinatario[i];

												NFE_QTDE_VOLUME.value      	= obj.struct.qtde_volume[i];
												NFE_COD_UNIDADE.value      	= obj.struct.cod_unidade[i];
												NFE_NUM_NATUREZA.value     	= obj.struct.num_natureza[i];
												NFE_NATUREZA.value       	= obj.struct.natureza[i];
												NFE_NUM_ESPECIE.value      	= obj.struct.num_especie[i];
												NFE_ESPECIE.value       	= obj.struct.especie[i];
												NFE_ALTURA.value       		= (obj.struct.altura[i] == '')?'0':obj.struct.altura[i];
												NFE_COMPRIMENTO.value      	= (obj.struct.comprimento[i] == '')?'0':obj.struct.comprimento[i];
												NFE_LARGURA.value       	= (obj.struct.largura[i] == '')?'0':obj.struct.largura[i];
												NFE_CUBAGEM.value       	= obj.struct.cubagem[i];
												NFE_CUBAGEM_SUGERIDA.value  = obj.struct.cubagem_sugerida[i];
												ICMS_PARTILHADO.value   = obj.struct.icms_partilhado[i];

												
													NFE_PESO.value               = 0;
													NFE_PESO_CUBADO.value        = 0;
													NFE_PESO_KG_CONVERTIDO.value = 0;
													NFE_PESO_COBRADO.value       = 0;
												
												f_calcula_cubagem('NFE');
												f_salvar_NFE();
											break;

											case 2:
												f_incluir_OUTROS();
													NF_CONHECIMENTO_ID.value		= obj.struct.conhecimento_id[i];
													OUTROS_DESCRICAO.value			= obj.struct.descricao_docto[i];


													OUTROS_VALOR.value				= toCurrency(obj.struct.valor_total[i]);
													OUTROS_QTDE_VOLUME.value      	= obj.struct.qtde_volume[i];
													OUTROS_COD_UNIDADE.value      	= obj.struct.cod_unidade[i];
													OUTROS_NUM_NATUREZA.value     	= obj.struct.num_natureza[i];
													OUTROS_NATUREZA.value       	= obj.struct.natureza[i];
													OUTROS_NUM_ESPECIE.value      	= obj.struct.num_especie[i];
													OUTROS_ESPECIE.value       		= obj.struct.especie[i];
													OUTROS_ALTURA.value       		= (obj.struct.altura[i] == '')?'0':obj.struct.altura[i];
													OUTROS_COMPRIMENTO.value      	= (obj.struct.comprimento[i] == '')?'0':obj.struct.comprimento[i];
													OUTROS_LARGURA.value       		= (obj.struct.largura[i] == '')?'0':obj.struct.largura[i];
													OUTROS_CUBAGEM.value       		= obj.struct.cubagem[i];
													OUTROS_CUBAGEM_SUGERIDA.value   = obj.struct.cubagem_sugerida[i];

													
														OUTROS_PESO.value               = 0;
														OUTROS_PESO_CUBADO.value        = 0;
														OUTROS_PESO_KG_CONVERTIDO.value = 0;
														OUTROS_PESO_COBRADO.value       = 0;
													
													f_calcula_cubagem('OUTROS');
												f_salvar_OUTROS();
											break;
										}
									}
									f_busca_conhecimento_dados();
								}
							 });
		}
	}
	v_cnpj_ordem = '';
	function f_busca_conhecimento_dados(){
		with(document.forms[0]) {
			f_query_wddx("/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_conhecimento_dados",
						 'CONHECIMENTO_ID=' + CONHECIMENTO_ID.value + '&cod_modelo=57'
						 ,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.num_conhecimento.length > 0) {
								  FRETE_EM.value = obj.struct.frete_em[0];

								  // Dados Gerais
								  	v_proprietario_tracao = obj.struct.proprietario_tracao[0];
									CONHECIMENTO_ID.value		= obj.struct.conhecimento_id[0];
									NUM_CONHECIMENTO.value		= obj.struct.num_conhecimento[0];
									DATA_EMISSAO.value			= obj.struct.data_emissao_data_hora[0];
									COD_ORGANOGRAMA_GERENCIAL.value = obj.struct.cod_organograma_gerencial[0];
									PAGADOR.value				= obj.struct.pagador[0];
									PLACA_CONTROLE.value 		= obj.struct.placa_tracao[0];
									PLACA_REFERENCIA.value 		= obj.struct.placa[0];
									REGRA_FISCAL.value			= obj.struct.regra_fiscal_id[0];
									REGRA_FISCAL_ID.value		= obj.struct.regra_fiscal_id[0];

									f_limpar_engates();
									if (obj.struct.placa[0] != '' && obj.struct.placa[0] != obj.struct.placa_tracao[0]) {
										v_obj = f_engata();
										v_obj.setValue(obj.struct.placa[0]);
									}

									COD_PROPRIETARIO.value 		= obj.struct.cod_proprietario[0];
									PROP_CNPJ_CPF.value 		= obj.struct.prop_cnpj_cpf[0];
									PROPRIETARIO.value          = obj.struct.prop_razao_social[0];
									PROP_RAZAO_SOCIAL.value 	= obj.struct.prop_razao_social[0];
									PROP_ENDERECO.value 		= obj.struct.prop_endereco[0];
									PROP_UF.value 				= obj.struct.prop_uf[0];
									COD_MOTORISTA.value 		= obj.struct.cod_motorista[0];
									MOTORISTA.value 			= obj.struct.nome_motorista[0];
									NOME_MOTORISTA.value 		= obj.struct.nome_motorista[0];

									NUM_ROMANEIO.value			= obj.struct.num_romaneio[0];
									ITEM_ID.value				= obj.struct.item_id[0];
									
									COD_PESSOA_FILIAL.value		= obj.struct.cod_pessoa_filial[0];
									COD_DEPARTAMENTO.value		= obj.struct.cod_departamento[0];
									COD_SETOR.value				= obj.struct.cod_setor[0];
									COD_CENTRO_CUSTO.value		= obj.struct.cod_centro_custo[0];
									
									CFOP_ID.value 				= obj.struct.cfop_id[0];
									CFOP.value 					= obj.struct.cfop[0];
									NATUREZA_OPERACAO.value		= obj.struct.natureza_operacao[0];
									M3.value					= obj.struct.m3[0];
									SITUACAO_ID.value			= obj.struct.situacao_id[0];

									IMPRESSO.value				= obj.struct.impresso[0];
									ENTRADA_DADOS.value			= obj.struct.entrada_dados[0];
									TEM_NOTA.value				= 0

									NUM_PRODUTO.value 			= obj.struct.num_produto[0];
									ST_ICMS_ID.value 			= obj.struct.st_icms_id[0];
									ST_ICMS_ID_COMBO.value 		= obj.struct.st_icms_id[0];
									ST_ORIGEM_ID.value 			= obj.struct.st_origem_id[0];
									REGRA_FISCAL_ID.value 		= obj.struct.regra_fiscal_id[0];
									PAGADOR.value 				= obj.struct.pagador[0];
									PRAZO_ENTREGA.value			= obj.struct.prazo_entrega[0];
									PESO.value					= obj.struct.peso[0];
									VOLUME.value 				= obj.struct.volume[0];
									NUM_NATUREZA.value			= obj.struct.num_natureza[0];
									NUM_NATUREZA.onchange();
									NUM_ESPECIE.value			= obj.struct.num_especie[0];
									NUM_ESPECIE.onchange();
									
									RODAPE.value				= obj.struct.rodape[0];

									// Coleta
									COLETA_COD_PESSOA.value			= obj.struct.coleta_cod_pessoa[0];
									COLETA_ENDERECO.value			= obj.struct.coleta_logradouro[0];
									COLETA_CNPJ_CPF.value			= obj.struct.coleta_cnpj_cpf[0];
									COLETA_RAZAO_SOCIAL.value   	= obj.struct.coleta_razao_social[0];
									COLETA_BAIRRO.value				= obj.struct.coleta_bairro[0];
									COLETA_CEP.value				= obj.struct.coleta_cep[0];
									COLETA_MUNICIPIO.value			= obj.struct.coleta_municipio[0];
									COLETA_UF.value 				= obj.struct.coleta_uf[0];
									COLETA_MUNICIPIO_ID.value 		= obj.struct.coleta_municipio_id[0];
//									COLETA_INSCRICAO_ESTADUAL.value = obj.struct.coleta_inscricao_estadual[0];
									f_busca_pessoa_COLETA(0);

									// Entrega
									RED_ENDERECO.value	    = obj.struct.entrega_logradouro[0];
									RED_BAIRRO.value		= obj.struct.entrega_bairro[0];
									RED_CEP.value			= obj.struct.entrega_cep[0];
									RED_MUNICIPIO.value 	= obj.struct.entrega_municipio[0];
									RED_UF.value 			= obj.struct.entrega_uf[0];
									RED_MUNICIPIO_ID.value 	= obj.struct.entrega_municipio_id[0];

									// Rementente
									COD_REMETENTE.value 		= obj.struct.cod_remetente[0];
									REM_CNPJ_CPF.value 			= obj.struct.rem_cnpj_cpf[0];
									REM_RAZAO_SOCIAL.value 		= obj.struct.rem_razao_social[0];
//									REM_INSCRICAO_ESTADUAL.value = obj.struct.rem_inscricao_estadual[0];
									REM_ENDERECO.value 			= obj.struct.rem_endereco[0];
									REM_ENDERECO_NUM.value 		= obj.struct.rem_endereco_num[0];
									REM_BAIRRO.value 			= obj.struct.rem_bairro[0];
									REM_CEP.value 				= obj.struct.rem_cep[0];
									REM_MUNICIPIO.value 		= obj.struct.rem_municipio[0];
									REM_MUNICIPIO_ID.value 		= obj.struct.rem_municipio_id[0];
									REM_UF.value 				= obj.struct.rem_uf[0];

									// Destinatario
									COD_DESTINATARIO.value 		= obj.struct.cod_destinatario[0];
									DEST_CNPJ_CPF.value 		= obj.struct.dest_cnpj_cpf[0];
									DEST_RAZAO_SOCIAL.value 	= obj.struct.dest_razao_social[0];
//									DEST_INSCRICAO_ESTADUAL.value = obj.struct.dest_inscricao_estadual[0];
									DEST_ENDERECO.value 		= obj.struct.dest_endereco[0];
									DEST_ENDERECO_NUM.value 	= obj.struct.dest_endereco_num[0];
									DEST_BAIRRO.value 			= obj.struct.dest_bairro[0];
									DEST_CEP.value 				= obj.struct.dest_cep[0];
									DEST_MUNICIPIO.value 		= obj.struct.dest_municipio[0];
									DEST_MUNICIPIO_ID.value 	= obj.struct.dest_municipio_id[0];
									DEST_UF.value 				= obj.struct.dest_uf[0];

									// Redespacho - Entrega
									COD_REDESPACHO.value 	= obj.struct.cod_redespacho[0];
									RED_CNPJ_CPF.value 		= obj.struct.red_cnpj_cpf[0];
									RED_RAZAO_SOCIAL.value 	= obj.struct.red_razao_social[0];
//									RED_INSCRICAO_ESTADUAL.value = obj.struct.red_inscricao_estadual[0];
									RED_ENDERECO.value 			= obj.struct.red_endereco[0];
									RED_ENDERECO_NUM.value 		= obj.struct.red_endereco_num[0];
									RED_BAIRRO.value 			= obj.struct.red_bairro[0];
									RED_CEP.value 				= obj.struct.red_cep[0];
									RED_MUNICIPIO.value 		= obj.struct.red_municipio[0];
									RED_MUNICIPIO_ID.value 		= obj.struct.red_municipio_id[0];
									RED_UF.value 				= obj.struct.red_uf[0];

									// Cliente Cobranca
									COD_CLIENTE_COBRANCA.value 	= obj.struct.cod_cliente_cobranca[0];
									COB_CNPJ_CPF.value 			= obj.struct.cob_cnpj_cpf[0];
									COB_RAZAO_SOCIAL.value 		= obj.struct.cob_razao_social[0];
//									COB_INSCRICAO_ESTADUAL.value = obj.struct.cob_inscricao_estadual[0];
									COB_ENDERECO.value 			= obj.struct.cob_endereco[0];
									COB_ENDERECO_NUM.value 		= obj.struct.cob_endereco_num[0];
									COB_BAIRRO.value 			= obj.struct.cob_bairro[0];
									COB_CEP.value 				= obj.struct.cob_cep[0];
									COB_MUNICIPIO.value 		= obj.struct.cob_municipio[0];
									COB_MUNICIPIO_ID.value 		= obj.struct.cob_municipio_id[0];
									COB_UF.value 				= obj.struct.cob_uf[0];

									// Cliente Negociador
									COD_NEGOCIADOR.value 		= obj.struct.cod_negociador[0];
									NEG_CNPJ_CPF.value 			= obj.struct.neg_cnpj_cpf[0];
									NEG_RAZAO_SOCIAL.value 		= obj.struct.neg_razao_social[0];
//									NEG_INSCRICAO_ESTADUAL.value = obj.struct.neg_inscricao_estadual[0];
									NEG_ENDERECO.value 			= obj.struct.neg_endereco[0];
									NEG_ENDERECO_NUM.value 		= obj.struct.neg_endereco_num[0];
									NEG_BAIRRO.value 			= obj.struct.neg_bairro[0];
									NEG_CEP.value 				= obj.struct.neg_cep[0];
									NEG_MUNICIPIO.value 		= obj.struct.neg_municipio[0];
									NEG_MUNICIPIO_ID.value 		= obj.struct.neg_municipio_id[0];
									NEG_UF.value 				= obj.struct.neg_uf[0];

									ADEME.value					= obj.struct.ademe[0];
									DESCONTO.value				= obj.struct.desconto[0];
									IMPOSTOS.value				= obj.struct.impostos[0];
									DESPACHO_CALC.value			= obj.struct.despacho[0];
									PEDAGIO_CALC.value			= obj.struct.pedagio[0];
									SEC_CAT_CALC.value			= obj.struct.sec_cat[0];
									GRIS_CALC.value				= obj.struct.gris[0];
									COLETA_ENTREGA_CALC.value	= obj.struct.coleta_entrega[0];
									DESPACHO.value				= obj.struct.despacho[0];
									PEDAGIO.value				= obj.struct.pedagio[0];
									SEC_CAT.value				= obj.struct.sec_cat[0];
									GRIS.value					= obj.struct.gris[0];
									COLETA_ENTREGA.value		= obj.struct.coleta_entrega[0];
									FRETE_UNITARIO.value		= obj.struct.frete_unitario[0];
									FRETE_UNITARIO_DESC.value	= obj.struct.frete_unitario[0];
									FRETE_PESO.value			= obj.struct.frete_peso[0];
									FRETE_VALOR.value			= obj.struct.frete_valor[0];
									BASE_CALCULO_ICMS.value		= obj.struct.base_calculo_icms[0];
									ALIQUOTA_ICMS.value			= obj.struct.aliquota_icms[0];
									VALOR_ICMS.value			= obj.struct.valor_icms[0];
									TOTAL_CONHECIMENTO.value	= obj.struct.total_conhecimento[0];
									VALOR_ICMS_SUBSTIT.value	= obj.struct.valor_icms_substit[0];
									OPERACAO_ID.value		    = obj.struct.operacao_id[0];
									OPERACAO_CTRC.value		    = obj.struct.operacao_descricao[0];
									OPERACAO_ID_CTRC.value		= obj.struct.operacao_id[0];
									ORGANIZACIONAL_ID_GERENCIAL.value =  obj.struct.organizacional_id[0];

									if (NUM_PRODUTO.value == 7) {
										BASE_CALCULO_ICMS.value		= obj.struct.base_calculo_iss[0];
										ALIQUOTA_ICMS.value			= obj.struct.aliquota_iss[0];
										VALOR_ICMS.value			= obj.struct.valor_iss[0];
									}

									if ( obj.struct.valor_icms_substit[0] > 0)
										document.getElementById("tr_icms_substit").style.display = '';
									else
										document.getElementById("tr_icms_substit").style.display = 'none';

									v_cnpj_ordem = obj.struct.cnpj_ordem[0];
									PESO_KG.value = obj.struct.peso[0];
									f_on_busca_conhecimento();
									
										f_busca_tipo_calculo();
									
								}
								else {
								 alert('Conhecimento não encontrado!');
								 f_incluir();

								}
							}
						});
		}
		f_busca_tipo_servico();
	}

	function f_on_busca_conhecimento() {
	}

	var setReadOnly = [];

	setReadOnly['complemento'] = function(value) {
		with(document.forms[0]) {
			IMPRESSO.value 						= 0;
			OPERACAO_ID.readOnly 				= value;
			ST_ICMS_ID_COMBO.disabled			= value;
			COD_ORGANOGRAMA_GERENCIAL.disabled 	= value;
			NUM_PRODUTO.disabled				= true;
			PLACA_CONTROLE.readOnly				= value;
			PLACA_REFERENCIA.readOnly			= value;
			setReadOnly['composicao'](true);
			setReadOnly['NOTAS_FISCAIS'](true);
			setReadOnly['mercadorias_dados'](true);
			setReadOnly['mercadorias_calculos'](false);
			FRETE_UNITARIO_DESC.readOnly =  true;
		}
	}

	setReadOnly['substituto'] = function(value) {
		with(document.forms[0]) {
			IMPRESSO.value 						= 0;
			OPERACAO_ID.readOnly 				= value;
			ST_ICMS_ID_COMBO.disabled			= value;
			COD_ORGANOGRAMA_GERENCIAL.disabled 	= value;
			REGRA_FISCAL_ID.disabled			= value;
			REGRA_FISCAL.disabled				= value;
			NUM_PRODUTO.disabled				= value;
			PLACA_CONTROLE.readOnly				= value;
			PLACA_REFERENCIA.readOnly			= value;
			setReadOnly['composicao'](value);
			setReadOnly['mercadorias_dados'](value);
			setReadOnly['mercadorias_calculos'](value);
			FRETE_UNITARIO_DESC.readOnly =  value;
			ALIQUOTA_ICMS.readOnly = value;

			
				setReadOnly['NOTAS_FISCAIS'](value);

				try {
					document.getElementById('tr_lista_botoes_NOTAS_FISCAIS').style.display = 'none';
					document.getElementById('tr_lista_botoes_NFE').style.display = 'none';
					document.getElementById('tr_lista_botoes_OUTROS').style.display = 'none';
				} catch(e) {}
			
			setReadOnly['REM'](value);
			setReadOnly['DEST'](value);
			setReadOnly['COLETA'](value);
			setReadOnly['RED'](value);
            //setReadOnly['COB'](value);
			setReadOnly['NEG'](value);

			PAGADOR.disabled = value;
		}
	}

	setReadOnly['substitutoAberto'] = function(value) {
		with(document.forms[0]) {
			IMPRESSO.value 						= 0;
			//OPERACAO_ID.readOnly 				= value;
			//ST_ICMS_ID_COMBO.disabled			= value;
			COD_ORGANOGRAMA_GERENCIAL.disabled 	= value;
			//REGRA_FISCAL_ID.disabled			= value;
			//REGRA_FISCAL.disabled				= value;
			//NUM_PRODUTO.disabled				= value;
			//PLACA_CONTROLE.readOnly				= value;
			//PLACA_REFERENCIA.readOnly			= value;
			//setReadOnly['composicao'](value);
			//setReadOnly['NOTAS_FISCAIS'](value);/**/
			//setReadOnly['mercadorias_dados'](value);
			//setReadOnly['mercadorias_calculos'](value);
			//FRETE_UNITARIO_DESC.readOnly =  value;
			//ALIQUOTA_ICMS.readOnly = value;

			/*try {
				document.getElementById('tr_lista_botoes_NOTAS_FISCAIS').style.display = 'none';
				document.getElementById('tr_lista_botoes_NFE').style.display = 'none';
				document.getElementById('tr_lista_botoes_OUTROS').style.display = 'none';
			} catch(e) {}
			setReadOnly['REM'](value);
			setReadOnly['DEST'](value);
			setReadOnly['COLETA'](value);
			setReadOnly['RED'](value);
			setReadOnly['COB'](value);
			setReadOnly['NEG'](value);

			PAGADOR.disabled = value;*/
		}
	}


	setReadOnly['frota_agregado'] = function(value) {
		with(document.forms[0]) {
			OPERACAO_ID.readOnly 					= value;
			REGRA_FISCAL_ID.disabled			= value;
			REGRA_FISCAL.disabled				= value;
			ST_ICMS_ID_COMBO.disabled			= value;
			PAGADOR.disabled					= value;
			NUM_PRODUTO.disabled				= true;
			PLACA_CONTROLE.readOnly				= value;
			PLACA_REFERENCIA.readOnly			= value;
			setReadOnly['REM'](true);
			setReadOnly['RED'](true);
			setReadOnly['composicao'](true);
		}
	}

	setReadOnly['subcontratado'] = function(value) {
		with(document.forms[0]) {
			OPERACAO_ID.readOnly 					= value;
			COD_ORGANOGRAMA_GERENCIAL.disabled 	= value;
			REGRA_FISCAL_ID.disabled			= value;
			ST_ICMS_ID_COMBO.disabled			= value;
			PAGADOR.disabled					= value;
			NUM_PRODUTO.disabled				= true;
			PLACA_CONTROLE.readOnly				= value;
			PLACA_REFERENCIA.readOnly			= value;
			setReadOnly['rem_dest'](true);
			setReadOnly['NOTAS_FISCAIS'](true);
			setReadOnly['mercadorias_dados'](true);
			setReadOnly['composicao'](true);
			REGRA_FISCAL.disabled = true;
			DATA_EMISSAO.readOnly = true;
			document.getElementById('btn_data_emissao').style.display = 'none';
			PRAZO_ENTREGA.readOnly = true;
			document.getElementById('btn_prazo_entrega').style.display = 'none';
			PESO.readOnly =  true;
			COD_UNIDADE.disabled = true;
			ALIQUOTA_ICMS.readOnly = true;
		}
	}

	setReadOnly['terceiro'] = function(value) {
		with(document.forms[0]) {
			ST_ICMS_ID_COMBO.disabled			= value;
			REGRA_FISCAL.disabled = value;
			NUM_PRODUTO.disabled = true;
			setReadOnly['REM'](value);
		}
	}

	function f_seta_placa_controle(value) {
		with(document.forms[0]) {
			PLACA_CONTROLE.value = value;
			PLACA_CONTROLE.onchange();
		}
	}
	function f_seta_placa_referencia(value,idx) {
		with(document.forms[0]) {
			try {
				document.getElementById('PLACA_REFERENCIA_'+idx).value = value;
			} catch(e) {}
		}
	}
	function f_seta_placa_referencia2(value) {
		with(document.forms[0]) {
			PLACA_REFERENCIA2.value = value;
		}
	}

	function f_none() {

	}

	v_placas_referencia = [];
	function f_engata() {
		v_obj = new PlacaReferencia(document.getElementById('sp_placa_referencia'),v_placas_referencia.length+1);
		v_placas_referencia.push(v_obj);
		return v_obj;
	}

	function f_desengata() {
		if (v_placas_referencia.length > 0) {
			v_placas_referencia[v_placas_referencia.length-1].destroy();
			v_placas_referencia.pop();
			return true;
		}
		return false;
	}
	function f_limpar_engates() {
		while(f_desengata());
	}
	function f_limpar_engates_brancos() {
		for(var i=v_placas_referencia.length-1;i>=0;i--) {
			if(v_placas_referencia[i].getValue().replace(/ /g,'') == '') {
				v_placas_referencia[i].destroy();
				v_placas_referencia.splice(i,1);
			}
		}
	}

	function f_busca_dado_veiculo_referencia(v_codigo,v_id){
		if(v_codigo != '')
		{
			with(document.forms[0]) {
				var ePlaca=/[A-Z]{3}\-?[0-9]{4}/gi;
				if(ePlaca.test(v_codigo))//se é uma placa remove o -
					v_codigo=v_codigo.replace("-","");
				f_query_wddx("/modulos/cte/_componentes/consulta/cfc_veiculo.cfc?method=get_veiculo",'frota_exa='+v_codigo,
					function(obj){
						if(obj.ajax.readyState == 4 && obj.ajax.status == 200) { // Quando estiver tudo pronto.
							if(obj.struct.placa!='')
							{
								if(obj.struct.tracao==0)
									document.getElementById(v_id).value = obj.struct.placa;
								else
								{
									PLACA_CONTROLE.value = obj.struct.placa;
									f_busca_composicao();
								}
							}
							else
							{
								alert("Veículo não encontrado.");
							}
						}
					});
			}
		}
	}

	function PlacaReferencia (group,index) {
		this.group = group;

		this.index = index;
		this.obj = document.createElement('nobr');
		this.input = document.createElement('input');
		with(this.input) {
			style.marginRight = '4px';
			style.width = '75px';
			name		= 'PLACA_REFERENCIA_INTERNA';
			type		= 'text';
			id			= 'PLACA_REFERENCIA_'+index;
			onchange = function(){f_busca_dado_veiculo_referencia(this.value,id);}
			onkeypress	= function () {
				return f_formata(this,event,'AAAAAAAAAAAAAAAA');
			}
			obrigatorio	= 0
			
			display		= 'PLACA DE REFERENCIA';
		}
		this.obj.appendChild(this.input);
		this.btnLocalizar = document.createElement('button');
		with(this.btnLocalizar) {
			idx = index;
			onclick = function () {
				NewWindow('/modulos/cte/_localizar/localizar_veiculo.cfm?proprietario=3&placa=PLACA_REFERENCIA&funcao=f_seta_placa_referencia(PLACA_REFERENCIA.value,'+index+')','_blank',800,600,'yes');
			}
			className = "botao-16x16";
		}
		this.btnLocalizarIMG = document.createElement('img');
		with (this.btnLocalizarIMG) {
			src = "/_imagens/botoes/16x16/buscar.gif";
			alt = "Buscar Veículo";
			width = "16";
			height="16";
			align="absmiddle";
		}
		this.btnLocalizar.appendChild(this.btnLocalizarIMG);
		this.obj.appendChild(this.btnLocalizar);
		this.btnCadastrar = document.createElement('button');
		with(this.btnCadastrar) {
			idx = index;
			onclick = function () {
				f_abrir_janela('/aplicacoes/cadastros/veiculos/principal.cfm?funcao_end=f_incluir()','f_seta_placa_referencia(f_get_placa_veiculo(),'+index+')',800,600);
			}
			className = "botao-16x16";
		}
		this.btnCadastrarIMG = document.createElement('img');
		with (this.btnCadastrarIMG) {
			src = "/_imagens/botoes/16x16/cadastrar.gif";
			alt = "Cadastrar Veículo de Terceiro";
			width = "16";
			height="16";
			align="absmiddle";
		}
		this.btnCadastrar.appendChild(this.btnCadastrarIMG);
		this.obj.appendChild(this.btnCadastrar);
		this.getObj = function () {
			return this.obj;
		}
		group.appendChild(this.obj);
		this.destroy = function() {
		    try {
				this.obj.removeNode(true);
			} catch(e) {}
			
		}
		this.setValue = function (value) {
			this.input.value = value;
		}
		this.getValue = function () {
			return this.input.value;
		}
		this.setReadOnly = function (value) {
			this.input.readOnly = value;
			this.btnLocalizar.disabled = value;
			this.btnCadastrar.disabled = value;
		}
		
			this.btnLocalizar.style.visibility = 'hidden';
			this.btnCadastrar.style.visibility = 'hidden';
		
		if (document.v_comp_readonly) {
			this.setReadOnly(true);
		}
	}

	document.v_comp_readonly = false;
	setReadOnly['composicao'] = function(value) {
		with(document.forms[0]) {
			document.v_comp_readonly = value;
			PLACA_CONTROLE.readOnly = value;
			document.getElementById('btn_localizar_placa_tracao').disabled = value;
			document.getElementById('btn_cadastrar_placa_tracao').disabled = value;
			document.getElementById('btn_engata').disabled = value;
			document.getElementById('btn_desengata').disabled = value;
			for(var i=0;i<v_placas_referencia.length;i++) {
				v_placas_referencia[i].setReadOnly(value);
			}
		}
	}

	function f_muda_pagador() {
		with(document.forms[0]) {

			ST_ICMS_ID.value = '';
			ST_ICMS_ID_COMBO.value = '';

			if (COB_CNPJ_CPF.readOnly)
				return false;

			if(PAGADOR.value == '') {
				f_limpa_COB();
			}else if(PAGADOR.value == 0) {
				v_endereco_copiar = REM_CB_ENDERECO.value;
				f_copia_cliente_COB('REM','COD_REMETENTE');
			} else {
				v_endereco_copiar = DEST_CB_ENDERECO.value;
				f_copia_cliente_COB('DEST','COD_DESTINATARIO');
			}

			//Somente chama os calculos se não estiver limpando o campo
			if(PAGADOR.value != ''){
				f_calculos();
			}
		}
	}

	function f_muda_tipo_frete(p_executa_calculos) {
		f_busca_produto_frete(p_executa_calculos);
	}

	

	function f_muda_uf(p_busca_tipo_calculo) {
		with(document.forms[0]) {
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_administracao.cfc?method=get_filial_uf'
						,'cod_pessoa=' + COD_PESSOA_FILIAL.value
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.uf.length == 0) {
									alert('Erro ao selecionar filial.');
								}
								else {
									UF_FILIAL_EMISSAO.value = 	obj.struct.uf[0];
									if(document.forms[0].NUM_ROMANEIO_FROTA) {
										if(document.forms[0].NUM_ROMANEIO_FROTA.value) {
											if(p_busca_tipo_calculo == 1) {
												f_busca_tipo_calculo();
											}
											else {
												f_calculos();
											}
										}
									}
									else {
										if(p_busca_tipo_calculo == 1) {
											f_busca_tipo_calculo();
										}
										else {
											f_calculos();
										}
									}
								}
							}
						});
		}
	}

	function f_busca_serie() {
		with(document.forms[0]) {
			f_limpa_select(SERIE);

			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_serie'
						,'cod_pessoa_filial=' + COD_PESSOA_FILIAL.value +
						'&cod_departamento=' + COD_DEPARTAMENTO.value +
						'&cod_setor=' + COD_SETOR.value +
						'&cod_centro_custo=' + COD_CENTRO_CUSTO.value +
						'&cod_modelo=\'57\''
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.serie.length > 0) {
									for(var i = 0; i < obj.struct.serie.length; i++) {
										f_cria_option(obj.struct.serie[i], obj.struct.serie[i], SERIE);
									}
								}
								else {
									alert('Nenhuma série de CTRC (57 - Conhecimento de Transporte Eletrônico) foi encontrada para o organograma escolhido. Entre em contato com o departamento Fiscal.');
								}
							}
						});
		}
	}

	function f_preenche_operacao(p_operacao_id, p_descricao){
		with(document.forms[0]) {
			OPERACAO_ID_CTRC.value = p_operacao_id;
			OPERACAO_CTRC.value    = p_descricao;
		}
	}

	function f_localizar_operacao(){
		with(document.forms[0]) {
			NewWindow('localizar_operacao.cfm?somente_ativas=1&lotacao=' + LOTACAO.value + '&cod_pessoa_filial=' + COD_PESSOA_FILIAL.value + '&cod_departamento=' + COD_DEPARTAMENTO.value +
                       '&cod_setor=' + COD_SETOR.value + '&cod_centro_custo=' + COD_CENTRO_CUSTO.value + '&internacional=' + INTERNACIONAL.value + '&campo=OPERACAO_ID&funcao=f_busca_operacao()','_blank',600,600,'yes');

		}
	}

	function f_mensagem_contingencia(){
		with(document.forms[0]) {
			
				document.getElementById('contingencia').innerHTML = '';

			
		}
	}

	function f_busca_organizacional(p_operacao_id) {
		with(document.forms[0]) {

			f_limpa_select(ORGANIZACIONAL_ID);
			COD_ORGANIZACIONAL.value = '';

			if(p_operacao_id == '')
				return;

			var v_filtro = '';
			if(p_operacao_id != '' && p_operacao_id != null) {
				v_filtro = 'operacao_id=' + p_operacao_id + '&entrada_saida=1';
			}

			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_organizacional'
						,v_filtro
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.organizacional_id.length > 0) {
									f_limpa_select(ORGANIZACIONAL_ID);
									if(obj.struct.organizacional_id.length > 1) {
										v_opt = f_cria_option('', '-- Selecione --', ORGANIZACIONAL_ID);
										v_opt.setAttribute('codigo', '');
									}

									for(var i = 0; i < obj.struct.organizacional_id.length; i++) {
										v_opt = f_cria_option(obj.struct.organizacional_id[i], obj.struct.descricao_completa[i], ORGANIZACIONAL_ID);
										v_opt.setAttribute('codigo', obj.struct.cod_organizacional[i]);
										if( ORGANIZACIONAL_ID_GERENCIAL.value != '' && ORGANIZACIONAL_ID_GERENCIAL.value == obj.struct.organizacional_id[i]){
											v_opt.selected = true;
											COD_ORGANIZACIONAL.value = obj.struct.cod_organizacional[i];
										}
									}

									

								}
								
								else {
									alert('Nenhum Centro de Custo Gerencial foi encontrado para esta operação.');
								}
								
							}
						});
		}
	}


	function f_muda_organizacional() {
		with(document.forms[0]) {
			for(var i = 0; i < ORGANIZACIONAL_ID.options.length; i++) {
				if(ORGANIZACIONAL_ID.options[i].getAttribute('codigo') == COD_ORGANIZACIONAL.value) {
					ORGANIZACIONAL_ID.options[i].selected = true;
					return;
				}
			}
			ORGANIZACIONAL_ID.value = '';
			alert('Centro de Custo Gerencial não encontrado.');
		}
	}

	function f_busca_dados_item() {
		with(document.forms[0]) {
			try {
				document.getElementById('tr_romaneio_carregando').style.display = '';
			} catch(e) {}
			CONSULTA.value = 1;
			target = 'consultas';
			action = 'consultas.cfm';
			submit();
		}
	}

	function f_busca_operacao() {
		with(document.forms[0]) {
			
			f_limpa_REM();
			setReadOnly['REM'](false);

			
			f_limpa_COLETA();
			setReadOnly['COLETA'](false);

			
			f_limpa_DEST();

			setReadOnly['DEST'](false);

			
			f_limpa_RED();
			setReadOnly['RED'](false);

			
			f_limpa_COB();
			setReadOnly['COB'](false);

			
			f_limpa_NEG();
			setReadOnly['NEG'](false);

			
			f_limpar_NOTAS_FISCAIS();
			f_limpar_NFE();
			f_limpar_OUTROS();

			if(OPERACAO_ID_CTRC.value == '') {
				document.getElementById('tr_operacao_carregando').style.display = 'none';
				OPERACAO_CTRC.value = '';
				OPERACAO_ID_CTRC.value = '';
				TIPO_FRETE.value = '';
				CIF_FOB.value = 0;
				document.getElementById('sp_produto_definido').style.display = 'none';
				NUM_PRODUTO.disabled = false;

				
				f_limpa_select(document.getElementById('COD_PESSOA_FILIAL'));
				f_limpa_select(document.getElementById('COD_DEPARTAMENTO'));
				f_limpa_select(document.getElementById('COD_SETOR'));
				f_limpa_select(document.getElementById('COD_CENTRO_CUSTO'));

				f_cria_option('', '-- Selecione uma Operação Logística --', document.getElementById('COD_PESSOA_FILIAL'));
				f_cria_option('', '-- Selecione uma Filial --', document.getElementById('COD_DEPARTAMENTO'));
				f_cria_option('', '-- Selecione um Departamento --', document.getElementById('COD_SETOR'));
				f_cria_option('', '-- Selecione um Setor --', document.getElementById('COD_CENTRO_CUSTO'));

				
				f_limpa_select(document.getElementById('ORGANIZACIONAL_ID'));
				f_cria_option('', '-- Selecione uma Operação Logística --', document.getElementById('ORGANIZACIONAL_ID'));
				COD_ORGANIZACIONAL.value = '';

				return;
			}

			document.getElementById('tr_operacao_carregando').style.display = '';

			CONSULTA.value = 4;
			target = 'consultas';
			action = 'consultas.cfm';
			submit();
		}
	}

	function f_limpa_romaneio(p_nao_limpar_filial) {
		with(document.forms[0]) {
			try {
				document.getElementById('td_romaneio').innerHTML = '';
			} catch(e) {}

			ITEM_ID.value				= '';
			OPERACAO_ID.value 		    = '';

			NUM_PRODUTO.value 			= '';

			REGRA_FISCAL_ID.value 		= '1';
			REGRA_FISCAL.value 			= '1';
			PAGADOR.value 				= '';
			VIAGEM_CARGA_ID.value		= '';
			SOLICITACAO_CARGA_ID.value	= '';
			VIAGEM_ID.value	= '';

			
			f_limpa_select(document.getElementById('ORGANIZACIONAL_ID'));
			f_cria_option('', '-- Selecione uma Operação Logística --', document.getElementById('ORGANIZACIONAL_ID'));
			COD_ORGANIZACIONAL.value = '';

			
			f_limpar_NOTAS_FISCAIS();
			f_limpar_NFE();
			f_limpar_OUTROS();

			
			f_limpa_REM();
			
				setReadOnly['REM'](false);
			

			
			f_limpa_COLETA();
			
				setReadOnly['COLETA'](false);
			

			
			f_limpa_DEST();
			
				setReadOnly['DEST'](false);
			

			
			f_limpa_RED();
			
				setReadOnly['RED'](false);
			

			
			f_limpa_COB();
			
				setReadOnly['COB'](false);
			

			
			f_limpa_NEG();
			
				setReadOnly['NEG'](false);
			

			if(p_nao_limpar_filial == 1) {
			
				f_limpa_select(document.getElementById('COD_PESSOA_FILIAL'));
				f_limpa_select(document.getElementById('COD_DEPARTAMENTO'));
				f_limpa_select(document.getElementById('COD_SETOR'));
				f_limpa_select(document.getElementById('COD_CENTRO_CUSTO'));

				f_cria_option('', '-- Selecione uma Operação --', document.getElementById('COD_PESSOA_FILIAL'));
				f_cria_option('', '-- Selecione uma Filial --', document.getElementById('COD_DEPARTAMENTO'));
				f_cria_option('', '-- Selecione um Departamento --', document.getElementById('COD_SETOR'));
				f_cria_option('', '-- Selecione um Setor --', document.getElementById('COD_CENTRO_CUSTO'));

			}

			
			MUNICIPIO_ULT_ENTREGA.value    = '';
			MUNICIPIO_ULT_ENTREGA_UF.value = '';
			PRAZO_ENTREGA.value  		   = '';

			
			OPERACAO_ID_CTRC.value	= '';
			OPERACAO_CTRC.value     = '';
			CFOP_ID.value			= '';
			CFOP.value				= '';
			PROPRIETARIO.value      = '';
			MOTORISTA.value         = '';
			f_limpar_engates();

			
			f_limpa_vale_pedagio();
			
			EMITE_MULTIMODAL.value = '0';
			VINCULADO_MULTIMODAL.value = '0';
			f_valida_cte_ref();
		}
	}

	function f_busca_composicao(p_busca_item) {
		with(document.forms[0]) {
			var ePlaca=/[A-Z]{3}\-?[0-9]{4}/gi;
			if(ePlaca.test(PLACA_CONTROLE.value))//se é uma placa remove o -
				PLACA_CONTROLE.value=PLACA_CONTROLE.value.replace("-","");
			if(PLACA_CONTROLE.value == '') {
				PLACA_REFERENCIA.value 		= '';
				VEICULO_PROPRIETARIO.value 	= '';
				COD_PROPRIETARIO.value  	= '';
				PROP_CNPJ_CPF.value 		= '';
				PROPRIETARIO.value          = '';
				PROP_RAZAO_SOCIAL.value 	= '';
				PROP_ENDERECO.value     	= '';
				PROP_UF.value 				= '';
				f_limpar_engates();
				return;
			}
			
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_veiculo.cfc?method=get_composicao'
						,'cod_veiculo='+PLACA_CONTROLE.value
						 +'&data='+DATA_BASE_COMPOSICAO.value
						 +'&trata_erro=1'
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.erro!='true')
								{
									f_busca_dado_veiculo();
									with(document.forms[0]) {
										VEICULO_PROPRIETARIO.value = 1;
										if(obj.struct.cod_veiculo.length == 0) {
											alert('Veiculo não cadastrado.');
											PLACA_REFERENCIA.value = '';
											PLACA_CONTROLE.select();
											return;
										}
									
										PLACA_CONTROLE.value = obj.struct.placa[0];
										f_limpar_engates();

										for (var i=1;i<obj.struct.placa.length;i++) {
											v_obj = f_engata();
											v_obj.setValue(obj.struct.placa[i]);
										}

										if (obj.struct.veiculo_proprietario[0] == 2) {
										   VEICULO_PROPRIETARIO.value = 2;
										}
										else
										if (p_busca_item)
										   f_busca_romaneio_item();
										
										VEICULO_PROPRIETARIO.value = 	obj.struct.veiculo_proprietario[0];
									}
								}
								else{
									alert('Erro ao localizar veículo: ' + obj.struct.mensagem.detail);
								}
							}
						});

			f_valida_veiculos();
			f_busca_sincronia_pendente();
		}
	}
	
	function f_busca_sincronia_pendente(){
		with(document.forms[0]) {
			if(PLACA_CONTROLE.value == ''){
				document.getElementById('lbl_sincronia_pendente').innerHTML = '';
				document.getElementById('lbl_sincronia_pendente').style.display = 'none';
				return;
			}
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_veiculo.cfc?method=get_sincronia_pendente'
						 ,'placa=' + PLACA_CONTROLE.value
						 ,function(obj) {
							if (obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.sincronia_pendente[0] == ''){
									document.getElementById('lbl_sincronia_pendente').innerHTML = '';
									document.getElementById('lbl_sincronia_pendente').style.display = 'none';
								}else{
									document.getElementById('lbl_sincronia_pendente').innerHTML = obj.struct.sincronia_pendente[0];
									document.getElementById('lbl_sincronia_pendente').style.display = '';
								}
							} else {
								document.getElementById('lbl_sincronia_pendente').innerHTML = '';
								document.getElementById('lbl_sincronia_pendente').style.display = 'none';
							}
						 });
		}
	}
	
	function f_busca_dado_veiculo(){
		with(document.forms[0]) {
			if(PLACA_CONTROLE.value == '')
				return;
			f_query_wddx("/modulos/cte/_componentes/consulta/cfc_veiculo.cfc?method=get_motorista_proprietario",'PLACA_CONTROLE='+PLACA_CONTROLE.value+'&DATA_EMISSAO='+DATA_EMISSAO.value,f_busca_dado_veiculo_result);
		}
	}

	function f_busca_dado_veiculo_result(obj){ //callback functions always take one argument. This is the result passed back from the server.
		if(obj.ajax.readyState == 4) { // Quando estiver tudo pronto.
			with(document.forms[0]) {
				COD_PROPRIETARIO.value  = obj.struct.cod_pessoa_proprietario;
				PROP_CNPJ_CPF.value 	= obj.struct.cnpj_prop;
				PROPRIETARIO.value      = obj.struct.proprietario;
				PROP_RAZAO_SOCIAL.value = obj.struct.proprietario;
				PROP_ENDERECO.value     = obj.struct.endereco;
				PROP_UF.value 			= obj.struct.uf;

				return true;
			}
		}
	}

	function f_validar_chave_nfe() {
		with(document.forms[0]) {
			f_cria_carregando_ajax();
			OPERACAO.value = 13;
			target = 'consultas';
			action = 'confirma.cfm';
			submit();
		}
		return false;
	}

	function f_validar_chave_cte() {
		with(document.forms[0]) {
			f_cria_carregando_ajax();
			OPERACAO.value = 17;
			target = 'consultas';
			action = 'confirma.cfm';
			submit();
		}
		return false;
	}

	function f_show_erro_tf(){
		showModal('/publico/mensagem_erro.cfm', 'msg_erro', 'yes', 'yes', 'no', 600, 600);
		document.form_erro.submit();
	}

	function f_valida_autorizacao(){
		with(document.forms[0]) {
			
		}
	}

	function f_valida_obs_globalizado(){
		with(document.forms[0]) {
			if(TIPO_DOCUMENTO_OPERACAO.value == '2'){
				document.getElementById('fld_obs_globalizado').style.display = '';
				document.getElementById('fld_obs_globalizado').disabled = 0;				
			} else {		
				document.getElementById('fld_obs_globalizado').style.display = 'none';
				document.getElementById('fld_obs_globalizado').disabled = 1;
				OBSERVACAO_GLOBALIZADO.value = '';
			}			
		}
	}

	function f_valida_cte_ref(){
		with(document.forms[0]) {
			document.getElementById("td_cte_ref_content").style.display = 'none';
			document.getElementById("td_cte_ref_title").style.display = 'none';		    
			setReadOnly['NOTA_MERCADORIA'](false);

			if (VINCULADO_MULTIMODAL.value == '1') {
				if(POSSUI_MULTIMODAL_VINCULADO.value != '0'){
					
						setReadOnly['NOTA_MERCADORIA'](true);
					
				}

				document.getElementById("td_cte_ref_content").style.display = '';
				document.getElementById("td_cte_ref_title").style.display = '';
				
				document.getElementById("tr_cte_ref_pesos").style.display = 'none';
				document.getElementById('tr_lista_botoes_CTES_REF').style.display = '';
				document.getElementById('CTE_REF_CHAVE').readOnly = false;
			}
			if (EMITE_MULTIMODAL.value == '1'){
				document.getElementById("tr_cte_ref_pesos").style.display = '';
				document.getElementById('tr_lista_botoes_CTES_REF').style.display = 'none';
				document.getElementById('CTE_REF_CHAVE').readOnly = true;
				
				document.getElementById('NOTA_PESO').readOnly = false;
				document.getElementById('NFE_PESO').readOnly = false;
				document.getElementById('OUTROS_PESO').readOnly = false;
				document.getElementById('tr_lista_botoes_NOTAS_FISCAIS').style.display = '';
				document.getElementById('tr_lista_botoes_NFE').style.display = '';
				document.getElementById('tr_lista_botoes_OUTROS').style.display = '';
			}
			
			f_pedido_shipment_edicao(PEDIDO_SHIPMENT_EDICAO.value);
	    }
	}

	function f_valida_peso_cte_ref(){
		with(document.forms[0]) {
		    if (EMITE_MULTIMODAL.value == '1' && VINCULADO_MULTIMODAL.value == '1') { 
		       var v_peso;
			    var v_peso_permitido;
			    v_ctes  = f_listagem_CTES_REF();
			    for(i=0; i<v_ctes.length; i++){
			        v_peso = document.getElementById('CTE_REF_PESO_REAL_CTES_REF_' + v_ctes[i].id);
				    v_peso_permitido = document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_' + v_ctes[i].id)
			       
				    if (Number(v_peso.value) > Number(v_peso_permitido.value)) {
			          alert('Os documentos vinculados ao CT-e possuem um peso total de '+v_peso.value+'. Esse peso não pode ultrapassar o valor máximo permitido de '+v_peso_permitido.value+'.');
			          return false;
					}
			    }
			}
			return true;
		}
	}

	function f_prazo_entrega(v_alert) {
		with(document.forms[0]) {
			if (!COLETA_MUNICIPIO_ID.value || !RED_MUNICIPIO_ID.value || !DATA_EMISSAO.value) {
				if(v_alert == 1) {
					PRAZO_ENTREGA.value = '';
					alert('Para calcular o Prazo de Entrega é necessário informar a Data de Emissão, Local de Coleta e Local de Entrega.');
				}
				return false;
			}
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_previsao_entrega'
						 ,'origem_municipio_id=' + COLETA_MUNICIPIO_ID.value +
						 '&destino_municipio_id=' + RED_MUNICIPIO_ID.value +
						 '&data_inicio=' + DATA_EMISSAO.value
						 ,function(obj) {
							if (obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								PRAZO_ENTREGA.value = obj.struct.data_prazo_entrega[0];
							}
						 });
		}
	}

	function f_mostra_validacao_veiculos(){
		with(document.forms[0]) {
			var v_placas_validacao = f_get_lista_engates();
			v_placas_validacao = document.getElementById('PLACA_CONTROLE').value + ',' + v_placas_validacao;
			if(v_placas_validacao == ','){
				alert('Para validar a Composição a composição deve estar preenchida.');
				return false;
			}
			f_valida_veiculos();
			f_abrir_janela('/modulos/cte/emitir/validacao_veiculos.cfm?placas='+ v_placas_validacao + '&data=' + DATA_BASE_COMPOSICAO.value , 'f_atualizar()', 900, 300, true)
		}
	}

	function f_valida_veiculos(){
		with(document.forms[0]) {
			var v_placas_validacao = f_get_lista_engates();
			v_placas_validacao = document.getElementById('PLACA_CONTROLE').value + ',' + v_placas_validacao;
			if(v_placas_validacao == ','){
				alert('Para validar a Composição a composição deve estar preenchida.');
				return false;
			}

			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_veiculo.cfc?method=get_validacao_composicao'
						 ,'placas=' + v_placas_validacao + '&data=' + DATA_BASE_COMPOSICAO.value
						 ,function(obj) {
							if (obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.composicao_ok[0] == 1){
									v_conteudo = '<button id="btn_validar_veiculos" class="botao-16x16" onClick="f_mostra_validacao_veiculos();"><img width="16" height="16" align="absMiddle" alt="" src="/_imagens/botoes/16x16/confirmar_transp.gif" alt="Todos os veículos foram validados para envio dos dados para a Sefaz" title="Todos os veículos foram validados para envio dos dados para a Sefaz"/></button>';
									VEICULOS_OK.value = 1;
								}else{
									v_conteudo = '<button id="btn_validar_veiculos" class="botao-16x16" onClick="f_mostra_validacao_veiculos();"><img width="16" height="16" align="absMiddle" alt="" src="/_imagens/botoes/16x16/error2.png" alt="Um ou mais veículos não foram validados para enviar os dados para a Sefaz" title="Um ou mais veículos não foram validados para enviar os dados para a Sefaz"/></button>';
									VEICULOS_OK.value = 0;
								}

								document.getElementById('span_validacao_compo').innerHTML = v_conteudo;
							}
						 });
		}
	}

	function f_formata_cnpj_cpf( el ) {
			vr = el;
			tam = vr.length;
			if(tam == 14){
				el= vr.substr(0, 2) + '.' + vr.substr(2, 3) + '.' + vr.substr(5, 3) + '/' + vr.substr(8, 4) + '-' + vr.substr(12, 2);
			}
			if(tam == 11){
				el= vr.substr(0, 3) + '.' + vr.substr(3, 3) + '.' + vr.substr(6, 3) + '-' + vr.substr(9, 2);
			}
		  return el;

	}

	function f_onmouseover_area_tooltip(p_tip){
		document.getElementById("tooltip_"+p_tip).style.display = '';
	}

	function f_onmouseout_area_tooltip(p_tip){
		document.getElementById("tooltip_"+p_tip).style.display = 'none';
	}

	function f_busca_tipo_servico(){
		with(document.forms[0]){
			if(COD_REMETENTE.value != '' &&
			   COLETA_COD_PESSOA.value != '' &&
			   COD_CLIENTE_COBRANCA.value != '' &&
       		   OPERACAO_ID_CTRC.value != '' &&
       		   COB_COD_ENDERECO.value != ''
			   ){
				f_query_wddx('/modulos/cte/_componentes/consulta/cfc_cte.cfc?method=get_tipo_servico'
								 ,'cod_remetente=' + COD_REMETENTE.value + '&coleta_cod_pessoa=' + COLETA_COD_PESSOA.value + '&cod_cliente_cobranca=' + COD_CLIENTE_COBRANCA.value + '&operacao_id=' + OPERACAO_ID_CTRC.value + '&cod_endereco_cob=' + COB_COD_ENDERECO.value + '&solicitacao_carga_id=' + SOLICITACAO_CARGA_ID.value + '&modal=' + MODAL.value + '&cod_pessoa_filial=' + COD_PESSOA_FILIAL.value + '&cod_destinatario=' + COD_DESTINATARIO.value
								 ,function(obj) {
									if (obj.ajax.readyState == 4 && obj.ajax.status == 200) {
										if(obj.struct.tpserv.length > 0	){
										    VINCULADO_MULTIMODAL.value = '0';
											if(obj.struct.tpserv[0] == 0 || obj.struct.tpserv[0] == 4 || COMPLEMENTO.value == 1){
												document.getElementById("td_docto_anteriores_content").style.display = 'none';
												document.getElementById("td_docto_anteriores_title").style.display = 'none';
												f_set_lista_min_DOCSANT(0);
												
												if (obj.struct.tpserv[0] == 4) {
												   VINCULADO_MULTIMODAL.value = '1';
												}
											}
											else{
												document.getElementById("td_docto_anteriores_content").style.display = '';
												document.getElementById("td_docto_anteriores_title").style.display = '';
												if(obj.struct.tpserv[0] == 2){
													var tooltip = '<div id="tooltip_1" class="tooltip" style="display:none;" align="center"><p class="texto_tooltip"><b>Frete próprio e Tomador do Serviço</b> ('+f_formata_cnpj_cpf(document.getElementById("COB_CNPJ_CPF").value)+' - '+document.getElementById("COB_RAZAO_SOCIAL").value+'), com atividade fiscal Contrib.-Transporte</p></div>';
													document.getElementById("classificacao_documentos_anteriores").innerHTML = 'Esta emiss&atilde;o &eacute; considerada como <b>Redespacho</b> <img width="16" height="16" align="absMiddle" alt="" src="/_imagens/botoes/16x16/ajuda2.gif" alt="redespacho" onmouseover="f_onmouseover_area_tooltip(1);"  onmouseout="f_onmouseout_area_tooltip(1);" style="cursor:help;"/>'+tooltip+'. Para esta emiss&atilde;o &eacute; necessário informar o(s) documento(s) anterior(es).';
												} else if(obj.struct.tpserv[0] == 1){
													document.getElementById("classificacao_documentos_anteriores").innerHTML = 'A opera&ccedil;&atilde;o '+document.getElementById("OPERACAO_ID_CTRC").value+' - '+document.getElementById("OPERACAO_CTRC").value+' est&aacute; definida como <b>Subcontratado</b>. Para esta emiss&atilde;o &eacute; necess&aacute;rio informar o(s) documento(s) anterior(es).';
												}
												document.getElementById("classificacao_documentos_anteriores").style.top = window.event.clientY  - 10;
												document.getElementById("classificacao_documentos_anteriores").style.left = window.event.clientX  + 90;
												f_set_lista_min_DOCSANT(1);
											}
											f_valida_cte_ref();
										}else{
											alert('Problemas ao identificar o tipo de serviço.');
										}
									}
								 });
			   }
		}
	}

</script>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>..: KM&amp;M Transporte e Logística :..</title>
<link href="/levolog/_estilos/class.css" rel="stylesheet" type="text/css">
<link href="/levolog/_estilos/tags.css" rel="stylesheet" type="text/css">
<link href="/levolog/_estilos/abas.css" rel="stylesheet" type="text/css">
<style type="text/css">
.campo {
	border-bottom:1px solid #3C946D;
	border-right:1px solid #3C946D;
	border-left:1px solid #095130;
	border-top:1px solid #095130;
	background-color:#FFFFFF;
	font-family:Verdana, Arial, Helvetica, sans-serif;
	font-size:10px;
	color:#333333;
}
.campo_destaque {
	border-bottom:2px solid #093;
	border-right:2px solid #093;
	border-left:2px solid #093;
	border-top:2px solid #093;
	background-color:#FFFFFF;
	font-family:Verdana, Arial, Helvetica, sans-serif;
	font-size:10px;
	color:#333333;
}

.botao_tbl_frete{
	background-color:transparent;
	cursor:pointer;
	border:none;
	font-family:Verdana, Arial, Helvetica, sans-serif;
	color:#012346;
	font-size:10px;
}

a.a_erro_tf, a_erro_tf_hover{
	cursor:pointer;
}

a.a_erro_tf_hover{
	text-decoration:underline !important;
	cursor:pointer;
}

@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
   /* CSS especifico para o IE10 aqui */
   input[type=radio], input[type=checkbox]{
		height:17px !important;
		width:17px !important;
	}
}

/* TOOL TIP */

.texto_tooltip{
	font-family:			Calibri, Arial, Helvetica, sans-serif;
	font-size:				11px;
	color:					#000;
}
.tooltip{
	padding:				3px;
	text-align:				left;
	background:				#FFFFE8;
	border:					1px solid #EEE;
	z-index:				5000;
	float:					left;
	position:				absolute;
}


</style>

</head>
<body class="background" style="height: 100%; overflow: auto;" onload="document.forms[0].NUM_ROMANEIO.focus();">

<form name="form_transportes" id="form_transportes" action="consultas.cfm?COMPLEMENTO=1" enctype="multipart/form-data" method="post" target="consultas">
      <input name="EMITIR_POR_TABELA_FRETE" tabindex="1" id="EMITIR_POR_TABELA_FRETE" type="hidden" value="0">
        <input name="BASE_CALC_MAIOR_TOTAL" tabindex="2" id="BASE_CALC_MAIOR_TOTAL" type="hidden" value="0">
      <input name="COD_TIPO_CONHECIMENTO_DIARIA" tabindex="3" id="COD_TIPO_CONHECIMENTO_DIARIA" type="hidden" value="25;2">
      <input name="COEFICIENTE_CUBAGEM" tabindex="4" id="COEFICIENTE_CUBAGEM" type="hidden" value="300">
      <input name="EMITIR_SEM_NUM_COMPROVANTE" tabindex="5" type="hidden" value="">
      <input name="COD_TRANSPORTADORA" tabindex="6" type="hidden" value="">
      <input name="CNPJ_TRANSPORTADORA" tabindex="7" type="hidden" value="32668157000348">
      <input name="NOME_TRANSPORTADORA" tabindex="8" type="hidden" value="">
      <input name="OPERACAO" tabindex="9" type="hidden" value="">
      <input name="CONSULTA" tabindex="10" type="hidden" value="6">
      <input name="CONFIRMA" tabindex="11" type="hidden" value="1" fixo="1">
      <input name="FRETE_PROPRIO" tabindex="12" type="hidden" value="1" fixo="1">
      <input name="CONHECIMENTO_ID" tabindex="13" type="hidden" value="">
	  <input name="PAGTO_VALE_PEDAGIO" tabindex="14" id="PAGTO_VALE_PEDAGIO" type="hidden" value=""> 
	  <input name="VP_OBRIGATORIO_CTE" tabindex="15" id="VP_OBRIGATORIO_CTE" type="hidden" value="">
      
      <input name="TABELA_FRETE_MODELO_ID" tabindex="16" type="hidden" value="2">

      <input name="CARGA_ID" tabindex="17" type="hidden" value="" fixo="1">
	  <input name="FRACIONADO" tabindex="18" id="FRACIONADO" type="hidden" value="0" fixo="1" sempre_ativo="1">
	  <input name="PARAM_DATA_BASE_COMPOSICAO" tabindex="19" id="PARAM_DATA_BASE_COMPOSICAO" type="hidden" value="Data de início da solicitação" fixo="1" sempre_ativo="1">
	  <input name="DATA_BASE_COMPOSICAO" tabindex="20" id="DATA_BASE_COMPOSICAO" type="hidden" value="28/11/2025 15:36" fixo="1" sempre_ativo="1">	  

	  <input name="SOLICITACAO_NUM_NATUREZA" tabindex="21" type="hidden" value="">
      <input name="COD_ATIVIDADE" tabindex="22" type="hidden" value="">

	  <input name="NUM_ROMANEIO" tabindex="23" id="NUM_ROMANEIO" type="hidden" value="350749" fixo="1" display="ROMANEIO">
      <input name="ITEM_ID" tabindex="24" type="hidden" value="966497">
      <input name="ST_ICMS_ID" tabindex="25" type="hidden" value="40">
      <input name="ST_ORIGEM_ID" tabindex="26" type="hidden" value="0">

      <input name="REGRA_FISCAL_ID" tabindex="27" type="hidden" value="3">
	  <input name="IMPRIMIR" tabindex="28" type="hidden" value="1" fixo="1">
	  <input name="COD_PROPRIETARIO" tabindex="29" id="COD_PROPRIETARIO" type="hidden" value="1357639">
	  <input name="PROP_CNPJ_CPF" tabindex="30" id="PROP_CNPJ_CPF" type="hidden" value="46859598000170">
	  <input name="PROP_RAZAO_SOCIAL" tabindex="31" id="PROP_RAZAO_SOCIAL" type="hidden" value="LUCAS JOSE ARAUJO AZEVEDO">
	  <input name="PROP_ENDERECO" tabindex="32" id="PROP_ENDERECO" type="hidden" value="R RIO PARA  47,  SERRA VERDE ">
	  <input name="PROP_UF" tabindex="33" id="PROP_UF" type="hidden" value="MG                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ">
	  <input name="COD_MOTORISTA" tabindex="34" id="COD_MOTORISTA" type="hidden" value="9647">
	  <input name="NOME_MOTORISTA" tabindex="35" id="NOME_MOTORISTA" type="hidden" value="LUCAS JOSE ARAUJO AZEVEDO">

	
	  <input name="COD_PESSOA_FILIAL" tabindex="36" id="COD_PESSOA_FILIAL" type="hidden" value="9543" fixo="1">
	  <input name="COD_DEPARTAMENTO" tabindex="37" id="COD_DEPARTAMENTO" type="hidden" value="1" fixo="1">
	  <input name="COD_SETOR" tabindex="38" id="COD_SETOR" type="hidden" value="1" fixo="1">
	  <input name="COD_CENTRO_CUSTO" tabindex="39" id="COD_CENTRO_CUSTO" type="hidden" value="3" fixo="1">
	
      <input name="COD_PESSOA_FILIAL_AUX" tabindex="40" id="COD_PESSOA_FILIAL_AUX" type="hidden" value="9543" fixo="1">
	  <input name="NATUREZA_OPERACAO" tabindex="41" id="NATUREZA_OPERACAO" type="hidden" value="Prest. Serv. Estabelecimento Industrial">

	  <input name="SITUACAO_ID" tabindex="42" id="SITUACAO_ID" type="hidden" value="0">
	  <input name="IMPRESSO" tabindex="43" id="IMPRESSO" type="hidden" value="1" fixo="1">
	  <input name="ENTRADA_DADOS" tabindex="44" id="ENTRADA_DADOS" type="hidden" value="5">
	  <input name="CORRECAO" tabindex="45" id="CORRECAO" type="hidden">
	  <input name="TEM_NOTA" tabindex="46" id="TEM_NOTA" type="hidden" value="0">
	  <input name="MUNICIPAL" tabindex="47" id="MUNICIPAL" type="hidden" value="0" fixo="1">
	  

	  <input name="PLACA_REFERENCIA" tabindex="48" id="PLACA_REFERENCIA" type="hidden">
	  <input name="PLACA_REFERENCIA_COMPOSICAO" tabindex="49" id="PLACA_REFERENCIA_COMPOSICAO" type="hidden">
	  <input name="VIAGEM_CARGA_ID" tabindex="50" id="VIAGEM_CARGA_ID" type="hidden" value="">
	  <input name="CARGA_CONSOLIDADA_ID" tabindex="51" id="CARGA_CONSOLIDADA_ID" type="hidden">
	  <input name="SOLICITACAO_CARGA_ID" tabindex="52" id="SOLICITACAO_CARGA_ID" type="hidden" value="1549535">
	  <input name="VIAGEM_ID" tabindex="53" id="VIAGEM_ID" type="hidden" value="">
      <input name="UF_FILIAL_EMISSAO" tabindex="54" id="UF_FILIAL_EMISSAO" type="hidden" value="MG">
      <input name="ENTRADA_TELA" tabindex="55" id="ENTRADA_TELA" type="hidden">
      <input name="ABERTO" tabindex="56" id="ABERTO" type="hidden" value="0" fixo="1">
      <input name="SUBSTITUTO" tabindex="57" id="SUBSTITUTO" type="hidden" value="0" fixo="1">
      <input name="LOTACAO" tabindex="58" id="LOTACAO" type="hidden" value="1" fixo="1">
      <input name="COMPLEMENTO" tabindex="59" id="COMPLEMENTO" type="hidden" value="1" fixo="1">
      <input name="TIPO_DOCUMENTO" tabindex="60" id="TIPO_DOCUMENTO" type="hidden">
      <input name="ORGANIZACIONAL_ID_GERENCIAL" tabindex="61" id="ORGANIZACIONAL_ID_GERENCIAL" type="hidden" sempre_ativo="1">
      <input name="TIPO_SERVICO_COMERCIAL" tabindex="62" id="TIPO_SERVICO_COMERCIAL" type="hidden" value="41" sempre_ativo="1">
      <input name="TIPO_DOCTO_FRETE" tabindex="63" id="TIPO_DOCTO_FRETE" type="hidden" sempre_ativo="1">
      <input name="DISPENSADO_TABELA_FRETE" tabindex="64" id="DISPENSADO_TABELA_FRETE" type="hidden" value="0">
      <input name="CADASTRO" tabindex="65" id="CADASTRO" type="hidden" value="0" fixo="1">
      <input name="INTERNACIONAL" tabindex="66" id="INTERNACIONAL" type="hidden" value="0" fixo="1">
      <input name="CALCULA_PRAZO_ENTREGA" tabindex="67" id="CALCULA_PRAZO_ENTREGA" type="hidden" value="0" fixo="1">
      <input name="CUBAGEM" tabindex="68" id="CUBAGEM" type="hidden" value="0">
      <input name="TIPO_DOCUMENTO_OPERACAO" tabindex="69" id="TIPO_DOCUMENTO_OPERACAO" onchange="f_valida_obs_globalizado()" type="hidden">
	  <input name="LANCTO_ID" tabindex="70" id="LANCTO_ID" type="hidden" value="" fixo="1" sempre_ativo="1">
      <input name="EMITE_MULTIMODAL" tabindex="71" id="EMITE_MULTIMODAL" type="hidden" value="0">
      <input name="VINCULADO_MULTIMODAL" tabindex="72" id="VINCULADO_MULTIMODAL" type="hidden" value="0">
	  <input name="POSSUI_MULTIMODAL_VINCULADO" tabindex="73" id="POSSUI_MULTIMODAL_VINCULADO" type="hidden" value="0">
      <input name="PESO_REAL" tabindex="74" id="PESO_REAL" type="hidden" value="0">
      <input name="MODAL" tabindex="75" id="MODAL" type="hidden" value="1">
      <input name="PEDIDO_SHIPMENT_EDICAO" tabindex="76" id="PEDIDO_SHIPMENT_EDICAO" type="hidden">
	  <input name="VEICULOS_OK" tabindex="77" type="hidden" value="1">
      <input name="POPULANDO_DADOS" tabindex="78" type="hidden" value="0">
      <input name="CIF_FOB" tabindex="79" id="CIF_FOB" type="hidden" value="0">
      <input name="TIPO_FRETE_DESC" tabindex="80" id="TIPO_FRETE_DESC" type="hidden" value="">
	  <input name="ACERTO" tabindex="81" id="ACERTO" type="hidden" value="0">
<table width="100%" height="100%" class="texto" border="0" cellspacing="1" cellpadding="3">
      
      <tbody><tr>
          <td height="1" class="obrigatorio" id="contingencia" valign="top" style="text-align: center; font-size: 18px; display: none;" colspan="6"></td>
      </tr>

      
      


      <tr>
      	<td height="1" valign="top" colspan="6">
        	<fieldset tabindex="82">
            <legend>Dados Gerais</legend>
            <button tabindex="83" class="botao-16x16" id="btn_buscar_lote" style="display: none;" onclick="NewWindow('/modulos/cte/_localizar/localizar_operacao.cfm?&amp;lotacao=' + LOTACAO.value +'&amp;modalidade=FROTA,AGREGADO&amp;filial_atual=1&amp;campo=VIAGEM_CARGA_ID&amp;funcao=f_busca_dados_item()','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button><table height="100%" class="texto" border="0" cellspacing="1" cellpadding="3">
                
                	<input name="NUM_CONHECIMENTO" tabindex="84" id="NUM_CONHECIMENTO" type="hidden" value="-1">
                    <input name="SERIE" tabindex="85" id="SERIE" type="hidden" value="1">
                    <input name="PLACA_REFERENCIA" tabindex="86" id="PLACA_REFERENCIA" type="hidden">
                

               	<input name="OPERACAO_ID" tabindex="87" id="OPERACAO_ID" type="hidden" size="15" maxlength="10" readonly="" value="43">
                <input name="ENTREGAS" tabindex="88" title="NUMERO DE ENTREGAS" id="ENTREGAS" style="text-align: center;" type="hidden" size="2" maxlength="2" value="1" fixo="1" display="ENTREGA" obrigatorio="1">
                
                            <tbody><tr>
                <td nowrap="">Regra Fiscal: </td>
                				<td nowrap="" colspan="2">
									<select name="REGRA_FISCAL" tabindex="89" id="REGRA_FISCAL" onchange="f_calculos()" fixo="1">
                    
                    <option value="1" selected="">Normal (ICMS incluso no frete)</option>
                  
                    <option value="3">Frete Liquido (Frete sem ICMS)</option>
                  
                </select>
                    </td>

                                <td>CFOP:</td>
                    <td>
                                	<input name="CFOP" tabindex="90" id="CFOP" style="width: 40px;" type="text" readonly=""> <input name="CFOP_ID" tabindex="91" id="CFOP_ID" style="width: 16px;" type="text" readonly="">
                </td>
                            </tr>

              <tr>
                <td height="1" nowrap="">Pago por: </td>
                <td valign="top">
                
                                        	<input name="COD_ORGANOGRAMA_GERENCIAL" tabindex="92" type="hidden" value="3">
                                        
                <select name="PAGADOR" tabindex="93" disabled="" class="requerido_form" id="PAGADOR" onchange="f_muda_pagador();" display="PAGADOR" obrigatorio="1">
                  <option value="">-- Selecione --</option>
                  <option value="0">Remetente (CIF)</option>
                  <option value="1">Destinatário (FOB)</option>
                                    </select>
                                </td>

                <td align="center" class="obrigatorio" id="dv_operacao" valign="middle">&nbsp;</td>

                                <td nowrap="">Situação Tributária:</td>
                                <td nowrap="">
									<select name="ST_ICMS_ID_COMBO" tabindex="94" id="ST_ICMS_ID_COMBO" style="width: 500px;" onchange="document.forms[0].ST_ICMS_ID.value = this.value; f_calculos();">
                    <option value="">-- Selecione --</option>
                    
                    <option value="80">Responsabilidade do Recolhimento do ICMS atribuido ao tomador</option>
                    
                    <option value="81">ICMS devido à Outra UF</option>
                    
                    <option value="00">Tributada integralmente</option>
                    
                    <option value="10">Tributada e com cobranca do ICMS por substituição tributaria</option>
                    
                    <option value="20">Com redução de base de calculo</option>
                    
                    <option value="30">Isenta ou não tributada e com cobranca do ICMS por substituição tributaria</option>
                    
                    <option value="40">Isenta</option>
                    
                    <option value="41">Não tributada</option>
                    
                    <option value="50">Suspenção</option>
                    
                    <option value="51">Diferimento</option>
                    
                    <option value="60">ICMS cobrado anteriormente por substituição tributaria</option>
                    
                    <option value="70">Com redução da base de calculo e cobranca do ICMS por substituição tributaria</option>
                    
                    <option value="90">Outras</option>
                    
				                	</select>
                                </td>
                            </tr>

              <tr>
								<td height="1" class="texto" nowrap="">Data Emissão: </td>
                                <td>
                   <table cellspacing="0" cellpadding="0">
                   	  <tbody><tr>

			                                <td style="padding-right: 15px;">
                        	<input name="DATA_EMISSAO" tabindex="95" class="requerido_form" id="DATA_EMISSAO" style="width: 120px;" onkeypress="return f_formata(this,event,'00/00/0000 00:00')" onblur="f_atualiza_data();" onchange="f_busca_composicao();" type="text" maxlength="16" readonly="" display="DATA EMISSÃO" obrigatorio="1" tipo="data_hora">
                        	<button tabindex="96" class="botao-16x16" id="btn_data_emissao" style="display: none;"><img width="16" height="16" align="absmiddle" src="/_imagens/botoes/16x16/calendario.gif"></button>
                        </td>

			                                <td align="center" class="obrigatorio" id="dv_operacao" valign="middle">&nbsp;</td>

			                                <td class="texto" nowrap="">Prazo Entrega:</td>
			                                <td>
			                                    <input name="PRAZO_ENTREGA" tabindex="97" class="requerido_form" id="PRAZO_ENTREGA" style="width: 110px;" onkeypress="return f_formata(this,event,'00/00/0000 00:00')" type="text" display="PRAZO DE ENTREGA" obrigatorio="1" tipo="data_hora">
                        <button tabindex="98" class="botao-16x16" id="btn_prazo_entrega" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/calendario.gif"></button>&nbsp;
			                                    <button tabindex="99" class="botao-16x16" id="btn_prazo" onclick="f_prazo_entrega(1)" type="button"><img width="16" height="16" align="absmiddle" alt="Atualizar prazo entrega" src="/_imagens/botoes/16x16/atualizar.gif"></button>
			                                </td>
                        <script>
                          Calendar.setup(
                            {
                              inputField  : "PRAZO_ENTREGA",      // ID of the input field
                              ifFormat    :  "%d/%m/%Y %H:%M",    // the date format
                              button      : "btn_prazo_entrega",    // ID of the button
                              range       : [2001,2050],
                              showsTime	  : true
                            }
                          );
                      </script>
                        </tr>
                   </tbody></table>
								</td>

								<td align="center" class="obrigatorio" id="dv_operacao" valign="middle">&nbsp;</td>

                                <td nowrap="">Tipo de Frete:</td>
                                <td nowrap="">
                                    <select name="NUM_PRODUTO" tabindex="100" class="requerido_form" id="NUM_PRODUTO" display="TIPO DE FRETE" obrigatorio="1"><option value="1">FRETE RODOVIARIO</option></select>
                            <span class="obrigatorio" id="sp_produto_definido" style="display: none;">Definido na Operação</span>
                 </td>
              </tr>
              <tr>
                 <td height="1" nowrap="">Veículos: </td>
                                <td colspan="2">
                  <nobr>
                                        <input name="PLACA_CONTROLE" tabindex="101" id="PLACA_CONTROLE" style="width: 75px;" onkeypress="return f_formata(this,event,'AAAAAAAAA')" onchange="f_busca_composicao()" type="text" readonly="" display="PLACA CAVALO" obrigatorio="0">
                                        <span style="visibility: hidden;">
                                            <button tabindex="102" class="botao-16x16" id="btn_localizar_placa_tracao" onclick="NewWindow('/modulos/cte/_localizar/localizar_veiculo.cfm?proprietario=3&amp;placa=PLACA_CONTROLE&amp;funcao=f_busca_composicao()','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="Buscar Veículo" src="/_imagens/botoes/16x16/buscar.gif"></button>
                                            <button tabindex="103" class="botao-16x16" id="btn_cadastrar_placa_tracao" onclick="f_abrir_janela('/aplicacoes/cadastros/veiculos/principal.cfm?funcao_end=f_incluir()','f_seta_placa_controle(f_get_placa_veiculo())',800,600)" type="button"><img width="16" height="16" align="absmiddle" alt="Cadastrar Veículo de Terceiro" src="/_imagens/botoes/16x16/cadastrar.gif"></button>
                                        </span>
                                        <span id="sp_placa_referencia"></span>
                <button tabindex="104" class="botao-16x16" id="btn_engata" onclick="f_engata()" type="button"><img width="16" height="16" align="absmiddle" alt="Engatar" src="/_imagens/botoes/16x16/engatar.gif"></button>
                  <button tabindex="105" class="botao-16x16" id="btn_desengata" onclick="f_desengata();" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/desengatar.gif"></button>
                  <span id="span_validacao_compo"><button class="botao-16x16" id="btn_validar_veiculos" onclick="f_mostra_validacao_veiculos();"><img width="16" height="16" title="Todos os veículos foram validados para envio dos dados para a Sefaz" align="absMiddle" alt="" src="/_imagens/botoes/16x16/confirmar_transp.gif"></button></span> 
                                    </nobr>
				<label class="obrigatorio" id="lbl_sincronia_pendente" style="display: none;" name="lbl_sincronia_pendente"></label>
                                </td>

                <td width="1%" nowrap="">Proprietário:</td>
                                <td width="90%">
                                    <input name="PROPRIETARIO" tabindex="106" id="PROPRIETARIO" style="width: 500px;" type="text" readonly="">
                                    <input name="VEICULO_PROPRIETARIO" tabindex="107" style="display: none;" type="hidden" value="3">
                                </td>
              </tr>

              <tr>
                
                <td>Tipo:</td>
                    <td height="1" colspan="2">
                	<select name="CONHECIMENTO_TIPO_ID" tabindex="108" class="requerido_form" id="CONHECIMENTO_TIPO_ID" onchange="f_valida_autorizacao();f_busca_tipo_calculo();" display="TIPO" obrigatorio="1">
                    	
                            <option value="" dispensa_tabela="0">-- Selecione --</option>
                        
                                <option value="2" dispensa_tabela="1">Conhecimento de Complemento</option>
						
                                <option value="25" dispensa_tabela="1">Conhecimento de Diária</option>
						
                	</select>
                </td>
                

                <td width="1%" nowrap="">Motorista:</td>
                                <td width="90%">
                                    <input name="MOTORISTA" tabindex="109" id="MOTORISTA" style="width: 500px;" type="text" readonly="" display="MOTORISTA">
                                    
                                </td>
              </tr>

              
                  <tr>
                    <td height="1" nowrap="">Operação Logística:</td>
                                    <td colspan="4">
                                        <input name="OPERACAO_ID_CTRC" tabindex="110" class="requerido_form" id="OPERACAO_ID_CTRC" style="width: 5%;" onchange="f_busca_operacao()" type="text" readonly="true" display="OPERACAO LOGISTICA" obrigatorio="1">
                                    <input name="OPERACAO_CTRC" tabindex="111" id="OPERACAO_CTRC" style="width: 50%;" type="text" readonly="">
                                    
                                    <input name="TIPO_FRETE" tabindex="112" id="TIPO_FRETE" type="hidden" value="">
                                    </td>
                  </tr>
              

			<tr>
                <td class="texto" nowrap="nowrap">CC Gerencial:</td>
                                <td class="texto" colspan="4">
                                    <input name="COD_ORGANIZACIONAL" tabindex="113" class="requerido_form" id="COD_ORGANIZACIONAL" style="width: 5%;" onkeypress="return f_formata(this,event,'AAAAAAAAAAA')" onchange="f_muda_organizacional()" type="text" maxlength="11" readonly="" display="CÓD. CENTRO DE CUSTO GERENCIAL" obrigatorio="1">
                   <select name="ORGANIZACIONAL_ID" tabindex="114" class="requerido_form" id="ORGANIZACIONAL_ID" style="width: 50%;" onchange="document.forms[0].COD_ORGANIZACIONAL.value=document.forms[0].ORGANIZACIONAL_ID.options[document.forms[0].ORGANIZACIONAL_ID.selectedIndex].getAttribute('codigo')" display="CENTRO DE CUSTO GERENCIAL" obrigatorio="1"><option value="344" codigo="1.2.2.1.1.2">FRETOLOG/OPERAÇÃO/INDÚSTRIA/INDUSTRIA / BELGO/INDUSTRIA / BELGO / BETIM/INDUSTRIA / BELGO / BETIM /OUTBOUND</option></select>
                                </td>
            </tr>
			
			
			
      		</tbody></table>
            </fieldset>
          </td>
       </tr>

       <tr>
         <td valign="top" style="padding: 3px 0px 0px;" colspan="6">
   		

		 <table width="100%" height="100%" id="tbl_abas" border="0" cellspacing="0" cellpadding="3">
               <tbody><tr>
				
                 <td width="1" class="td_aba_up" nowrap="">Conhecimento</td>
			   

                  <td width="1" height="1" class="td_aba_down" nowrap="">Remetente/Destinatário</td>
                  <td width="1" class="td_aba_down" nowrap=""><nobr>Notas Fiscais</nobr></td>
                  <td width="1" class="td_aba_down" nowrap="">Negociação</td>
                  <td width="1" class="td_aba_down" id="td_impostos_title" nowrap="">Impostos</td>
                  <td width="1" class="td_aba_down" id="aba_auditoria_comercial" nowrap="" style="display: none;"><nobr>Auditoria Comercial</nobr></td>
                  <td width="1" class="td_aba_down" nowrap="">Observações</td>
                  
                  	<td class="td_aba_down" nowrap="nowrap">Observações do Contribuinte</td>
                  
                  <td width="1" class="td_aba_down" id="td_autorizacao_title" nowrap="" style="display: none;">Autorização</td>
                  <td width="1" class="td_aba_down" id="td_docto_anteriores_title" nowrap="" style="display: none;"><nobr>Documentos Anteriores</nobr></td>
                  <td width="1" class="td_aba_down" id="td_cte_ref_title" nowrap="" style="display: none;"><nobr>CT-es Referenciados</nobr></td>
			      <td width="1700" class="td_aba_none">&nbsp;</td>
               </tr>

			   
               <tr>
                  <td class="td_aba_corpo" valign="top" colspan="7"> 
<script language="javascript1.2">


function f_busca_ctrc(){
	with(document.forms[0]) {
		if(NUM_CONHECIMENTO_COMPLEMENTO.value == '') {
			document.getElementById('td_conhecimento_comp').innerHTML = '';
			CONHECIMENTO_ID_COMPLEM.value = '';
		}

		f_limpa_complemento();
		f_limpar_NOTAS_FISCAIS();
		f_limpar_NFE();
		f_limpar_OUTROS();

		

		if(SERIE_COMPLEMENTO.value != '' && NUM_CONHECIMENTO_COMPLEMENTO.value != '') {
			document.getElementById('tr_complemento_carregando').style.display = '';
			v_num_con = NUM_CONHECIMENTO.value;
			f_query_ajax('/modulos/cte/emitir/consultas.cfm?consulta=20' +
						
						'&COD_PESSOA_FILIAL=' + COD_PESSOA_FILIAL.value +
						'&COD_CENTRO_CUSTO=' + COD_CENTRO_CUSTO.value +
						'&LOTACAO=1' +
						
						'&NUM_CONHECIMENTO=' + NUM_CONHECIMENTO_COMPLEMENTO.value +
						'&SERIE=' + SERIE_COMPLEMENTO.value

						,function (obj) {
							document.getElementById('td_conhecimento_comp').innerHTML = obj;
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								with(document.forms[0]) {
									v_num2 = NUM_CONHECIMENTO.value;
									if(document.forms[0].CONHECIMENTO_ID_CONSULTA) {

										if (CONHECIMENTO_ID_CONSULTA.value == '' || (document.forms[0].CANCELADO_CONSULTA && CANCELADO_CONSULTA.value == '1')) {
											if(document.forms[0].CANCELADO_CONSULTA && CANCELADO_CONSULTA.value == '1') {
												f_limpa_complemento();
												alert('O conhecimento a ser complementado está cancelado!');
												return false;
											} else {
												f_limpa_complemento();
												alert('Conhecimento não encontrado ou pertence a outra filial!');
												return false;
											}
											//document.getElementById('td_conhecimento_comp').innerHTML = '';
											v_num = NUM_CONHECIMENTO_COMPLEMENTO.value;
											f_incluir();
											setReadOnly['complemento'](true);
											NUM_CONHECIMENTO_COMPLEMENTO.value = v_num;
											try {
												NUM_CONHECIMENTO_COMPLEMENTO.select();
											} catch(e) {}
											return;
										}

										if(QTDE_COMPLEMENTOS.value != 0){
										   if(!confirm('O CT-e informado possui ' + QTDE_COMPLEMENTOS.value + ' complemento(s) emitido(s). Deseja continuar mesmo assim?')) {
											  NUM_CONHECIMENTO_COMPLEMENTO.value = '';
											  f_incluir();
											  setReadOnly['complemento'](true);
											  try {
												NUM_CONHECIMENTO_COMPLEMENTO.select();
											  } catch(e) {}
											  document.getElementById('tr_complemento_carregando').style.display = 'none';
											  return;
										   }
										}

										CONHECIMENTO_ID.value 			= CONHECIMENTO_ID_CONSULTA.value;
										CONHECIMENTO_ID_COMPLEM.value 	= CONHECIMENTO_ID_CONSULTA.value;
										f_on_busca_conhecimento = f_desabilita_para_complemento;
										f_busca_conhecimento();
									}
								}
							}
						});
		}
	}
	f_desabilita_campos();
}

function f_limpa_complemento(){
	with(document.forms[0]) {
		COD_PESSOA_FILIAL.disabled = false;
		COD_DEPARTAMENTO.disabled = false;
		COD_SETOR.disabled = false;
		COD_CENTRO_CUSTO.disabled = false;
		f_limpa_romaneio();

		return;
	}
}

// Função para desabilitar todos os campos não editaveis no complemento
function f_desabilita_para_complemento() {
	with(document.forms[0]) {
		DATA_EMISSAO.value = '19/12/2025 16:18';
		CONHECIMENTO_ID.value 		= '';
		NUM_CONHECIMENTO.value 		= '';
		OBSERVACAO.value 			= '';
		RODAPE.value 				= '';
		ADEME.value					= '0.00';
		DESCONTO.value				= '0.00';
		IMPOSTOS.value				= '0.00';
		DESPACHO_CALC.value			= '0.00';
		PEDAGIO_CALC.value			= '0.00';
		SEC_CAT_CALC.value			= '0.00';
		GRIS_CALC.value				= '0.00';
		COLETA_ENTREGA_CALC.value	= '0.00';
		DESPACHO.value				= '0.00';
		PEDAGIO.value				= '0.00';
		SEC_CAT.value				= '0.00';
		GRIS.value					= '0.00';
		COLETA_ENTREGA.value		= '0.00';
		FRETE_UNITARIO.value		= '0.00';
		FRETE_UNITARIO_DESC.value	= '0.00';
		FRETE_PESO.value			= '0.00';
		FRETE_VALOR.value			= '0.00';
		BASE_CALCULO_ICMS.value		= '0.00';
		ALIQUOTA_ICMS.value			= '0.00';
//		ALIQUOTA_ICMS.readOnly      = false;
		VALOR_ICMS.value			= '0.00';
		TOTAL_CONHECIMENTO.value	= '0.00';
		VALOR_ICMS_SUBSTIT.value	= '0.00';
		NUM_CONHECIMENTO.value = v_num_con;
		switch(TIPO_COMPLEMENTO_ID.value) {
			case '1':
				OBSERVACAO.value = 'CTe Complementar de Imposto referente ao CTe: '+ NUM_CONHECIMENTO_COMPLEMENTO.value +'/'+SERIE_COMPLEMENTO.value+'\n'
				v_observacao_base = OBSERVACAO.value;
				break;
			case '2':
				OBSERVACAO.value = 'CTe Complementar ao CTe: '+ NUM_CONHECIMENTO_COMPLEMENTO.value +'/'+SERIE_COMPLEMENTO.value+'\n'
				v_observacao_base = OBSERVACAO.value;
				break;
			case '3':
				OBSERVACAO.value = 'CTe Complementar para Cobrança de Imposto referente ao CTe: '+ NUM_CONHECIMENTO_COMPLEMENTO.value +'/'+SERIE_COMPLEMENTO.value+'\n'
				v_observacao_base = OBSERVACAO.value;
				break;
			default:
				break;
		}
		document.getElementById('PEDIDO_SHIPMENT').parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.style.display = 'none';
	}
}

function f_desabilita_campos(){
	setReadOnly['REM'](true);
	setReadOnly['DEST'](true);
	setReadOnly['RED'](true);
	setReadOnly['COB'](true);
	setReadOnly['NEG'](true);
	setReadOnly['COLETA'](true);
}

function f_muda_tipo_complemento() {
	with(document.forms[0]) {
		if(CONHECIMENTO_ID_COMPLEM.value != '') {
			f_busca_ctrc();
		}

		ST_ICMS_ID_COMBO.value 		= '0.00';
		VALOR_ICMS.value 			= '0.00';
		PESO.value 					= '0.00';
		FRETE_UNITARIO_DESC.value 	= '0.00';
		AD_VALOREM.value 			= '0.00';
		SEC_CAT.value 				= '0.00';
		DESPACHO.value 				= '0.00';
		PEDAGIO.value 				= '0.00';
		GRIS.value 					= '0.00';
		COLETA_ENTREGA.value 		= '0.00';

		try {
			document.getElementById('tr_lista_botoes_NOTAS_FISCAIS').style.display = 'none';
			document.getElementById('tr_lista_botoes_NFE').style.display = 'none';
			document.getElementById('tr_lista_botoes_OUTROS').style.display = 'none';
		} catch(e) {}

		f_desabilita_campos();

		switch(TIPO_COMPLEMENTO_ID.value) {
			case '1':
				setReadOnly['mercadorias_dados'](true);
				setReadOnly['mercadorias_calculos'](true);
				BASE_CALCULO_ICMS.readOnly		= true;
				VALOR_ICMS.readOnly 			= false;
				ALIQUOTA_ICMS.readOnly			= true;
				PESO.readOnly 					= true;
				FRETE_UNITARIO_DESC.readOnly 	= true;
				AD_VALOREM.readOnly 			= true;
				SEC_CAT.readOnly 				= true;
				DESPACHO.readOnly 				= true;
				PEDAGIO.readOnly 				= true;
				GRIS.readOnly 					= true;
				COLETA_ENTREGA.readOnly 		= true;
				REGRA_FISCAL.disabled 		    = true;
				REGRA_FISCAL_ID.disabled 		= true;
				FRETE_EM.disabled				= true;

				f_desabilita_campos();
				break;
			case '2':
				setReadOnly['mercadorias_dados'](true);
				setReadOnly['mercadorias_calculos'](true);
				BASE_CALCULO_ICMS.readOnly		= true;
				ALIQUOTA_ICMS.readOnly			= true;
				VALOR_ICMS.readOnly 			= true;
				PESO.readOnly 					= false;
				FRETE_UNITARIO_DESC.readOnly 	= false;
				AD_VALOREM.readOnly 			= false;
				SEC_CAT.readOnly 				= false;
				DESPACHO.readOnly 				= false;
				PEDAGIO.readOnly 				= false;
				GRIS.readOnly 					= false;
				COLETA_ENTREGA.readOnly 		= false;
				FRETE_EM.disabled				= false;

				f_desabilita_campos();
				break;
			case '3':
				setReadOnly['mercadorias_dados'](true);
				setReadOnly['mercadorias_calculos'](true);
				ST_ICMS_ID_COMBO.value			= '90';
				ST_ICMS_ID.value				= '90';
				ST_ICMS_ID_COMBO.disabled 		= true;
				VALOR_ICMS.readOnly 			= true;
				BASE_CALCULO_ICMS.readOnly		= true;
				PESO.readOnly 					= false;
				FRETE_UNITARIO_DESC.readOnly 	= false;
				AD_VALOREM.readOnly 			= true;
				SEC_CAT.readOnly 				= true;
				DESPACHO.readOnly 				= true;
				PEDAGIO.readOnly 				= true;
				GRIS.readOnly 					= true;
				COLETA_ENTREGA.readOnly 		= true;

				f_desabilita_campos();
				break;
			default:
				setReadOnly['mercadorias_dados'](true);
				setReadOnly['mercadorias_calculos'](true);
				setReadOnly['NOTAS_FISCAIS'](true);
				document.getElementById('tr_lista_botoes_NOTAS_FISCAIS').style.display = 'none';
				ST_ICMS_ID_COMBO.disabled 		= true;
				VALOR_ICMS.readOnly 			= true;
				PESO.readOnly 					= true;
				FRETE_UNITARIO_DESC.readOnly 	= true;
				AD_VALOREM.readOnly 			= true;
				SEC_CAT.readOnly 				= true;
				DESPACHO.readOnly 				= true;
				PEDAGIO.readOnly 				= true;
				GRIS.readOnly 					= true;
				COLETA_ENTREGA.readOnly 		= true;

				f_desabilita_campos();
				break;
		}
	}
}

</script>
<span style="display: none;">
<input name="CONHECIMENTO_ID_COMPLEM" tabindex="115" type="hidden" value="1042461" display="CONHECIMENTO A SER COMPLEMENTADO" obrigatorio="1">
</span>
<table width="100%" border="0" cellspacing="1" cellpadding="3">
   <tbody><tr id="tr_complemento_carregando" style="display: none;">
     <td id="td_complemento_carregando" style="padding: 5px;"><img title="" alt="" src="/_imagens/uteis/carregando.gif"></td>
   </tr>
   <tr>
     <td class="texto">Tipo:</td>
     <td nowrap="" colspan="2"><select name="TIPO_COMPLEMENTO_ID" tabindex="116" class="requerido_form" id="TIPO_COMPLEMENTO_ID" onchange="f_muda_tipo_complemento()" display="TIPO DE COMPLEMENTO" obrigatorio="1">
     	<option value="">-- Selecione --</option>
        
        <option value="1">Complemento de Imposto</option>
        
        <option value="2">CTe de Complemento</option>
        
     </select>     </td>
   </tr>
   <tr>
      <td width="1%" class="texto">Conhecimento:</td>
      <td width="12%" nowrap=""><input name="NUM_CONHECIMENTO_COMPLEMENTO" tabindex="117" id="NUM_CONHECIMENTO_COMPLEMENTO" onchange="f_busca_ctrc()" type="text" size="15" maxlength="10">
        <select name="SERIE_COMPLEMENTO" tabindex="118" class="requerido_form" id="SERIE_COMPLEMENTO" onchange="f_busca_ctrc()" fixo="1" display="SERIE" obrigatorio="1">
          
            <option value="">-- Selecione --</option>
          
            <option value="1">1</option>
          
            <option value="2">2</option>
          
            <option value="3">3</option>
          
            <option value="4">4</option>
          
            <option value="10">10</option>
          
        </select></td>
      <td width="75%" align="left" class="info" id="td_veiculo_proprietario">* Conhecimento que será complementado </td>
   </tr>
   <tr>
      <td class="texto" id="td_conhecimento_comp" colspan="3">
	<script language="javascript1.2" src="/_scripts/scripts_db.js"></script>
   
    
    
                    <input name="CONHECIMENTO_ID_CONSULTA" type="hidden" value="1042461">
                    <input name="CNPJ_CPF_FILIAL_CONSULTA" type="hidden" value="32668157000348">
                    <input name="SERIE_CONSULTA" type="hidden" value="1">
                    <input name="CANCELADO_CONSULTA" type="hidden" value="0">
                    <input name="COMPLEMENTO_NUM_ROMANEIO" type="hidden" value="350749">
                    <input name="COMPLEMENTO_ROMANEIO_ITEM_ID" type="hidden" value="966497">
					<input name="QTDE_COMPLEMENTOS" type="hidden" value="0">
                    <fieldset><legend>Dados do Conhecimento</legend>
                    <table width="100%" border="0" cellspacing="1" cellpadding="3">
                      <tbody><tr>
                        <td width="12%" class="texto"><nobr>Nº Conhecimento: </nobr> </td>
                        <td width="10%" class="texto_negrito">147928/1</td>
                        <td width="7%" class="texto">Emissão:</td>
                        <td width="25%" class="texto_negrito">28/11/2025 00:00</td>
                        <td width="7%" class="texto">&nbsp;</td>
                        <td width="39%" class="texto">&nbsp;</td>
                      </tr>
                      
                      <tr>
                        <td class="texto">Remetente:</td>
                        <td class="texto" colspan="5"><span class="texto_negrito">61074506002426 - BELGO BEKAERT ARAMES LTDA</span></td>
                      </tr>
                      <tr>
                        <td class="texto">Endereço:</td>
                        <td class="texto_negrito" colspan="3"><span>32631040 - AVENIDA PARQUE DAS AROEIRAS</span></td>
                        <td class="texto">Município:</td>
                        <td class="texto"><span class="texto_negrito">Betim/MG</span></td>
                      </tr>
                      <tr>
                        <td class="texto">Destinatário:</td>
                        <td class="texto_negrito" colspan="5">15090456000167 - JOST AGRICULTURE &amp; CONSTRUCTION SOUTH AMERICA</td>
                      </tr>
                      <tr>
                        <td class="texto">Endereço:</td>
                        <td class="texto_negrito" colspan="3">37810000 - ROD BR 491 - KM 70 S/N</td>
                        <td class="texto">Município:</td>
                        <td class="texto"><span class="texto_negrito">Guaranésia/MG</span></td>
                      </tr>
                    </tbody></table>
                    </fieldset>
                    <!-- Trecho de Execução do requestEnd -->
</td>
   </tr>
</tbody></table>
</td>
               </tr>
               

               <tr style="display: none;">
                        	<td class="td_aba_corpo" valign="top" colspan="10">
                            	<fieldset tabindex="119" id="fds_rem_dest" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	<script>
	
	setReadOnly['rem_dest'] = function(value) {
		setReadOnly['REM'](value);
		setReadOnly['DEST'](value);
		setReadOnly['CONS'](value);
		//setReadOnly['COB'](value);
		setReadOnly['COLETA'](value);
		setReadOnly['ENTREGA'](value);
		setReadOnly['NEG'](value);
	}
	
	function f_atualiza_pagador(){
		with(document.forms[0]) {
			if(REM_CNPJ_CPF.value == COB_CNPJ_CPF.value){
				PAGADOR.value = 0;
			}else{
				PAGADOR.value = 1;
			}
		}
	}
	
   function f_atualiza_cob(rem_dest){
      with(document.forms[0]) {
         if(CIF_FOB.value == 1 && rem_dest == 1){//Remetente
            f_copia_cliente_COB('REM','COD_REMETENTE');
         }
         if(CIF_FOB.value == 2 && rem_dest == 2){//Destinatário
            f_copia_cliente_COB('DEST','COD_DESTINATARIO');
         }
       }
   }

</script>

<table width="100%" id="tb_rem_dest" border="0" cellspacing="0" cellpadding="3">
  <tbody><tr>
    <td>
	  
<script>
var v_enderecos_REM = [];
var v_ie_REM = [];
var v_endereco_copiar = '';
setReadOnly['REM'] = function(value) {
	with(document.forms[0]) {
		REM_CNPJ_CPF.readOnly 			= value;
		document.getElementById('btn_localizar_REM').style.display = (value ? 'none' : '');
		document.getElementById('btn_limpar_REM').style.display = (value ? 'none' : '');
	}
}

function f_limpa_REM(p_nao_recalcular) {
	with(document.forms[0]) {
		//alert('f_limpa_ ' + REM);
		COD_REMETENTE.value = '';
		REM_TIPO_PESSOA.value = '';
		REM_RAZAO_SOCIAL.value = '';
		REM_ENDERECO.value = '';
		REM_CEP.value = '';
		REM_MUNICIPIO.value = '';
		REM_CNPJ_CPF.value = '';
		REM_UF.value = '';
		REM_MUNICIPIO_ID.value = '';
		REM_ENDERECO_NUM.value = '';
		REM_BAIRRO.value = '';
        REM_INSCRICAO_ESTADUAL.value = '';
        try{
			document.getElementById('REM_INSCRICAO_ESTADUAL').removeAttribute("disabled");
		} catch(e){}
		
		
		
		//limpa endereços
		f_limpa_select(REM_CB_ENDERECO);
        f_limpa_select(REM_INSCRICAO_ESTADUAL);
		f_cria_option('', '-- Localize a pessoa --', REM_CB_ENDERECO);
		f_cria_option('', '-- Localize a pessoa --', REM_INSCRICAO_ESTADUAL);
		
		document.getElementById('sp_REM_unica').style.display = '';
		document.getElementById('sp_REM_multipla').style.display = 'none';
		v_enderecos_REM = new Array();
		v_ie_REM = new Array();
		
		
	}
}

function f_copia_cliente_REM(p_origem,p_cod_pessoa) {
	with(document.forms[0]) {
		REM_CNPJ_CPF.value 			= document.getElementById(p_origem+'_CNPJ_CPF').value;
		f_busca_pessoa_REM();
		
		
		REM_CB_ENDERECO.value			= document.getElementById(p_origem + '_CB_ENDERECO').value;
	}
}
	
function f_busca_pessoa_REM(por_cod_pessoa) {
	with(document.forms[0]) {
		if(!por_cod_pessoa)
			v_cnpj = REM_CNPJ_CPF.value;
		else
			v_cod_pessoa = COD_REMETENTE.value;
		f_limpa_REM(1);
		if(!por_cod_pessoa)
			REM_CNPJ_CPF.value = v_cnpj;
		else
			COD_REMETENTE.value = v_cod_pessoa;
		if (!por_cod_pessoa && REM_CNPJ_CPF.value.replace(/ /g, '') == '')
			return;
	   if (true || REM_CNPJ_CPF.value.length > 4) {
		   	if(por_cod_pessoa)
		   		arguments = 'rapida=1&num_modalidade=13,5&cod_pessoa='+COD_REMETENTE.value
			else
				arguments = 'rapida=1&num_modalidade=13,5&cnpj_cpf='+REM_CNPJ_CPF.value
			
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_pessoa.cfc?method=get_pessoa_endereco_comercial'
						,arguments
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.cod_pessoa.length > 0) {
									REM_TIPO_PESSOA.value = obj.struct.tipo_pessoa[0];
									REM_CNPJ_CPF.value = obj.struct.cnpj_cpf[0];									
									COD_REMETENTE.value = obj.struct.cod_pessoa[0];
									REM_RAZAO_SOCIAL.value = (obj.struct.razao_social[0] == '')?obj.struct.cliente[0]:obj.struct.razao_social[0];
									f_preenche_cb_enderecos_REM(obj.struct.cod_pessoa[0]);
									f_busca_tipo_servico();
                           f_preenche_cb_ie_REM(obj.struct.inscricao_estadual[0] + ',' + obj.struct.ie_adicional[0]);
								}
								else {
									v_cnpj = REM_CNPJ_CPF.value;
									f_limpa_REM();
									REM_CNPJ_CPF.value = v_cnpj;
									alert('Remetente não encontrado');
								}
								try{
									
								} catch(e){}
							}
						});
			}	
	}
}

function f_preenche_cb_enderecos_REM(p_cod_pessoa, v_endereco) {
	with(document.forms[0]) {
		if(document.getElementById('REM_ENDERECO_SOLICITACAO').value > 0  ){
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_solicitacao.cfc?method=get_enderecos_solicitacao';
			arguments = 'cod_endereco='+document.getElementById('REM_ENDERECO_SOLICITACAO').value;
		} else {
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_operacao_enderecos';
			arguments = 'cod_pessoa='+COD_REMETENTE.value;
		}
		f_query_wddx(url, arguments ,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								f_limpa_select(document.getElementById('REM_CB_ENDERECO'));
								v_enderecos_REM = new Array();
								
								if(obj.struct.cod_endereco.length > 0) {
									for(var i = 0; i < obj.struct.cod_endereco.length; i++) {
										v_enderecos_REM.push( {
											cod_pessoa		      : obj.struct.cod_pessoa[i],
											cod_endereco	      : obj.struct.cod_endereco[i],
											municipio_id	      : obj.struct.municipio_id[i],
											municipio		      : obj.struct.municipio[i],
											cep				      : obj.struct.cep[i],
											logradouro		      : obj.struct.logradouro[i],
											numero			      : obj.struct.numero[i],
											bairro			      : obj.struct.bairro[i],
											uf				      : obj.struct.uf[i],
											padrao			      : obj.struct.endereco_padrao[i],
											inscricao_estadual    : obj.struct.inscricao_estadual[i],
											cod_atividade_fiscal  : obj.struct.cod_atividade_fiscal[i]											
										} );
										
									}
									f_busca_endereco_REM(p_cod_pessoa, v_endereco);
								}else{
									f_limpa_select(document.getElementById('REM_CB_ENDERECO'));
									v_enderecos_REM = new Array();
								}
								
							}
						});
	}
}


function f_seta_CNPJ_CPF_REM(v_param){
	with(document.forms[0]){
		REM_CNPJ_CPF.value = v_param;
	}
	f_busca_pessoa_REM();
} 

function f_preenche_cb_ie_REM(p_lista_ie, p_valor_atual) {
   if(p_lista_ie != null && p_lista_ie != "") {
      f_limpa_select(document.getElementById('REM_INSCRICAO_ESTADUAL'));
      var v_lista_array = p_lista_ie.toString().split(',');
      with(document.forms[0]) {
         for(var i = 0; i < v_lista_array.length; i++) {
            if(v_lista_array[i] != null && v_lista_array[i] != "") {
               f_cria_option(v_lista_array[i], v_lista_array[i], document.getElementById('REM_INSCRICAO_ESTADUAL'));
            }
         }
      }
      
      // seta o valor desejado no combo de IE
      if(p_valor_atual != null && p_valor_atual != undefined && p_valor_atual != "") {
         var select = document.getElementById('REM_INSCRICAO_ESTADUAL');
         for(var i = 0; i < select.options.length; i++) {
            if(select.options[i].value == p_valor_atual) {
               select.options[i].selected = true;
               break;
            }
         }
      }
   } else {
      f_limpa_select(document.getElementById('REM_INSCRICAO_ESTADUAL'));
   }
}


function f_muda_endereco_REM(){
	with(document.forms[0]){
		REM_MUNICIPIO_ID.value = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('municipio_id');
		REM_MUNICIPIO.value	 = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('municipio');
		REM_CEP.value			 = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('cep');
		REM_ENDERECO.value	 = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('endereco');
		REM_ENDERECO_NUM.value = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('num');
		REM_BAIRRO.value		 = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('bairro');
		REM_UF.value			 = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('uf');
		REM_COD_ENDERECO.value = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('cod_endereco');
		REM_COD_ATIVIDADE_FISCAL.value = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('cod_atividade_fiscal');
        f_busca_tipo_servico();

		if (document.getElementById('REM_TIPO_PESSOA').value == 1) {
    		REM_INSCRICAO_ESTADUAL.value   = document.getElementById("REM_CB_ENDERECO").options[document.getElementById("REM_CB_ENDERECO").selectedIndex].getAttribute('inscricao_estadual');
			document.getElementById('REM_INSCRICAO_ESTADUAL').setAttribute("disabled","disabled");
		}
		try{
			f_muda_tipo_frete(1);f_atualiza_cob(1); 
		} catch(e){}
	}
}

function f_busca_endereco_REM(p_cod_pessoa, v_endereco) {
		with(document.forms[0]) {			
			var v_inserir;
			f_limpa_select(REM_CB_ENDERECO);
			for(var i = 0; i < v_enderecos_REM.length; i++) {
				if(Number(v_enderecos_REM[i].cod_pessoa) == Number(p_cod_pessoa)) {
					v_inserir = true;
					
					if(v_inserir) {
						v_option = f_cria_option(v_enderecos_REM[i].cod_endereco,v_enderecos_REM[i].cep + ' - ' + v_enderecos_REM[i].logradouro + ',' + v_enderecos_REM[i].numero + ' - ' + v_enderecos_REM[i].bairro + ' - ' + v_enderecos_REM[i].municipio + ' - ' + v_enderecos_REM[i].uf, REM_CB_ENDERECO);
						v_option.setAttribute('cep', v_enderecos_REM[i].cep);
						v_option.setAttribute('num', v_enderecos_REM[i].numero);
						v_option.setAttribute('endereco', v_enderecos_REM[i].logradouro);
						v_option.setAttribute('bairro', v_enderecos_REM[i].bairro);
						v_option.setAttribute('municipio', v_enderecos_REM[i].municipio);
						v_option.setAttribute('uf', v_enderecos_REM[i].uf);
						v_option.setAttribute('municipio_id', v_enderecos_REM[i].municipio_id);
						v_option.setAttribute('cod_endereco', v_enderecos_REM[i].cod_endereco);
						v_option.setAttribute('inscricao_estadual', v_enderecos_REM[i].inscricao_estadual);
						v_option.setAttribute('cod_atividade_fiscal', v_enderecos_REM[i].cod_atividade_fiscal);
						
						if(!v_endereco){
							if(v_enderecos_REM[i].padrao == 1) {
								f_muda_endereco_REM();
							} else if (document.getElementById('REM_ENDERECO_SOLICITACAO').value > 0){
								f_muda_endereco_REM();
							}
						}
						
					}

					v_inserir = false;				
				}
			}

			if(v_endereco){
				REM_CB_ENDERECO.value = v_endereco;
				f_muda_endereco_REM();
			}
			
			//Atualiza o endereço quando o mesmo é decorrente de uma cópia
			if(v_endereco_copiar != '') {
				REM_CB_ENDERECO.value = v_endereco_copiar;
				f_muda_endereco_REM();
				v_endereco_copiar = '';		
			}
		}
}


function f_muda_pessoa_REM(){
	with(document.forms[0]){
			var elem = document.getElementById("NOME_REM_COMBO").options[document.getElementById("NOME_REM_COMBO").selectedIndex];
			var attributeElem = elem.attributes || elem;

			REM_TIPO_PESSOA.value         = attributeElem['tipo_pessoa'].nodeValue;
			REM_CNPJ_CPF.value			= attributeElem['cnpj_cpf'].nodeValue;
			REM_RAZAO_SOCIAL.value		= attributeElem['razao_social'].nodeValue;
			COD_REMETENTE.value					= elem.value;
			f_busca_endereco_REM(COD_REMETENTE.value);
			f_preenche_cb_ie_REM(attributeElem['lista_ie'].nodeValue);
			f_busca_tipo_servico();
	}
}

function f_muda_ie_REM() {
   var prefixo = 'REM';
   var prefixoMudar = ';REM;COLETA;DEST;RED;COB;NEG'.replace(new RegExp("^.+"+prefixo+";", "g"), '').split(';');
   
   for (var p = 0; p < prefixoMudar.length; p++) {
      if (prefixoMudar[p] == null || prefixoMudar[p] == "") break;
      if(document.getElementById(prefixo + '_CNPJ_CPF').value != document.getElementById(prefixoMudar[p] + '_CNPJ_CPF').value) {
         return;
      }
      
      // seta o valor desejado no combo de IE
      var select = document.getElementById(prefixoMudar[p] + '_INSCRICAO_ESTADUAL');
      for(var i = 0; i < select.options.length; i++) {
         if(select.options[i].value == document.getElementById('REM_INSCRICAO_ESTADUAL').value) {
            select.options[i].selected = true;
            break;
         }
      }
   }
}
</script>
<span style="display: none;">
<input name="COD_REMETENTE" tabindex="120" id="COD_REMETENTE" type="hidden" value="72" display="REMETENTE" obrigatorio="1">
<input name="REM_TIPO_PESSOA" tabindex="121" id="REM_TIPO_PESSOA" type="hidden" value="">
<input name="REM_MUNICIPIO_ID" tabindex="122" id="REM_MUNICIPIO_ID" type="hidden" value="25747">
<input name="REM_COD_ENDERECO" tabindex="123" id="REM_COD_ENDERECO" type="hidden" value="80947">
<input name="REM_COD_ATIVIDADE_FISCAL" tabindex="124" id="REM_COD_ATIVIDADE_FISCAL" type="hidden" value="5">
<input name="REM_ENDERECO_SOLICITACAO" tabindex="125" id="REM_ENDERECO_SOLICITACAO" type="hidden" value="0">
</span>

<fieldset tabindex="126">
<legend>Remetente</legend>
<table width="700" border="0" cellspacing="1" cellpadding="1">
  <tbody><tr>
    <td width="100" height="20" class="texto" nowrap="">CNPJ/CPF:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2"><nobr>
      <span id="sp_REM_unica">
          <input name="REM_CNPJ_CPF" tabindex="127" class="requerido_form" id="REM_CNPJ_CPF" onkeypress="return f_formata(this,event,'00000000000000')" onchange="f_busca_pessoa_REM()" type="text" size="20" maxlength="16" readonly="" display="REMETENTE" obrigatorio="1" tipo="">
          <input name="REM_RAZAO_SOCIAL" tabindex="128" id="REM_RAZAO_SOCIAL" type="text" size="60" maxlength="60" readonly="true">
          <button tabindex="129" class="botao-16x16" id="btn_localizar_REM" style="display: none;" onclick="if(this.form.REM_CNPJ_CPF.readOnly || this.form.REM_CNPJ_CPF.disabled) { return; }  NewWindow('/_consultas/localizar_pessoa.cfm?modalidade_id=13,5&amp;campo=COD_REMETENTE&amp;field=COD_PESSOA&amp;funcao=f_busca_pessoa_REM(true)','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="Buscar" src="/_imagens/botoes/16x16/buscar.gif"></button>
                
              <button tabindex="130" class="botao-16x16" id="btn_limpar_REM" style="display: none;" onclick="if(this.form.REM_CNPJ_CPF.readOnly || this.form.REM_CNPJ_CPF.disabled) { return; } f_limpa_REM()" type="button"><img width="16" height="16" align="absmiddle" alt="Limpar" src="/_imagens/botoes/16x16/apagar.gif"></button>
      </span>
               
      <span id="sp_REM_multipla" style="display: none;">
          <select name="NOME_REM_COMBO" tabindex="131" id="NOME_REM_COMBO" style="width: 628px;" onchange="f_muda_pessoa_REM();">            
          </select>
      </span>
      <select name="REM_INSCRICAO_ESTADUAL" tabindex="132" class="requerido_form" id="REM_INSCRICAO_ESTADUAL" style="width: 141px;" onchange="f_muda_ie_REM();" display="REMETENTE" obrigatorio="1"><option value="1863356610840">1863356610840</option></select>
  </nobr></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Endereço:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2">
       <nobr>
           <select name="REM_CB_ENDERECO" tabindex="133" id="REM_CB_ENDERECO" style="width: 628px;" onchange="f_muda_endereco_REM();" display="REMETENTE" obrigatorio="Endereço do Remetente"><option value="80947" cep="32631040" num="" endereco="AVENIDA PARQUE DAS AROEIRAS" bairro="AROEIRAS" municipio="Betim" uf="MG" municipio_id="25747" cod_endereco="80947" inscricao_estadual="1863356610840" cod_atividade_fiscal="5">32631040 - AVENIDA PARQUE DAS AROEIRAS, - AROEIRAS - Betim - MG</option></select>
       </nobr>
       <label class="obrigatorio" id="REM_LBL_AVISO" style="display: none;" name="REM_LBL_AVISO"><br>Endereço definido na solicitação de carga.</label>
    </td>
  </tr>
  
  <tr>
    <td height="20" class="texto" nowrap="">CEP:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="REM_CEP" tabindex="134" id="REM_CEP" style="width: 80px;" onkeypress="return f_formata(this,event,'00000000')" type="text" maxlength="16" readonly="true">
      Endereço:
      <input name="REM_ENDERECO" tabindex="135" id="REM_ENDERECO" type="text" size="45" maxlength="60" readonly="true">
      Nº: <input name="REM_ENDERECO_NUM" tabindex="136" id="REM_ENDERECO_NUM" type="text" size="6" maxlength="9" readonly="true">
      Bairro: <input name="REM_BAIRRO" tabindex="137" id="REM_BAIRRO" type="text" size="20" maxlength="60" readonly="true"></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Município:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="REM_MUNICIPIO" tabindex="138" id="REM_MUNICIPIO" type="text" size="60" maxlength="60" readonly="true">
      <input name="REM_UF" tabindex="139" id="REM_UF" type="text" size="4" maxlength="2" readonly="true">
	  
	  </td>
  </tr>
</tbody></table>
</fieldset>

    </td>
  </tr>
  <tr>
    <td>
	  
<script>
var v_enderecos_COLETA = [];
var v_ie_COLETA = [];
var v_endereco_copiar = '';
setReadOnly['COLETA'] = function(value) {
	with(document.forms[0]) {
		COLETA_CNPJ_CPF.readOnly 			= value;
		document.getElementById('btn_localizar_COLETA').style.display = (value ? 'none' : '');
		document.getElementById('btn_limpar_COLETA').style.display = (value ? 'none' : '');
	}
}

function f_limpa_COLETA(p_nao_recalcular) {
	with(document.forms[0]) {
		//alert('f_limpa_ ' + COLETA);
		COLETA_COD_PESSOA.value = '';
		COLETA_TIPO_PESSOA.value = '';
		COLETA_RAZAO_SOCIAL.value = '';
		COLETA_ENDERECO.value = '';
		COLETA_CEP.value = '';
		COLETA_MUNICIPIO.value = '';
		COLETA_CNPJ_CPF.value = '';
		COLETA_UF.value = '';
		COLETA_MUNICIPIO_ID.value = '';
		COLETA_ENDERECO_NUM.value = '';
		COLETA_BAIRRO.value = '';
        COLETA_INSCRICAO_ESTADUAL.value = '';
        try{
			document.getElementById('COLETA_INSCRICAO_ESTADUAL').removeAttribute("disabled");
		} catch(e){}
		
		
		
		//limpa endereços
		f_limpa_select(COLETA_CB_ENDERECO);
        f_limpa_select(COLETA_INSCRICAO_ESTADUAL);
		f_cria_option('', '-- Localize a pessoa --', COLETA_CB_ENDERECO);
		f_cria_option('', '-- Localize a pessoa --', COLETA_INSCRICAO_ESTADUAL);
		
		document.getElementById('sp_COLETA_unica').style.display = '';
		document.getElementById('sp_COLETA_multipla').style.display = 'none';
		v_enderecos_COLETA = new Array();
		v_ie_COLETA = new Array();
		
		
	}
}

function f_copia_cliente_COLETA(p_origem,p_cod_pessoa) {
	with(document.forms[0]) {
		COLETA_CNPJ_CPF.value 			= document.getElementById(p_origem+'_CNPJ_CPF').value;
		f_busca_pessoa_COLETA();
		
		
		COLETA_CB_ENDERECO.value			= document.getElementById(p_origem + '_CB_ENDERECO').value;
	}
}
	
function f_busca_pessoa_COLETA(por_cod_pessoa) {
	with(document.forms[0]) {
		if(!por_cod_pessoa)
			v_cnpj = COLETA_CNPJ_CPF.value;
		else
			v_cod_pessoa = COLETA_COD_PESSOA.value;
		f_limpa_COLETA(1);
		if(!por_cod_pessoa)
			COLETA_CNPJ_CPF.value = v_cnpj;
		else
			COLETA_COD_PESSOA.value = v_cod_pessoa;
		if (!por_cod_pessoa && COLETA_CNPJ_CPF.value.replace(/ /g, '') == '')
			return;
	   if (true || COLETA_CNPJ_CPF.value.length > 4) {
		   	if(por_cod_pessoa)
		   		arguments = 'rapida=1&num_modalidade=13,5&cod_pessoa='+COLETA_COD_PESSOA.value
			else
				arguments = 'rapida=1&num_modalidade=13,5&cnpj_cpf='+COLETA_CNPJ_CPF.value
			
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_pessoa.cfc?method=get_pessoa_endereco_comercial'
						,arguments
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.cod_pessoa.length > 0) {
									COLETA_TIPO_PESSOA.value = obj.struct.tipo_pessoa[0];
									COLETA_CNPJ_CPF.value = obj.struct.cnpj_cpf[0];									
									COLETA_COD_PESSOA.value = obj.struct.cod_pessoa[0];
									COLETA_RAZAO_SOCIAL.value = (obj.struct.razao_social[0] == '')?obj.struct.cliente[0]:obj.struct.razao_social[0];
									f_preenche_cb_enderecos_COLETA(obj.struct.cod_pessoa[0]);
									f_busca_tipo_servico();
                           f_preenche_cb_ie_COLETA(obj.struct.inscricao_estadual[0] + ',' + obj.struct.ie_adicional[0]);
								}
								else {
									v_cnpj = COLETA_CNPJ_CPF.value;
									f_limpa_COLETA();
									COLETA_CNPJ_CPF.value = v_cnpj;
									alert('Local de Coleta não encontrado');
								}
								try{
									
								} catch(e){}
							}
						});
			}	
	}
}

function f_preenche_cb_enderecos_COLETA(p_cod_pessoa, v_endereco) {
	with(document.forms[0]) {
		if(document.getElementById('COLETA_ENDERECO_SOLICITACAO').value > 0  ){
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_solicitacao.cfc?method=get_enderecos_solicitacao';
			arguments = 'cod_endereco='+document.getElementById('COLETA_ENDERECO_SOLICITACAO').value;
		} else {
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_operacao_enderecos';
			arguments = 'cod_pessoa='+COLETA_COD_PESSOA.value;
		}
		f_query_wddx(url, arguments ,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								f_limpa_select(document.getElementById('COLETA_CB_ENDERECO'));
								v_enderecos_COLETA = new Array();
								
								if(obj.struct.cod_endereco.length > 0) {
									for(var i = 0; i < obj.struct.cod_endereco.length; i++) {
										v_enderecos_COLETA.push( {
											cod_pessoa		      : obj.struct.cod_pessoa[i],
											cod_endereco	      : obj.struct.cod_endereco[i],
											municipio_id	      : obj.struct.municipio_id[i],
											municipio		      : obj.struct.municipio[i],
											cep				      : obj.struct.cep[i],
											logradouro		      : obj.struct.logradouro[i],
											numero			      : obj.struct.numero[i],
											bairro			      : obj.struct.bairro[i],
											uf				      : obj.struct.uf[i],
											padrao			      : obj.struct.endereco_padrao[i],
											inscricao_estadual    : obj.struct.inscricao_estadual[i],
											cod_atividade_fiscal  : obj.struct.cod_atividade_fiscal[i]											
										} );
										
									}
									f_busca_endereco_COLETA(p_cod_pessoa, v_endereco);
								}else{
									f_limpa_select(document.getElementById('COLETA_CB_ENDERECO'));
									v_enderecos_COLETA = new Array();
								}
								
							}
						});
	}
}


function f_seta_CNPJ_CPF_COLETA(v_param){
	with(document.forms[0]){
		COLETA_CNPJ_CPF.value = v_param;
	}
	f_busca_pessoa_COLETA();
} 

function f_preenche_cb_ie_COLETA(p_lista_ie, p_valor_atual) {
   if(p_lista_ie != null && p_lista_ie != "") {
      f_limpa_select(document.getElementById('COLETA_INSCRICAO_ESTADUAL'));
      var v_lista_array = p_lista_ie.toString().split(',');
      with(document.forms[0]) {
         for(var i = 0; i < v_lista_array.length; i++) {
            if(v_lista_array[i] != null && v_lista_array[i] != "") {
               f_cria_option(v_lista_array[i], v_lista_array[i], document.getElementById('COLETA_INSCRICAO_ESTADUAL'));
            }
         }
      }
      
      // seta o valor desejado no combo de IE
      if(p_valor_atual != null && p_valor_atual != undefined && p_valor_atual != "") {
         var select = document.getElementById('COLETA_INSCRICAO_ESTADUAL');
         for(var i = 0; i < select.options.length; i++) {
            if(select.options[i].value == p_valor_atual) {
               select.options[i].selected = true;
               break;
            }
         }
      }
   } else {
      f_limpa_select(document.getElementById('COLETA_INSCRICAO_ESTADUAL'));
   }
}


function f_muda_endereco_COLETA(){
	with(document.forms[0]){
		COLETA_MUNICIPIO_ID.value = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('municipio_id');
		COLETA_MUNICIPIO.value	 = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('municipio');
		COLETA_CEP.value			 = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('cep');
		COLETA_ENDERECO.value	 = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('endereco');
		COLETA_ENDERECO_NUM.value = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('num');
		COLETA_BAIRRO.value		 = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('bairro');
		COLETA_UF.value			 = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('uf');
		COLETA_COD_ENDERECO.value = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('cod_endereco');
		COLETA_COD_ATIVIDADE_FISCAL.value = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('cod_atividade_fiscal');
        f_busca_tipo_servico();

		if (document.getElementById('COLETA_TIPO_PESSOA').value == 1) {
    		COLETA_INSCRICAO_ESTADUAL.value   = document.getElementById("COLETA_CB_ENDERECO").options[document.getElementById("COLETA_CB_ENDERECO").selectedIndex].getAttribute('inscricao_estadual');
			document.getElementById('COLETA_INSCRICAO_ESTADUAL').setAttribute("disabled","disabled");
		}
		try{
			f_muda_tipo_frete(1); 
		} catch(e){}
	}
}

function f_busca_endereco_COLETA(p_cod_pessoa, v_endereco) {
		with(document.forms[0]) {			
			var v_inserir;
			f_limpa_select(COLETA_CB_ENDERECO);
			for(var i = 0; i < v_enderecos_COLETA.length; i++) {
				if(Number(v_enderecos_COLETA[i].cod_pessoa) == Number(p_cod_pessoa)) {
					v_inserir = true;
					
					if(v_inserir) {
						v_option = f_cria_option(v_enderecos_COLETA[i].cod_endereco,v_enderecos_COLETA[i].cep + ' - ' + v_enderecos_COLETA[i].logradouro + ',' + v_enderecos_COLETA[i].numero + ' - ' + v_enderecos_COLETA[i].bairro + ' - ' + v_enderecos_COLETA[i].municipio + ' - ' + v_enderecos_COLETA[i].uf, COLETA_CB_ENDERECO);
						v_option.setAttribute('cep', v_enderecos_COLETA[i].cep);
						v_option.setAttribute('num', v_enderecos_COLETA[i].numero);
						v_option.setAttribute('endereco', v_enderecos_COLETA[i].logradouro);
						v_option.setAttribute('bairro', v_enderecos_COLETA[i].bairro);
						v_option.setAttribute('municipio', v_enderecos_COLETA[i].municipio);
						v_option.setAttribute('uf', v_enderecos_COLETA[i].uf);
						v_option.setAttribute('municipio_id', v_enderecos_COLETA[i].municipio_id);
						v_option.setAttribute('cod_endereco', v_enderecos_COLETA[i].cod_endereco);
						v_option.setAttribute('inscricao_estadual', v_enderecos_COLETA[i].inscricao_estadual);
						v_option.setAttribute('cod_atividade_fiscal', v_enderecos_COLETA[i].cod_atividade_fiscal);
						
						if(!v_endereco){
							if(v_enderecos_COLETA[i].padrao == 1) {
								f_muda_endereco_COLETA();
							} else if (document.getElementById('COLETA_ENDERECO_SOLICITACAO').value > 0){
								f_muda_endereco_COLETA();
							}
						}
						
					}

					v_inserir = false;				
				}
			}

			if(v_endereco){
				COLETA_CB_ENDERECO.value = v_endereco;
				f_muda_endereco_COLETA();
			}
			
			//Atualiza o endereço quando o mesmo é decorrente de uma cópia
			if(v_endereco_copiar != '') {
				COLETA_CB_ENDERECO.value = v_endereco_copiar;
				f_muda_endereco_COLETA();
				v_endereco_copiar = '';		
			}
		}
}


function f_muda_pessoa_COLETA(){
	with(document.forms[0]){
			var elem = document.getElementById("NOME_COLETA_COMBO").options[document.getElementById("NOME_COLETA_COMBO").selectedIndex];
			var attributeElem = elem.attributes || elem;

			COLETA_TIPO_PESSOA.value         = attributeElem['tipo_pessoa'].nodeValue;
			COLETA_CNPJ_CPF.value			= attributeElem['cnpj_cpf'].nodeValue;
			COLETA_RAZAO_SOCIAL.value		= attributeElem['razao_social'].nodeValue;
			COLETA_COD_PESSOA.value					= elem.value;
			f_busca_endereco_COLETA(COLETA_COD_PESSOA.value);
			f_preenche_cb_ie_COLETA(attributeElem['lista_ie'].nodeValue);
			f_busca_tipo_servico();
	}
}

function f_muda_ie_COLETA() {
   var prefixo = 'COLETA';
   var prefixoMudar = ';REM;COLETA;DEST;RED;COB;NEG'.replace(new RegExp("^.+"+prefixo+";", "g"), '').split(';');
   
   for (var p = 0; p < prefixoMudar.length; p++) {
      if (prefixoMudar[p] == null || prefixoMudar[p] == "") break;
      if(document.getElementById(prefixo + '_CNPJ_CPF').value != document.getElementById(prefixoMudar[p] + '_CNPJ_CPF').value) {
         return;
      }
      
      // seta o valor desejado no combo de IE
      var select = document.getElementById(prefixoMudar[p] + '_INSCRICAO_ESTADUAL');
      for(var i = 0; i < select.options.length; i++) {
         if(select.options[i].value == document.getElementById('COLETA_INSCRICAO_ESTADUAL').value) {
            select.options[i].selected = true;
            break;
         }
      }
   }
}
</script>
<span style="display: none;">
<input name="COLETA_COD_PESSOA" tabindex="140" id="COLETA_COD_PESSOA" type="hidden" value="72" display="COLETA" obrigatorio="1">
<input name="COLETA_TIPO_PESSOA" tabindex="141" id="COLETA_TIPO_PESSOA" type="hidden" value="">
<input name="COLETA_MUNICIPIO_ID" tabindex="142" id="COLETA_MUNICIPIO_ID" type="hidden" value="25747">
<input name="COLETA_COD_ENDERECO" tabindex="143" id="COLETA_COD_ENDERECO" type="hidden" value="80947">
<input name="COLETA_COD_ATIVIDADE_FISCAL" tabindex="144" id="COLETA_COD_ATIVIDADE_FISCAL" type="hidden" value="5">
<input name="COLETA_ENDERECO_SOLICITACAO" tabindex="145" id="COLETA_ENDERECO_SOLICITACAO" type="hidden" value="0">
</span>

<fieldset tabindex="146">
<legend>Expedidor (Local de Coleta)</legend>
<table width="700" border="0" cellspacing="1" cellpadding="1">
  <tbody><tr>
    <td width="100" height="20" class="texto" nowrap="">CNPJ/CPF:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2"><nobr>
      <span id="sp_COLETA_unica">
          <input name="COLETA_CNPJ_CPF" tabindex="147" class="requerido_form" id="COLETA_CNPJ_CPF" onkeypress="return f_formata(this,event,'00000000000000')" onchange="f_busca_pessoa_COLETA()" type="text" size="20" maxlength="16" readonly="" display="COLETA" obrigatorio="1" tipo="">
          <input name="COLETA_RAZAO_SOCIAL" tabindex="148" id="COLETA_RAZAO_SOCIAL" type="text" size="60" maxlength="60" readonly="true">
          <button tabindex="149" class="botao-16x16" id="btn_localizar_COLETA" style="display: none;" onclick="if(this.form.COLETA_CNPJ_CPF.readOnly || this.form.COLETA_CNPJ_CPF.disabled) { return; }  NewWindow('/_consultas/localizar_pessoa.cfm?modalidade_id=13,5&amp;campo=COLETA_COD_PESSOA&amp;field=COD_PESSOA&amp;funcao=f_busca_pessoa_COLETA(true)','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="Buscar" src="/_imagens/botoes/16x16/buscar.gif"></button>
                
              <button tabindex="150" class="botao-16x16" id="btn_limpar_COLETA" style="display: none;" onclick="if(this.form.COLETA_CNPJ_CPF.readOnly || this.form.COLETA_CNPJ_CPF.disabled) { return; } f_limpa_COLETA()" type="button"><img width="16" height="16" align="absmiddle" alt="Limpar" src="/_imagens/botoes/16x16/apagar.gif"></button>
      </span>
               
      <span id="sp_COLETA_multipla" style="display: none;">
          <select name="NOME_COLETA_COMBO" tabindex="151" id="NOME_COLETA_COMBO" style="width: 628px;" onchange="f_muda_pessoa_COLETA();">            
          </select>
      </span>
      <select name="COLETA_INSCRICAO_ESTADUAL" tabindex="152" class="requerido_form" id="COLETA_INSCRICAO_ESTADUAL" style="width: 141px;" onchange="f_muda_ie_COLETA();" display="COLETA" obrigatorio="1"><option value="1863356610840">1863356610840</option></select>
  </nobr></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Endereço:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2">
       <nobr>
           <select name="COLETA_CB_ENDERECO" tabindex="153" id="COLETA_CB_ENDERECO" style="width: 628px;" onchange="f_muda_endereco_COLETA();" display="COLETA" obrigatorio="Endereço do Local de Coleta"><option value="80947" cep="32631040" num="" endereco="AVENIDA PARQUE DAS AROEIRAS" bairro="AROEIRAS" municipio="Betim" uf="MG" municipio_id="25747" cod_endereco="80947" inscricao_estadual="1863356610840" cod_atividade_fiscal="5">32631040 - AVENIDA PARQUE DAS AROEIRAS, - AROEIRAS - Betim - MG</option></select>
       </nobr>
       <label class="obrigatorio" id="COLETA_LBL_AVISO" style="display: none;" name="COLETA_LBL_AVISO"><br>Endereço definido na solicitação de carga.</label>
    </td>
  </tr>
  
  <tr>
    <td height="20" class="texto" nowrap="">CEP:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="COLETA_CEP" tabindex="154" id="COLETA_CEP" style="width: 80px;" onkeypress="return f_formata(this,event,'00000000')" type="text" maxlength="16" readonly="true">
      Endereço:
      <input name="COLETA_ENDERECO" tabindex="155" id="COLETA_ENDERECO" type="text" size="45" maxlength="60" readonly="true">
      Nº: <input name="COLETA_ENDERECO_NUM" tabindex="156" id="COLETA_ENDERECO_NUM" type="text" size="6" maxlength="9" readonly="true">
      Bairro: <input name="COLETA_BAIRRO" tabindex="157" id="COLETA_BAIRRO" type="text" size="20" maxlength="60" readonly="true"></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Município:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="COLETA_MUNICIPIO" tabindex="158" id="COLETA_MUNICIPIO" type="text" size="60" maxlength="60" readonly="true">
      <input name="COLETA_UF" tabindex="159" id="COLETA_UF" type="text" size="4" maxlength="2" readonly="true">
	  
	  </td>
  </tr>
</tbody></table>
</fieldset>

    </td>
  </tr>
  <tr>
    <td>
	  
<script>
var v_enderecos_DEST = [];
var v_ie_DEST = [];
var v_endereco_copiar = '';
setReadOnly['DEST'] = function(value) {
	with(document.forms[0]) {
		DEST_CNPJ_CPF.readOnly 			= value;
		document.getElementById('btn_localizar_DEST').style.display = (value ? 'none' : '');
		document.getElementById('btn_limpar_DEST').style.display = (value ? 'none' : '');
	}
}

function f_limpa_DEST(p_nao_recalcular) {
	with(document.forms[0]) {
		//alert('f_limpa_ ' + DEST);
		COD_DESTINATARIO.value = '';
		DEST_TIPO_PESSOA.value = '';
		DEST_RAZAO_SOCIAL.value = '';
		DEST_ENDERECO.value = '';
		DEST_CEP.value = '';
		DEST_MUNICIPIO.value = '';
		DEST_CNPJ_CPF.value = '';
		DEST_UF.value = '';
		DEST_MUNICIPIO_ID.value = '';
		DEST_ENDERECO_NUM.value = '';
		DEST_BAIRRO.value = '';
        DEST_INSCRICAO_ESTADUAL.value = '';
        try{
			document.getElementById('DEST_INSCRICAO_ESTADUAL').removeAttribute("disabled");
		} catch(e){}
		
		
		
		//limpa endereços
		f_limpa_select(DEST_CB_ENDERECO);
        f_limpa_select(DEST_INSCRICAO_ESTADUAL);
		f_cria_option('', '-- Localize a pessoa --', DEST_CB_ENDERECO);
		f_cria_option('', '-- Localize a pessoa --', DEST_INSCRICAO_ESTADUAL);
		
		document.getElementById('sp_DEST_unica').style.display = '';
		document.getElementById('sp_DEST_multipla').style.display = 'none';
		v_enderecos_DEST = new Array();
		v_ie_DEST = new Array();
		
		
	}
}

function f_copia_cliente_DEST(p_origem,p_cod_pessoa) {
	with(document.forms[0]) {
		DEST_CNPJ_CPF.value 			= document.getElementById(p_origem+'_CNPJ_CPF').value;
		f_busca_pessoa_DEST();
		
		
		DEST_CB_ENDERECO.value			= document.getElementById(p_origem + '_CB_ENDERECO').value;
	}
}
	
function f_busca_pessoa_DEST(por_cod_pessoa) {
	with(document.forms[0]) {
		if(!por_cod_pessoa)
			v_cnpj = DEST_CNPJ_CPF.value;
		else
			v_cod_pessoa = COD_DESTINATARIO.value;
		f_limpa_DEST(1);
		if(!por_cod_pessoa)
			DEST_CNPJ_CPF.value = v_cnpj;
		else
			COD_DESTINATARIO.value = v_cod_pessoa;
		if (!por_cod_pessoa && DEST_CNPJ_CPF.value.replace(/ /g, '') == '')
			return;
	   if (true || DEST_CNPJ_CPF.value.length > 4) {
		   	if(por_cod_pessoa)
		   		arguments = 'rapida=1&num_modalidade=13,5&cod_pessoa='+COD_DESTINATARIO.value
			else
				arguments = 'rapida=1&num_modalidade=13,5&cnpj_cpf='+DEST_CNPJ_CPF.value
			
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_pessoa.cfc?method=get_pessoa_endereco_comercial'
						,arguments
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.cod_pessoa.length > 0) {
									DEST_TIPO_PESSOA.value = obj.struct.tipo_pessoa[0];
									DEST_CNPJ_CPF.value = obj.struct.cnpj_cpf[0];									
									COD_DESTINATARIO.value = obj.struct.cod_pessoa[0];
									DEST_RAZAO_SOCIAL.value = (obj.struct.razao_social[0] == '')?obj.struct.cliente[0]:obj.struct.razao_social[0];
									f_preenche_cb_enderecos_DEST(obj.struct.cod_pessoa[0]);
									f_busca_tipo_servico();
                           f_preenche_cb_ie_DEST(obj.struct.inscricao_estadual[0] + ',' + obj.struct.ie_adicional[0]);
								}
								else {
									v_cnpj = DEST_CNPJ_CPF.value;
									f_limpa_DEST();
									DEST_CNPJ_CPF.value = v_cnpj;
									alert('Destinatário não encontrado');
								}
								try{
									
								} catch(e){}
							}
						});
			}	
	}
}

function f_preenche_cb_enderecos_DEST(p_cod_pessoa, v_endereco) {
	with(document.forms[0]) {
		if(document.getElementById('DEST_ENDERECO_SOLICITACAO').value > 0  ){
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_solicitacao.cfc?method=get_enderecos_solicitacao';
			arguments = 'cod_endereco='+document.getElementById('DEST_ENDERECO_SOLICITACAO').value;
		} else {
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_operacao_enderecos';
			arguments = 'cod_pessoa='+COD_DESTINATARIO.value;
		}
		f_query_wddx(url, arguments ,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								f_limpa_select(document.getElementById('DEST_CB_ENDERECO'));
								v_enderecos_DEST = new Array();
								
								if(obj.struct.cod_endereco.length > 0) {
									for(var i = 0; i < obj.struct.cod_endereco.length; i++) {
										v_enderecos_DEST.push( {
											cod_pessoa		      : obj.struct.cod_pessoa[i],
											cod_endereco	      : obj.struct.cod_endereco[i],
											municipio_id	      : obj.struct.municipio_id[i],
											municipio		      : obj.struct.municipio[i],
											cep				      : obj.struct.cep[i],
											logradouro		      : obj.struct.logradouro[i],
											numero			      : obj.struct.numero[i],
											bairro			      : obj.struct.bairro[i],
											uf				      : obj.struct.uf[i],
											padrao			      : obj.struct.endereco_padrao[i],
											inscricao_estadual    : obj.struct.inscricao_estadual[i],
											cod_atividade_fiscal  : obj.struct.cod_atividade_fiscal[i]											
										} );
										
									}
									f_busca_endereco_DEST(p_cod_pessoa, v_endereco);
								}else{
									f_limpa_select(document.getElementById('DEST_CB_ENDERECO'));
									v_enderecos_DEST = new Array();
								}
								
							}
						});
	}
}


function f_seta_CNPJ_CPF_DEST(v_param){
	with(document.forms[0]){
		DEST_CNPJ_CPF.value = v_param;
	}
	f_busca_pessoa_DEST();
} 

function f_preenche_cb_ie_DEST(p_lista_ie, p_valor_atual) {
   if(p_lista_ie != null && p_lista_ie != "") {
      f_limpa_select(document.getElementById('DEST_INSCRICAO_ESTADUAL'));
      var v_lista_array = p_lista_ie.toString().split(',');
      with(document.forms[0]) {
         for(var i = 0; i < v_lista_array.length; i++) {
            if(v_lista_array[i] != null && v_lista_array[i] != "") {
               f_cria_option(v_lista_array[i], v_lista_array[i], document.getElementById('DEST_INSCRICAO_ESTADUAL'));
            }
         }
      }
      
      // seta o valor desejado no combo de IE
      if(p_valor_atual != null && p_valor_atual != undefined && p_valor_atual != "") {
         var select = document.getElementById('DEST_INSCRICAO_ESTADUAL');
         for(var i = 0; i < select.options.length; i++) {
            if(select.options[i].value == p_valor_atual) {
               select.options[i].selected = true;
               break;
            }
         }
      }
   } else {
      f_limpa_select(document.getElementById('DEST_INSCRICAO_ESTADUAL'));
   }
}


function f_muda_endereco_DEST(){
	with(document.forms[0]){
		DEST_MUNICIPIO_ID.value = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('municipio_id');
		DEST_MUNICIPIO.value	 = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('municipio');
		DEST_CEP.value			 = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('cep');
		DEST_ENDERECO.value	 = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('endereco');
		DEST_ENDERECO_NUM.value = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('num');
		DEST_BAIRRO.value		 = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('bairro');
		DEST_UF.value			 = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('uf');
		DEST_COD_ENDERECO.value = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('cod_endereco');
		DEST_COD_ATIVIDADE_FISCAL.value = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('cod_atividade_fiscal');
        f_busca_tipo_servico();

		if (document.getElementById('DEST_TIPO_PESSOA').value == 1) {
    		DEST_INSCRICAO_ESTADUAL.value   = document.getElementById("DEST_CB_ENDERECO").options[document.getElementById("DEST_CB_ENDERECO").selectedIndex].getAttribute('inscricao_estadual');
			document.getElementById('DEST_INSCRICAO_ESTADUAL').setAttribute("disabled","disabled");
		}
		try{
			f_muda_tipo_frete(1);f_atualiza_cob(2); 
		} catch(e){}
	}
}

function f_busca_endereco_DEST(p_cod_pessoa, v_endereco) {
		with(document.forms[0]) {			
			var v_inserir;
			f_limpa_select(DEST_CB_ENDERECO);
			for(var i = 0; i < v_enderecos_DEST.length; i++) {
				if(Number(v_enderecos_DEST[i].cod_pessoa) == Number(p_cod_pessoa)) {
					v_inserir = true;
					
					if(v_inserir) {
						v_option = f_cria_option(v_enderecos_DEST[i].cod_endereco,v_enderecos_DEST[i].cep + ' - ' + v_enderecos_DEST[i].logradouro + ',' + v_enderecos_DEST[i].numero + ' - ' + v_enderecos_DEST[i].bairro + ' - ' + v_enderecos_DEST[i].municipio + ' - ' + v_enderecos_DEST[i].uf, DEST_CB_ENDERECO);
						v_option.setAttribute('cep', v_enderecos_DEST[i].cep);
						v_option.setAttribute('num', v_enderecos_DEST[i].numero);
						v_option.setAttribute('endereco', v_enderecos_DEST[i].logradouro);
						v_option.setAttribute('bairro', v_enderecos_DEST[i].bairro);
						v_option.setAttribute('municipio', v_enderecos_DEST[i].municipio);
						v_option.setAttribute('uf', v_enderecos_DEST[i].uf);
						v_option.setAttribute('municipio_id', v_enderecos_DEST[i].municipio_id);
						v_option.setAttribute('cod_endereco', v_enderecos_DEST[i].cod_endereco);
						v_option.setAttribute('inscricao_estadual', v_enderecos_DEST[i].inscricao_estadual);
						v_option.setAttribute('cod_atividade_fiscal', v_enderecos_DEST[i].cod_atividade_fiscal);
						
						if(!v_endereco){
							if(v_enderecos_DEST[i].padrao == 1) {
								f_muda_endereco_DEST();
							} else if (document.getElementById('DEST_ENDERECO_SOLICITACAO').value > 0){
								f_muda_endereco_DEST();
							}
						}
						
					}

					v_inserir = false;				
				}
			}

			if(v_endereco){
				DEST_CB_ENDERECO.value = v_endereco;
				f_muda_endereco_DEST();
			}
			
			//Atualiza o endereço quando o mesmo é decorrente de uma cópia
			if(v_endereco_copiar != '') {
				DEST_CB_ENDERECO.value = v_endereco_copiar;
				f_muda_endereco_DEST();
				v_endereco_copiar = '';		
			}
		}
}


function f_muda_pessoa_DEST(){
	with(document.forms[0]){
			var elem = document.getElementById("NOME_DEST_COMBO").options[document.getElementById("NOME_DEST_COMBO").selectedIndex];
			var attributeElem = elem.attributes || elem;

			DEST_TIPO_PESSOA.value         = attributeElem['tipo_pessoa'].nodeValue;
			DEST_CNPJ_CPF.value			= attributeElem['cnpj_cpf'].nodeValue;
			DEST_RAZAO_SOCIAL.value		= attributeElem['razao_social'].nodeValue;
			COD_DESTINATARIO.value					= elem.value;
			f_busca_endereco_DEST(COD_DESTINATARIO.value);
			f_preenche_cb_ie_DEST(attributeElem['lista_ie'].nodeValue);
			f_busca_tipo_servico();
	}
}

function f_muda_ie_DEST() {
   var prefixo = 'DEST';
   var prefixoMudar = ';REM;COLETA;DEST;RED;COB;NEG'.replace(new RegExp("^.+"+prefixo+";", "g"), '').split(';');
   
   for (var p = 0; p < prefixoMudar.length; p++) {
      if (prefixoMudar[p] == null || prefixoMudar[p] == "") break;
      if(document.getElementById(prefixo + '_CNPJ_CPF').value != document.getElementById(prefixoMudar[p] + '_CNPJ_CPF').value) {
         return;
      }
      
      // seta o valor desejado no combo de IE
      var select = document.getElementById(prefixoMudar[p] + '_INSCRICAO_ESTADUAL');
      for(var i = 0; i < select.options.length; i++) {
         if(select.options[i].value == document.getElementById('DEST_INSCRICAO_ESTADUAL').value) {
            select.options[i].selected = true;
            break;
         }
      }
   }
}
</script>
<span style="display: none;">
<input name="COD_DESTINATARIO" tabindex="160" id="COD_DESTINATARIO" type="hidden" value="1147" display="DESTINATÁRIO" obrigatorio="1">
<input name="DEST_TIPO_PESSOA" tabindex="161" id="DEST_TIPO_PESSOA" type="hidden" value="">
<input name="DEST_MUNICIPIO_ID" tabindex="162" id="DEST_MUNICIPIO_ID" type="hidden" value="30260">
<input name="DEST_COD_ENDERECO" tabindex="163" id="DEST_COD_ENDERECO" type="hidden" value="82014">
<input name="DEST_COD_ATIVIDADE_FISCAL" tabindex="164" id="DEST_COD_ATIVIDADE_FISCAL" type="hidden" value="5">
<input name="DEST_ENDERECO_SOLICITACAO" tabindex="165" id="DEST_ENDERECO_SOLICITACAO" type="hidden" value="0">
</span>

<fieldset tabindex="166">
<legend>Destinatário</legend>
<table width="700" border="0" cellspacing="1" cellpadding="1">
  <tbody><tr>
    <td width="100" height="20" class="texto" nowrap="">CNPJ/CPF:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2"><nobr>
      <span id="sp_DEST_unica">
          <input name="DEST_CNPJ_CPF" tabindex="167" class="requerido_form" id="DEST_CNPJ_CPF" onkeypress="return f_formata(this,event,'00000000000000')" onchange="f_busca_pessoa_DEST()" type="text" size="20" maxlength="16" readonly="" display="DESTINATÁRIO" obrigatorio="1" tipo="">
          <input name="DEST_RAZAO_SOCIAL" tabindex="168" id="DEST_RAZAO_SOCIAL" type="text" size="60" maxlength="60" readonly="true">
          <button tabindex="169" class="botao-16x16" id="btn_localizar_DEST" style="display: none;" onclick="if(this.form.DEST_CNPJ_CPF.readOnly || this.form.DEST_CNPJ_CPF.disabled) { return; }  NewWindow('/_consultas/localizar_pessoa.cfm?modalidade_id=13,5&amp;campo=COD_DESTINATARIO&amp;field=COD_PESSOA&amp;funcao=f_busca_pessoa_DEST(true)','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="Buscar" src="/_imagens/botoes/16x16/buscar.gif"></button>
                
              <button tabindex="170" class="botao-16x16" id="btn_limpar_DEST" style="display: none;" onclick="if(this.form.DEST_CNPJ_CPF.readOnly || this.form.DEST_CNPJ_CPF.disabled) { return; } f_limpa_DEST()" type="button"><img width="16" height="16" align="absmiddle" alt="Limpar" src="/_imagens/botoes/16x16/apagar.gif"></button>
      </span>
               
      <span id="sp_DEST_multipla" style="display: none;">
          <select name="NOME_DEST_COMBO" tabindex="171" id="NOME_DEST_COMBO" style="width: 628px;" onchange="f_muda_pessoa_DEST();">            
          </select>
      </span>
      <select name="DEST_INSCRICAO_ESTADUAL" tabindex="172" class="requerido_form" id="DEST_INSCRICAO_ESTADUAL" style="width: 141px;" onchange="f_muda_ie_DEST();" display="DESTINATÁRIO" obrigatorio="1"><option value="0022417780089">0022417780089</option></select>
  </nobr></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Endereço:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2">
       <nobr>
           <select name="DEST_CB_ENDERECO" tabindex="173" id="DEST_CB_ENDERECO" style="width: 628px;" onchange="f_muda_endereco_DEST();" display="DESTINATÁRIO" obrigatorio="Endereço do Destinatário"><option value="82014" cep="37810000" num="" endereco="ROD BR 491 - KM 70 S/N" bairro="DISTRITO INDUSTRIAL II" municipio="Guaranésia" uf="MG" municipio_id="30260" cod_endereco="82014" inscricao_estadual="0022417780089" cod_atividade_fiscal="5">37810000 - ROD BR 491 - KM 70 S/N, - DISTRITO INDUSTRIAL II - Guaranésia - MG</option></select>
       </nobr>
       <label class="obrigatorio" id="DEST_LBL_AVISO" style="display: none;" name="DEST_LBL_AVISO"><br>Endereço definido na solicitação de carga.</label>
    </td>
  </tr>
  
  <tr>
    <td height="20" class="texto" nowrap="">CEP:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="DEST_CEP" tabindex="174" id="DEST_CEP" style="width: 80px;" onkeypress="return f_formata(this,event,'00000000')" type="text" maxlength="16" readonly="true">
      Endereço:
      <input name="DEST_ENDERECO" tabindex="175" id="DEST_ENDERECO" type="text" size="45" maxlength="60" readonly="true">
      Nº: <input name="DEST_ENDERECO_NUM" tabindex="176" id="DEST_ENDERECO_NUM" type="text" size="6" maxlength="9" readonly="true">
      Bairro: <input name="DEST_BAIRRO" tabindex="177" id="DEST_BAIRRO" type="text" size="20" maxlength="60" readonly="true"></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Município:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="DEST_MUNICIPIO" tabindex="178" id="DEST_MUNICIPIO" type="text" size="60" maxlength="60" readonly="true">
      <input name="DEST_UF" tabindex="179" id="DEST_UF" type="text" size="4" maxlength="2" readonly="true">
	  
	  </td>
  </tr>
</tbody></table>
</fieldset>

    </td>
  </tr>
  <tr>
    <td>
	  
<script>
var v_enderecos_RED = [];
var v_ie_RED = [];
var v_endereco_copiar = '';
setReadOnly['RED'] = function(value) {
	with(document.forms[0]) {
		RED_CNPJ_CPF.readOnly 			= value;
		document.getElementById('btn_localizar_RED').style.display = (value ? 'none' : '');
		document.getElementById('btn_limpar_RED').style.display = (value ? 'none' : '');
	}
}

function f_limpa_RED(p_nao_recalcular) {
	with(document.forms[0]) {
		//alert('f_limpa_ ' + RED);
		COD_REDESPACHO.value = '';
		RED_TIPO_PESSOA.value = '';
		RED_RAZAO_SOCIAL.value = '';
		RED_ENDERECO.value = '';
		RED_CEP.value = '';
		RED_MUNICIPIO.value = '';
		RED_CNPJ_CPF.value = '';
		RED_UF.value = '';
		RED_MUNICIPIO_ID.value = '';
		RED_ENDERECO_NUM.value = '';
		RED_BAIRRO.value = '';
        RED_INSCRICAO_ESTADUAL.value = '';
        try{
			document.getElementById('RED_INSCRICAO_ESTADUAL').removeAttribute("disabled");
		} catch(e){}
		
		
		
		//limpa endereços
		f_limpa_select(RED_CB_ENDERECO);
        f_limpa_select(RED_INSCRICAO_ESTADUAL);
		f_cria_option('', '-- Localize a pessoa --', RED_CB_ENDERECO);
		f_cria_option('', '-- Localize a pessoa --', RED_INSCRICAO_ESTADUAL);
		
		document.getElementById('sp_RED_unica').style.display = '';
		document.getElementById('sp_RED_multipla').style.display = 'none';
		v_enderecos_RED = new Array();
		v_ie_RED = new Array();
		
		
	}
}

function f_copia_cliente_RED(p_origem,p_cod_pessoa) {
	with(document.forms[0]) {
		RED_CNPJ_CPF.value 			= document.getElementById(p_origem+'_CNPJ_CPF').value;
		f_busca_pessoa_RED();
		
		
		RED_CB_ENDERECO.value			= document.getElementById(p_origem + '_CB_ENDERECO').value;
	}
}
	
function f_busca_pessoa_RED(por_cod_pessoa) {
	with(document.forms[0]) {
		if(!por_cod_pessoa)
			v_cnpj = RED_CNPJ_CPF.value;
		else
			v_cod_pessoa = COD_REDESPACHO.value;
		f_limpa_RED(1);
		if(!por_cod_pessoa)
			RED_CNPJ_CPF.value = v_cnpj;
		else
			COD_REDESPACHO.value = v_cod_pessoa;
		if (!por_cod_pessoa && RED_CNPJ_CPF.value.replace(/ /g, '') == '')
			return;
	   if (true || RED_CNPJ_CPF.value.length > 4) {
		   	if(por_cod_pessoa)
		   		arguments = 'rapida=1&num_modalidade=13,5&cod_pessoa='+COD_REDESPACHO.value
			else
				arguments = 'rapida=1&num_modalidade=13,5&cnpj_cpf='+RED_CNPJ_CPF.value
			
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_pessoa.cfc?method=get_pessoa_endereco_comercial'
						,arguments
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.cod_pessoa.length > 0) {
									RED_TIPO_PESSOA.value = obj.struct.tipo_pessoa[0];
									RED_CNPJ_CPF.value = obj.struct.cnpj_cpf[0];									
									COD_REDESPACHO.value = obj.struct.cod_pessoa[0];
									RED_RAZAO_SOCIAL.value = (obj.struct.razao_social[0] == '')?obj.struct.cliente[0]:obj.struct.razao_social[0];
									f_preenche_cb_enderecos_RED(obj.struct.cod_pessoa[0]);
									f_busca_tipo_servico();
                           f_preenche_cb_ie_RED(obj.struct.inscricao_estadual[0] + ',' + obj.struct.ie_adicional[0]);
								}
								else {
									v_cnpj = RED_CNPJ_CPF.value;
									f_limpa_RED();
									RED_CNPJ_CPF.value = v_cnpj;
									alert('Local de Entrega não encontrado');
								}
								try{
									
								} catch(e){}
							}
						});
			}	
	}
}

function f_preenche_cb_enderecos_RED(p_cod_pessoa, v_endereco) {
	with(document.forms[0]) {
		if(document.getElementById('RED_ENDERECO_SOLICITACAO').value > 0  ){
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_solicitacao.cfc?method=get_enderecos_solicitacao';
			arguments = 'cod_endereco='+document.getElementById('RED_ENDERECO_SOLICITACAO').value;
		} else {
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_operacao_enderecos';
			arguments = 'cod_pessoa='+COD_REDESPACHO.value;
		}
		f_query_wddx(url, arguments ,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								f_limpa_select(document.getElementById('RED_CB_ENDERECO'));
								v_enderecos_RED = new Array();
								
								if(obj.struct.cod_endereco.length > 0) {
									for(var i = 0; i < obj.struct.cod_endereco.length; i++) {
										v_enderecos_RED.push( {
											cod_pessoa		      : obj.struct.cod_pessoa[i],
											cod_endereco	      : obj.struct.cod_endereco[i],
											municipio_id	      : obj.struct.municipio_id[i],
											municipio		      : obj.struct.municipio[i],
											cep				      : obj.struct.cep[i],
											logradouro		      : obj.struct.logradouro[i],
											numero			      : obj.struct.numero[i],
											bairro			      : obj.struct.bairro[i],
											uf				      : obj.struct.uf[i],
											padrao			      : obj.struct.endereco_padrao[i],
											inscricao_estadual    : obj.struct.inscricao_estadual[i],
											cod_atividade_fiscal  : obj.struct.cod_atividade_fiscal[i]											
										} );
										
									}
									f_busca_endereco_RED(p_cod_pessoa, v_endereco);
								}else{
									f_limpa_select(document.getElementById('RED_CB_ENDERECO'));
									v_enderecos_RED = new Array();
								}
								
							}
						});
	}
}


function f_seta_CNPJ_CPF_RED(v_param){
	with(document.forms[0]){
		RED_CNPJ_CPF.value = v_param;
	}
	f_busca_pessoa_RED();
} 

function f_preenche_cb_ie_RED(p_lista_ie, p_valor_atual) {
   if(p_lista_ie != null && p_lista_ie != "") {
      f_limpa_select(document.getElementById('RED_INSCRICAO_ESTADUAL'));
      var v_lista_array = p_lista_ie.toString().split(',');
      with(document.forms[0]) {
         for(var i = 0; i < v_lista_array.length; i++) {
            if(v_lista_array[i] != null && v_lista_array[i] != "") {
               f_cria_option(v_lista_array[i], v_lista_array[i], document.getElementById('RED_INSCRICAO_ESTADUAL'));
            }
         }
      }
      
      // seta o valor desejado no combo de IE
      if(p_valor_atual != null && p_valor_atual != undefined && p_valor_atual != "") {
         var select = document.getElementById('RED_INSCRICAO_ESTADUAL');
         for(var i = 0; i < select.options.length; i++) {
            if(select.options[i].value == p_valor_atual) {
               select.options[i].selected = true;
               break;
            }
         }
      }
   } else {
      f_limpa_select(document.getElementById('RED_INSCRICAO_ESTADUAL'));
   }
}


function f_muda_endereco_RED(){
	with(document.forms[0]){
		RED_MUNICIPIO_ID.value = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('municipio_id');
		RED_MUNICIPIO.value	 = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('municipio');
		RED_CEP.value			 = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('cep');
		RED_ENDERECO.value	 = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('endereco');
		RED_ENDERECO_NUM.value = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('num');
		RED_BAIRRO.value		 = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('bairro');
		RED_UF.value			 = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('uf');
		RED_COD_ENDERECO.value = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('cod_endereco');
		RED_COD_ATIVIDADE_FISCAL.value = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('cod_atividade_fiscal');
        f_busca_tipo_servico();

		if (document.getElementById('RED_TIPO_PESSOA').value == 1) {
    		RED_INSCRICAO_ESTADUAL.value   = document.getElementById("RED_CB_ENDERECO").options[document.getElementById("RED_CB_ENDERECO").selectedIndex].getAttribute('inscricao_estadual');
			document.getElementById('RED_INSCRICAO_ESTADUAL').setAttribute("disabled","disabled");
		}
		try{
			f_muda_tipo_frete(1); 
		} catch(e){}
	}
}

function f_busca_endereco_RED(p_cod_pessoa, v_endereco) {
		with(document.forms[0]) {			
			var v_inserir;
			f_limpa_select(RED_CB_ENDERECO);
			for(var i = 0; i < v_enderecos_RED.length; i++) {
				if(Number(v_enderecos_RED[i].cod_pessoa) == Number(p_cod_pessoa)) {
					v_inserir = true;
					
					if(v_inserir) {
						v_option = f_cria_option(v_enderecos_RED[i].cod_endereco,v_enderecos_RED[i].cep + ' - ' + v_enderecos_RED[i].logradouro + ',' + v_enderecos_RED[i].numero + ' - ' + v_enderecos_RED[i].bairro + ' - ' + v_enderecos_RED[i].municipio + ' - ' + v_enderecos_RED[i].uf, RED_CB_ENDERECO);
						v_option.setAttribute('cep', v_enderecos_RED[i].cep);
						v_option.setAttribute('num', v_enderecos_RED[i].numero);
						v_option.setAttribute('endereco', v_enderecos_RED[i].logradouro);
						v_option.setAttribute('bairro', v_enderecos_RED[i].bairro);
						v_option.setAttribute('municipio', v_enderecos_RED[i].municipio);
						v_option.setAttribute('uf', v_enderecos_RED[i].uf);
						v_option.setAttribute('municipio_id', v_enderecos_RED[i].municipio_id);
						v_option.setAttribute('cod_endereco', v_enderecos_RED[i].cod_endereco);
						v_option.setAttribute('inscricao_estadual', v_enderecos_RED[i].inscricao_estadual);
						v_option.setAttribute('cod_atividade_fiscal', v_enderecos_RED[i].cod_atividade_fiscal);
						
						if(!v_endereco){
							if(v_enderecos_RED[i].padrao == 1) {
								f_muda_endereco_RED();
							} else if (document.getElementById('RED_ENDERECO_SOLICITACAO').value > 0){
								f_muda_endereco_RED();
							}
						}
						
					}

					v_inserir = false;				
				}
			}

			if(v_endereco){
				RED_CB_ENDERECO.value = v_endereco;
				f_muda_endereco_RED();
			}
			
			//Atualiza o endereço quando o mesmo é decorrente de uma cópia
			if(v_endereco_copiar != '') {
				RED_CB_ENDERECO.value = v_endereco_copiar;
				f_muda_endereco_RED();
				v_endereco_copiar = '';		
			}
		}
}


function f_muda_pessoa_RED(){
	with(document.forms[0]){
			var elem = document.getElementById("NOME_RED_COMBO").options[document.getElementById("NOME_RED_COMBO").selectedIndex];
			var attributeElem = elem.attributes || elem;

			RED_TIPO_PESSOA.value         = attributeElem['tipo_pessoa'].nodeValue;
			RED_CNPJ_CPF.value			= attributeElem['cnpj_cpf'].nodeValue;
			RED_RAZAO_SOCIAL.value		= attributeElem['razao_social'].nodeValue;
			COD_REDESPACHO.value					= elem.value;
			f_busca_endereco_RED(COD_REDESPACHO.value);
			f_preenche_cb_ie_RED(attributeElem['lista_ie'].nodeValue);
			f_busca_tipo_servico();
	}
}

function f_muda_ie_RED() {
   var prefixo = 'RED';
   var prefixoMudar = ';REM;COLETA;DEST;RED;COB;NEG'.replace(new RegExp("^.+"+prefixo+";", "g"), '').split(';');
   
   for (var p = 0; p < prefixoMudar.length; p++) {
      if (prefixoMudar[p] == null || prefixoMudar[p] == "") break;
      if(document.getElementById(prefixo + '_CNPJ_CPF').value != document.getElementById(prefixoMudar[p] + '_CNPJ_CPF').value) {
         return;
      }
      
      // seta o valor desejado no combo de IE
      var select = document.getElementById(prefixoMudar[p] + '_INSCRICAO_ESTADUAL');
      for(var i = 0; i < select.options.length; i++) {
         if(select.options[i].value == document.getElementById('RED_INSCRICAO_ESTADUAL').value) {
            select.options[i].selected = true;
            break;
         }
      }
   }
}
</script>
<span style="display: none;">
<input name="COD_REDESPACHO" tabindex="180" id="COD_REDESPACHO" type="hidden" value="1147" display="RECEBEDOR" obrigatorio="1">
<input name="RED_TIPO_PESSOA" tabindex="181" id="RED_TIPO_PESSOA" type="hidden" value="">
<input name="RED_MUNICIPIO_ID" tabindex="182" id="RED_MUNICIPIO_ID" type="hidden" value="30260">
<input name="RED_COD_ENDERECO" tabindex="183" id="RED_COD_ENDERECO" type="hidden" value="82014">
<input name="RED_COD_ATIVIDADE_FISCAL" tabindex="184" id="RED_COD_ATIVIDADE_FISCAL" type="hidden" value="5">
<input name="RED_ENDERECO_SOLICITACAO" tabindex="185" id="RED_ENDERECO_SOLICITACAO" type="hidden" value="0">
</span>

<fieldset tabindex="186">
<legend>Recebedor (Local de Entrega)</legend>
<table width="700" border="0" cellspacing="1" cellpadding="1">
  <tbody><tr>
    <td width="100" height="20" class="texto" nowrap="">CNPJ/CPF:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2"><nobr>
      <span id="sp_RED_unica">
          <input name="RED_CNPJ_CPF" tabindex="187" class="requerido_form" id="RED_CNPJ_CPF" onkeypress="return f_formata(this,event,'00000000000000')" onchange="f_busca_pessoa_RED()" type="text" size="20" maxlength="16" readonly="" display="RECEBEDOR" obrigatorio="1" tipo="">
          <input name="RED_RAZAO_SOCIAL" tabindex="188" id="RED_RAZAO_SOCIAL" type="text" size="60" maxlength="60" readonly="true">
          <button tabindex="189" class="botao-16x16" id="btn_localizar_RED" style="display: none;" onclick="if(this.form.RED_CNPJ_CPF.readOnly || this.form.RED_CNPJ_CPF.disabled) { return; }  NewWindow('/_consultas/localizar_pessoa.cfm?modalidade_id=13,5&amp;campo=COD_REDESPACHO&amp;field=COD_PESSOA&amp;funcao=f_busca_pessoa_RED(true)','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="Buscar" src="/_imagens/botoes/16x16/buscar.gif"></button>
                
              <button tabindex="190" class="botao-16x16" id="btn_limpar_RED" style="display: none;" onclick="if(this.form.RED_CNPJ_CPF.readOnly || this.form.RED_CNPJ_CPF.disabled) { return; } f_limpa_RED()" type="button"><img width="16" height="16" align="absmiddle" alt="Limpar" src="/_imagens/botoes/16x16/apagar.gif"></button>
      </span>
               
      <span id="sp_RED_multipla" style="display: none;">
          <select name="NOME_RED_COMBO" tabindex="191" id="NOME_RED_COMBO" style="width: 628px;" onchange="f_muda_pessoa_RED();">            
          </select>
      </span>
      <select name="RED_INSCRICAO_ESTADUAL" tabindex="192" class="requerido_form" id="RED_INSCRICAO_ESTADUAL" style="width: 141px;" onchange="f_muda_ie_RED();" display="RECEBEDOR" obrigatorio="1"><option value="0022417780089">0022417780089</option></select>
  </nobr></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Endereço:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2">
       <nobr>
           <select name="RED_CB_ENDERECO" tabindex="193" id="RED_CB_ENDERECO" style="width: 628px;" onchange="f_muda_endereco_RED();" display="RECEBEDOR" obrigatorio="Endereço do Local de Entrega"><option value="82014" cep="37810000" num="" endereco="ROD BR 491 - KM 70 S/N" bairro="DISTRITO INDUSTRIAL II" municipio="Guaranésia" uf="MG" municipio_id="30260" cod_endereco="82014" inscricao_estadual="0022417780089" cod_atividade_fiscal="5">37810000 - ROD BR 491 - KM 70 S/N, - DISTRITO INDUSTRIAL II - Guaranésia - MG</option></select>
       </nobr>
       <label class="obrigatorio" id="RED_LBL_AVISO" style="display: none;" name="RED_LBL_AVISO"><br>Endereço definido na solicitação de carga.</label>
    </td>
  </tr>
  
  <tr>
    <td height="20" class="texto" nowrap="">CEP:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="RED_CEP" tabindex="194" id="RED_CEP" style="width: 80px;" onkeypress="return f_formata(this,event,'00000000')" type="text" maxlength="16" readonly="true">
      Endereço:
      <input name="RED_ENDERECO" tabindex="195" id="RED_ENDERECO" type="text" size="45" maxlength="60" readonly="true">
      Nº: <input name="RED_ENDERECO_NUM" tabindex="196" id="RED_ENDERECO_NUM" type="text" size="6" maxlength="9" readonly="true">
      Bairro: <input name="RED_BAIRRO" tabindex="197" id="RED_BAIRRO" type="text" size="20" maxlength="60" readonly="true"></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Município:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="RED_MUNICIPIO" tabindex="198" id="RED_MUNICIPIO" type="text" size="60" maxlength="60" readonly="true">
      <input name="RED_UF" tabindex="199" id="RED_UF" type="text" size="4" maxlength="2" readonly="true">
	  
	  </td>
  </tr>
</tbody></table>
</fieldset>

    </td>
  </tr>
  <tr>
    <td>
	  
<script>
var v_enderecos_COB = [];
var v_ie_COB = [];
var v_endereco_copiar = '';
setReadOnly['COB'] = function(value) {
	with(document.forms[0]) {
		COB_CNPJ_CPF.readOnly 			= value;
		document.getElementById('btn_localizar_COB').style.display = (value ? 'none' : '');
		document.getElementById('btn_limpar_COB').style.display = (value ? 'none' : '');
	}
}

function f_limpa_COB(p_nao_recalcular) {
	with(document.forms[0]) {
		//alert('f_limpa_ ' + COB);
		COD_CLIENTE_COBRANCA.value = '';
		COB_TIPO_PESSOA.value = '';
		COB_RAZAO_SOCIAL.value = '';
		COB_ENDERECO.value = '';
		COB_CEP.value = '';
		COB_MUNICIPIO.value = '';
		COB_CNPJ_CPF.value = '';
		COB_UF.value = '';
		COB_MUNICIPIO_ID.value = '';
		COB_ENDERECO_NUM.value = '';
		COB_BAIRRO.value = '';
        COB_INSCRICAO_ESTADUAL.value = '';
        try{
			document.getElementById('COB_INSCRICAO_ESTADUAL').removeAttribute("disabled");
		} catch(e){}
		
		
		
		//limpa endereços
		f_limpa_select(COB_CB_ENDERECO);
        f_limpa_select(COB_INSCRICAO_ESTADUAL);
		f_cria_option('', '-- Localize a pessoa --', COB_CB_ENDERECO);
		f_cria_option('', '-- Localize a pessoa --', COB_INSCRICAO_ESTADUAL);
		
		document.getElementById('sp_COB_unica').style.display = '';
		document.getElementById('sp_COB_multipla').style.display = 'none';
		v_enderecos_COB = new Array();
		v_ie_COB = new Array();
		
		
			   ST_ICMS_ID.value = '';
			   ST_ICMS_ID_COMBO.value = '';
			
			if (Number(p_nao_recalcular) == 0) {
				try{
					f_atualiza_pagador();f_busca_tipo_calculo(); 
				} catch(e){}
			}
		
	}
}

function f_copia_cliente_COB(p_origem,p_cod_pessoa) {
	with(document.forms[0]) {
		COB_CNPJ_CPF.value 			= document.getElementById(p_origem+'_CNPJ_CPF').value;
		f_busca_pessoa_COB();
		
		
		
		try{
			f_atualiza_pagador();f_busca_tipo_calculo(); 
			
		    f_calculos();
		} catch(e){}
		COB_CB_ENDERECO.value			= document.getElementById(p_origem + '_CB_ENDERECO').value;
	}
}
	
function f_busca_pessoa_COB(por_cod_pessoa) {
	with(document.forms[0]) {
		if(!por_cod_pessoa)
			v_cnpj = COB_CNPJ_CPF.value;
		else
			v_cod_pessoa = COD_CLIENTE_COBRANCA.value;
		f_limpa_COB(1);
		if(!por_cod_pessoa)
			COB_CNPJ_CPF.value = v_cnpj;
		else
			COD_CLIENTE_COBRANCA.value = v_cod_pessoa;
		if (!por_cod_pessoa && COB_CNPJ_CPF.value.replace(/ /g, '') == '')
			return;
	   if (true || COB_CNPJ_CPF.value.length > 4) {
		   	if(por_cod_pessoa)
		   		arguments = 'rapida=1&num_modalidade=13,5&cod_pessoa='+COD_CLIENTE_COBRANCA.value
			else
				arguments = 'rapida=1&num_modalidade=13,5&cnpj_cpf='+COB_CNPJ_CPF.value
			
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_pessoa.cfc?method=get_pessoa_endereco_comercial'
						,arguments
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.cod_pessoa.length > 0) {
									COB_TIPO_PESSOA.value = obj.struct.tipo_pessoa[0];
									COB_CNPJ_CPF.value = obj.struct.cnpj_cpf[0];									
									COD_CLIENTE_COBRANCA.value = obj.struct.cod_pessoa[0];
									COB_RAZAO_SOCIAL.value = (obj.struct.razao_social[0] == '')?obj.struct.cliente[0]:obj.struct.razao_social[0];
									f_preenche_cb_enderecos_COB(obj.struct.cod_pessoa[0]);
									f_busca_tipo_servico();
                           f_preenche_cb_ie_COB(obj.struct.inscricao_estadual[0] + ',' + obj.struct.ie_adicional[0]);
								}
								else {
									v_cnpj = COB_CNPJ_CPF.value;
									f_limpa_COB();
									COB_CNPJ_CPF.value = v_cnpj;
									alert('Cliente de Cobrança não encontrado');
								}
								try{
									
										   ST_ICMS_ID.value = '';
										   ST_ICMS_ID_COMBO.value = '';
										f_atualiza_pagador();f_busca_tipo_calculo(); 
								} catch(e){}
							}
						});
			}	
	}
}

function f_preenche_cb_enderecos_COB(p_cod_pessoa, v_endereco) {
	with(document.forms[0]) {
		if(document.getElementById('COB_ENDERECO_SOLICITACAO').value > 0  ){
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_solicitacao.cfc?method=get_enderecos_solicitacao';
			arguments = 'cod_endereco='+document.getElementById('COB_ENDERECO_SOLICITACAO').value;
		} else {
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_operacao_enderecos';
			arguments = 'cod_pessoa='+COD_CLIENTE_COBRANCA.value;
		}
		f_query_wddx(url, arguments ,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								f_limpa_select(document.getElementById('COB_CB_ENDERECO'));
								v_enderecos_COB = new Array();
								
								if(obj.struct.cod_endereco.length > 0) {
									for(var i = 0; i < obj.struct.cod_endereco.length; i++) {
										v_enderecos_COB.push( {
											cod_pessoa		      : obj.struct.cod_pessoa[i],
											cod_endereco	      : obj.struct.cod_endereco[i],
											municipio_id	      : obj.struct.municipio_id[i],
											municipio		      : obj.struct.municipio[i],
											cep				      : obj.struct.cep[i],
											logradouro		      : obj.struct.logradouro[i],
											numero			      : obj.struct.numero[i],
											bairro			      : obj.struct.bairro[i],
											uf				      : obj.struct.uf[i],
											padrao			      : obj.struct.endereco_padrao[i],
											inscricao_estadual    : obj.struct.inscricao_estadual[i],
											cod_atividade_fiscal  : obj.struct.cod_atividade_fiscal[i]											
										} );
										
									}
									f_busca_endereco_COB(p_cod_pessoa, v_endereco);
								}else{
									f_limpa_select(document.getElementById('COB_CB_ENDERECO'));
									v_enderecos_COB = new Array();
								}
								
							}
						});
	}
}


function f_seta_CNPJ_CPF_COB(v_param){
	with(document.forms[0]){
		COB_CNPJ_CPF.value = v_param;
	}
	f_busca_pessoa_COB();
} 

function f_preenche_cb_ie_COB(p_lista_ie, p_valor_atual) {
   if(p_lista_ie != null && p_lista_ie != "") {
      f_limpa_select(document.getElementById('COB_INSCRICAO_ESTADUAL'));
      var v_lista_array = p_lista_ie.toString().split(',');
      with(document.forms[0]) {
         for(var i = 0; i < v_lista_array.length; i++) {
            if(v_lista_array[i] != null && v_lista_array[i] != "") {
               f_cria_option(v_lista_array[i], v_lista_array[i], document.getElementById('COB_INSCRICAO_ESTADUAL'));
            }
         }
      }
      
      // seta o valor desejado no combo de IE
      if(p_valor_atual != null && p_valor_atual != undefined && p_valor_atual != "") {
         var select = document.getElementById('COB_INSCRICAO_ESTADUAL');
         for(var i = 0; i < select.options.length; i++) {
            if(select.options[i].value == p_valor_atual) {
               select.options[i].selected = true;
               break;
            }
         }
      }
   } else {
      f_limpa_select(document.getElementById('COB_INSCRICAO_ESTADUAL'));
   }
}


function f_muda_endereco_COB(){
	with(document.forms[0]){
		COB_MUNICIPIO_ID.value = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('municipio_id');
		COB_MUNICIPIO.value	 = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('municipio');
		COB_CEP.value			 = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('cep');
		COB_ENDERECO.value	 = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('endereco');
		COB_ENDERECO_NUM.value = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('num');
		COB_BAIRRO.value		 = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('bairro');
		COB_UF.value			 = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('uf');
		COB_COD_ENDERECO.value = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('cod_endereco');
		COB_COD_ATIVIDADE_FISCAL.value = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('cod_atividade_fiscal');
        f_busca_tipo_servico();

		if (document.getElementById('COB_TIPO_PESSOA').value == 1) {
    		COB_INSCRICAO_ESTADUAL.value   = document.getElementById("COB_CB_ENDERECO").options[document.getElementById("COB_CB_ENDERECO").selectedIndex].getAttribute('inscricao_estadual');
			document.getElementById('COB_INSCRICAO_ESTADUAL').setAttribute("disabled","disabled");
		}
		try{
			f_muda_tipo_frete(1); 
		} catch(e){}
	}
}

function f_busca_endereco_COB(p_cod_pessoa, v_endereco) {
		with(document.forms[0]) {			
			var v_inserir;
			f_limpa_select(COB_CB_ENDERECO);
			for(var i = 0; i < v_enderecos_COB.length; i++) {
				if(Number(v_enderecos_COB[i].cod_pessoa) == Number(p_cod_pessoa)) {
					v_inserir = true;
					
					if(v_inserir) {
						v_option = f_cria_option(v_enderecos_COB[i].cod_endereco,v_enderecos_COB[i].cep + ' - ' + v_enderecos_COB[i].logradouro + ',' + v_enderecos_COB[i].numero + ' - ' + v_enderecos_COB[i].bairro + ' - ' + v_enderecos_COB[i].municipio + ' - ' + v_enderecos_COB[i].uf, COB_CB_ENDERECO);
						v_option.setAttribute('cep', v_enderecos_COB[i].cep);
						v_option.setAttribute('num', v_enderecos_COB[i].numero);
						v_option.setAttribute('endereco', v_enderecos_COB[i].logradouro);
						v_option.setAttribute('bairro', v_enderecos_COB[i].bairro);
						v_option.setAttribute('municipio', v_enderecos_COB[i].municipio);
						v_option.setAttribute('uf', v_enderecos_COB[i].uf);
						v_option.setAttribute('municipio_id', v_enderecos_COB[i].municipio_id);
						v_option.setAttribute('cod_endereco', v_enderecos_COB[i].cod_endereco);
						v_option.setAttribute('inscricao_estadual', v_enderecos_COB[i].inscricao_estadual);
						v_option.setAttribute('cod_atividade_fiscal', v_enderecos_COB[i].cod_atividade_fiscal);
						
						if(!v_endereco){
							if(v_enderecos_COB[i].padrao == 1) {
								f_muda_endereco_COB();
							} else if (document.getElementById('COB_ENDERECO_SOLICITACAO').value > 0){
								f_muda_endereco_COB();
							}
						}
						
					}

					v_inserir = false;				
				}
			}

			if(v_endereco){
				COB_CB_ENDERECO.value = v_endereco;
				f_muda_endereco_COB();
			}
			
			//Atualiza o endereço quando o mesmo é decorrente de uma cópia
			if(v_endereco_copiar != '') {
				COB_CB_ENDERECO.value = v_endereco_copiar;
				f_muda_endereco_COB();
				v_endereco_copiar = '';		
			}
		}
}


function f_muda_pessoa_COB(){
	with(document.forms[0]){
			var elem = document.getElementById("NOME_COB_COMBO").options[document.getElementById("NOME_COB_COMBO").selectedIndex];
			var attributeElem = elem.attributes || elem;

			COB_TIPO_PESSOA.value         = attributeElem['tipo_pessoa'].nodeValue;
			COB_CNPJ_CPF.value			= attributeElem['cnpj_cpf'].nodeValue;
			COB_RAZAO_SOCIAL.value		= attributeElem['razao_social'].nodeValue;
			COD_CLIENTE_COBRANCA.value					= elem.value;
			f_busca_endereco_COB(COD_CLIENTE_COBRANCA.value);
			f_preenche_cb_ie_COB(attributeElem['lista_ie'].nodeValue);
			f_busca_tipo_servico();
	}
}

function f_muda_ie_COB() {
   var prefixo = 'COB';
   var prefixoMudar = ';REM;COLETA;DEST;RED;COB;NEG'.replace(new RegExp("^.+"+prefixo+";", "g"), '').split(';');
   
   for (var p = 0; p < prefixoMudar.length; p++) {
      if (prefixoMudar[p] == null || prefixoMudar[p] == "") break;
      if(document.getElementById(prefixo + '_CNPJ_CPF').value != document.getElementById(prefixoMudar[p] + '_CNPJ_CPF').value) {
         return;
      }
      
      // seta o valor desejado no combo de IE
      var select = document.getElementById(prefixoMudar[p] + '_INSCRICAO_ESTADUAL');
      for(var i = 0; i < select.options.length; i++) {
         if(select.options[i].value == document.getElementById('COB_INSCRICAO_ESTADUAL').value) {
            select.options[i].selected = true;
            break;
         }
      }
   }
}
</script>
<span style="display: none;">
<input name="COD_CLIENTE_COBRANCA" tabindex="200" id="COD_CLIENTE_COBRANCA" type="hidden" value="72" display="COBRANÇA" obrigatorio="1">
<input name="COB_TIPO_PESSOA" tabindex="201" id="COB_TIPO_PESSOA" type="hidden" value="">
<input name="COB_MUNICIPIO_ID" tabindex="202" id="COB_MUNICIPIO_ID" type="hidden" value="25747">
<input name="COB_COD_ENDERECO" tabindex="203" id="COB_COD_ENDERECO" type="hidden" value="80947">
<input name="COB_COD_ATIVIDADE_FISCAL" tabindex="204" id="COB_COD_ATIVIDADE_FISCAL" type="hidden" value="5">
<input name="COB_ENDERECO_SOLICITACAO" tabindex="205" id="COB_ENDERECO_SOLICITACAO" type="hidden" value="0">
</span>

<fieldset tabindex="206">
<legend>Tomador do Serviço (Cliente Cobrança)</legend>
<table width="700" border="0" cellspacing="1" cellpadding="1">
  <tbody><tr>
    <td width="100" height="20" class="texto" nowrap="">CNPJ/CPF:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2"><nobr>
      <span id="sp_COB_unica">
          <input name="COB_CNPJ_CPF" tabindex="207" class="requerido_form" id="COB_CNPJ_CPF" onkeypress="return f_formata(this,event,'00000000000000')" onchange="f_busca_pessoa_COB()" type="text" size="20" maxlength="16" readonly="" display="COBRANÇA" obrigatorio="1" tipo="">
          <input name="COB_RAZAO_SOCIAL" tabindex="208" id="COB_RAZAO_SOCIAL" type="text" size="60" maxlength="60" readonly="true">
          <button tabindex="209" class="botao-16x16" id="btn_localizar_COB" style="display: none;" onclick="if(this.form.COB_CNPJ_CPF.readOnly || this.form.COB_CNPJ_CPF.disabled) { return; }  NewWindow('/_consultas/localizar_pessoa.cfm?modalidade_id=13,5&amp;campo=COD_CLIENTE_COBRANCA&amp;field=COD_PESSOA&amp;funcao=f_busca_pessoa_COB(true)','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="Buscar" src="/_imagens/botoes/16x16/buscar.gif"></button>
                
              <button tabindex="210" class="botao-16x16" id="btn_limpar_COB" style="display: none;" onclick="if(this.form.COB_CNPJ_CPF.readOnly || this.form.COB_CNPJ_CPF.disabled) { return; } f_limpa_COB()" type="button"><img width="16" height="16" align="absmiddle" alt="Limpar" src="/_imagens/botoes/16x16/apagar.gif"></button>
      </span>
               
      <span id="sp_COB_multipla" style="display: none;">
          <select name="NOME_COB_COMBO" tabindex="211" id="NOME_COB_COMBO" style="width: 628px;" onchange="f_muda_pessoa_COB();">            
          </select>
      </span>
      <select name="COB_INSCRICAO_ESTADUAL" tabindex="212" class="requerido_form" id="COB_INSCRICAO_ESTADUAL" style="width: 141px;" onchange="f_muda_ie_COB();" display="COBRANÇA" obrigatorio="1"><option value="1863356610840">1863356610840</option></select>
  </nobr></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Endereço:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2">
       <nobr>
           <select name="COB_CB_ENDERECO" tabindex="213" id="COB_CB_ENDERECO" style="width: 628px;" onchange="f_muda_endereco_COB();" display="COBRANÇA" obrigatorio="Endereço do Cliente de Cobrança"><option value="80947" cep="32631040" num="" endereco="AVENIDA PARQUE DAS AROEIRAS" bairro="AROEIRAS" municipio="Betim" uf="MG" municipio_id="25747" cod_endereco="80947" inscricao_estadual="1863356610840" cod_atividade_fiscal="5">32631040 - AVENIDA PARQUE DAS AROEIRAS, - AROEIRAS - Betim - MG</option></select>
       </nobr>
       <label class="obrigatorio" id="COB_LBL_AVISO" style="display: none;" name="COB_LBL_AVISO"><br>Endereço definido na solicitação de carga.</label>
    </td>
  </tr>
  
  <tr>
    <td height="20" class="texto" nowrap="">CEP:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="COB_CEP" tabindex="214" id="COB_CEP" style="width: 80px;" onkeypress="return f_formata(this,event,'00000000')" type="text" maxlength="16" readonly="true">
      Endereço:
      <input name="COB_ENDERECO" tabindex="215" id="COB_ENDERECO" type="text" size="45" maxlength="60" readonly="true">
      Nº: <input name="COB_ENDERECO_NUM" tabindex="216" id="COB_ENDERECO_NUM" type="text" size="6" maxlength="9" readonly="true">
      Bairro: <input name="COB_BAIRRO" tabindex="217" id="COB_BAIRRO" type="text" size="20" maxlength="60" readonly="true"></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Município:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="COB_MUNICIPIO" tabindex="218" id="COB_MUNICIPIO" type="text" size="60" maxlength="60" readonly="true">
      <input name="COB_UF" tabindex="219" id="COB_UF" type="text" size="4" maxlength="2" readonly="true">
	  
	  </td>
  </tr>
</tbody></table>
</fieldset>

    </td>
  </tr>
  <tr>
    <td>
	  
<script>
var v_enderecos_NEG = [];
var v_ie_NEG = [];
var v_endereco_copiar = '';
setReadOnly['NEG'] = function(value) {
	with(document.forms[0]) {
		NEG_CNPJ_CPF.readOnly 			= value;
		document.getElementById('btn_localizar_NEG').style.display = (value ? 'none' : '');
		document.getElementById('btn_limpar_NEG').style.display = (value ? 'none' : '');
	}
}

function f_limpa_NEG(p_nao_recalcular) {
	with(document.forms[0]) {
		//alert('f_limpa_ ' + NEG);
		COD_NEGOCIADOR.value = '';
		NEG_TIPO_PESSOA.value = '';
		NEG_RAZAO_SOCIAL.value = '';
		NEG_ENDERECO.value = '';
		NEG_CEP.value = '';
		NEG_MUNICIPIO.value = '';
		NEG_CNPJ_CPF.value = '';
		NEG_UF.value = '';
		NEG_MUNICIPIO_ID.value = '';
		NEG_ENDERECO_NUM.value = '';
		NEG_BAIRRO.value = '';
        NEG_INSCRICAO_ESTADUAL.value = '';
        try{
			document.getElementById('NEG_INSCRICAO_ESTADUAL').removeAttribute("disabled");
		} catch(e){}
		
		
		
		//limpa endereços
		f_limpa_select(NEG_CB_ENDERECO);
        f_limpa_select(NEG_INSCRICAO_ESTADUAL);
		f_cria_option('', '-- Localize a pessoa --', NEG_CB_ENDERECO);
		f_cria_option('', '-- Localize a pessoa --', NEG_INSCRICAO_ESTADUAL);
		
		document.getElementById('sp_NEG_unica').style.display = '';
		document.getElementById('sp_NEG_multipla').style.display = 'none';
		v_enderecos_NEG = new Array();
		v_ie_NEG = new Array();
		
		
	}
}

function f_copia_cliente_NEG(p_origem,p_cod_pessoa) {
	with(document.forms[0]) {
		NEG_CNPJ_CPF.value 			= document.getElementById(p_origem+'_CNPJ_CPF').value;
		f_busca_pessoa_NEG();
		
		
		NEG_CB_ENDERECO.value			= document.getElementById(p_origem + '_CB_ENDERECO').value;
	}
}
	
function f_busca_pessoa_NEG(por_cod_pessoa) {
	with(document.forms[0]) {
		if(!por_cod_pessoa)
			v_cnpj = NEG_CNPJ_CPF.value;
		else
			v_cod_pessoa = COD_NEGOCIADOR.value;
		f_limpa_NEG(1);
		if(!por_cod_pessoa)
			NEG_CNPJ_CPF.value = v_cnpj;
		else
			COD_NEGOCIADOR.value = v_cod_pessoa;
		if (!por_cod_pessoa && NEG_CNPJ_CPF.value.replace(/ /g, '') == '')
			return;
	   if (true || NEG_CNPJ_CPF.value.length > 4) {
		   	if(por_cod_pessoa)
		   		arguments = 'rapida=1&num_modalidade=13,5&cod_pessoa='+COD_NEGOCIADOR.value
			else
				arguments = 'rapida=1&num_modalidade=13,5&cnpj_cpf='+NEG_CNPJ_CPF.value
			
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_pessoa.cfc?method=get_pessoa_endereco_comercial'
						,arguments
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.cod_pessoa.length > 0) {
									NEG_TIPO_PESSOA.value = obj.struct.tipo_pessoa[0];
									NEG_CNPJ_CPF.value = obj.struct.cnpj_cpf[0];									
									COD_NEGOCIADOR.value = obj.struct.cod_pessoa[0];
									NEG_RAZAO_SOCIAL.value = (obj.struct.razao_social[0] == '')?obj.struct.cliente[0]:obj.struct.razao_social[0];
									f_preenche_cb_enderecos_NEG(obj.struct.cod_pessoa[0]);
									f_busca_tipo_servico();
                           f_preenche_cb_ie_NEG(obj.struct.inscricao_estadual[0] + ',' + obj.struct.ie_adicional[0]);
								}
								else {
									v_cnpj = NEG_CNPJ_CPF.value;
									f_limpa_NEG();
									NEG_CNPJ_CPF.value = v_cnpj;
									alert('Negociador não encontrado');
								}
								try{
									f_busca_tipo_calculo(); 
								} catch(e){}
							}
						});
			}	
	}
}

function f_preenche_cb_enderecos_NEG(p_cod_pessoa, v_endereco) {
	with(document.forms[0]) {
		if(document.getElementById('NEG_ENDERECO_SOLICITACAO').value > 0  ){
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_solicitacao.cfc?method=get_enderecos_solicitacao';
			arguments = 'cod_endereco='+document.getElementById('NEG_ENDERECO_SOLICITACAO').value;
		} else {
			url = '/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_operacao_enderecos';
			arguments = 'cod_pessoa='+COD_NEGOCIADOR.value;
		}
		f_query_wddx(url, arguments ,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								f_limpa_select(document.getElementById('NEG_CB_ENDERECO'));
								v_enderecos_NEG = new Array();
								
								if(obj.struct.cod_endereco.length > 0) {
									for(var i = 0; i < obj.struct.cod_endereco.length; i++) {
										v_enderecos_NEG.push( {
											cod_pessoa		      : obj.struct.cod_pessoa[i],
											cod_endereco	      : obj.struct.cod_endereco[i],
											municipio_id	      : obj.struct.municipio_id[i],
											municipio		      : obj.struct.municipio[i],
											cep				      : obj.struct.cep[i],
											logradouro		      : obj.struct.logradouro[i],
											numero			      : obj.struct.numero[i],
											bairro			      : obj.struct.bairro[i],
											uf				      : obj.struct.uf[i],
											padrao			      : obj.struct.endereco_padrao[i],
											inscricao_estadual    : obj.struct.inscricao_estadual[i],
											cod_atividade_fiscal  : obj.struct.cod_atividade_fiscal[i]											
										} );
										
									}
									f_busca_endereco_NEG(p_cod_pessoa, v_endereco);
								}else{
									f_limpa_select(document.getElementById('NEG_CB_ENDERECO'));
									v_enderecos_NEG = new Array();
								}
								
							}
						});
	}
}


function f_seta_CNPJ_CPF_NEG(v_param){
	with(document.forms[0]){
		NEG_CNPJ_CPF.value = v_param;
	}
	f_busca_pessoa_NEG();
} 

function f_preenche_cb_ie_NEG(p_lista_ie, p_valor_atual) {
   if(p_lista_ie != null && p_lista_ie != "") {
      f_limpa_select(document.getElementById('NEG_INSCRICAO_ESTADUAL'));
      var v_lista_array = p_lista_ie.toString().split(',');
      with(document.forms[0]) {
         for(var i = 0; i < v_lista_array.length; i++) {
            if(v_lista_array[i] != null && v_lista_array[i] != "") {
               f_cria_option(v_lista_array[i], v_lista_array[i], document.getElementById('NEG_INSCRICAO_ESTADUAL'));
            }
         }
      }
      
      // seta o valor desejado no combo de IE
      if(p_valor_atual != null && p_valor_atual != undefined && p_valor_atual != "") {
         var select = document.getElementById('NEG_INSCRICAO_ESTADUAL');
         for(var i = 0; i < select.options.length; i++) {
            if(select.options[i].value == p_valor_atual) {
               select.options[i].selected = true;
               break;
            }
         }
      }
   } else {
      f_limpa_select(document.getElementById('NEG_INSCRICAO_ESTADUAL'));
   }
}


function f_muda_endereco_NEG(){
	with(document.forms[0]){
		NEG_MUNICIPIO_ID.value = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('municipio_id');
		NEG_MUNICIPIO.value	 = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('municipio');
		NEG_CEP.value			 = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('cep');
		NEG_ENDERECO.value	 = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('endereco');
		NEG_ENDERECO_NUM.value = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('num');
		NEG_BAIRRO.value		 = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('bairro');
		NEG_UF.value			 = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('uf');
		NEG_COD_ENDERECO.value = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('cod_endereco');
		NEG_COD_ATIVIDADE_FISCAL.value = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('cod_atividade_fiscal');
        f_busca_tipo_servico();

		if (document.getElementById('NEG_TIPO_PESSOA').value == 1) {
    		NEG_INSCRICAO_ESTADUAL.value   = document.getElementById("NEG_CB_ENDERECO").options[document.getElementById("NEG_CB_ENDERECO").selectedIndex].getAttribute('inscricao_estadual');
			document.getElementById('NEG_INSCRICAO_ESTADUAL').setAttribute("disabled","disabled");
		}
		try{
			f_muda_tipo_frete(1); 
		} catch(e){}
	}
}

function f_busca_endereco_NEG(p_cod_pessoa, v_endereco) {
		with(document.forms[0]) {			
			var v_inserir;
			f_limpa_select(NEG_CB_ENDERECO);
			for(var i = 0; i < v_enderecos_NEG.length; i++) {
				if(Number(v_enderecos_NEG[i].cod_pessoa) == Number(p_cod_pessoa)) {
					v_inserir = true;
					
					if(v_inserir) {
						v_option = f_cria_option(v_enderecos_NEG[i].cod_endereco,v_enderecos_NEG[i].cep + ' - ' + v_enderecos_NEG[i].logradouro + ',' + v_enderecos_NEG[i].numero + ' - ' + v_enderecos_NEG[i].bairro + ' - ' + v_enderecos_NEG[i].municipio + ' - ' + v_enderecos_NEG[i].uf, NEG_CB_ENDERECO);
						v_option.setAttribute('cep', v_enderecos_NEG[i].cep);
						v_option.setAttribute('num', v_enderecos_NEG[i].numero);
						v_option.setAttribute('endereco', v_enderecos_NEG[i].logradouro);
						v_option.setAttribute('bairro', v_enderecos_NEG[i].bairro);
						v_option.setAttribute('municipio', v_enderecos_NEG[i].municipio);
						v_option.setAttribute('uf', v_enderecos_NEG[i].uf);
						v_option.setAttribute('municipio_id', v_enderecos_NEG[i].municipio_id);
						v_option.setAttribute('cod_endereco', v_enderecos_NEG[i].cod_endereco);
						v_option.setAttribute('inscricao_estadual', v_enderecos_NEG[i].inscricao_estadual);
						v_option.setAttribute('cod_atividade_fiscal', v_enderecos_NEG[i].cod_atividade_fiscal);
						
						if(!v_endereco){
							if(v_enderecos_NEG[i].padrao == 1) {
								f_muda_endereco_NEG();
							} else if (document.getElementById('NEG_ENDERECO_SOLICITACAO').value > 0){
								f_muda_endereco_NEG();
							}
						}
						
					}

					v_inserir = false;				
				}
			}

			if(v_endereco){
				NEG_CB_ENDERECO.value = v_endereco;
				f_muda_endereco_NEG();
			}
			
			//Atualiza o endereço quando o mesmo é decorrente de uma cópia
			if(v_endereco_copiar != '') {
				NEG_CB_ENDERECO.value = v_endereco_copiar;
				f_muda_endereco_NEG();
				v_endereco_copiar = '';		
			}
		}
}


function f_muda_pessoa_NEG(){
	with(document.forms[0]){
			var elem = document.getElementById("NOME_NEG_COMBO").options[document.getElementById("NOME_NEG_COMBO").selectedIndex];
			var attributeElem = elem.attributes || elem;

			NEG_TIPO_PESSOA.value         = attributeElem['tipo_pessoa'].nodeValue;
			NEG_CNPJ_CPF.value			= attributeElem['cnpj_cpf'].nodeValue;
			NEG_RAZAO_SOCIAL.value		= attributeElem['razao_social'].nodeValue;
			COD_NEGOCIADOR.value					= elem.value;
			f_busca_endereco_NEG(COD_NEGOCIADOR.value);
			f_preenche_cb_ie_NEG(attributeElem['lista_ie'].nodeValue);
			f_busca_tipo_servico();
	}
}

function f_muda_ie_NEG() {
   var prefixo = 'NEG';
   var prefixoMudar = ';REM;COLETA;DEST;RED;COB;NEG'.replace(new RegExp("^.+"+prefixo+";", "g"), '').split(';');
   
   for (var p = 0; p < prefixoMudar.length; p++) {
      if (prefixoMudar[p] == null || prefixoMudar[p] == "") break;
      if(document.getElementById(prefixo + '_CNPJ_CPF').value != document.getElementById(prefixoMudar[p] + '_CNPJ_CPF').value) {
         return;
      }
      
      // seta o valor desejado no combo de IE
      var select = document.getElementById(prefixoMudar[p] + '_INSCRICAO_ESTADUAL');
      for(var i = 0; i < select.options.length; i++) {
         if(select.options[i].value == document.getElementById('NEG_INSCRICAO_ESTADUAL').value) {
            select.options[i].selected = true;
            break;
         }
      }
   }
}
</script>
<span style="display: none;">
<input name="COD_NEGOCIADOR" tabindex="220" id="COD_NEGOCIADOR" type="hidden" value="72" display="NEGOCIADOR" obrigatorio="1">
<input name="NEG_TIPO_PESSOA" tabindex="221" id="NEG_TIPO_PESSOA" type="hidden" value="">
<input name="NEG_MUNICIPIO_ID" tabindex="222" id="NEG_MUNICIPIO_ID" type="hidden" value="25747">
<input name="NEG_COD_ENDERECO" tabindex="223" id="NEG_COD_ENDERECO" type="hidden" value="1">
<input name="NEG_COD_ATIVIDADE_FISCAL" tabindex="224" id="NEG_COD_ATIVIDADE_FISCAL" type="hidden" value="5">
<input name="NEG_ENDERECO_SOLICITACAO" tabindex="225" id="NEG_ENDERECO_SOLICITACAO" type="hidden" value="0">
</span>

<fieldset tabindex="226">
<legend>Negociador</legend>
<table width="700" border="0" cellspacing="1" cellpadding="1">
  <tbody><tr>
    <td width="100" height="20" class="texto" nowrap="">CNPJ/CPF:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2"><nobr>
      <span id="sp_NEG_unica">
          <input name="NEG_CNPJ_CPF" tabindex="227" class="requerido_form" id="NEG_CNPJ_CPF" onkeypress="return f_formata(this,event,'00000000000000')" onchange="f_busca_pessoa_NEG()" type="text" size="20" maxlength="16" readonly="" display="NEGOCIADOR" obrigatorio="1" tipo="">
          <input name="NEG_RAZAO_SOCIAL" tabindex="228" id="NEG_RAZAO_SOCIAL" type="text" size="89" maxlength="60" readonly="true">
          <button tabindex="229" class="botao-16x16" id="btn_localizar_NEG" style="display: none;" onclick="if(this.form.NEG_CNPJ_CPF.readOnly || this.form.NEG_CNPJ_CPF.disabled) { return; }  NewWindow('/_consultas/localizar_pessoa.cfm?modalidade_id=13,5&amp;campo=COD_NEGOCIADOR&amp;field=COD_PESSOA&amp;funcao=f_busca_pessoa_NEG(true)','_blank',800,600,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="Buscar" src="/_imagens/botoes/16x16/buscar.gif"></button>
                
              <button tabindex="230" class="botao-16x16" id="btn_limpar_NEG" style="display: none;" onclick="if(this.form.NEG_CNPJ_CPF.readOnly || this.form.NEG_CNPJ_CPF.disabled) { return; } f_limpa_NEG()" type="button"><img width="16" height="16" align="absmiddle" alt="Limpar" src="/_imagens/botoes/16x16/apagar.gif"></button>
      </span>
               
      <span id="sp_NEG_multipla" style="display: none;">
          <select name="NOME_NEG_COMBO" tabindex="231" id="NOME_NEG_COMBO" style="width: 628px;" onchange="f_muda_pessoa_NEG();">            
          </select>
      </span>
      <select name="NEG_INSCRICAO_ESTADUAL" tabindex="232" class="requerido_form" id="NEG_INSCRICAO_ESTADUAL" style="width: 141px; display: none;" onchange="f_muda_ie_NEG();" display="NEGOCIADOR" obrigatorio="1"><option value="1863356610840">1863356610840</option></select>
  </nobr></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Endereço:</td>
    <td width="600" height="1" class="texto" nowrap="" colspan="2">
       <nobr>
           <select name="NEG_CB_ENDERECO" tabindex="233" id="NEG_CB_ENDERECO" style="width: 628px;" onchange="f_muda_endereco_NEG();" display="NEGOCIADOR" obrigatorio="Endereço do Negociador"><option value="1" cep="32631040" num="" endereco="AVENIDA PARQUE DAS AROEIRAS" bairro="AROEIRAS" municipio="Betim" uf="MG" municipio_id="25747" cod_endereco="1" inscricao_estadual="1863356610840" cod_atividade_fiscal="5">32631040 - AVENIDA PARQUE DAS AROEIRAS, - AROEIRAS - Betim - MG</option></select>
       </nobr>
       <label class="obrigatorio" id="NEG_LBL_AVISO" style="display: none;" name="NEG_LBL_AVISO"><br>Endereço definido na solicitação de carga.</label>
    </td>
  </tr>
  
  <tr>
    <td height="20" class="texto" nowrap="">CEP:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="NEG_CEP" tabindex="234" id="NEG_CEP" style="width: 80px;" onkeypress="return f_formata(this,event,'00000000')" type="text" maxlength="16" readonly="true">
      Endereço:
      <input name="NEG_ENDERECO" tabindex="235" id="NEG_ENDERECO" type="text" size="45" maxlength="60" readonly="true">
      Nº: <input name="NEG_ENDERECO_NUM" tabindex="236" id="NEG_ENDERECO_NUM" type="text" size="6" maxlength="9" readonly="true">
      Bairro: <input name="NEG_BAIRRO" tabindex="237" id="NEG_BAIRRO" type="text" size="20" maxlength="60" readonly="true"></td>
  </tr>
  <tr>
    <td width="100" height="20" class="texto" nowrap="">Município:</td>
    <td height="20" class="texto" nowrap="" colspan="2"><input name="NEG_MUNICIPIO" tabindex="238" id="NEG_MUNICIPIO" type="text" size="60" maxlength="60" readonly="true">
      <input name="NEG_UF" tabindex="239" id="NEG_UF" type="text" size="4" maxlength="2" readonly="true">
	  
	  </td>
  </tr>
</tbody></table>
</fieldset>

    </td>
  </tr>
</tbody></table>

                                </fieldset>
							</td>
               </tr>

               <tr style="display: none;">
                            <td class="td_aba_corpo" valign="top" colspan="10">
                                <fieldset tabindex="240" id="fds_notas_fiscais" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	
<script>

setReadOnly['NOTAS_FISCAIS'] = function(value) {
		with(document.forms[0]) {
			
			NOTA_NUMERO.readOnly		= value;
			NOTA_SERIE.disabled			= value;
			NOTA_SUB_SERIE.disabled		= value;
			NOTA_MODELO.disabled		= value;
			NOTA_DATA_EMISSAO.readOnly	= value;
			NOTA_VALOR.readOnly			= value;
			NOTA_VALOR_SEGURADO.readOnly= value;
			NOTA_ORDEM_COMPRA.readOnly	= value;
			NOTA_QTDE_VOLUME.readOnly	= value;
			NOTA_PESO.readOnly			= value;
			NOTA_COD_UNIDADE.disabled	= value;
			NOTA_M3.readOnly			= value;
			NOTA_PESO_CUBADO.readOnly	= value;
			NOTA_NUM_NATUREZA.readOnly	= value;
			NOTA_COMPLEMENTO.readOnly	= value;
			NOTA_NUM_ESPECIE.readOnly	= value;
			NOTA_ALTURA.readOnly		= value;
			NOTA_LARGURA.readOnly		= value;
			NOTA_COMPRIMENTO.readOnly	= value;
			NOTA_PESO_COBRADO.readOnly	= value;
			PEDIDO_SHIPMENT.readOnly	= value;
			
			document.getElementById('btn_pedido_shipment').disabled = value;
			document.getElementById('btn_pedido_shipment_sem_preenchimento').disabled = value;
		}
	}

setReadOnly['NOTA_MERCADORIA'] = function(value) {
		with(document.forms[0]) {
			PEDIDO_SHIPMENT.readOnly	= value;			
			document.getElementById('btn_pedido_shipment').disabled = value;

			// nota
			document.getElementById('tr_lista_botoes_NOTAS_FISCAIS').style.display = value?'none':'';
			NOTA_NUMERO.readOnly		= value;
			NOTA_SERIE.disabled			= value;
			NOTA_SUB_SERIE.disabled		= value;
			NOTA_MODELO.disabled		= value;
			NOTA_DATA_EMISSAO.readOnly	= value;
			NOTA_VALOR.readOnly			= value;
			NOTA_VALOR_SEGURADO.readOnly= value;
			NOTA_CFOP.readOnly			= value;
			NOTA_ORDEM_COMPRA.readOnly	= value;
			NOTA_QTDE_VOLUME.readOnly	= value;
			NOTA_PESO.readOnly			= value;
			NOTA_COD_UNIDADE.disabled	= value;
			NOTA_M3.readOnly			= value;
			NOTA_PESO_CUBADO.readOnly	= value;
			NOTA_NUM_NATUREZA.readOnly	= value;
			NOTA_COMPLEMENTO.readOnly	= value;
			NOTA_NUM_ESPECIE.readOnly	= value;
			NOTA_ALTURA.readOnly		= value;
			NOTA_LARGURA.readOnly		= value;
			NOTA_COMPRIMENTO.readOnly	= value;
			NOTA_PESO_COBRADO.readOnly	= value;
			
			//nfe
			document.getElementById('tr_lista_botoes_NFE').style.display = value?'none':'';
			CHAVE_ACESSO_NFE.readOnly	= value;
			PIN_SUFRAMA_NFE.readOnly	= value;
			NFE_VALOR.readOnly			= value;
			NFE_VALOR_SEGURADO.readOnly	= value;
			DATA_EMISSAO_NFE.readOnly	= value;
			NUMERO_NFE.readOnly			= value;
			MODELO_NFE.disabled			= value;
			SERIE_NFE.disabled			= value;
			NFE_CFOP.disabled			= value;
			NFE_ORDEM_COMPRA.readOnly	= value;			
			NFE_QTDE_VOLUME.readOnly	= value;
			NFE_PESO.readOnly			= value;
			NFE_COD_UNIDADE.disabled	= value;
			NFE_M3.readOnly				= value;
			NFE_PESO_CUBADO.readOnly	= value;
			NFE_NUM_NATUREZA.readOnly	= value;
			NFE_COMPLEMENTO.readOnly	= value;
			NFE_NUM_ESPECIE.readOnly	= value;
			NFE_ALTURA.readOnly			= value;
			NFE_LARGURA.readOnly		= value;
			NFE_COMPRIMENTO.readOnly	= value;
			NFE_PESO_COBRADO.readOnly	= value;
			
			//outros
			document.getElementById('tr_lista_botoes_OUTROS').style.display = value?'none':'';
			OUTROS_NUMERO.readOnly			= value;
			OUTROS_DATA_EMISSAO.readOnly	= value;
			OUTROS_VALOR.readOnly			= value;
			OUTROS_VALOR_SEGURADO.readOnly	= value;
			OUTROS_DESCRICAO.readOnly		= value;
			OUTROS_ORDEM_COMPRA.readOnly	= value;
			OUTROS_QTDE_VOLUME.readOnly		= value;
			OUTROS_PESO.readOnly			= value;
			OUTROS_COD_UNIDADE.disabled		= value;
			OUTROS_M3.readOnly				= value;
			OUTROS_PESO_CUBADO.readOnly		= value;
			OUTROS_NUM_NATUREZA.readOnly	= value;
			OUTROS_COMPLEMENTO.readOnly		= value;
			OUTROS_NUM_ESPECIE.readOnly		= value;
			OUTROS_ALTURA.readOnly			= value;
			OUTROS_LARGURA.readOnly			= value;
			OUTROS_COMPRIMENTO.readOnly		= value;
			OUTROS_PESO_COBRADO.readOnly	= value;
        }
	}

setReadOnly['NOTAS_ANULACAO'] = function(value) {
   with(document.forms[0]) {
      CHAVE_ACESSO_NFE.readOnly	= value;
      PIN_SUFRAMA_NFE.readOnly	= value;
      NFE_VALOR.readOnly			= value;
      NFE_VALOR_SEGURADO.readOnly= value;
      DATA_EMISSAO_NFE.readOnly	= value;
      NUMERO_NFE.readOnly			= value;
      MODELO_NFE.disabled			= value;
      SERIE_NFE.disabled			= value;
      NFE_CFOP.disabled			   = value;
      NFE_ORDEM_COMPRA.readOnly	= value;
      NFE_COMPLEMENTO.readOnly	= value;
      
      document.getElementById('btn_pedido_shipment').disabled = value;
      document.getElementById('btn_pedido_shipment_sem_preenchimento').disabled = value;
   }
}

function f_busca_natureza(p_nome) {
	with(document.forms[0]) {
		if(POPULANDO_DADOS.value == 1){
		   return;
		}
		
		if (!v_edicao){
			if(document.getElementById(p_nome+'_NUM_NATUREZA').value){
				document.getElementById(p_nome+'_NATUREZA').value = 'Aguarde, consultando...';
				f_query_wddx('/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_natureza'
							,'num_natureza='+document.getElementById(p_nome+'_NUM_NATUREZA').value+'&operacao_id='+ OPERACAO_ID_CTRC.value
							,function(obj){
								if(obj.ajax.readyState == 4 && obj.ajax.status == 200){
									if(obj.struct.num_natureza.length == 1){
										document.getElementById(p_nome+'_NATUREZA').value = obj.struct.descricao[0];
									}else{
										document.getElementById(p_nome+'_NATUREZA').value = '';
										alert('Natureza não encontrada ou não permitida para esta Operação Logística.');
									}
								}
							});
			}else{
				document.getElementById(p_nome+'_NATUREZA').value = '';
			}
		}
	}
}

function f_busca_especie(p_nome) {
	with(document.forms[0]) {
		if(POPULANDO_DADOS.value == 1){
		   return;
		}
		
		if (!v_edicao){
			if(document.getElementById(p_nome+'_NUM_ESPECIE').value){
				document.getElementById(p_nome+'_ESPECIE').value = 'Aguarde, consultando...';
				f_query_wddx('/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_especie'
							,'num_especie='+document.getElementById(p_nome+'_NUM_ESPECIE').value
							,function(obj){
								if(obj.ajax.readyState == 4 && obj.ajax.status == 200){
									if(obj.struct.num_especie.length > 0){
										document.getElementById(p_nome+'_ESPECIE').value = obj.struct.descricao[0];
									}else{
										document.getElementById(p_nome+'_ESPECIE').value = '';
										alert('Espécie não encontrada.');
									}
								}
							});
			}else{
				document.getElementById(p_nome+'_ESPECIE').value = '';
			}
		}
	}
}


</script>
<script language="javascript1.2">
	v_modelo = [];
	
	v_serie1 = [];
	
	v_sub_serie1 = [];
	
	function f_busca_serie_nota() {
		with(document.forms[0]) {
		
			v_c = 0;
			v_serie = '';
			NOTA_SERIE.value = '';
			for(var i=0;i<v_serie1.length;i++) {
				if(v_serie1[i].cod_modelo == NOTA_MODELO.value) {
					v_serie_sel = v_serie1[i].serie;
					v_c++;
				}
			}
			if(v_c == 1) {
				NOTA_SERIE.value = v_serie_sel;
			}
			f_busca_sub_serie_nota();
		
		}
	}
	function f_busca_sub_serie_nota() {
		with(document.forms[0]) {
		
			NOTA_SUB_SERIE.value = '';
			v_c = 0;
			v_subserie_sel = '';
			for(var i=0;i<v_serie1.length;i++) {
				if(v_sub_serie1[i].serie == NOTA_SERIE.value && v_sub_serie1[i].cod_modelo == NOTA_MODELO.value) {
					v_sub_serie_sel = v_sub_serie1[i].sub_serie;
					v_c++;
				}
			}
			if(v_c == 1) {
				NOTA_SUB_SERIE.value = v_sub_serie_sel;
			}
			
		
		}
	}
	
	function f_calcula_peso_cobrado(p_nome) {
		with(document.forms[0]){
			var p_nome = p_nome ? p_nome : 'NOTA';
			if(Number(document.getElementById(p_nome+'_PESO_KG_CONVERTIDO').value) > Number(document.getElementById(p_nome+'_CUBAGEM').value)){
				document.getElementById(p_nome+'_PESO_COBRADO').value = document.getElementById(p_nome+'_PESO_KG_CONVERTIDO').value; 
			}else{
				document.getElementById(p_nome+'_PESO_COBRADO').value = document.getElementById(p_nome+'_CUBAGEM').value;
			}
		}
	}

	function f_calcula_peso_kg(p_nome) {
		with(document.forms[0]) {
			var p_nome = p_nome ? p_nome : 'NOTA';
			document.getElementById(p_nome+'_PESO_KG_CONVERTIDO').value = '';
			if(document.getElementById(p_nome+'_PESO').value == '' || document.getElementById(p_nome+'_COD_UNIDADE').value == '') {
				return;
			}
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_logistico.cfc?method=converte_unidade'
						,'valor='+document.getElementById(p_nome+'_PESO').value+'&unidade_origem='+document.getElementById(p_nome+'_COD_UNIDADE').value+'&unidade_destino=KG'
						,function (obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								with(document.forms[0]) {
									document.getElementById(p_nome+'_PESO_KG_CONVERTIDO').value = toCurrency(obj.struct);
									f_calcula_peso_cobrado(p_nome);
								}
							}
						})	
		}
	}
	function f_calcula_cubagem(p_nome){		
		with(document.forms[0]){
			var p_nome = p_nome ? p_nome : 'NOTA';
			var v_calcula_peso_cobrado = v_inserida == 0;
			
			if(document.getElementById(p_nome+'_ALTURA').value != null &&  document.getElementById(p_nome+'_LARGURA').value != null && document.getElementById(p_nome+'_COMPRIMENTO').value != null){
				if (v_calcula_peso_cobrado){
					document.getElementById(p_nome+'_M3').value = toCurrency(Number(document.getElementById(p_nome+'_ALTURA').value * document.getElementById(p_nome+'_LARGURA').value * document.getElementById(p_nome+'_COMPRIMENTO').value * document.getElementById(p_nome+'_QTDE_VOLUME').value));
					document.getElementById(p_nome+'_CUBAGEM_SUGERIDA').value = toCurrency(Number(document.getElementById('COEFICIENTE_CUBAGEM').value * document.getElementById(p_nome+'_M3').value));
					document.getElementById(p_nome+'_CUBAGEM').value = document.getElementById(p_nome+'_CUBAGEM_SUGERIDA').value;
					document.getElementById(p_nome+'_PESO_CUBADO').value = Number(document.getElementById(p_nome+'_ALTURA').value * document.getElementById(p_nome+'_LARGURA').value * document.getElementById(p_nome+'_COMPRIMENTO').value * document.getElementById(p_nome+'_QTDE_VOLUME').value);
				}
				
				if (document.getElementById(p_nome+'_PESO_CUBADO').value == ''){
				   document.getElementById(p_nome+'_PESO_CUBADO').value = document.getElementById(p_nome+'_CUBAGEM').value;
				}				
				
			}
		}
		if (v_calcula_peso_cobrado){
			f_calcula_peso_cobrado(p_nome);
		}
	}
	
	function f_muda_tipo_documento(){
		with(document.forms[0]) {
			//Verifica se não possui ennhum documento
			v_total_nf = f_listagem_NOTAS_FISCAIS();
			v_total_nfe = f_listagem_NFE();
			v_total_outros = f_listagem_OUTROS();
			
			if( (Number(v_total_nf.length) + Number(v_total_nfe.length) + Number(v_total_outros.length) ) > 0){
				alert('Para alternar para outro tipo de documento , os documentos inseridos atualmente devem ser excluidos.');
				
				if(Number(v_total_nf.length)){
					TIPO_DOCUMENTO_ID.value = 0;
				}
				
				if(Number(v_total_nfe.length)){
					TIPO_DOCUMENTO_ID.value = 1;
				}
				
				if(Number(v_total_outros.length)){
					TIPO_DOCUMENTO_ID.value = 2;
				}
				
				return;
			}
			
			switch (Number(TIPO_DOCUMENTO_ID.value)){
				case 0:
					//habilita o fieldset especifico
					document.getElementById('tb_nota_fiscal').style.display = '';
					document.getElementById('tb_nota_fiscal').disabled = 0;
					
					
					//desabilita os outros fieldsets
					document.getElementById('fs_nfe').style.display = 'none';
					document.getElementById('fs_nfe').disabled = 1;
					document.getElementById('td_nfe').style.display = 'none';
					document.getElementById('td_nfe').disabled = 1;
					
					document.getElementById('fs_outros').style.display = 'none';
					document.getElementById('fs_outros').disabled = 1;
					break;
				case 1:
					//habilita o fieldset especifico
					document.getElementById('fs_nfe').style.display = '';
					document.getElementById('fs_nfe').disabled = 0;
					document.getElementById('td_nfe').style.display = '';
					document.getElementById('td_nfe').disabled = 0;
					
					//desabilita os outros fieldsets
					document.getElementById('tb_nota_fiscal').style.display = 'none';
					document.getElementById('tb_nota_fiscal').disabled = 1;
					document.getElementById('fs_outros').style.display = 'none';
					document.getElementById('fs_outros').disabled = 1;
					break;
				case 2:
					//habilita o fieldset especifico
					document.getElementById('fs_outros').style.display = '';
					document.getElementById('fs_outros').disabled = 0;
					
					//desabilita os outros fieldsets
					document.getElementById('fs_nfe').style.display = 'none';
					document.getElementById('fs_nfe').disabled = 1;
					document.getElementById('td_nfe').style.display = 'none';
					document.getElementById('td_nfe').disabled = 1;
					document.getElementById('tb_nota_fiscal').style.display = 'none';
					document.getElementById('tb_nota_fiscal').disabled = 1;
					break;
				case 3:
					//habilita o fieldset especifico
					document.getElementById('fs_outros').style.display = '';
					document.getElementById('fs_outros').disabled = 0;
					
					//desabilita os outros fieldsets
					document.getElementById('fs_nfe').style.display = 'none';
					document.getElementById('fs_nfe').disabled = 1;
					document.getElementById('td_nfe').style.display = 'none';
					document.getElementById('td_nfe').disabled = 1;
					document.getElementById('tb_nota_fiscal').style.display = 'none';
					document.getElementById('tb_nota_fiscal').disabled = 1;
					break;
				default:
					
			}
		}
	}
	
	function f_busca_dados_nfe() {
			with(document.forms[0]) {
			if(ARQUIVO.value){
				var v_nome_arquivo = ARQUIVO.value;
				var v_extensao = v_nome_arquivo.substr(v_nome_arquivo.lastIndexOf('.'));
				
				if(v_extensao != '.xml' && v_extensao != '.XML'){
					document.getElementById('td_nfe').innerHTML = document.getElementById('td_nfe').innerHTML;
					alert('O arquivo selecionado deve ser um XML.');
					return false;					
				}
				
				OPERACAO.value = 10;
				target = 'consultas';
				action = 'confirma.cfm';
				submit();
			}
		}
	}
	
	function f_busca_dados_chave_nfe(){
		with(document.forms[0]) {
		   MODELO_NFE.readOnly = false;
		   NUMERO_NFE.readOnly = false;
		   SERIE_NFE.readOnly = false;

			if(CHAVE_ACESSO_NFE.value){
				if( isNaN(CHAVE_ACESSO_NFE.value)){
					alert('Preencha somente os números da chave.');
					return false;
				}
				f_validar_chave_nfe();
				
				if(BUSCA_POR_CHAVE.value == 1) {
				   f_localizar_nfe_chave();
				}
				   v_chave = CHAVE_ACESSO_NFE.value.toString();
				   MODELO_NFE.value = Number(v_chave.substr(20,2));
				   NUMERO_NFE.value = Number(v_chave.substr(25,9));
				   SERIE_NFE.value = Number(v_chave.substr(22,3));
				   NFE_ORDEM_COMPRA.value = PEDIDO_SHIPMENT_SOLICITACAO.value;

				   MODELO_NFE.readOnly = true;
				   NUMERO_NFE.readOnly = true;
				   SERIE_NFE.readOnly = true;
			}
		}
			
	}
	
	function f_controla_tipo_docto_frete(){	
		with(document.forms[0]){
			if(TIPO_DOCTO_FRETE.value == ''){
				TIPO_DOCUMENTO_ID.disabled = '';
			}else{
				TIPO_DOCUMENTO_ID.value = TIPO_DOCTO_FRETE.value;
				f_muda_tipo_documento();
				TIPO_DOCUMENTO_ID.disabled = 'disabled';	
			}
		}
	}
	
	function f_pedido_shipment_obrigatorio(v_obrigatorio){
		v_class = v_obrigatorio == 1 ? 'requerido_form' : '';
		v_nota = document.getElementById('NOTA_ORDEM_COMPRA');
		v_nfe = document.getElementById('NFE_ORDEM_COMPRA');
		v_outros = document.getElementById('OUTROS_ORDEM_COMPRA');
		
		v_nota.setAttribute('obrigatorio',v_obrigatorio);
		v_nfe.setAttribute('obrigatorio',v_obrigatorio);
		v_outros.setAttribute('obrigatorio',v_obrigatorio);
		v_nota.className = v_class;
		v_nfe.className  = v_class;
		v_outros.className  = v_class;
	}

	function f_pedido_shipment_edicao(v_permite_editar){
		v_bool = v_permite_editar == 0 ? true : false;
		
		//Ajuste para registro de CT-e
		if (document.getElementById('ABERTO').value == 1){
		   v_bool = false;
		}

		document.getElementById('NOTA_ORDEM_COMPRA').readOnly	= v_bool;
		document.getElementById('NFE_ORDEM_COMPRA').readOnly	= v_bool;
		document.getElementById('OUTROS_ORDEM_COMPRA').readOnly = v_bool;
		
		document.getElementById('btn_pedido_shipment').disabled                   = v_bool;
		document.getElementById('btn_pedido_shipment_sem_preenchimento').disabled = v_bool;
	}

	parent.f_busca_dados_chave_nfe = f_busca_dados_chave_nfe;	

	function f_get_nfe_cfop_obrigatorio(){
		with(document.forms[0]){
			
				var js_v_nfe_cfop_obrigatorio = "Não";
;
			 
			return js_v_nfe_cfop_obrigatorio;
		}
	}
	
	function f_sanitizar_numero(obj){
		obj && obj.value && (obj.value = obj.value.replace(/(\d),(?=\d)/g, '$1.'));
	}

	function f_preenche_constantes_cfop_mercadoria(){
		var v_maior_valor = -0.001;
		with(document.forms[0]){
			//Notas Fiscais
			var v_valor_nfoc;
			v_nfs  = f_listagem_NOTAS_FISCAIS();
			for(i=0; i<v_nfs.length; i++){
				v_valor_nfoc = document.getElementById('NOTA_VALOR_NOTAS_FISCAIS_' + v_nfs[i].id);
				NFE_ICMS_PARTILHADO.value = 0;
				if (v_valor_nfoc.value > v_maior_valor){
					v_maior_valor = v_valor_nfoc.value;
					MERCADORIA_TRANSPORTADA.value = document.getElementById('NOTA_NUM_NATUREZA_NOTAS_FISCAIS_' + v_nfs[i].id).value;
					CFOP_TRANSPORTADO.value = document.getElementById('NOTA_CFOP_NOTAS_FISCAIS_' + v_nfs[i].id).value;
				}
			}

			//NFe
			var v_valor_nfeoc;
			v_nfes = f_listagem_NFE();
			NFE_ICMS_PARTILHADO.value = 0;
			for(i=0; i<v_nfes.length; i++){
				v_valor_nfeoc = document.getElementById('NFE_VALOR_NFE_' + v_nfes[i].id);
				if (v_valor_nfeoc.value > v_maior_valor){
					v_maior_valor = v_valor_nfeoc.value;
					MERCADORIA_TRANSPORTADA.value = document.getElementById('NFE_NUM_NATUREZA_NFE_' + v_nfes[i].id).value;
					CFOP_TRANSPORTADO.value = document.getElementById('NFE_CFOP_NFE_' + v_nfes[i].id).value;
				}
				if (document.getElementById('ICMS_PARTILHADO_NFE_' + v_nfes[i].id).value == 1) {
				   NFE_ICMS_PARTILHADO.value = 1;
				}
			}

			//Outros
			var v_valor_outrosoc;
			v_outros = f_listagem_OUTROS();
			for(i=0; i<v_outros.length; i++){
				v_valor_outrosoc = document.getElementById('OUTROS_VALOR_OUTROS_' + v_outros[i].id)
				NFE_ICMS_PARTILHADO.value = 0;
				if (v_valor_outrosoc.value > v_maior_valor){
					v_maior_valor = v_valor_outrosoc.value;
					MERCADORIA_TRANSPORTADA.value = document.getElementById('OUTROS_NUM_NATUREZA_OUTROS_' + v_outros[i].id).value;
      				CFOP_TRANSPORTADO.value = '';
				}
			}
		}
		return true;
	}
	
	/*Valida se é obrigatorio o preenchimento do campo pedido/shipment
	  das notas ficais e se o campo está preenchido */
function f_valida_notas_fiscais_ps(){
		v_notas = Array();
		
		if(document.getElementById("TIPO_DOCUMENTO_ID").value == 0){
			v_nfoc = document.getElementById('NOTA_ORDEM_COMPRA');
			if(v_nfoc.getAttribute('obrigatorio') == 1){
				v_nfs  = f_listagem_NOTAS_FISCAIS();
				for(i=0; i<v_nfs.length; i++){
					if(v_nfs[i].NOTA_ORDEM_COMPRA == '')
						v_notas.push(v_nfs[i].NOTA_NUMERO);
				}
			}
		}
		
		if(document.getElementById("TIPO_DOCUMENTO_ID").value == 1){
			v_nfeoc = document.getElementById('NFE_ORDEM_COMPRA');
			if(v_nfeoc.getAttribute('obrigatorio') == 1){
				v_nfes = f_listagem_NFE();
				
				for(i=0; i<v_nfes.length; i++){
					if(v_nfes[i].NFE_ORDEM_COMPRA == '')
						v_notas.push(v_nfes[i].NUMERO_NFE);
				}
			}
		}
		
		if(document.getElementById("TIPO_DOCUMENTO_ID").value == 2	){
			v_nfooc = document.getElementById('OUTROS_ORDEM_COMPRA');
			if(v_nfooc.getAttribute('obrigatorio') == 1){
				v_nfos = f_listagem_OUTROS();
				
				for(i=0; i<v_nfos.length; i++){
					if(v_nfos[i].OUTROS_ORDEM_COMPRA == '')
						v_notas.push(v_nfos[i].OUTROS_NUMERO);
				}
			}
		}		
		
		if(v_notas.length == 1){
			alert('A nota fiscal '+v_notas+' não possui valor informado no campo PEDIDO/SHIPMENT, é necessário seu preenchimento para prosseguir.');
			return false;
		}else if(v_notas.length > 1){
			alert('As notas fiscais '+v_notas.join(',')+' não possuem valor informado no campo PEDIDO/SHIPMENT, é necessário seu preenchimento para prosseguir.');
			return false;
		}else
			return true;
		
	}
	
	function f_replica_pedido_shipment(p_todos){
		with(document.forms[0]){
			if(PEDIDO_SHIPMENT.value == ''){
				alert('Para replicar um valor de Pedido/Shipment a todos os documentos o campo deve estar com um valor preenchido.');
				return false;
			}
			//contador
			var v_count = 0;
			
			//Notas Fiscais
			var v_nfoc;
			v_nfs  = f_listagem_NOTAS_FISCAIS();
			for(i=0; i<v_nfs.length; i++){
				v_nfoc = document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_' + v_nfs[i].id)
				if (v_nfoc.value == '' || p_todos == '1'){
					v_nfoc.value = PEDIDO_SHIPMENT.value;
					v_count++;
				}
			}
			
			//NFe
			var v_nfeoc;
			v_nfes = f_listagem_NFE();
			for(i=0; i<v_nfes.length; i++){
				v_nfeoc = document.getElementById('NFE_ORDEM_COMPRA_NFE_' + v_nfes[i].id)
				if (v_nfeoc.value == '' || p_todos == '1'){
					v_nfeoc.value = PEDIDO_SHIPMENT.value;
					v_count++;
				}
			}
			
			//Outros
			var v_outrosoc;
			v_outros = f_listagem_OUTROS();
			for(i=0; i<v_outros.length; i++){
				v_outrosoc = document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_' + v_outros[i].id)
				if (v_outrosoc.value == '' || p_todos == '1'){
					v_outrosoc.value = PEDIDO_SHIPMENT.value;
					v_count++;
				}
			}
			
			if(v_count++ == 0){
				alert('Nenhum documento teve o valor do Pedido/Shipment atualizado.');
			}else{
				if (p_todos == '1'){
					alert('Tdos os documentos foram atualizados para o valor do Pedido/Shipment da Viagem.');
				}else{
				alert('Os documentos que não continham valor Pedido/Shipment foram atualizados para o valor do Pedido/Shipment da Viagem.');
			}
		}
	}
	}
	
	function f_localizar_nfe(){
		with(document.forms[0]){
			if(DEST_CNPJ_CPF.value == '' || REM_CNPJ_CPF.value == '' || (OPERACAO_ID.value == '' && OPERACAO_ID_CTRC.value == '')){
				alert("Para localizar NF-e's integradas o Remetente e o Destinatário devem estar preenchidos.");
				return false;
			}
			
			
			   f_abrir_janela('/modulos/cte/emitir/localizar_nfe.cfm?cpf_cnpj_destinatario='+DEST_CNPJ_CPF.value+'&cpf_cnpj_emitente='+REM_CNPJ_CPF.value +'&placa='+PLACA_CONTROLE.value +'&operacao_id='+ nvl(OPERACAO_ID.value,OPERACAO_ID_CTRC.value), 'f_atualizar()', 800, 600, true)
			
		}
	}
	
	function f_localizar_nfe_chave(){
		with(document.forms[0]){
			var v_aux = 'chave='+CHAVE_ACESSO_NFE.value;
			f_busca_info_nfe(v_aux, NUM_NATUREZA.value, '','');
		}
	}
	
	function f_insere_nfe_integrada(p_documento_id, p_num_natureza, p_natureza, p_pedido_shippment){
		with(document.forms[0]) {
			DOCUMENTO_ID.value = p_documento_id;

			if(!DOCUMENTO_ID.value) {
				return;
			}
			
			var v_aux ='documento_id=' + DOCUMENTO_ID.value;
			f_busca_info_nfe(v_aux, p_num_natureza, p_natureza, p_pedido_shippment);
						
			v_inserida = 0;
			BUSCA_POR_CHAVE.value = 1;
		}
	}	
	
	function f_busca_info_nfe(p_filtro, p_num_natureza, p_natureza, p_pedido_shippment){ // recebe o filtro que será passado na query de busca da nota
		//38303 Incluir NFe ao CT-e 
		with(document.forms[0]){
			v_pedido_shipment_obg = NFE_ORDEM_COMPRA.getAttribute('obrigatorio');
			var tipoDoc = document.getElementById("TIPO_DOCUMENTO_ID").value ;
            
			f_query_wddx('/modulos/cte/_componentes/consulta/cfc_cte.cfc?method=get_nfe'
						,p_filtro + '&avon=0'
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.documento_id.length > 0) {									
									for(var i = 0; i < obj.struct.documento_id.length; i++) {
										f_incluir_NFE();
                                        NFE_ORDEM_COMPRA.setAttribute('obrigatorio', 0);
										
										v_inserida = 1;
										
										//Atribui o pedido shipment do xml da nota
										p_pedido_shippment = obj.struct.pedido_shippment[i];
										
										if(p_pedido_shippment == PEDIDO_SHIPMENT_SOLICITACAO.value){
										   p_pedido_shippment = '';
										}
										
										try{
											if(Number(p_pedido_shippment) == Number(PEDIDO_SHIPMENT_SOLICITACAO.value) ){
											   p_pedido_shippment = '';
											}
										} catch(e) {}
										
										/* Campos */
										// verifica tipo do documento para atribuir o pedido shipment correto
										if (tipoDoc == 0){
										   NOTA_ORDEM_COMPRA.value = NOTA_ORDEM_COMPRA.value + ' ' + p_pedido_shippment;
										}
										if (tipoDoc == 1){
									       if (p_pedido_shippment) {
  										      NFE_ORDEM_COMPRA.value = 'DT '+ p_pedido_shippment + '\n' + NFE_ORDEM_COMPRA.value;
										   }
										}

										CHAVE_ACESSO_NFE.value       = obj.struct.chave_numerica[i];
										NFE_VALOR.value              = obj.struct.valor[i];
										NFE_VALOR_SEGURADO.value     = obj.struct.valor[i];
										NFE_NUM_NATUREZA.value       = p_num_natureza;
										NFE_NATUREZA.value           = 'NFe Integrada';
										NFE_PESO.value               = obj.struct.peso_calculado[i];
										NFE_PESO_COBRADO.value       = obj.struct.peso_calculado[i];
										NFE_QTDE_VOLUME.value        = obj.struct.volume[i];
										NFE_CFOP.value               = obj.struct.cfop[i];
										NFE_NUM_ESPECIE.value        = obj.struct.num_especie[i];
										NFE_ESPECIE.value            = obj.struct.especie_mapeada[i];
										PIN_SUFRAMA_NFE.value        = '';
										REMETENTE_NFE.value          = obj.struct.razao_social_emitente[i];
										CNPJ_REMETENTE_NFE.value     = obj.struct.cpf_cnpj_emitente[i];
										DESTINATARIO_NFE.value       = obj.struct.razao_social_destinatario[i];
										CNPJ_DESTINATARIO_NFE.value  = obj.struct.cpf_cnpj_destinatario[i];
										NOME_ARQUIVO.value           = '';
										NUMERO_NFE.value             = obj.struct.numero_documento[i];
										MODELO_NFE.value             = obj.struct.modelo_documento[i];
										SERIE_NFE.value              = obj.struct.serie_documento[i];
										DATA_EMISSAO_NFE.value       = obj.struct.data_emissao[i];
										NFE_DOCUMENTO_ID.value       = obj.struct.documento_id[i];
										NFE_PESO_CUBADO.value 		  = obj.struct.peso_calculado[i];
										NFE_PESO_KG_CONVERTIDO.value = obj.struct.peso_calculado[i];
										NFE_PESO_COBRADO.value 		  = obj.struct.peso_calculado[i];
										ICMS_PARTILHADO.value    = obj.struct.icms_partilhado[i];
										f_calcula_cubagem('NFE');
										/* ------ */
										
										f_salvar_NFE();
										NFE_ORDEM_COMPRA.setAttribute('obrigatorio', v_pedido_shipment_obg);
									}
									
								}
								else {
									alert('NFE não encontrada.');
								}
							}
						});	
		}
	}
	
	function f_valor_segurado_automatico(tipo_documento, atualiza_valor_segurado) {
		with(document.forms[0]) {
			if(OPERACAO_ID.value == ''){
				return;
			}
			
			f_query_wddx('/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_config_valor_segurado'
						,'operacao_id=' + OPERACAO_ID.value
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {								
								if(obj.struct.destinado_exportacao.length > 0) {		

									for(var i = 0; i < obj.struct.destinado_exportacao.length; i++) {

										if (obj.struct.destinado_exportacao[i] == 1 && obj.struct.adicional_valor_segurado[i] > 0) {
											document.getElementById(tipo_documento+'_VALOR_SEGURADO').setAttribute('disabled', 'disabled');
											if (atualiza_valor_segurado == 1) {
												if (document.getElementById(tipo_documento+'_VALOR').value == '') {
													document.getElementById(tipo_documento+'_VALOR_SEGURADO').value = document.getElementById(tipo_documento+'_VALOR').value;
												} else {
													document.getElementById(tipo_documento+'_VALOR_SEGURADO').value = toCurrency(Number(document.getElementById(tipo_documento+'_VALOR').value) + (document.getElementById(tipo_documento+'_VALOR').value * obj.struct.adicional_valor_segurado[i] / 100));
												}
											}
										} else {
											document.getElementById(tipo_documento+'_VALOR_SEGURADO').removeAttribute('disabled');
											if (atualiza_valor_segurado == 1) {
												document.getElementById(tipo_documento+'_VALOR_SEGURADO').value = document.getElementById(tipo_documento+'_VALOR').value;
											}
										}
                              
                              // Calcula sobretaxa valor segurado, de acordo com quantidade de notas da solicitação
                              if (NUM_ROMANEIO.value != "" && obj.struct.perc_sobretaxa[i] > 0) {
                                 var perc_sobretaxa = obj.struct.perc_sobretaxa[i];
                                 f_query_wddx('/modulos/cte/_componentes/consulta/logistica/cfc_operacao.cfc?method=get_count_notas_solicitacao'
                                    ,'num_romaneio=' + NUM_ROMANEIO.value
                                    ,function(obj2) {
                                       if(obj2.ajax.readyState == 4 && obj2.ajax.status == 200) {
                                          var valor_segurado = Number(document.getElementById(tipo_documento+'_VALOR_SEGURADO').value);
                                          valor_segurado = toCurrency(valor_segurado + (valor_segurado * perc_sobretaxa / 100));
                                          document.getElementById(tipo_documento+'_VALOR_SEGURADO').value = valor_segurado;
                                          var num_notas = obj2.struct.num_notas[0] + ';';
                                          if (NOTA_NUMERO.value != '' && obj2.struct.count_notas[0] > 0 && num_notas.search(NOTA_NUMERO.value + ';') > -1) {
                                             NOTA_VALOR_SEGURADO.disabled = true;
                                          } else {
                                             NOTA_VALOR_SEGURADO.disabled = false;
                                          }
                                       }
                                    }
                                 );
                              }

									}
								}
							}
						});
		}
	}
</script>
<input name="CFOP_TRANSPORTADO" tabindex="241" id="CFOP_TRANSPORTADO" type="hidden" value="5102">
<input name="NFE_ICMS_PARTILHADO" tabindex="242" id="NFE_ICMS_PARTILHADO" type="hidden" value="0">
<input name="BUSCA_POR_CHAVE" tabindex="243" id="BUSCA_POR_CHAVE" type="hidden" value="1" secao="NFE">
<input name="MERCADORIA_TRANSPORTADA" tabindex="244" id="MERCADORIA_TRANSPORTADA" type="hidden" value="9">
<input name="NF_CONHECIMENTO_ID" tabindex="245" id="NF_CONHECIMENTO_ID" type="hidden" value="" fixo="1">
<table width="900" border="0" cellspacing="0" cellpadding="0">
	<tbody><tr>
    	<td width="90%">
        	<table width="90%" border="0" cellspacing="3" cellpadding="1">
            	<tbody><tr>
                	<td class="texto" nowrap="" style="width: 1%;">Tipo do Documento:</td>
                    <td class="texto" nowrap="" style="width: 1%;">
                    <select name="TIPO_DOCUMENTO_ID" tabindex="246" class="requerido_form" id="TIPO_DOCUMENTO_ID" style="width: 300px;" onchange="f_muda_tipo_documento();" display="TIPO DO DOCUMENTO" obrigatorio="1">
					  
                        	<option value="0">Nota Fiscal</option>                        
                      
                        	<option value="1">Nota Fiscal Eletrônica</option>                        
                      
                        	<option value="2">Outros</option>                        
                      
                        	<option value="3">CTe Redespachado</option>                        
                      
                    </select></td>
					
                    <td class="texto" nowrap="" style="width: 98%;">
                        <span id="td_nfe">Enviar Arquivo:
                        <input name="CONTEUDO" tabindex="247" id="CONTEUDO" onchange="document.forms[0].ARQUIVO.value = document.forms[0].CONTEUDO.value;document.forms[0].BUSCA_POR_CHAVE.value = 0;f_busca_dados_nfe();" type="file" display="NFE / XML" secao="NFE">&nbsp;&nbsp;
                        
						
						
						
						<button tabindex="248" class="botao" id="btn_busca_nfe" onclick="document.forms[0].BUSCA_POR_CHAVE.value = 0;f_localizar_nfe();">
                        	<img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif">&nbsp;Localizar NFE
                        </button>
                        </span>
                    </td>
                </tr>
                <tr style="display: none;">
                	<td class="texto" nowrap="" valign="top">
                       Pedido / Shipment Viagem:
                    </td>
                    <td class="texto" nowrap="" valign="top" colspan="2"> 
                       <table>
							<tbody><tr>
								<td rowspan="2">
                       <textarea name="PEDIDO_SHIPMENT" tabindex="249" id="PEDIDO_SHIPMENT" style="width: 500px; height: 45px; resize: none;" onkeypress="if (this.value.length >= 160) return false;" onblur="if (this.value.length > 160) this.value = this.value.substr(0, 160);" cols="60" obrigatorio="0" row="4" size="160"></textarea>
                       <input name="PEDIDO_SHIPMENT_SOLICITACAO" tabindex="250" id="PEDIDO_SHIPMENT_SOLICITACAO" type="hidden" size="160" maxlength="160" value="0014693539" obrigatorio="0">&nbsp;
								</td>
								<td>
			                       <button tabindex="251" class="botao" id="btn_pedido_shipment" style="width: 350px;" onclick="f_replica_pedido_shipment(1)" type="button">
                          <img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/aplicar.gif">&nbsp;
                          Aplicar a todos os Documentos
                       </button>
                    </td>
                </tr>
							<tr>
								<td>
			                       <button tabindex="252" class="botao" id="btn_pedido_shipment_sem_preenchimento" style="width: 350px;" onclick="f_replica_pedido_shipment()" type="button">
			                          <img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/aplicar.gif">&nbsp;
			                          Aplicar a todos os Documentos sem preenchimento
			                       </button>
								</td>
							</tr>
						</tbody></table>
                    </td>
                </tr>
            </tbody></table>            
        </td>
    </tr>
</tbody></table>
<table width="100%" disabled="" class="texto" id="tb_nota_fiscal" style="display: none;" border="0" cellspacing="1" cellpadding="3"><!--DWLayoutTable-->
   <tbody><tr>
     <td height="1" nowrap="" style="padding: 0px;" colspan="4"><fieldset tabindex="253"><legend>Nota Fiscal</legend><table width="100%" border="0" cellspacing="1" cellpadding="3">
   <tbody><tr>
      <td width="1%" height="1" class="texto" nowrap="">Nº Nota:
	    <input name="NOTAS" tabindex="254" id="NOTAS" type="hidden" value="undefined">
        <input name="ARQUIVO" tabindex="255" id="ARQUIVO" type="hidden" value="" sempre_ativo="1" display="NFE / XML DA NFE" secao="NFE">
        <input name="COD_MODELO" tabindex="256" id="COD_MODELO" type="hidden" value=""></td>
      <td class="texto"><input name="NOTA_NUMERO" tabindex="257" class="requerido_form" id="NOTA_NUMERO" onkeypress="return f_formata(this,event,'000000000000')" type="text" size="15" maxlength="10" display="NOTAS FISCAIS / NUM NOTA" obrigatorio="1" tipo="numerico" secao="NOTAS_FISCAIS"></td>
      <td class="texto"><nobr>Emissão: </nobr></td>
      <td class="texto"><nobr><input name="NOTA_DATA_EMISSAO" tabindex="258" class="requerido_form" id="NOTA_DATA_EMISSAO" onkeypress="return f_formata(this,event,'00/00/0000')" type="text" size="15" maxlength="10" value="" display="NOTAS FISCAIS / DATA EMISSÃO" obrigatorio="1" tipo="data" secao="NOTAS_FISCAIS">
<button tabindex="259" class="botao-16x16" id="trigger"><img width="16" height="16" align="absmiddle" src="/_imagens/botoes/16x16/calendario.gif"></button>
     </nobr>	  </td>
   </tr>
   
   <tr>
      <td height="1" class="texto" nowrap="">Modelo:</td>
      <td width="1%" class="texto">
	     
		    <input name="NOTA_MODELO" tabindex="260" class="requerido_form" id="NOTA_MODELO" style="width: 40px;" fixo="1" display="NOTAS FISCAIS / MODELO" obrigatorio="1" secao="NOTAS_FISCAIS">
		 
	  </td>
      <td width="1%" class="texto">Série:<nobr></nobr></td>
      <td width="99%" class="texto">
      
      <input name="NOTA_SERIE" tabindex="261" class="requerido_form" id="NOTA_SERIE" style="width: 40px;" onkeypress="return f_formata(this,event,'AAA')" onchange="f_busca_sub_serie_nota()" fixo="1" display="NOTAS FISCAIS / SÉRIE" obrigatorio="1" secao="NOTAS_FISCAIS">
        Sub-série:
        <input name="NOTA_SUB_SERIE" tabindex="262" class="requerido_form" id="NOTA_SUB_SERIE" style="width: 40px;" onkeypress="return f_formata(this,event,'000')" fixo="1" display="NOTAS FISCAIS / SUB-SÉRIE" obrigatorio="1" secao="NOTAS_FISCAIS">
      </td></tr>
   
   <tr>
     <td height="1" class="texto" nowrap="">Valor da Nota:</td>
     <td class="texto"><input name="NOTA_VALOR" tabindex="263" class="requerido_form" id="NOTA_VALOR" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value);  f_valor_segurado_automatico('NOTA', 1);" type="text" size="15" maxlength="15" display="NOTAS FISCAIS / VALOR" obrigatorio="1" tipo="numerico" secao="NOTAS_FISCAIS"></td>
     <td class="texto"><nobr>Valor Segurado: </nobr> </td>
     <td class="texto"><input name="NOTA_VALOR_SEGURADO" tabindex="264" id="NOTA_VALOR_SEGURADO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" display="NOTAS FISCAIS / VALOR" obrigatorio="0" tipo="numerico" secao="NOTAS_FISCAIS">
     <nobr>CFOP: </nobr>
     <input name="NOTA_CFOP" tabindex="265" class="requerido_form" id="NOTA_CFOP" type="text" size="10" maxlength="4" display="NOTAS FISCAIS / CFOP" obrigatorio="1" secao="NOTAS_FISCAIS"></td>
  </tr>
   <tr>
     <td height="1" class="texto" nowrap="" valign="top">Pedido/Shipment:</td>
     <td class="texto" valign="top" colspan="6"><textarea name="NOTA_ORDEM_COMPRA" tabindex="266" id="NOTA_ORDEM_COMPRA" style="width: 500px; height: 45px; resize: none;" onkeypress="if (this.value.length >= 160) return false;" onblur="if (this.value.length > 160) this.value = this.value.substr(0, 160);" cols="60" readonly="" display="NOTAS FISCAIS / PEDIDO/SHIPMENT" obrigatorio="0" secao="NOTAS_FISCAIS" row="4"></textarea></td>
     </tr>
     </tbody></table></fieldset></td>
   </tr>
   <tr>
     <td height="1" nowrap="" style="padding: 0px;" colspan="4"><fieldset tabindex="267">
     <legend>Mercadoria</legend>
     <table width="100%" border="0" cellspacing="1" cellpadding="3">
              <tbody><tr>
                <td width="8%" class="texto">Volumes:</td>
                <td width="12%" class="texto"><input name="NOTA_QTDE_VOLUME" tabindex="268" class="requerido_form" id="NOTA_QTDE_VOLUME" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_calcula_cubagem('NOTA');" type="text" size="15" maxlength="10" display="NOTAS FISCAIS / QUANTIDADE" obrigatorio="1" tipo="numerico" secao="NOTAS_FISCAIS"></td>
                <td class="texto">Peso:
                  <input name="NOTA_PESO" tabindex="269" class="requerido_form" id="NOTA_PESO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_sanitizar_numero(this); f_calcula_peso_kg('NOTA')" type="text" size="10" maxlength="10" display="NOTAS FISCAIS / PESO" obrigatorio="1" tipo="numerico" secao="NOTAS_FISCAIS">
                  <select name="NOTA_COD_UNIDADE" tabindex="270" class="requerido_form" id="NOTA_COD_UNIDADE" onchange="f_calcula_peso_kg('NOTA')" fixo="1" display="NOTAS FISCAIS / UNIDADE" obrigatorio="1" secao="NOTAS_FISCAIS" manter="1">
	                  <option value="">-- Selecione --</option>
					  
					  <option value="CX 10">Caixa c/ 10</option>
					  
					  <option value="GAL22L">Galão 22 Litros</option>
					  
					  <option value="PAR">Pares</option>
					  
					  <option value="GR">Gramas</option>
					  
					  <option value="MTS">Metros</option>
					  
					  <option value="ML">Mililitros</option>
					  
					  <option value="GAL15L">Galão 15 Litros</option>
					  
					  <option value="GAL25L">Galão 25 Litros</option>
					  
					  <option value="GL10LT">Galão 10l</option>
					  
					  <option value="GL10LTS">Galão 10 Litros</option>
					  
					  <option value="GL20LTS">Galão 20 Litros</option>
					  
					  <option value="GL5LTS">Galão 5 Litros</option>
					  
					  <option value="Kg" selected="">Kilogramas</option>
					  
					  <option value="LT">Litros</option>
					  
					  <option value="M3">metros cubicos</option>
					  
					  <option value="TON">Toneladas</option>
					  
					  <option value="UN">Unidade</option>
					  
					  <option value="CX 100">Cx c/ 100</option>
					  
					  <option value="RL">Rolo</option>
					  
					  <option value="CX">Caixa</option>
					  
					  <option value="PCT">Pacote</option>
					  
                  </select>
                  <input name="NOTA_M3" tabindex="271" id="NOTA_M3" type="hidden" value="0.00" fixo="1">
                  <input name="NOTA_PESO_CUBADO" tabindex="272" id="NOTA_PESO_CUBADO" type="hidden" value="0" fixo="1">
                  <input name="NOTA_PESO_KG_CONVERTIDO" tabindex="273" id="NOTA_PESO_KG_CONVERTIDO" type="hidden" size="10" maxlength="10" value="" display="NOTAS FISCAIS / PESO" obrigatorio="0" tipo="numerico" secao="NOTAS_FISCAIS"></td>
              </tr>
              <tr>
                <td class="texto">Natureza:</td>
                <td class="texto" colspan="2"><input name="NOTA_NUM_NATUREZA" tabindex="274" class="requerido_form" id="NOTA_NUM_NATUREZA" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_natureza('NOTA')" type="text" display="NOTAS FISCAIS / NATUREZA" obrigatorio="1" secao="NOTAS_FISCAIS">
                  <input name="NOTA_NATUREZA" tabindex="275" class="requerido_form" id="NOTA_NATUREZA" style="width: 200px;" type="text" readonly="true" display="NOTAS FISCAIS / NATUREZA" obrigatorio="1" secao="NOTAS_FISCAIS">
                  <button tabindex="276" class="botao-16x16" onclick="NewWindow('localizar_natureza.cfm?num_natureza=NOTA_NUM_NATUREZA&amp;natureza=NOTA_NATUREZA&amp;operacao_id=' + OPERACAO_ID_CTRC.value,'_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button>
                  &nbsp;
                <input name="NOTA_COMPLEMENTO" tabindex="277" id="NOTA_COMPLEMENTO" style="width: 177px;" type="text" display="NOTAS FISCAIS / COMPLEMENTO" secao="NOTAS_FISCAIS"></td>
              </tr>
              <tr>
                <td class="texto">Espécie:</td>
                <td class="texto" colspan="2"><input name="NOTA_NUM_ESPECIE" tabindex="278" class="requerido_form" id="NOTA_NUM_ESPECIE" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_especie('NOTA')" type="text" display="NOTAS FISCAIS / ESPECIE" obrigatorio="1" secao="NOTAS_FISCAIS">
                  <input name="NOTA_ESPECIE" tabindex="279" class="requerido_form" id="NOTA_ESPECIE" style="width: 200px;" type="text" readonly="true" display="NOTAS FISCAIS / ESPECIE" obrigatorio="1" secao="NOTAS_FISCAIS">
                  <button tabindex="280" class="botao-16x16" onclick="NewWindow('/_consultas/localizar_especie.cfm?num_ESPECIE=NOTA_NUM_ESPECIE&amp;ESPECIE=NOTA_ESPECIE','_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button></td>
              </tr>
              <tr>
                <td class="texto">Altura:</td>
                <td class="texto" colspan="2"><input name="NOTA_ALTURA" tabindex="281" id="NOTA_ALTURA" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('NOTA');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / ALTURA" obrigatorio="0" tipo="numerico" secao="NOTAS_FISCAIS">
                  Comprimento:
                    <input name="NOTA_COMPRIMENTO" tabindex="282" id="NOTA_COMPRIMENTO" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('NOTA');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / COMPRIMENTO" obrigatorio="0" tipo="numerico" secao="NOTAS_FISCAIS">
                    Largura:
                    <input name="NOTA_LARGURA" tabindex="283" id="NOTA_LARGURA" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('NOTA');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / LARGURA" obrigatorio="0" tipo="numerico" secao="NOTAS_FISCAIS">
              </tr>
              <tr>
              	<td class="texto">Cubagem sugerida:</td>
                <td class="texto" colspan="2"><input name="NOTA_CUBAGEM_SUGERIDA" tabindex="284" id="NOTA_CUBAGEM_SUGERIDA" onkeypress="return f_formata_numero_decimal(this,event);" type="text" size="15" maxlength="10" readonly="true" fixo="1" display="NOTA FISCAL / CUBAGEM SUGERIDA" obrigatorio="0" tipo="numerico" secao="NOTAS_FISCAIS">
                Cubagem total:
                <input name="NOTA_CUBAGEM" tabindex="285" id="NOTA_CUBAGEM" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_peso_cobrado('NOTA');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / CUBAGEM" obrigatorio="0" tipo="numerico" secao="NOTAS_FISCAIS">
                </td>
              </tr>
              <tr>
                <td class="texto"><nobr>Peso Cobrado: </nobr> </td>
                <td class="texto" colspan="2"><input name="NOTA_PESO_COBRADO" tabindex="286" class="requerido_form" id="NOTA_PESO_COBRADO" style="width: 90px;" onkeypress="return f_formata_numero_decimal(this,event)" type="text" display="NOTAS FISCAIS / PESO COBRADO" obrigatorio="1" secao="NOTAS_FISCAIS">
                  Kg</td>
              </tr>
      </tbody></table></fieldset></td>
   </tr>
   <tr>
      <td colspan="4">
		
<script src="/_scripts/tablesort.js"></script>
<script language="javascript1.2">
var DOUBLE_QUOTES = new RegExp( '"([^"]*)"', 'g' );


function f_ordenar_NOTAS_FISCAIS(campo, desc, tipo) {
//	try {
		if(!tipo) 
			tipo = 'caseinsensitivestring';
		v_tb = document.getElementById('tb_lista_NOTAS_FISCAIS');
		v_rows2 = new Array();
		for(var i=0;i<v_tb.rows.length;i++) 
			v_rows2.push(v_tb.rows[i]);
		v_rows2.sort(function(a,b) {
				v_id_a = a.id.replace('tr_lista_NOTAS_FISCAIS_','');
				v_id_b = b.id.replace('tr_lista_NOTAS_FISCAIS_','');
				if(tipo == 'number') {
					if( Number(document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_a).value) < Number(document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_b).value)) 
						return desc ? +1 : -1;
					if( Number(document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_a).value) > Number(document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_b).value)) 
						return desc ? -1 : +1;
				} else if(tipo == 'caseinsensitivestring') {
					if(document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_a).value < document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_b).value) 
						return desc ? +1 : -1;
					if(document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_a).value > document.getElementById(campo+'_NOTAS_FISCAIS_'+v_id_b).value) 
						return desc ? -1 : +1;
				}
				return 0;
			});
		for(var i=0;i<v_rows2.length;i++) {
			v_tb.appendChild(v_rows2[i]);
		}
//	} catch(e) {}
}

function f_incluir_NOTAS_FISCAIS() {
	with(document.forms[0]) {
		
		f_cancelar_NOTAS_FISCAIS();
	}
}

function f_excluir_NOTAS_FISCAIS(v_nro, v_nao_mostra_confirmar) {
	if(v_nro == -1) {
		return;
	}
	if(!v_nao_mostra_confirmar) {
		if(!confirm('Clique OK para confirmar a exclusão do registro!')) {
			return;
		}
	}
	with (document.forms[0]) {
		
			lista_deleted_NOTAS_FISCAIS.value = lista_deleted_NOTAS_FISCAIS.value+','+document.getElementById('NOTA_NUMERO_NOTAS_FISCAIS_'+v_nro).value;
		
	}
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');		
	for(var i=0;i<tbody.rows.length;i++) {
		if(tbody.rows[i].id == 'tr_lista_NOTAS_FISCAIS_'+v_nro) {
			tbody.deleteRow(i);
			f_cancelar_NOTAS_FISCAIS();
			break;
		}
	}
		
	
	f_cancelar_NOTAS_FISCAIS();
	f_on_salva_lista_NOTAS_FISCAIS();
	f_on_excluir_NOTAS_FISCAIS();
}
function f_limpar_NOTAS_FISCAIS() {
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');	
	while (tbody.rows.length > 0) {
		tbody.deleteRow(0);
	}
		
	
	document.forms[0].lista_selected_NOTAS_FISCAIS.value = -1;
}
var lista_count_NOTAS_FISCAIS = 0;


function f_testa_existencia_NOTAS_FISCAIS(chave, linha_atual, selectable) {
	var listagem = f_listagem_NOTAS_FISCAIS();
	for(var i=0;i<listagem.length;i++) {
		var items = chave.split('|');
		var igual = true;
		for(var j=0;j<items.length;j++) {
			if(eval('listagem['+i+'].'+items[j]) != eval('document.forms[0].'+items[j]+'.value') || listagem[i].id == linha_atual) {
					igual = false;
			}
		}
		if (igual) {
			return true;
		}
	}
}
function f_salvar_NOTAS_FISCAIS() {
	
	if (!f_before_salvar_NOTAS_FISCAIS()) {
	   return;
	}	
	if(f_verifica_form(document.forms[0], 'NOTAS_FISCAIS'))	{
		var padrao = true;
		var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');
		for(var i=0;i<tbody.rows.length;i++) {
			var row_id = tbody.rows[i].id.replace('tr_lista_NOTAS_FISCAIS_', '');
			if(document.getElementById('lista_padrao_NOTAS_FISCAIS_'+row_id).style.display == '') {
				padrao = false;
			}
		}
		with(document.forms[0]) {
			
			if(lista_selected_NOTAS_FISCAIS.value == -1) {
				var v_tr = document.createElement('TR');
				v_tr.id = 'tr_lista_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
				var temp_count = lista_count_NOTAS_FISCAIS;
				v_tr.style.cursor = 'pointer';
				v_tr.onclick = function() {
					f_seleciona_NOTAS_FISCAIS(temp_count);
				}
				var v_td = document.createElement('TD');
				var v_dv1 = document.createElement('div');
				v_td.appendChild(v_dv1);
				v_td.className = 'linha_1';
				lista_inputs = '<input type="hidden" name="PADRAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="PADRAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((padrao)?1:0)+'">';
				
				if (NF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
				} else if (NF_CONHECIMENTO_ID.type == 'file') {
					v_campo_file = document.forms[0].NF_CONHECIMENTO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NF_CONHECIMENTO_ID';
					v_file_input.id = 'NF_CONHECIMENTO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NF_CONHECIMENTO_ID.value;
				
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NUMERO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NUMERO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_NUMERO.checked)?"1":"0")+'">';
				} else if (NOTA_NUMERO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_NUMERO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_NUMERO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_NUMERO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_NUMERO';
					v_file_input.id = 'NOTA_NUMERO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_NUMERO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_NUMERO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NUMERO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_SERIE.checked)?"1":"0")+'">';
				} else if (NOTA_SERIE.type == 'file') {
					v_campo_file = document.forms[0].NOTA_SERIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_SERIE';
					v_file_input.id = 'NOTA_SERIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_SERIE.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_SUB_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_SUB_SERIE.checked)?"1":"0")+'">';
				} else if (NOTA_SUB_SERIE.type == 'file') {
					v_campo_file = document.forms[0].NOTA_SUB_SERIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_SUB_SERIE';
					v_file_input.id = 'NOTA_SUB_SERIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_SUB_SERIE.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_MODELO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_MODELO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_MODELO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_MODELO.checked)?"1":"0")+'">';
				} else if (NOTA_MODELO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_MODELO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_MODELO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_MODELO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_MODELO';
					v_file_input.id = 'NOTA_MODELO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_MODELO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_MODELO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_MODELO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_DATA_EMISSAO.checked)?"1":"0")+'">';
				} else if (NOTA_DATA_EMISSAO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_DATA_EMISSAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_DATA_EMISSAO';
					v_file_input.id = 'NOTA_DATA_EMISSAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_DATA_EMISSAO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_VALOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_VALOR_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_VALOR.checked)?"1":"0")+'">';
				} else if (NOTA_VALOR.type == 'file') {
					v_campo_file = document.forms[0].NOTA_VALOR;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_VALOR_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_VALOR_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_VALOR';
					v_file_input.id = 'NOTA_VALOR';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_VALOR.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_VALOR_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_VALOR_SEGURADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_VALOR_SEGURADO.checked)?"1":"0")+'">';
				} else if (NOTA_VALOR_SEGURADO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_VALOR_SEGURADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_VALOR_SEGURADO';
					v_file_input.id = 'NOTA_VALOR_SEGURADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_VALOR_SEGURADO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_ORDEM_COMPRA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_ORDEM_COMPRA.checked)?"1":"0")+'">';
				} else if (NOTA_ORDEM_COMPRA.type == 'file') {
					v_campo_file = document.forms[0].NOTA_ORDEM_COMPRA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_ORDEM_COMPRA';
					v_file_input.id = 'NOTA_ORDEM_COMPRA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_ORDEM_COMPRA.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_QTDE_VOLUME.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_QTDE_VOLUME.checked)?"1":"0")+'">';
				} else if (NOTA_QTDE_VOLUME.type == 'file') {
					v_campo_file = document.forms[0].NOTA_QTDE_VOLUME;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_QTDE_VOLUME';
					v_file_input.id = 'NOTA_QTDE_VOLUME';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_QTDE_VOLUME.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_PESO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_PESO.checked)?"1":"0")+'">';
				} else if (NOTA_PESO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_PESO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_PESO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_PESO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_PESO';
					v_file_input.id = 'NOTA_PESO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_PESO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_PESO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_COD_UNIDADE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_COD_UNIDADE.checked)?"1":"0")+'">';
				} else if (NOTA_COD_UNIDADE.type == 'file') {
					v_campo_file = document.forms[0].NOTA_COD_UNIDADE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_COD_UNIDADE';
					v_file_input.id = 'NOTA_COD_UNIDADE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_COD_UNIDADE.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_M3.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_M3_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_M3_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_M3.checked)?"1":"0")+'">';
				} else if (NOTA_M3.type == 'file') {
					v_campo_file = document.forms[0].NOTA_M3;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_M3_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_M3_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_M3';
					v_file_input.id = 'NOTA_M3';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_M3.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_M3_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_M3_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_PESO_CUBADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_PESO_CUBADO.checked)?"1":"0")+'">';
				} else if (NOTA_PESO_CUBADO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_PESO_CUBADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_PESO_CUBADO';
					v_file_input.id = 'NOTA_PESO_CUBADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_PESO_CUBADO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_PESO_KG_CONVERTIDO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_PESO_KG_CONVERTIDO.checked)?"1":"0")+'">';
				} else if (NOTA_PESO_KG_CONVERTIDO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_PESO_KG_CONVERTIDO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_PESO_KG_CONVERTIDO';
					v_file_input.id = 'NOTA_PESO_KG_CONVERTIDO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_PESO_KG_CONVERTIDO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_NUM_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_NUM_NATUREZA.checked)?"1":"0")+'">';
				} else if (NOTA_NUM_NATUREZA.type == 'file') {
					v_campo_file = document.forms[0].NOTA_NUM_NATUREZA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_NUM_NATUREZA';
					v_file_input.id = 'NOTA_NUM_NATUREZA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_NUM_NATUREZA.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_NATUREZA.checked)?"1":"0")+'">';
				} else if (NOTA_NATUREZA.type == 'file') {
					v_campo_file = document.forms[0].NOTA_NATUREZA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_NATUREZA';
					v_file_input.id = 'NOTA_NATUREZA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_NATUREZA.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_COMPLEMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_COMPLEMENTO.checked)?"1":"0")+'">';
				} else if (NOTA_COMPLEMENTO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_COMPLEMENTO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_COMPLEMENTO';
					v_file_input.id = 'NOTA_COMPLEMENTO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_COMPLEMENTO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_NUM_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_NUM_ESPECIE.checked)?"1":"0")+'">';
				} else if (NOTA_NUM_ESPECIE.type == 'file') {
					v_campo_file = document.forms[0].NOTA_NUM_ESPECIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_NUM_ESPECIE';
					v_file_input.id = 'NOTA_NUM_ESPECIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_NUM_ESPECIE.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_ESPECIE.checked)?"1":"0")+'">';
				} else if (NOTA_ESPECIE.type == 'file') {
					v_campo_file = document.forms[0].NOTA_ESPECIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_ESPECIE';
					v_file_input.id = 'NOTA_ESPECIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_ESPECIE.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_ALTURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_ALTURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_ALTURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_ALTURA.checked)?"1":"0")+'">';
				} else if (NOTA_ALTURA.type == 'file') {
					v_campo_file = document.forms[0].NOTA_ALTURA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_ALTURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_ALTURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_ALTURA';
					v_file_input.id = 'NOTA_ALTURA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_ALTURA.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_ALTURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_ALTURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_LARGURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_LARGURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_LARGURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_LARGURA.checked)?"1":"0")+'">';
				} else if (NOTA_LARGURA.type == 'file') {
					v_campo_file = document.forms[0].NOTA_LARGURA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_LARGURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_LARGURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_LARGURA';
					v_file_input.id = 'NOTA_LARGURA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_LARGURA.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_LARGURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_LARGURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_COMPRIMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_COMPRIMENTO.checked)?"1":"0")+'">';
				} else if (NOTA_COMPRIMENTO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_COMPRIMENTO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_COMPRIMENTO';
					v_file_input.id = 'NOTA_COMPRIMENTO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_COMPRIMENTO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_CUBAGEM.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_CUBAGEM.checked)?"1":"0")+'">';
				} else if (NOTA_CUBAGEM.type == 'file') {
					v_campo_file = document.forms[0].NOTA_CUBAGEM;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_CUBAGEM';
					v_file_input.id = 'NOTA_CUBAGEM';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_CUBAGEM.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_CUBAGEM_SUGERIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_CUBAGEM_SUGERIDA.checked)?"1":"0")+'">';
				} else if (NOTA_CUBAGEM_SUGERIDA.type == 'file') {
					v_campo_file = document.forms[0].NOTA_CUBAGEM_SUGERIDA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_CUBAGEM_SUGERIDA';
					v_file_input.id = 'NOTA_CUBAGEM_SUGERIDA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_CUBAGEM_SUGERIDA.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_PESO_COBRADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_PESO_COBRADO.checked)?"1":"0")+'">';
				} else if (NOTA_PESO_COBRADO.type == 'file') {
					v_campo_file = document.forms[0].NOTA_PESO_COBRADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_PESO_COBRADO';
					v_file_input.id = 'NOTA_PESO_COBRADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_PESO_COBRADO.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOTA_CFOP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_CFOP_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_CFOP_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" value="'+((NOTA_CFOP.checked)?"1":"0")+'">';
				} else if (NOTA_CFOP.type == 'file') {
					v_campo_file = document.forms[0].NOTA_CFOP;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOTA_CFOP_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_campo_file.name = 'NOTA_CFOP_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS;
					v_file_input.name = 'NOTA_CFOP';
					v_file_input.id = 'NOTA_CFOP';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOTA_CFOP.value;
				
					lista_inputs += '<input type="hidden" name="NOTA_CFOP_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" id="NOTA_CFOP_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'">';
				}
//				v_td.appendChild(v_input)
				
				v_dv1.innerHTML = '<img id="lista_padrao_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				v_td.width = 16;
				
				v_td.style.display = 'none';
				
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = '';
				
				v_td.innerHTML = ''+NOTA_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = '';
				
				v_td.innerHTML = ''+NOTA_MODELO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = '';
				
				v_td.innerHTML = ''+NOTA_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = '';
				
				v_td.innerHTML = ''+NOTA_SUB_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = '';
				
				v_td.innerHTML = ''+NOTA_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = '';
				
				v_td.innerHTML = ''+NOTA_VALOR.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = '';
				
				v_td.innerHTML = ''+NOTA_PESO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				tbody.appendChild(v_tr);
				
				if (NF_CONHECIMENTO_ID.type != 'checkbox' && NF_CONHECIMENTO_ID.type != 'file') {
					document.getElementById('NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NF_CONHECIMENTO_ID.value;
				}
				
				if (NOTA_NUMERO.type != 'checkbox' && NOTA_NUMERO.type != 'file') {
					document.getElementById('NOTA_NUMERO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_NUMERO.value;
				}
				
				if (NOTA_SERIE.type != 'checkbox' && NOTA_SERIE.type != 'file') {
					document.getElementById('NOTA_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_SERIE.value;
				}
				
				if (NOTA_SUB_SERIE.type != 'checkbox' && NOTA_SUB_SERIE.type != 'file') {
					document.getElementById('NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_SUB_SERIE.value;
				}
				
				if (NOTA_MODELO.type != 'checkbox' && NOTA_MODELO.type != 'file') {
					document.getElementById('NOTA_MODELO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_MODELO.value;
				}
				
				if (NOTA_DATA_EMISSAO.type != 'checkbox' && NOTA_DATA_EMISSAO.type != 'file') {
					document.getElementById('NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_DATA_EMISSAO.value;
				}
				
				if (NOTA_VALOR.type != 'checkbox' && NOTA_VALOR.type != 'file') {
					document.getElementById('NOTA_VALOR_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_VALOR.value;
				}
				
				if (NOTA_VALOR_SEGURADO.type != 'checkbox' && NOTA_VALOR_SEGURADO.type != 'file') {
					document.getElementById('NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_VALOR_SEGURADO.value;
				}
				
				if (NOTA_ORDEM_COMPRA.type != 'checkbox' && NOTA_ORDEM_COMPRA.type != 'file') {
					document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_ORDEM_COMPRA.value;
				}
				
				if (NOTA_QTDE_VOLUME.type != 'checkbox' && NOTA_QTDE_VOLUME.type != 'file') {
					document.getElementById('NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_QTDE_VOLUME.value;
				}
				
				if (NOTA_PESO.type != 'checkbox' && NOTA_PESO.type != 'file') {
					document.getElementById('NOTA_PESO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_PESO.value;
				}
				
				if (NOTA_COD_UNIDADE.type != 'checkbox' && NOTA_COD_UNIDADE.type != 'file') {
					document.getElementById('NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_COD_UNIDADE.value;
				}
				
				if (NOTA_M3.type != 'checkbox' && NOTA_M3.type != 'file') {
					document.getElementById('NOTA_M3_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_M3.value;
				}
				
				if (NOTA_PESO_CUBADO.type != 'checkbox' && NOTA_PESO_CUBADO.type != 'file') {
					document.getElementById('NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_PESO_CUBADO.value;
				}
				
				if (NOTA_PESO_KG_CONVERTIDO.type != 'checkbox' && NOTA_PESO_KG_CONVERTIDO.type != 'file') {
					document.getElementById('NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_PESO_KG_CONVERTIDO.value;
				}
				
				if (NOTA_NUM_NATUREZA.type != 'checkbox' && NOTA_NUM_NATUREZA.type != 'file') {
					document.getElementById('NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_NUM_NATUREZA.value;
				}
				
				if (NOTA_NATUREZA.type != 'checkbox' && NOTA_NATUREZA.type != 'file') {
					document.getElementById('NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_NATUREZA.value;
				}
				
				if (NOTA_COMPLEMENTO.type != 'checkbox' && NOTA_COMPLEMENTO.type != 'file') {
					document.getElementById('NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_COMPLEMENTO.value;
				}
				
				if (NOTA_NUM_ESPECIE.type != 'checkbox' && NOTA_NUM_ESPECIE.type != 'file') {
					document.getElementById('NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_NUM_ESPECIE.value;
				}
				
				if (NOTA_ESPECIE.type != 'checkbox' && NOTA_ESPECIE.type != 'file') {
					document.getElementById('NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_ESPECIE.value;
				}
				
				if (NOTA_ALTURA.type != 'checkbox' && NOTA_ALTURA.type != 'file') {
					document.getElementById('NOTA_ALTURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_ALTURA.value;
				}
				
				if (NOTA_LARGURA.type != 'checkbox' && NOTA_LARGURA.type != 'file') {
					document.getElementById('NOTA_LARGURA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_LARGURA.value;
				}
				
				if (NOTA_COMPRIMENTO.type != 'checkbox' && NOTA_COMPRIMENTO.type != 'file') {
					document.getElementById('NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_COMPRIMENTO.value;
				}
				
				if (NOTA_CUBAGEM.type != 'checkbox' && NOTA_CUBAGEM.type != 'file') {
					document.getElementById('NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_CUBAGEM.value;
				}
				
				if (NOTA_CUBAGEM_SUGERIDA.type != 'checkbox' && NOTA_CUBAGEM_SUGERIDA.type != 'file') {
					document.getElementById('NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_CUBAGEM_SUGERIDA.value;
				}
				
				if (NOTA_PESO_COBRADO.type != 'checkbox' && NOTA_PESO_COBRADO.type != 'file') {
					document.getElementById('NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_PESO_COBRADO.value;
				}
				
				if (NOTA_CFOP.type != 'checkbox' && NOTA_CFOP.type != 'file') {
					document.getElementById('NOTA_CFOP_NOTAS_FISCAIS_'+lista_count_NOTAS_FISCAIS).value = NOTA_CFOP.value;
				}
				

				lista_count_NOTAS_FISCAIS++;
				f_atualiza_campos_escravos_NOTAS_FISCAIS();
				f_incluir_NOTAS_FISCAIS();
			} else {
				var v_tr = document.getElementById('tr_lista_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value);
				padrao = (document.getElementById('PADRAO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value == 1);
				lista_inputs = '<input type="hidden" name="PADRAO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((padrao)?1:0)+'">';
				
				if (NF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
					document.getElementById('NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NF_CONHECIMENTO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NF_CONHECIMENTO_ID.value+'">';
					document.getElementById('NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NF_CONHECIMENTO_ID.value;
				}
				
				if (NOTA_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NUMERO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_NUMERO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_NUMERO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_NUMERO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_NUMERO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_NUMERO.value+'">';
					document.getElementById('NOTA_NUMERO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_NUMERO.value;
				}
				
				if (NOTA_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_SERIE.checked)?"1":"0")+'">';
					document.getElementById('NOTA_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_SERIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_SERIE.value+'">';
					document.getElementById('NOTA_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_SERIE.value;
				}
				
				if (NOTA_SUB_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_SUB_SERIE.checked)?"1":"0")+'">';
					document.getElementById('NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_SUB_SERIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_SUB_SERIE.value+'">';
					document.getElementById('NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_SUB_SERIE.value;
				}
				
				if (NOTA_MODELO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_MODELO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_MODELO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_MODELO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_MODELO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_MODELO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_MODELO.value+'">';
					document.getElementById('NOTA_MODELO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_MODELO.value;
				}
				
				if (NOTA_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_DATA_EMISSAO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_DATA_EMISSAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_DATA_EMISSAO.value+'">';
					document.getElementById('NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_DATA_EMISSAO.value;
				}
				
				if (NOTA_VALOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_VALOR.checked)?"1":"0")+'">';
					document.getElementById('NOTA_VALOR_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_VALOR.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_VALOR.value+'">';
					document.getElementById('NOTA_VALOR_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_VALOR.value;
				}
				
				if (NOTA_VALOR_SEGURADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_VALOR_SEGURADO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_VALOR_SEGURADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_VALOR_SEGURADO.value+'">';
					document.getElementById('NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_VALOR_SEGURADO.value;
				}
				
				if (NOTA_ORDEM_COMPRA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_ORDEM_COMPRA.checked)?"1":"0")+'">';
					document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_ORDEM_COMPRA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_ORDEM_COMPRA.value+'">';
					document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_ORDEM_COMPRA.value;
				}
				
				if (NOTA_QTDE_VOLUME.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_QTDE_VOLUME.checked)?"1":"0")+'">';
					document.getElementById('NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_QTDE_VOLUME.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_QTDE_VOLUME.value+'">';
					document.getElementById('NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_QTDE_VOLUME.value;
				}
				
				if (NOTA_PESO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_PESO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_PESO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_PESO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_PESO.value+'">';
					document.getElementById('NOTA_PESO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_PESO.value;
				}
				
				if (NOTA_COD_UNIDADE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_COD_UNIDADE.checked)?"1":"0")+'">';
					document.getElementById('NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_COD_UNIDADE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_COD_UNIDADE.value+'">';
					document.getElementById('NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_COD_UNIDADE.value;
				}
				
				if (NOTA_M3.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_M3_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_M3.checked)?"1":"0")+'">';
					document.getElementById('NOTA_M3_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_M3.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_M3_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_M3.value+'">';
					document.getElementById('NOTA_M3_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_M3.value;
				}
				
				if (NOTA_PESO_CUBADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_PESO_CUBADO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_PESO_CUBADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_PESO_CUBADO.value+'">';
					document.getElementById('NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_PESO_CUBADO.value;
				}
				
				if (NOTA_PESO_KG_CONVERTIDO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_PESO_KG_CONVERTIDO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_PESO_KG_CONVERTIDO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_PESO_KG_CONVERTIDO.value+'">';
					document.getElementById('NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_PESO_KG_CONVERTIDO.value;
				}
				
				if (NOTA_NUM_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_NUM_NATUREZA.checked)?"1":"0")+'">';
					document.getElementById('NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_NUM_NATUREZA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_NUM_NATUREZA.value+'">';
					document.getElementById('NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_NUM_NATUREZA.value;
				}
				
				if (NOTA_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_NATUREZA.checked)?"1":"0")+'">';
					document.getElementById('NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_NATUREZA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_NATUREZA.value+'">';
					document.getElementById('NOTA_NATUREZA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_NATUREZA.value;
				}
				
				if (NOTA_COMPLEMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_COMPLEMENTO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_COMPLEMENTO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_COMPLEMENTO.value+'">';
					document.getElementById('NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_COMPLEMENTO.value;
				}
				
				if (NOTA_NUM_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_NUM_ESPECIE.checked)?"1":"0")+'">';
					document.getElementById('NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_NUM_ESPECIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_NUM_ESPECIE.value+'">';
					document.getElementById('NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_NUM_ESPECIE.value;
				}
				
				if (NOTA_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_ESPECIE.checked)?"1":"0")+'">';
					document.getElementById('NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_ESPECIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_ESPECIE.value+'">';
					document.getElementById('NOTA_ESPECIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_ESPECIE.value;
				}
				
				if (NOTA_ALTURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_ALTURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_ALTURA.checked)?"1":"0")+'">';
					document.getElementById('NOTA_ALTURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_ALTURA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_ALTURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_ALTURA.value+'">';
					document.getElementById('NOTA_ALTURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_ALTURA.value;
				}
				
				if (NOTA_LARGURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_LARGURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_LARGURA.checked)?"1":"0")+'">';
					document.getElementById('NOTA_LARGURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_LARGURA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_LARGURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_LARGURA.value+'">';
					document.getElementById('NOTA_LARGURA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_LARGURA.value;
				}
				
				if (NOTA_COMPRIMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_COMPRIMENTO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_COMPRIMENTO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_COMPRIMENTO.value+'">';
					document.getElementById('NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_COMPRIMENTO.value;
				}
				
				if (NOTA_CUBAGEM.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_CUBAGEM.checked)?"1":"0")+'">';
					document.getElementById('NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_CUBAGEM.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_CUBAGEM.value+'">';
					document.getElementById('NOTA_CUBAGEM_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_CUBAGEM.value;
				}
				
				if (NOTA_CUBAGEM_SUGERIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_CUBAGEM_SUGERIDA.checked)?"1":"0")+'">';
					document.getElementById('NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_CUBAGEM_SUGERIDA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_CUBAGEM_SUGERIDA.value+'">';
					document.getElementById('NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_CUBAGEM_SUGERIDA.value;
				}
				
				if (NOTA_PESO_COBRADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_PESO_COBRADO.checked)?"1":"0")+'">';
					document.getElementById('NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_PESO_COBRADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_PESO_COBRADO.value+'">';
					document.getElementById('NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_PESO_COBRADO.value;
				}
				
				if (NOTA_CFOP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOTA_CFOP_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+((NOTA_CFOP.checked)?"1":"0")+'">';
					document.getElementById('NOTA_CFOP_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = ((NOTA_CFOP.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOTA_CFOP_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" value="'+NOTA_CFOP.value+'">';
					document.getElementById('NOTA_CFOP_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value = NOTA_CFOP.value;
				}
				
//				v_tr.cells[0].innerHTML = '<img id="lista_padrao_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				
					var v_td = v_tr.cells[1];
					v_td.innerHTML = ''+NOTA_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[2];
					v_td.innerHTML = ''+NOTA_MODELO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[3];
					v_td.innerHTML = ''+NOTA_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[4];
					v_td.innerHTML = ''+NOTA_SUB_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[5];
					v_td.innerHTML = ''+NOTA_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[6];
					v_td.innerHTML = ''+NOTA_VALOR.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[7];
					v_td.innerHTML = ''+NOTA_PESO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
								
				f_atualiza_campos_escravos_NOTAS_FISCAIS();
				f_incluir_NOTAS_FISCAIS();
			}
		}
			
		
		f_on_salva_lista_NOTAS_FISCAIS();
	}
}
function f_cancelar_NOTAS_FISCAIS() {
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');		
	for(var i=0;i<tbody.rows.length;i++) {
		for(var j=0;j<tbody.rows[i].cells.length;j++) {
			tbody.rows[i].cells[j].className = 'linha_1';
		}
	}
	with(document.forms[0]) {
	
		

		if(document.getElementById('NF_CONHECIMENTO_ID').getAttribute('type') != 'file') {
		  if (!NF_CONHECIMENTO_ID.getAttribute('manter') || NF_CONHECIMENTO_ID.getAttribute('manter') == 0) {
				if(NF_CONHECIMENTO_ID.type == 'checkbox') {
					NF_CONHECIMENTO_ID.checked = false;
				} else if(NF_CONHECIMENTO_ID.type == 'select-one') {
					NF_CONHECIMENTO_ID.selectedIndex = 0;
				} else {
					NF_CONHECIMENTO_ID.value = '';
				}
				
				try {
					NF_CONHECIMENTO_ID.focus();
				} catch(e) {
				}
				
			}
		}
		

		if(document.getElementById('NOTA_NUMERO').getAttribute('type') != 'file') {
		  if (!NOTA_NUMERO.getAttribute('manter') || NOTA_NUMERO.getAttribute('manter') == 0) {
				if(NOTA_NUMERO.type == 'checkbox') {
					NOTA_NUMERO.checked = false;
				} else if(NOTA_NUMERO.type == 'select-one') {
					NOTA_NUMERO.selectedIndex = 0;
				} else {
					NOTA_NUMERO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_SERIE').getAttribute('type') != 'file') {
		  if (!NOTA_SERIE.getAttribute('manter') || NOTA_SERIE.getAttribute('manter') == 0) {
				if(NOTA_SERIE.type == 'checkbox') {
					NOTA_SERIE.checked = false;
				} else if(NOTA_SERIE.type == 'select-one') {
					NOTA_SERIE.selectedIndex = 0;
				} else {
					NOTA_SERIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_SUB_SERIE').getAttribute('type') != 'file') {
		  if (!NOTA_SUB_SERIE.getAttribute('manter') || NOTA_SUB_SERIE.getAttribute('manter') == 0) {
				if(NOTA_SUB_SERIE.type == 'checkbox') {
					NOTA_SUB_SERIE.checked = false;
				} else if(NOTA_SUB_SERIE.type == 'select-one') {
					NOTA_SUB_SERIE.selectedIndex = 0;
				} else {
					NOTA_SUB_SERIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_MODELO').getAttribute('type') != 'file') {
		  if (!NOTA_MODELO.getAttribute('manter') || NOTA_MODELO.getAttribute('manter') == 0) {
				if(NOTA_MODELO.type == 'checkbox') {
					NOTA_MODELO.checked = false;
				} else if(NOTA_MODELO.type == 'select-one') {
					NOTA_MODELO.selectedIndex = 0;
				} else {
					NOTA_MODELO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_DATA_EMISSAO').getAttribute('type') != 'file') {
		  if (!NOTA_DATA_EMISSAO.getAttribute('manter') || NOTA_DATA_EMISSAO.getAttribute('manter') == 0) {
				if(NOTA_DATA_EMISSAO.type == 'checkbox') {
					NOTA_DATA_EMISSAO.checked = false;
				} else if(NOTA_DATA_EMISSAO.type == 'select-one') {
					NOTA_DATA_EMISSAO.selectedIndex = 0;
				} else {
					NOTA_DATA_EMISSAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_VALOR').getAttribute('type') != 'file') {
		  if (!NOTA_VALOR.getAttribute('manter') || NOTA_VALOR.getAttribute('manter') == 0) {
				if(NOTA_VALOR.type == 'checkbox') {
					NOTA_VALOR.checked = false;
				} else if(NOTA_VALOR.type == 'select-one') {
					NOTA_VALOR.selectedIndex = 0;
				} else {
					NOTA_VALOR.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_VALOR_SEGURADO').getAttribute('type') != 'file') {
		  if (!NOTA_VALOR_SEGURADO.getAttribute('manter') || NOTA_VALOR_SEGURADO.getAttribute('manter') == 0) {
				if(NOTA_VALOR_SEGURADO.type == 'checkbox') {
					NOTA_VALOR_SEGURADO.checked = false;
				} else if(NOTA_VALOR_SEGURADO.type == 'select-one') {
					NOTA_VALOR_SEGURADO.selectedIndex = 0;
				} else {
					NOTA_VALOR_SEGURADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_ORDEM_COMPRA').getAttribute('type') != 'file') {
		  if (!NOTA_ORDEM_COMPRA.getAttribute('manter') || NOTA_ORDEM_COMPRA.getAttribute('manter') == 0) {
				if(NOTA_ORDEM_COMPRA.type == 'checkbox') {
					NOTA_ORDEM_COMPRA.checked = false;
				} else if(NOTA_ORDEM_COMPRA.type == 'select-one') {
					NOTA_ORDEM_COMPRA.selectedIndex = 0;
				} else {
					NOTA_ORDEM_COMPRA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_QTDE_VOLUME').getAttribute('type') != 'file') {
		  if (!NOTA_QTDE_VOLUME.getAttribute('manter') || NOTA_QTDE_VOLUME.getAttribute('manter') == 0) {
				if(NOTA_QTDE_VOLUME.type == 'checkbox') {
					NOTA_QTDE_VOLUME.checked = false;
				} else if(NOTA_QTDE_VOLUME.type == 'select-one') {
					NOTA_QTDE_VOLUME.selectedIndex = 0;
				} else {
					NOTA_QTDE_VOLUME.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_PESO').getAttribute('type') != 'file') {
		  if (!NOTA_PESO.getAttribute('manter') || NOTA_PESO.getAttribute('manter') == 0) {
				if(NOTA_PESO.type == 'checkbox') {
					NOTA_PESO.checked = false;
				} else if(NOTA_PESO.type == 'select-one') {
					NOTA_PESO.selectedIndex = 0;
				} else {
					NOTA_PESO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_COD_UNIDADE').getAttribute('type') != 'file') {
		  if (!NOTA_COD_UNIDADE.getAttribute('manter') || NOTA_COD_UNIDADE.getAttribute('manter') == 0) {
				if(NOTA_COD_UNIDADE.type == 'checkbox') {
					NOTA_COD_UNIDADE.checked = false;
				} else if(NOTA_COD_UNIDADE.type == 'select-one') {
					NOTA_COD_UNIDADE.selectedIndex = 0;
				} else {
					NOTA_COD_UNIDADE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_M3').getAttribute('type') != 'file') {
		  if (!NOTA_M3.getAttribute('manter') || NOTA_M3.getAttribute('manter') == 0) {
				if(NOTA_M3.type == 'checkbox') {
					NOTA_M3.checked = false;
				} else if(NOTA_M3.type == 'select-one') {
					NOTA_M3.selectedIndex = 0;
				} else {
					NOTA_M3.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_PESO_CUBADO').getAttribute('type') != 'file') {
		  if (!NOTA_PESO_CUBADO.getAttribute('manter') || NOTA_PESO_CUBADO.getAttribute('manter') == 0) {
				if(NOTA_PESO_CUBADO.type == 'checkbox') {
					NOTA_PESO_CUBADO.checked = false;
				} else if(NOTA_PESO_CUBADO.type == 'select-one') {
					NOTA_PESO_CUBADO.selectedIndex = 0;
				} else {
					NOTA_PESO_CUBADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_PESO_KG_CONVERTIDO').getAttribute('type') != 'file') {
		  if (!NOTA_PESO_KG_CONVERTIDO.getAttribute('manter') || NOTA_PESO_KG_CONVERTIDO.getAttribute('manter') == 0) {
				if(NOTA_PESO_KG_CONVERTIDO.type == 'checkbox') {
					NOTA_PESO_KG_CONVERTIDO.checked = false;
				} else if(NOTA_PESO_KG_CONVERTIDO.type == 'select-one') {
					NOTA_PESO_KG_CONVERTIDO.selectedIndex = 0;
				} else {
					NOTA_PESO_KG_CONVERTIDO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_NUM_NATUREZA').getAttribute('type') != 'file') {
		  if (!NOTA_NUM_NATUREZA.getAttribute('manter') || NOTA_NUM_NATUREZA.getAttribute('manter') == 0) {
				if(NOTA_NUM_NATUREZA.type == 'checkbox') {
					NOTA_NUM_NATUREZA.checked = false;
				} else if(NOTA_NUM_NATUREZA.type == 'select-one') {
					NOTA_NUM_NATUREZA.selectedIndex = 0;
				} else {
					NOTA_NUM_NATUREZA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_NATUREZA').getAttribute('type') != 'file') {
		  if (!NOTA_NATUREZA.getAttribute('manter') || NOTA_NATUREZA.getAttribute('manter') == 0) {
				if(NOTA_NATUREZA.type == 'checkbox') {
					NOTA_NATUREZA.checked = false;
				} else if(NOTA_NATUREZA.type == 'select-one') {
					NOTA_NATUREZA.selectedIndex = 0;
				} else {
					NOTA_NATUREZA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_COMPLEMENTO').getAttribute('type') != 'file') {
		  if (!NOTA_COMPLEMENTO.getAttribute('manter') || NOTA_COMPLEMENTO.getAttribute('manter') == 0) {
				if(NOTA_COMPLEMENTO.type == 'checkbox') {
					NOTA_COMPLEMENTO.checked = false;
				} else if(NOTA_COMPLEMENTO.type == 'select-one') {
					NOTA_COMPLEMENTO.selectedIndex = 0;
				} else {
					NOTA_COMPLEMENTO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_NUM_ESPECIE').getAttribute('type') != 'file') {
		  if (!NOTA_NUM_ESPECIE.getAttribute('manter') || NOTA_NUM_ESPECIE.getAttribute('manter') == 0) {
				if(NOTA_NUM_ESPECIE.type == 'checkbox') {
					NOTA_NUM_ESPECIE.checked = false;
				} else if(NOTA_NUM_ESPECIE.type == 'select-one') {
					NOTA_NUM_ESPECIE.selectedIndex = 0;
				} else {
					NOTA_NUM_ESPECIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_ESPECIE').getAttribute('type') != 'file') {
		  if (!NOTA_ESPECIE.getAttribute('manter') || NOTA_ESPECIE.getAttribute('manter') == 0) {
				if(NOTA_ESPECIE.type == 'checkbox') {
					NOTA_ESPECIE.checked = false;
				} else if(NOTA_ESPECIE.type == 'select-one') {
					NOTA_ESPECIE.selectedIndex = 0;
				} else {
					NOTA_ESPECIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_ALTURA').getAttribute('type') != 'file') {
		  if (!NOTA_ALTURA.getAttribute('manter') || NOTA_ALTURA.getAttribute('manter') == 0) {
				if(NOTA_ALTURA.type == 'checkbox') {
					NOTA_ALTURA.checked = false;
				} else if(NOTA_ALTURA.type == 'select-one') {
					NOTA_ALTURA.selectedIndex = 0;
				} else {
					NOTA_ALTURA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_LARGURA').getAttribute('type') != 'file') {
		  if (!NOTA_LARGURA.getAttribute('manter') || NOTA_LARGURA.getAttribute('manter') == 0) {
				if(NOTA_LARGURA.type == 'checkbox') {
					NOTA_LARGURA.checked = false;
				} else if(NOTA_LARGURA.type == 'select-one') {
					NOTA_LARGURA.selectedIndex = 0;
				} else {
					NOTA_LARGURA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_COMPRIMENTO').getAttribute('type') != 'file') {
		  if (!NOTA_COMPRIMENTO.getAttribute('manter') || NOTA_COMPRIMENTO.getAttribute('manter') == 0) {
				if(NOTA_COMPRIMENTO.type == 'checkbox') {
					NOTA_COMPRIMENTO.checked = false;
				} else if(NOTA_COMPRIMENTO.type == 'select-one') {
					NOTA_COMPRIMENTO.selectedIndex = 0;
				} else {
					NOTA_COMPRIMENTO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_CUBAGEM').getAttribute('type') != 'file') {
		  if (!NOTA_CUBAGEM.getAttribute('manter') || NOTA_CUBAGEM.getAttribute('manter') == 0) {
				if(NOTA_CUBAGEM.type == 'checkbox') {
					NOTA_CUBAGEM.checked = false;
				} else if(NOTA_CUBAGEM.type == 'select-one') {
					NOTA_CUBAGEM.selectedIndex = 0;
				} else {
					NOTA_CUBAGEM.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_CUBAGEM_SUGERIDA').getAttribute('type') != 'file') {
		  if (!NOTA_CUBAGEM_SUGERIDA.getAttribute('manter') || NOTA_CUBAGEM_SUGERIDA.getAttribute('manter') == 0) {
				if(NOTA_CUBAGEM_SUGERIDA.type == 'checkbox') {
					NOTA_CUBAGEM_SUGERIDA.checked = false;
				} else if(NOTA_CUBAGEM_SUGERIDA.type == 'select-one') {
					NOTA_CUBAGEM_SUGERIDA.selectedIndex = 0;
				} else {
					NOTA_CUBAGEM_SUGERIDA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_PESO_COBRADO').getAttribute('type') != 'file') {
		  if (!NOTA_PESO_COBRADO.getAttribute('manter') || NOTA_PESO_COBRADO.getAttribute('manter') == 0) {
				if(NOTA_PESO_COBRADO.type == 'checkbox') {
					NOTA_PESO_COBRADO.checked = false;
				} else if(NOTA_PESO_COBRADO.type == 'select-one') {
					NOTA_PESO_COBRADO.selectedIndex = 0;
				} else {
					NOTA_PESO_COBRADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOTA_CFOP').getAttribute('type') != 'file') {
		  if (!NOTA_CFOP.getAttribute('manter') || NOTA_CFOP.getAttribute('manter') == 0) {
				if(NOTA_CFOP.type == 'checkbox') {
					NOTA_CFOP.checked = false;
				} else if(NOTA_CFOP.type == 'select-one') {
					NOTA_CFOP.selectedIndex = 0;
				} else {
					NOTA_CFOP.value = '';
				}
				
			}
		}
		
		lista_selected_NOTAS_FISCAIS.value = -1;
	}
	f_desabilitar_botao_lista_NOTAS_FISCAIS('padrao');
	f_desabilitar_botao_lista_NOTAS_FISCAIS('excluir');
		
	f_on_incluir_NOTAS_FISCAIS();
}
function f_habilitar_botao_lista_NOTAS_FISCAIS(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_NOTAS_FISCAIS');
	if(obj != null) {
		obj.disabled = false;
		img_obj = document.getElementById('img_lista_'+v_botao+'_NOTAS_FISCAIS');
		img_obj.src = img_obj.src.replace('_disable.gif', '.gif');
	}
}
function f_desabilitar_botao_lista_NOTAS_FISCAIS(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_NOTAS_FISCAIS');
	if(obj != null) {
		obj.disabled = true;
		img_obj = document.getElementById('img_lista_'+v_botao+'_NOTAS_FISCAIS');
		if(img_obj.src.indexOf('_disable') == -1) {
			img_obj.src = img_obj.src.replace('.gif', '_disable.gif');
		}
	}
}
function f_seleciona_NOTAS_FISCAIS(v_nro) {
	
	if(!document.getElementById('btn_lista_incluir_NOTAS_FISCAIS').disabled) {
	
		f_before_selecionar_NOTAS_FISCAIS();
		f_cancelar_NOTAS_FISCAIS();
		var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');		
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_NOTAS_FISCAIS_'+v_nro) {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_1';
				}			
			} else {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_over';
				}
			}
		}
		with (document.forms[0]) {
			
			if(NF_CONHECIMENTO_ID.type == 'checkbox') {
				NF_CONHECIMENTO_ID.checked = (document.getElementById('NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NF_CONHECIMENTO_ID').type == 'file') {
				v_campo_valor = document.getElementById('NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NF_CONHECIMENTO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NF_CONHECIMENTO_ID';
				v_campo_valor.name = 'NF_CONHECIMENTO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NF_CONHECIMENTO_ID.value = document.getElementById('NF_CONHECIMENTO_ID_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_NUMERO.type == 'checkbox') {
				NOTA_NUMERO.checked = (document.getElementById('NOTA_NUMERO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_NUMERO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_NUMERO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_NUMERO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_NUMERO';
				v_campo_valor.name = 'NOTA_NUMERO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_NUMERO.value = document.getElementById('NOTA_NUMERO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_SERIE.type == 'checkbox') {
				NOTA_SERIE.checked = (document.getElementById('NOTA_SERIE_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_SERIE').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_SERIE_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_SERIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_SERIE';
				v_campo_valor.name = 'NOTA_SERIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_SERIE.value = document.getElementById('NOTA_SERIE_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_SUB_SERIE.type == 'checkbox') {
				NOTA_SUB_SERIE.checked = (document.getElementById('NOTA_SUB_SERIE_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_SUB_SERIE').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_SUB_SERIE_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_SUB_SERIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_SUB_SERIE';
				v_campo_valor.name = 'NOTA_SUB_SERIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_SUB_SERIE.value = document.getElementById('NOTA_SUB_SERIE_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_MODELO.type == 'checkbox') {
				NOTA_MODELO.checked = (document.getElementById('NOTA_MODELO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_MODELO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_MODELO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_MODELO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_MODELO';
				v_campo_valor.name = 'NOTA_MODELO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_MODELO.value = document.getElementById('NOTA_MODELO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_DATA_EMISSAO.type == 'checkbox') {
				NOTA_DATA_EMISSAO.checked = (document.getElementById('NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_DATA_EMISSAO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_DATA_EMISSAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_DATA_EMISSAO';
				v_campo_valor.name = 'NOTA_DATA_EMISSAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_DATA_EMISSAO.value = document.getElementById('NOTA_DATA_EMISSAO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_VALOR.type == 'checkbox') {
				NOTA_VALOR.checked = (document.getElementById('NOTA_VALOR_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_VALOR').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_VALOR_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_VALOR');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_VALOR';
				v_campo_valor.name = 'NOTA_VALOR';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_VALOR.value = document.getElementById('NOTA_VALOR_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_VALOR_SEGURADO.type == 'checkbox') {
				NOTA_VALOR_SEGURADO.checked = (document.getElementById('NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_VALOR_SEGURADO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_VALOR_SEGURADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_VALOR_SEGURADO';
				v_campo_valor.name = 'NOTA_VALOR_SEGURADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_VALOR_SEGURADO.value = document.getElementById('NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_ORDEM_COMPRA.type == 'checkbox') {
				NOTA_ORDEM_COMPRA.checked = (document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_ORDEM_COMPRA').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_ORDEM_COMPRA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_ORDEM_COMPRA';
				v_campo_valor.name = 'NOTA_ORDEM_COMPRA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_ORDEM_COMPRA.value = document.getElementById('NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_QTDE_VOLUME.type == 'checkbox') {
				NOTA_QTDE_VOLUME.checked = (document.getElementById('NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_QTDE_VOLUME').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_QTDE_VOLUME');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_QTDE_VOLUME';
				v_campo_valor.name = 'NOTA_QTDE_VOLUME';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_QTDE_VOLUME.value = document.getElementById('NOTA_QTDE_VOLUME_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_PESO.type == 'checkbox') {
				NOTA_PESO.checked = (document.getElementById('NOTA_PESO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_PESO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_PESO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_PESO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_PESO';
				v_campo_valor.name = 'NOTA_PESO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_PESO.value = document.getElementById('NOTA_PESO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_COD_UNIDADE.type == 'checkbox') {
				NOTA_COD_UNIDADE.checked = (document.getElementById('NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_COD_UNIDADE').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_COD_UNIDADE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_COD_UNIDADE';
				v_campo_valor.name = 'NOTA_COD_UNIDADE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_COD_UNIDADE.value = document.getElementById('NOTA_COD_UNIDADE_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_M3.type == 'checkbox') {
				NOTA_M3.checked = (document.getElementById('NOTA_M3_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_M3').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_M3_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_M3');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_M3';
				v_campo_valor.name = 'NOTA_M3';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_M3.value = document.getElementById('NOTA_M3_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_PESO_CUBADO.type == 'checkbox') {
				NOTA_PESO_CUBADO.checked = (document.getElementById('NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_PESO_CUBADO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_PESO_CUBADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_PESO_CUBADO';
				v_campo_valor.name = 'NOTA_PESO_CUBADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_PESO_CUBADO.value = document.getElementById('NOTA_PESO_CUBADO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_PESO_KG_CONVERTIDO.type == 'checkbox') {
				NOTA_PESO_KG_CONVERTIDO.checked = (document.getElementById('NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_PESO_KG_CONVERTIDO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_PESO_KG_CONVERTIDO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_PESO_KG_CONVERTIDO';
				v_campo_valor.name = 'NOTA_PESO_KG_CONVERTIDO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_PESO_KG_CONVERTIDO.value = document.getElementById('NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_NUM_NATUREZA.type == 'checkbox') {
				NOTA_NUM_NATUREZA.checked = (document.getElementById('NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_NUM_NATUREZA').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_NUM_NATUREZA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_NUM_NATUREZA';
				v_campo_valor.name = 'NOTA_NUM_NATUREZA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_NUM_NATUREZA.value = document.getElementById('NOTA_NUM_NATUREZA_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_NATUREZA.type == 'checkbox') {
				NOTA_NATUREZA.checked = (document.getElementById('NOTA_NATUREZA_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_NATUREZA').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_NATUREZA_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_NATUREZA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_NATUREZA';
				v_campo_valor.name = 'NOTA_NATUREZA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_NATUREZA.value = document.getElementById('NOTA_NATUREZA_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_COMPLEMENTO.type == 'checkbox') {
				NOTA_COMPLEMENTO.checked = (document.getElementById('NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_COMPLEMENTO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_COMPLEMENTO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_COMPLEMENTO';
				v_campo_valor.name = 'NOTA_COMPLEMENTO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_COMPLEMENTO.value = document.getElementById('NOTA_COMPLEMENTO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_NUM_ESPECIE.type == 'checkbox') {
				NOTA_NUM_ESPECIE.checked = (document.getElementById('NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_NUM_ESPECIE').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_NUM_ESPECIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_NUM_ESPECIE';
				v_campo_valor.name = 'NOTA_NUM_ESPECIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_NUM_ESPECIE.value = document.getElementById('NOTA_NUM_ESPECIE_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_ESPECIE.type == 'checkbox') {
				NOTA_ESPECIE.checked = (document.getElementById('NOTA_ESPECIE_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_ESPECIE').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_ESPECIE_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_ESPECIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_ESPECIE';
				v_campo_valor.name = 'NOTA_ESPECIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_ESPECIE.value = document.getElementById('NOTA_ESPECIE_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_ALTURA.type == 'checkbox') {
				NOTA_ALTURA.checked = (document.getElementById('NOTA_ALTURA_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_ALTURA').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_ALTURA_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_ALTURA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_ALTURA';
				v_campo_valor.name = 'NOTA_ALTURA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_ALTURA.value = document.getElementById('NOTA_ALTURA_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_LARGURA.type == 'checkbox') {
				NOTA_LARGURA.checked = (document.getElementById('NOTA_LARGURA_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_LARGURA').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_LARGURA_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_LARGURA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_LARGURA';
				v_campo_valor.name = 'NOTA_LARGURA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_LARGURA.value = document.getElementById('NOTA_LARGURA_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_COMPRIMENTO.type == 'checkbox') {
				NOTA_COMPRIMENTO.checked = (document.getElementById('NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_COMPRIMENTO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_COMPRIMENTO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_COMPRIMENTO';
				v_campo_valor.name = 'NOTA_COMPRIMENTO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_COMPRIMENTO.value = document.getElementById('NOTA_COMPRIMENTO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_CUBAGEM.type == 'checkbox') {
				NOTA_CUBAGEM.checked = (document.getElementById('NOTA_CUBAGEM_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_CUBAGEM').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_CUBAGEM_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_CUBAGEM');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_CUBAGEM';
				v_campo_valor.name = 'NOTA_CUBAGEM';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_CUBAGEM.value = document.getElementById('NOTA_CUBAGEM_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_CUBAGEM_SUGERIDA.type == 'checkbox') {
				NOTA_CUBAGEM_SUGERIDA.checked = (document.getElementById('NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_CUBAGEM_SUGERIDA').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_CUBAGEM_SUGERIDA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_CUBAGEM_SUGERIDA';
				v_campo_valor.name = 'NOTA_CUBAGEM_SUGERIDA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_CUBAGEM_SUGERIDA.value = document.getElementById('NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_PESO_COBRADO.type == 'checkbox') {
				NOTA_PESO_COBRADO.checked = (document.getElementById('NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_PESO_COBRADO').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_PESO_COBRADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_PESO_COBRADO';
				v_campo_valor.name = 'NOTA_PESO_COBRADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_PESO_COBRADO.value = document.getElementById('NOTA_PESO_COBRADO_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			if(NOTA_CFOP.type == 'checkbox') {
				NOTA_CFOP.checked = (document.getElementById('NOTA_CFOP_NOTAS_FISCAIS_'+v_nro).value == 1)
			} else if(document.getElementById('NOTA_CFOP').type == 'file') {
				v_campo_valor = document.getElementById('NOTA_CFOP_NOTAS_FISCAIS_'+v_nro);
				v_campo_atual = document.getElementById('NOTA_CFOP');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOTA_CFOP';
				v_campo_valor.name = 'NOTA_CFOP';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOTA_CFOP.value = document.getElementById('NOTA_CFOP_NOTAS_FISCAIS_'+v_nro).value;
			}
			
			lista_selected_NOTAS_FISCAIS.value = v_nro;
		}
		f_habilitar_botao_lista_NOTAS_FISCAIS('padrao');
		f_habilitar_botao_lista_NOTAS_FISCAIS('excluir');
		f_habilitar_botao_lista_NOTAS_FISCAIS('salvar');
		f_on_seleciona_NOTAS_FISCAIS();
	
	}
	
}
function f_padrao_NOTAS_FISCAIS(v_nro) {
	if(v_nro == -1) {
		return;
	}
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');		
	with(document.forms[0]) {
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_NOTAS_FISCAIS_'+v_nro) {
				var row_id = tbody.rows[i].id.replace('tr_lista_NOTAS_FISCAIS_', '');
				document.getElementById('lista_padrao_NOTAS_FISCAIS_'+row_id).style.display = 'none';
				document.getElementById('PADRAO_NOTAS_FISCAIS_'+row_id).value = 0;
			}
		}
	}
	document.getElementById('lista_padrao_NOTAS_FISCAIS_'+v_nro).style.display = '';
	document.getElementById('PADRAO_NOTAS_FISCAIS_'+v_nro).value = 1;
}	

function f_total_campo_NOTAS_FISCAIS(v_campo) {
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');
	var soma = 0;
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NOTAS_FISCAIS_', '');
		with(document.forms[0]) {
			try {
				soma += (eval("document.forms[0]."+v_campo+"_NOTAS_FISCAIS_"+id_linha+".value")*1);
			} catch(e) {
			}
		}
	}
	return soma;
}
function f_atualiza_campos_escravos_NOTAS_FISCAIS() {

}

function f_atualiza_campo_escravo_NOTAS_FISCAIS(v_valor_mestre, v_campo_escravo, v_value) {
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NOTAS_FISCAIS_', '');
		with(document.forms[0]) {
			try {
				if (eval("document.forms[0]._NOTAS_FISCAIS_"+id_linha).value == v_valor_mestre) {
					eval("document.forms[0]."+v_campo_escravo+"_NOTAS_FISCAIS_"+id_linha).value = v_value;
				}				
			} catch(e) {
			}
		}
	}
}

function f_register(p_id) {
	this.id = p_id;

	this.NF_CONHECIMENTO_ID = '';

	this.NOTA_NUMERO = '';

	this.NOTA_SERIE = '';

	this.NOTA_SUB_SERIE = '';

	this.NOTA_MODELO = '';

	this.NOTA_DATA_EMISSAO = '';

	this.NOTA_VALOR = '';

	this.NOTA_VALOR_SEGURADO = '';

	this.NOTA_ORDEM_COMPRA = '';

	this.NOTA_QTDE_VOLUME = '';

	this.NOTA_PESO = '';

	this.NOTA_COD_UNIDADE = '';

	this.NOTA_M3 = '';

	this.NOTA_PESO_CUBADO = '';

	this.NOTA_PESO_KG_CONVERTIDO = '';

	this.NOTA_NUM_NATUREZA = '';

	this.NOTA_NATUREZA = '';

	this.NOTA_COMPLEMENTO = '';

	this.NOTA_NUM_ESPECIE = '';

	this.NOTA_ESPECIE = '';

	this.NOTA_ALTURA = '';

	this.NOTA_LARGURA = '';

	this.NOTA_COMPRIMENTO = '';

	this.NOTA_CUBAGEM = '';

	this.NOTA_CUBAGEM_SUGERIDA = '';

	this.NOTA_PESO_COBRADO = '';

	this.NOTA_CFOP = '';
}
//busca todos os registros
function f_listagem_NOTAS_FISCAIS() {
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');
	var result = new Array();
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NOTAS_FISCAIS_', '');
		result[result.length] = new f_register(id_linha);
	
		try {
			result[result.length-1].NF_CONHECIMENTO_ID = eval("document.forms[0].NF_CONHECIMENTO_ID_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_NUMERO = eval("document.forms[0].NOTA_NUMERO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_SERIE = eval("document.forms[0].NOTA_SERIE_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_SUB_SERIE = eval("document.forms[0].NOTA_SUB_SERIE_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_MODELO = eval("document.forms[0].NOTA_MODELO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_DATA_EMISSAO = eval("document.forms[0].NOTA_DATA_EMISSAO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_VALOR = eval("document.forms[0].NOTA_VALOR_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_VALOR_SEGURADO = eval("document.forms[0].NOTA_VALOR_SEGURADO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_ORDEM_COMPRA = eval("document.forms[0].NOTA_ORDEM_COMPRA_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_QTDE_VOLUME = eval("document.forms[0].NOTA_QTDE_VOLUME_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_PESO = eval("document.forms[0].NOTA_PESO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_COD_UNIDADE = eval("document.forms[0].NOTA_COD_UNIDADE_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_M3 = eval("document.forms[0].NOTA_M3_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_PESO_CUBADO = eval("document.forms[0].NOTA_PESO_CUBADO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_PESO_KG_CONVERTIDO = eval("document.forms[0].NOTA_PESO_KG_CONVERTIDO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_NUM_NATUREZA = eval("document.forms[0].NOTA_NUM_NATUREZA_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_NATUREZA = eval("document.forms[0].NOTA_NATUREZA_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_COMPLEMENTO = eval("document.forms[0].NOTA_COMPLEMENTO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_NUM_ESPECIE = eval("document.forms[0].NOTA_NUM_ESPECIE_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_ESPECIE = eval("document.forms[0].NOTA_ESPECIE_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_ALTURA = eval("document.forms[0].NOTA_ALTURA_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_LARGURA = eval("document.forms[0].NOTA_LARGURA_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_COMPRIMENTO = eval("document.forms[0].NOTA_COMPRIMENTO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_CUBAGEM = eval("document.forms[0].NOTA_CUBAGEM_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_CUBAGEM_SUGERIDA = eval("document.forms[0].NOTA_CUBAGEM_SUGERIDA_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_PESO_COBRADO = eval("document.forms[0].NOTA_PESO_COBRADO_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOTA_CFOP = eval("document.forms[0].NOTA_CFOP_NOTAS_FISCAIS_"+id_linha).value;
		} catch(e) {}
	
	}
	return result;
}

function f_busca_campo_escravo_NOTAS_FISCAIS(v_valor_mestre, v_campo_escravo) {
	var tbody = document.getElementById('tb_lista_NOTAS_FISCAIS');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NOTAS_FISCAIS_', '');
		with(document.forms[0]) {
				if (eval("document.forms[0]._NOTAS_FISCAIS_"+id_linha).value == v_valor_mestre) {
					return eval("document.forms[0]."+v_campo_escravo+"_NOTAS_FISCAIS_"+id_linha).value;
				}				
		}
	}
	return '';
}
function f_set_lista_min_NOTAS_FISCAIS(value) {

}

function f_before_selecionar_NOTAS_FISCAIS() {}
function f_on_seleciona_NOTAS_FISCAIS() {}
function f_on_salva_lista_NOTAS_FISCAIS() {}
function f_before_salvar_NOTAS_FISCAIS() { return true; }
function f_on_incluir_NOTAS_FISCAIS() {}
function f_on_excluir_NOTAS_FISCAIS() {}
</script>

<table width="100%" height="100%" align="left" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr id="tr_lista_botoes_NOTAS_FISCAIS">
    <td><table border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>

		
          <td><button tabindex="287" class="botao" id="btn_lista_incluir_NOTAS_FISCAIS" onclick="f_incluir_NOTAS_FISCAIS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_incluir_NOTAS_FISCAIS" src="/_imagens/botoes/16x16/incluir.gif">&nbsp;Novo</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="288" class="botao" id="btn_lista_excluir_NOTAS_FISCAIS" onclick="f_excluir_NOTAS_FISCAIS(document.forms[0].lista_selected_NOTAS_FISCAIS.value)" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_excluir_NOTAS_FISCAIS" src="https://levolog.kmm.com.br/_imagens/botoes/16x16/excluir_disable.gif">&nbsp;Excluir</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="289" class="botao" id="btn_lista_salvar_NOTAS_FISCAIS" onclick="f_salvar_NOTAS_FISCAIS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_salvar_NOTAS_FISCAIS" src="/_imagens/botoes/16x16/confirmar.gif">&nbsp;Salvar</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="290" class="botao" id="btn_lista_cancelar_NOTAS_FISCAIS" onclick="f_cancelar_NOTAS_FISCAIS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_cancelar_NOTAS_FISCAIS" src="/_imagens/botoes/16x16/cancelar.gif">&nbsp;Cancelar</button></td>
          <td style="width: 4px;">&nbsp;</td>
		  
        </tr>
      </tbody></table></td>
  </tr>
  <tr><td height="4"></td></tr>
  <input name="lista_selected_NOTAS_FISCAIS" tabindex="291" id="lista_selected_NOTAS_FISCAIS" type="hidden" value="-1" fixo="1">
  <input name="lista_deleted_NOTAS_FISCAIS" tabindex="292" id="lista_deleted_NOTAS_FISCAIS" type="hidden" value="" fixo="1">
  <tr>
  
    <td height="200">
	<div class="lista" style="width: 100%; -ms-overflow-x: scroll;">
	<table width="100%" style="-ms-overflow-y: scroll;" border="0" cellspacing="1" cellpadding="3">
	<thead>
  <tr class="titulo_3" style="cursor: pointer;" onclick="sortColumn(event)">
    <td width="16" class="titulo_3" style="display: none;">&nbsp;</td>
  	
    <td width="100" align="" class="titulo_3" type="caseinsensitivestring">Nº Nota</td>
	
    <td width="80" align="" class="titulo_3" type="caseinsensitivestring">Modelo</td>
	
    <td width="80" align="" class="titulo_3" type="caseinsensitivestring">Série</td>
	
    <td width="80" align="" class="titulo_3" type="caseinsensitivestring">Sub-Série</td>
	
    <td width="120" align="" class="titulo_3" type="caseinsensitivestring">Data Emissão</td>
	
    <td width="150" align="" class="titulo_3" type="caseinsensitivestring">Valor</td>
	
    <td width="150" align="" class="titulo_3" type="caseinsensitivestring">Peso</td>
	
  </tr>
  </thead>
  <tbody id="tb_lista_NOTAS_FISCAIS">
  </tbody>
</table>

	</div></td>
  </tr>
</tbody></table>

		<script language="javascript1.2">
		var v_num_especie_notas = '';
		var v_num_natureza_notas = '';
		var v_cod_unidade_notas = '';
		var v_edicao = false;
		var v_nota_num_natureza = '';
		var v_nota_num_especie = '';
		function f_on_incluir_NOTAS_FISCAIS() {
			with(document.forms[0]) {
            NOTA_ALTURA.value = 0;
				NOTA_LARGURA.value = 0;
				NOTA_COMPRIMENTO.value = 0;
				if (!v_edicao){
					NOTA_COMPRIMENTO.onchange();
				}
				
				v_lista = f_listagem_NOTAS_FISCAIS();
				if(v_lista.length > 0){
					NOTA_NUM_NATUREZA.value = v_nota_num_natureza;
					NOTA_NUM_NATUREZA.onchange();
					NOTA_NUM_ESPECIE.value = v_nota_num_especie;
					
					NOTA_NUM_ESPECIE.onchange();
				}
				
				NOTA_QTDE_VOLUME.value = 1;
				NOTA_ORDEM_COMPRA.value = PEDIDO_SHIPMENT_SOLICITACAO.value;
				
				f_valor_segurado_automatico('NOTA', 0);
				
				v_edicao = false;
			}
		}
		function f_on_salva_lista_NOTAS_FISCAIS() {
			with(document.forms[0]) {
				v_lista = f_listagem_NOTAS_FISCAIS();
				if(v_lista.length > 0){
					//Segundo regra, se a natureza veio da solicitação, não deve ser substituida pela natureza da nota.
					if (SOLICITACAO_NUM_NATUREZA.value == '') {
					   NUM_NATUREZA.value = v_lista[0].NOTA_NUM_NATUREZA;
					   NUM_NATUREZA.onchange();
					}
					NUM_ESPECIE.value =  v_lista[0].NOTA_NUM_ESPECIE;
					NUM_ESPECIE.onchange();
				}
				VALOR_MERCADORIA.value = f_total_campo_NOTAS_FISCAIS('NOTA_VALOR');
				PESO.value = f_total_campo_NOTAS_FISCAIS('NOTA_PESO_COBRADO');
				M3.value = f_total_campo_NOTAS_FISCAIS('NOTA_M3')
				CUBAGEM.value = f_total_campo_NOTAS_FISCAIS('NOTA_CUBAGEM')
				PESO_KG.value = f_total_campo_NOTAS_FISCAIS('NOTA_PESO_KG_CONVERTIDO');
				var v_lista = f_listagem_NOTAS_FISCAIS();
				NOTAS.value = '';
				for(var i=0;i<v_lista.length;i++) {
					if(NOTAS.value == ''){
						NOTAS.value = v_lista[i].NOTA_NUMERO;						
					}else{
						NOTAS.value += ' , '+v_lista[i].NOTA_NUMERO;						
					}
				}
				f_preenche_constantes_cfop_mercadoria();
				try{
				f_preenche_observacao();
				} catch(e) {}
				
				COD_UNIDADE.value = 'Kg';
				VOLUME.value = f_total_campo_NOTAS_FISCAIS('NOTA_QTDE_VOLUME');
				
				if(POPULANDO_DADOS.value == 0){
				   f_calculos();
				}				
				PESO_REAL.value = f_total_campo_NOTAS_FISCAIS('NOTA_PESO');
				f_atualiza_peso_cte_ref();
				if (f_listagem_CTES_REF().length > 0) {
				   f_seleciona_CTES_REF(0);
				}
			}
		}
		function f_before_salvar_NOTAS_FISCAIS() {
			with(document.forms[0]) {
				if(f_ajax_running() > 0 && v_inserida == 0) {
					alert('Aguarde o término do processamento antes de salvar.');
					return false;
				}
				if(NOTA_NUM_ESPECIE.value != '' && NOTA_ESPECIE.value == '') {
					alert('A espécie selecionada não é válida!');
					return false;
				}
				if(NOTA_NUM_NATUREZA.value != '' && NOTA_NATUREZA.value == '') {
					alert('A natureza selecionada não é válida!');
					return false;
				}
				v_lista = f_listagem_NOTAS_FISCAIS();
				if(v_lista.length == 0){
					v_nota_num_natureza = NOTA_NUM_NATUREZA.value;
					v_nota_num_especie = NOTA_NUM_ESPECIE.value;
				}
				
				
				return true;
			}
		}
		function f_on_seleciona_NOTAS_FISCAIS() {
			with(document.forms[0]) {
				f_busca_serie_nota();
				NOTA_SERIE.value = document.getElementById('NOTA_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value;
				f_busca_sub_serie_nota();
				NOTA_SUB_SERIE.value = document.getElementById('NOTA_SUB_SERIE_NOTAS_FISCAIS_'+lista_selected_NOTAS_FISCAIS.value).value;
			}
		}
		function f_before_selecionar_NOTAS_FISCAIS(){
			v_edicao = true;			
		}
		function f_on_excluir_NOTAS_FISCAIS(){
			v_listagem = f_listagem_NOTAS_FISCAIS();
			if(v_listagem.length == 0)
				f_controla_tipo_docto_frete();
		}
		</script>
       </td>
   </tr>
</tbody></table>

<table width="100%" border="0" cellspacing="0" cellpadding="1">
	<tbody><tr>
    	<td width="100%">
        	<fieldset tabindex="293" id="fs_nfe"><legend>Nota Fiscal Eletrônica</legend>
                <table width="100%" border="0" cellspacing="3" cellpadding="1">
                    <tbody><tr>
                        <td width="100%" class="texto" nowrap="">Chave de Acesso da NFe:
                        <input name="NFE_ID" tabindex="294" id="NFE_ID" type="hidden" value="">
                        <input name="NOME_ARQUIVO" tabindex="295" id="NOME_ARQUIVO" type="hidden" value="">
                        <input name="DOCUMENTO_ID" tabindex="296" id="DOCUMENTO_ID" type="hidden">
                        <input name="NFE_DOCUMENTO_ID" tabindex="297" id="NFE_DOCUMENTO_ID" type="hidden" value="">
                        <input name="ICMS_PARTILHADO" tabindex="298" id="ICMS_PARTILHADO" type="hidden" value="" secao="NFE">
                        <input name="CHAVE_ACESSO_NFE" tabindex="299" class="requerido_form" id="CHAVE_ACESSO_NFE" style="width: 320px;" onchange="document.forms[0].BUSCA_POR_CHAVE.value = 0;f_busca_dados_chave_nfe();document.forms[0].BUSCA_POR_CHAVE.value = 0;" type="text" maxlength="44" display="NFE / CHAVE DE ACESSO DA NFE" obrigatorio="1" secao="NFE">
                        &nbsp;PIN do Suframa:
                    	<input name="PIN_SUFRAMA_NFE" tabindex="300" id="PIN_SUFRAMA_NFE" style="width: 100px;" onkeypress="return f_formata(this,event,'000000000')" type="text" maxlength="9" display="NFE / PIN DO SUFRAMA" secao="NFE">
                        &nbsp;Valor da Nota:
                    	<input name="NFE_VALOR" tabindex="301" class="requerido_form" id="NFE_VALOR" style="width: 85px;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value).toFixed(2);  f_valor_segurado_automatico('NFE', 1);" type="text" maxlength="15" display="NFE / VALOR" obrigatorio="1" tipo="numerico" secao="NFE">
                        &nbsp;Valor Segurado:
                    	<input name="NFE_VALOR_SEGURADO" tabindex="302" class="requerido_form" id="NFE_VALOR_SEGURADO" style="width: 85px;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value).toFixed(2);" type="text" maxlength="15" display="NFE / VALOR SEGURADO" obrigatorio="1" tipo="numerico" secao="NFE">
                        </td>
                    <tr>
                        <td width="100%" class="texto" nowrap="">Data de Emissão:<input name="DATA_EMISSAO_NFE" tabindex="303" class="requerido_form" id="DATA_EMISSAO_NFE" style="width: 85px;" onkeypress="return f_formata(this,event,'00/00/0000')" type="text" maxlength="44" display="NFE / DATA DE EMISSAO DA NFE" obrigatorio="1" tipo="data" secao="NFE">
                                                            <button tabindex="304" class="botao-16x16" id="BTN_DATA_EMISSAO_NFE" type="button"><img width="16" height="16" title="Data" align="absmiddle" alt="Data" src="/_imagens/botoes/16x16/calendario.gif"></button>
																<script type="text/javascript"> 
                                                                    Calendar.setup( {
                                                                        inputField  : "DATA_EMISSAO_NFE",      // ID of the input field
                                                                        ifFormat    : "%d/%m/%Y",               // the date format
                                                                        button      : "BTN_DATA_EMISSAO_NFE",  // ID of the button
                                                                        range       : [2001,2050]
                                                                    } );
                                                                </script>
                        &nbsp;Número:<input name="NUMERO_NFE" tabindex="305" class="requerido_form" id="NUMERO_NFE" style="width: 85px;" type="text" maxlength="44" display="NFE / NÚMERO DA NFE" obrigatorio="1" secao="NFE">
                        &nbsp;Modelo:<input name="MODELO_NFE" tabindex="306" class="requerido_form" id="MODELO_NFE" style="width: 85px;" type="text" maxlength="44" readonly="readonly" display="NFE / MODELO DA NFE" obrigatorio="1" secao="NFE">
                        &nbsp;Série:<input name="SERIE_NFE" tabindex="307" class="requerido_form" id="SERIE_NFE" style="width: 85px;" type="text" maxlength="44" readonly="readonly" display="NFE / SÉRIE DA NFE" obrigatorio="1" secao="NFE">
                        &nbsp;CFOP:
                                      <input name="NFE_CFOP" tabindex="308" id="NFE_CFOP" type="text" size="10" maxlength="4" display="NFE / CFOP" obrigatorio="0" secao="NFE">
                                   
                        </td>
                    </tr>
                    <tr>
                    	<td width="100%" class="texto" nowrap="">
                        	<label style="vertical-align: top;">Pedido/Shipment:</label><textarea name="NFE_ORDEM_COMPRA" tabindex="309" id="NFE_ORDEM_COMPRA" style="width: 500px; height: 45px; resize: none;" onkeypress="if (this.value.length >= 160) return false;" onblur="if (this.value.length > 160) this.value = this.value.substr(0, 160);" cols="60" readonly="" display="NFE / PEDIDO/SHIPMENT" obrigatorio="0" secao="NFE" row="4"></textarea>
                        </td>
                    </tr>                    
                    <tr>
                    	<td width="100%" class="texto" nowrap="">

                        	<fieldset tabindex="310" id="fs_nfe_arquivo"><legend>Dados do Arquivo</legend>
                                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                                    <tbody><tr>
                                        <td width="8%" class="texto">Remetente:</td>
                                        <td width="20%" class="texto"><input name="REMETENTE_NFE" tabindex="311" id="REMETENTE_NFE" style="width: 400px;" type="text" maxlength="30" readonly="readonly" display="NFE / REMETENTE DA NFE" secao="NFE">                                        </td>
                                        <td width="10%" class="texto" nowrap="nowrap">CPF/CNPJ Remetente:</td>
                                        <td width="50%" class="texto">
                                            <input name="CNPJ_REMETENTE_NFE" tabindex="312" id="CNPJ_REMETENTE_NFE" style="width: 125px;" type="text" maxlength="30" readonly="readonly" display="NFE / REMETENTE DA NFE" secao="NFE">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="8%" class="texto">Destinatário:</td>
                                        <td width="20%" class="texto"><input name="DESTINATARIO_NFE" tabindex="313" id="DESTINATARIO_NFE" style="width: 400px;" type="text" maxlength="30" readonly="readonly" display="NFE / DESTINATÁRIO DA NFE" secao="NFE">                                        </td>
                                        <td width="10%" class="texto" nowrap="nowrap">CPF/CNPJ Destinatário:</td>
                                        <td width="50%" class="texto">
                                            <input name="CNPJ_DESTINATARIO_NFE" tabindex="314" id="CNPJ_DESTINATARIO_NFE" style="width: 125px;" type="text" maxlength="30" readonly="readonly" display="NFE / DESTINATÁRIO DA NFE" secao="NFE"></td>
                                    </tr>
                                    
                                </tbody></table>
                            </fieldset>
                        </td>
                    </tr>
                    <tr>
                     	<td height="1" nowrap="" style="padding: 0px;" colspan="4"><fieldset tabindex="315">
                         <legend>Mercadoria</legend>
                         <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                  <tbody><tr>
                                    <td width="8%" class="texto">Volumes:</td>
                                    <td width="12%" class="texto"><input name="NFE_QTDE_VOLUME" tabindex="316" class="requerido_form" id="NFE_QTDE_VOLUME" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_calcula_cubagem('NFE');" type="text" size="15" maxlength="10" display="NFE / QUANTIDADE" obrigatorio="1" tipo="numerico" secao="NFE"></td>
                                    <td class="texto">Peso:
                                      <input name="NFE_PESO" tabindex="317" class="requerido_form" id="NFE_PESO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_sanitizar_numero(this); f_calcula_peso_kg('NFE')" type="text" size="10" maxlength="10" display="NFE / PESO" obrigatorio="1" tipo="numerico" secao="NFE">
                                      <select name="NFE_COD_UNIDADE" tabindex="318" class="requerido_form" id="NFE_COD_UNIDADE" onchange="f_calcula_peso_kg('NFE')" fixo="1" display="NFE / UNIDADE" obrigatorio="1" secao="NFE" manter="1">
                                           <option value="">-- Selecione --</option>
										  
										  <option value="CX 10">Caixa c/ 10</option>
										  
										  <option value="GAL22L">Galão 22 Litros</option>
										  
										  <option value="PAR">Pares</option>
										  
										  <option value="GR">Gramas</option>
										  
										  <option value="MTS">Metros</option>
										  
										  <option value="ML">Mililitros</option>
										  
										  <option value="GAL15L">Galão 15 Litros</option>
										  
										  <option value="GAL25L">Galão 25 Litros</option>
										  
										  <option value="GL10LT">Galão 10l</option>
										  
										  <option value="GL10LTS">Galão 10 Litros</option>
										  
										  <option value="GL20LTS">Galão 20 Litros</option>
										  
										  <option value="GL5LTS">Galão 5 Litros</option>
										  
										  <option value="Kg" selected="">Kilogramas</option>
										  
										  <option value="LT">Litros</option>
										  
										  <option value="M3">metros cubicos</option>
										  
										  <option value="TON">Toneladas</option>
										  
										  <option value="UN">Unidade</option>
										  
										  <option value="CX 100">Cx c/ 100</option>
										  
										  <option value="RL">Rolo</option>
										  
										  <option value="CX">Caixa</option>
										  
										  <option value="PCT">Pacote</option>
										  
                                      </select>
                                      <input name="NFE_M3" tabindex="319" id="NFE_M3" type="hidden" value="" fixo="1">
                                      <input name="NFE_PESO_CUBADO" tabindex="320" id="NFE_PESO_CUBADO" type="hidden" value="" fixo="1">
                                      <input name="NFE_PESO_KG_CONVERTIDO" tabindex="321" id="NFE_PESO_KG_CONVERTIDO" type="hidden" size="10" maxlength="10" value="" display="NFE / PESO" obrigatorio="0" tipo="numerico" secao="NFE"></td>
                                  </tr>
                                  <tr>
                                    <td class="texto">Natureza:</td>
                                    <td class="texto" colspan="2"><input name="NFE_NUM_NATUREZA" tabindex="322" class="requerido_form" id="NFE_NUM_NATUREZA" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_natureza('NFE')" type="text" display="NFE / NATUREZA" obrigatorio="1" secao="NFE">
                                      <input name="NFE_NATUREZA" tabindex="323" class="requerido_form" id="NFE_NATUREZA" style="width: 200px;" type="text" readonly="true" display="NFE / NATUREZA" obrigatorio="1" secao="NFE">
                                      <button tabindex="324" class="botao-16x16" onclick="NewWindow('localizar_natureza.cfm?num_natureza=NFE_NUM_NATUREZA&amp;natureza=NFE_NATUREZA&amp;operacao_id=' + OPERACAO_ID_CTRC.value,'_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button>
                                      &nbsp;
                                    <input name="NFE_COMPLEMENTO" tabindex="325" id="NFE_COMPLEMENTO" style="width: 177px;" type="text" display="NFE / COMPLEMENTO" secao="NFE"></td>
                                  </tr>
                                  <tr>
                                    <td class="texto">Espécie:</td>
                                    <td class="texto" colspan="2"><input name="NFE_NUM_ESPECIE" tabindex="326" class="requerido_form" id="NFE_NUM_ESPECIE" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_especie('NFE')" type="text" display="NFE / ESPECIE" obrigatorio="1" secao="NFE">
                                      <input name="NFE_ESPECIE" tabindex="327" class="requerido_form" id="NFE_ESPECIE" style="width: 200px;" type="text" readonly="true" display="NFE / ESPECIE" obrigatorio="1" secao="NFE">
                                      <button tabindex="328" class="botao-16x16" onclick="NewWindow('/_consultas/localizar_especie.cfm?num_ESPECIE=NFE_NUM_ESPECIE&amp;ESPECIE=NFE_ESPECIE','_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button></td>
                                  </tr>
                                  <tr>
                                    <td class="texto">Altura:</td>
                                    <td class="texto" colspan="2"><input name="NFE_ALTURA" tabindex="329" id="NFE_ALTURA" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('NFE');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / ALTURA" obrigatorio="0" tipo="numerico" secao="NFE">
                                      Comprimento:
                                        <input name="NFE_COMPRIMENTO" tabindex="330" id="NFE_COMPRIMENTO" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('NFE');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / COMPRIMENTO" obrigatorio="0" tipo="numerico" secao="NFE">
                                        Largura:
                                        <input name="NFE_LARGURA" tabindex="331" id="NFE_LARGURA" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('NFE');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / LARGURA" obrigatorio="0" tipo="numerico" secao="NFE">
                                  </tr>
                                  <tr>
                                  	<td class="texto">Cubagem sugerida:</td>
                                    <td class="texto" colspan="2">
                                        <input name="NFE_CUBAGEM_SUGERIDA" tabindex="332" id="NFE_CUBAGEM_SUGERIDA" onkeypress="return f_formata_numero_decimal(this,event);" type="text" size="15" maxlength="10" readonly="true" fixo="1" display="NOTA FISCAL / CUBAGEM SUGERIDA" obrigatorio="0" tipo="numerico" secao="NFE">
                                        Cubagem total:
                                        <input name="NFE_CUBAGEM" tabindex="333" id="NFE_CUBAGEM" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_peso_cobrado('NFE');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / CUBAGEM" obrigatorio="0" tipo="numerico" secao="NFE">
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="texto"><nobr>Peso Cobrado: </nobr> </td>
                                    <td class="texto" colspan="2"><input name="NFE_PESO_COBRADO" tabindex="334" class="requerido_form" id="NFE_PESO_COBRADO" style="width: 90px;" onkeypress="return f_formata_numero_decimal(this,event)" type="text" display="NFE / PESO COBRADO" obrigatorio="1" secao="NFE">
                                      Kg</td>
                                  </tr>
                          </tbody></table></fieldset></td>
                   </tr>
                </tbody></table>
                <table width="100%" border="0" cellspacing="3" cellpadding="1">
                	<tbody><tr>
                        <td width="90%" style="padding-top: 5px;">
                            <table width="100%" border="0" cellspacing="3" cellpadding="1">
                            <tbody><tr><td>
                            
<script src="/_scripts/tablesort.js"></script>
<script language="javascript1.2">
var DOUBLE_QUOTES = new RegExp( '"([^"]*)"', 'g' );


function f_ordenar_NFE(campo, desc, tipo) {
//	try {
		if(!tipo) 
			tipo = 'caseinsensitivestring';
		v_tb = document.getElementById('tb_lista_NFE');
		v_rows2 = new Array();
		for(var i=0;i<v_tb.rows.length;i++) 
			v_rows2.push(v_tb.rows[i]);
		v_rows2.sort(function(a,b) {
				v_id_a = a.id.replace('tr_lista_NFE_','');
				v_id_b = b.id.replace('tr_lista_NFE_','');
				if(tipo == 'number') {
					if( Number(document.getElementById(campo+'_NFE_'+v_id_a).value) < Number(document.getElementById(campo+'_NFE_'+v_id_b).value)) 
						return desc ? +1 : -1;
					if( Number(document.getElementById(campo+'_NFE_'+v_id_a).value) > Number(document.getElementById(campo+'_NFE_'+v_id_b).value)) 
						return desc ? -1 : +1;
				} else if(tipo == 'caseinsensitivestring') {
					if(document.getElementById(campo+'_NFE_'+v_id_a).value < document.getElementById(campo+'_NFE_'+v_id_b).value) 
						return desc ? +1 : -1;
					if(document.getElementById(campo+'_NFE_'+v_id_a).value > document.getElementById(campo+'_NFE_'+v_id_b).value) 
						return desc ? -1 : +1;
				}
				return 0;
			});
		for(var i=0;i<v_rows2.length;i++) {
			v_tb.appendChild(v_rows2[i]);
		}
//	} catch(e) {}
}

function f_incluir_NFE() {
	with(document.forms[0]) {
		
		f_cancelar_NFE();
	}
}

function f_excluir_NFE(v_nro, v_nao_mostra_confirmar) {
	if(v_nro == -1) {
		return;
	}
	if(!v_nao_mostra_confirmar) {
		if(!confirm('Clique OK para confirmar a exclusão do registro!')) {
			return;
		}
	}
	with (document.forms[0]) {
		
			lista_deleted_NFE.value = lista_deleted_NFE.value+','+document.getElementById('CHAVE_ACESSO_NFE_NFE_'+v_nro).value;
		
	}
	var tbody = document.getElementById('tb_lista_NFE');		
	for(var i=0;i<tbody.rows.length;i++) {
		if(tbody.rows[i].id == 'tr_lista_NFE_'+v_nro) {
			tbody.deleteRow(i);
			f_cancelar_NFE();
			break;
		}
	}
		
	
	f_cancelar_NFE();
	f_on_salva_lista_NFE();
	f_on_excluir_NFE();
}
function f_limpar_NFE() {
	var tbody = document.getElementById('tb_lista_NFE');	
	while (tbody.rows.length > 0) {
		tbody.deleteRow(0);
	}
		
	
	document.forms[0].lista_selected_NFE.value = -1;
}
var lista_count_NFE = 0;


function f_testa_existencia_NFE(chave, linha_atual, selectable) {
	var listagem = f_listagem_NFE();
	for(var i=0;i<listagem.length;i++) {
		var items = chave.split('|');
		var igual = true;
		for(var j=0;j<items.length;j++) {
			if(eval('listagem['+i+'].'+items[j]) != eval('document.forms[0].'+items[j]+'.value') || listagem[i].id == linha_atual) {
					igual = false;
			}
		}
		if (igual) {
			return true;
		}
	}
}
function f_salvar_NFE() {
	
	if (!f_before_salvar_NFE()) {
	   return;
	}	
	if(f_verifica_form(document.forms[0], 'NFE'))	{
		var padrao = true;
		var tbody = document.getElementById('tb_lista_NFE');
		for(var i=0;i<tbody.rows.length;i++) {
			var row_id = tbody.rows[i].id.replace('tr_lista_NFE_', '');
			if(document.getElementById('lista_padrao_NFE_'+row_id).style.display == '') {
				padrao = false;
			}
		}
		with(document.forms[0]) {
			
					if(f_testa_existencia_NFE('CHAVE_ACESSO_NFE', lista_selected_NFE.value, true)) {
						alert('Os campos não podem ser repetidos!');
						return;
					}
				
			if(lista_selected_NFE.value == -1) {
				var v_tr = document.createElement('TR');
				v_tr.id = 'tr_lista_NFE_'+lista_count_NFE;
				var temp_count = lista_count_NFE;
				v_tr.style.cursor = 'pointer';
				v_tr.onclick = function() {
					f_seleciona_NFE(temp_count);
				}
				var v_td = document.createElement('TD');
				var v_dv1 = document.createElement('div');
				v_td.appendChild(v_dv1);
				v_td.className = 'linha_1';
				lista_inputs = '<input type="hidden" name="PADRAO_NFE_'+lista_count_NFE+'" id="PADRAO_NFE_'+lista_count_NFE+'" value="'+((padrao)?1:0)+'">';
				
				if (NF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NFE_'+lista_count_NFE+'" id="NF_CONHECIMENTO_ID_NFE_'+lista_count_NFE+'" value="'+((NF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
				} else if (NF_CONHECIMENTO_ID.type == 'file') {
					v_campo_file = document.forms[0].NF_CONHECIMENTO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NF_CONHECIMENTO_ID_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NF_CONHECIMENTO_ID_NFE_'+lista_count_NFE;
					v_file_input.name = 'NF_CONHECIMENTO_ID';
					v_file_input.id = 'NF_CONHECIMENTO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NF_CONHECIMENTO_ID.value;
				
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NFE_'+lista_count_NFE+'" id="NF_CONHECIMENTO_ID_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ID_NFE_'+lista_count_NFE+'" id="NFE_ID_NFE_'+lista_count_NFE+'" value="'+((NFE_ID.checked)?"1":"0")+'">';
				} else if (NFE_ID.type == 'file') {
					v_campo_file = document.forms[0].NFE_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_ID_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_ID_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_ID';
					v_file_input.id = 'NFE_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_ID.value;
				
					lista_inputs += '<input type="hidden" name="NFE_ID_NFE_'+lista_count_NFE+'" id="NFE_ID_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CHAVE_ACESSO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CHAVE_ACESSO_NFE_NFE_'+lista_count_NFE+'" id="CHAVE_ACESSO_NFE_NFE_'+lista_count_NFE+'" value="'+((CHAVE_ACESSO_NFE.checked)?"1":"0")+'">';
				} else if (CHAVE_ACESSO_NFE.type == 'file') {
					v_campo_file = document.forms[0].CHAVE_ACESSO_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CHAVE_ACESSO_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'CHAVE_ACESSO_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'CHAVE_ACESSO_NFE';
					v_file_input.id = 'CHAVE_ACESSO_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CHAVE_ACESSO_NFE.value;
				
					lista_inputs += '<input type="hidden" name="CHAVE_ACESSO_NFE_NFE_'+lista_count_NFE+'" id="CHAVE_ACESSO_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_VALOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_VALOR_NFE_'+lista_count_NFE+'" id="NFE_VALOR_NFE_'+lista_count_NFE+'" value="'+((NFE_VALOR.checked)?"1":"0")+'">';
				} else if (NFE_VALOR.type == 'file') {
					v_campo_file = document.forms[0].NFE_VALOR;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_VALOR_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_VALOR_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_VALOR';
					v_file_input.id = 'NFE_VALOR';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_VALOR.value;
				
					lista_inputs += '<input type="hidden" name="NFE_VALOR_NFE_'+lista_count_NFE+'" id="NFE_VALOR_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_VALOR_SEGURADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_VALOR_SEGURADO_NFE_'+lista_count_NFE+'" id="NFE_VALOR_SEGURADO_NFE_'+lista_count_NFE+'" value="'+((NFE_VALOR_SEGURADO.checked)?"1":"0")+'">';
				} else if (NFE_VALOR_SEGURADO.type == 'file') {
					v_campo_file = document.forms[0].NFE_VALOR_SEGURADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_VALOR_SEGURADO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_VALOR_SEGURADO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_VALOR_SEGURADO';
					v_file_input.id = 'NFE_VALOR_SEGURADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_VALOR_SEGURADO.value;
				
					lista_inputs += '<input type="hidden" name="NFE_VALOR_SEGURADO_NFE_'+lista_count_NFE+'" id="NFE_VALOR_SEGURADO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (PIN_SUFRAMA_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="PIN_SUFRAMA_NFE_NFE_'+lista_count_NFE+'" id="PIN_SUFRAMA_NFE_NFE_'+lista_count_NFE+'" value="'+((PIN_SUFRAMA_NFE.checked)?"1":"0")+'">';
				} else if (PIN_SUFRAMA_NFE.type == 'file') {
					v_campo_file = document.forms[0].PIN_SUFRAMA_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'PIN_SUFRAMA_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'PIN_SUFRAMA_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'PIN_SUFRAMA_NFE';
					v_file_input.id = 'PIN_SUFRAMA_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = PIN_SUFRAMA_NFE.value;
				
					lista_inputs += '<input type="hidden" name="PIN_SUFRAMA_NFE_NFE_'+lista_count_NFE+'" id="PIN_SUFRAMA_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (REMETENTE_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REMETENTE_NFE_NFE_'+lista_count_NFE+'" id="REMETENTE_NFE_NFE_'+lista_count_NFE+'" value="'+((REMETENTE_NFE.checked)?"1":"0")+'">';
				} else if (REMETENTE_NFE.type == 'file') {
					v_campo_file = document.forms[0].REMETENTE_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'REMETENTE_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'REMETENTE_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'REMETENTE_NFE';
					v_file_input.id = 'REMETENTE_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = REMETENTE_NFE.value;
				
					lista_inputs += '<input type="hidden" name="REMETENTE_NFE_NFE_'+lista_count_NFE+'" id="REMETENTE_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CNPJ_REMETENTE_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CNPJ_REMETENTE_NFE_NFE_'+lista_count_NFE+'" id="CNPJ_REMETENTE_NFE_NFE_'+lista_count_NFE+'" value="'+((CNPJ_REMETENTE_NFE.checked)?"1":"0")+'">';
				} else if (CNPJ_REMETENTE_NFE.type == 'file') {
					v_campo_file = document.forms[0].CNPJ_REMETENTE_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CNPJ_REMETENTE_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'CNPJ_REMETENTE_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'CNPJ_REMETENTE_NFE';
					v_file_input.id = 'CNPJ_REMETENTE_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CNPJ_REMETENTE_NFE.value;
				
					lista_inputs += '<input type="hidden" name="CNPJ_REMETENTE_NFE_NFE_'+lista_count_NFE+'" id="CNPJ_REMETENTE_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DESTINATARIO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DESTINATARIO_NFE_NFE_'+lista_count_NFE+'" id="DESTINATARIO_NFE_NFE_'+lista_count_NFE+'" value="'+((DESTINATARIO_NFE.checked)?"1":"0")+'">';
				} else if (DESTINATARIO_NFE.type == 'file') {
					v_campo_file = document.forms[0].DESTINATARIO_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DESTINATARIO_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'DESTINATARIO_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'DESTINATARIO_NFE';
					v_file_input.id = 'DESTINATARIO_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DESTINATARIO_NFE.value;
				
					lista_inputs += '<input type="hidden" name="DESTINATARIO_NFE_NFE_'+lista_count_NFE+'" id="DESTINATARIO_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CNPJ_DESTINATARIO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CNPJ_DESTINATARIO_NFE_NFE_'+lista_count_NFE+'" id="CNPJ_DESTINATARIO_NFE_NFE_'+lista_count_NFE+'" value="'+((CNPJ_DESTINATARIO_NFE.checked)?"1":"0")+'">';
				} else if (CNPJ_DESTINATARIO_NFE.type == 'file') {
					v_campo_file = document.forms[0].CNPJ_DESTINATARIO_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CNPJ_DESTINATARIO_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'CNPJ_DESTINATARIO_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'CNPJ_DESTINATARIO_NFE';
					v_file_input.id = 'CNPJ_DESTINATARIO_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CNPJ_DESTINATARIO_NFE.value;
				
					lista_inputs += '<input type="hidden" name="CNPJ_DESTINATARIO_NFE_NFE_'+lista_count_NFE+'" id="CNPJ_DESTINATARIO_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NOME_ARQUIVO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOME_ARQUIVO_NFE_'+lista_count_NFE+'" id="NOME_ARQUIVO_NFE_'+lista_count_NFE+'" value="'+((NOME_ARQUIVO.checked)?"1":"0")+'">';
				} else if (NOME_ARQUIVO.type == 'file') {
					v_campo_file = document.forms[0].NOME_ARQUIVO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NOME_ARQUIVO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NOME_ARQUIVO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NOME_ARQUIVO';
					v_file_input.id = 'NOME_ARQUIVO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NOME_ARQUIVO.value;
				
					lista_inputs += '<input type="hidden" name="NOME_ARQUIVO_NFE_'+lista_count_NFE+'" id="NOME_ARQUIVO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NUMERO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NUMERO_NFE_NFE_'+lista_count_NFE+'" id="NUMERO_NFE_NFE_'+lista_count_NFE+'" value="'+((NUMERO_NFE.checked)?"1":"0")+'">';
				} else if (NUMERO_NFE.type == 'file') {
					v_campo_file = document.forms[0].NUMERO_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NUMERO_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NUMERO_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'NUMERO_NFE';
					v_file_input.id = 'NUMERO_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NUMERO_NFE.value;
				
					lista_inputs += '<input type="hidden" name="NUMERO_NFE_NFE_'+lista_count_NFE+'" id="NUMERO_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (MODELO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="MODELO_NFE_NFE_'+lista_count_NFE+'" id="MODELO_NFE_NFE_'+lista_count_NFE+'" value="'+((MODELO_NFE.checked)?"1":"0")+'">';
				} else if (MODELO_NFE.type == 'file') {
					v_campo_file = document.forms[0].MODELO_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'MODELO_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'MODELO_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'MODELO_NFE';
					v_file_input.id = 'MODELO_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = MODELO_NFE.value;
				
					lista_inputs += '<input type="hidden" name="MODELO_NFE_NFE_'+lista_count_NFE+'" id="MODELO_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (SERIE_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="SERIE_NFE_NFE_'+lista_count_NFE+'" id="SERIE_NFE_NFE_'+lista_count_NFE+'" value="'+((SERIE_NFE.checked)?"1":"0")+'">';
				} else if (SERIE_NFE.type == 'file') {
					v_campo_file = document.forms[0].SERIE_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'SERIE_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'SERIE_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'SERIE_NFE';
					v_file_input.id = 'SERIE_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = SERIE_NFE.value;
				
					lista_inputs += '<input type="hidden" name="SERIE_NFE_NFE_'+lista_count_NFE+'" id="SERIE_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DATA_EMISSAO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DATA_EMISSAO_NFE_NFE_'+lista_count_NFE+'" id="DATA_EMISSAO_NFE_NFE_'+lista_count_NFE+'" value="'+((DATA_EMISSAO_NFE.checked)?"1":"0")+'">';
				} else if (DATA_EMISSAO_NFE.type == 'file') {
					v_campo_file = document.forms[0].DATA_EMISSAO_NFE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DATA_EMISSAO_NFE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'DATA_EMISSAO_NFE_NFE_'+lista_count_NFE;
					v_file_input.name = 'DATA_EMISSAO_NFE';
					v_file_input.id = 'DATA_EMISSAO_NFE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DATA_EMISSAO_NFE.value;
				
					lista_inputs += '<input type="hidden" name="DATA_EMISSAO_NFE_NFE_'+lista_count_NFE+'" id="DATA_EMISSAO_NFE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_DOCUMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_DOCUMENTO_ID_NFE_'+lista_count_NFE+'" id="NFE_DOCUMENTO_ID_NFE_'+lista_count_NFE+'" value="'+((NFE_DOCUMENTO_ID.checked)?"1":"0")+'">';
				} else if (NFE_DOCUMENTO_ID.type == 'file') {
					v_campo_file = document.forms[0].NFE_DOCUMENTO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_DOCUMENTO_ID_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_DOCUMENTO_ID_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_DOCUMENTO_ID';
					v_file_input.id = 'NFE_DOCUMENTO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_DOCUMENTO_ID.value;
				
					lista_inputs += '<input type="hidden" name="NFE_DOCUMENTO_ID_NFE_'+lista_count_NFE+'" id="NFE_DOCUMENTO_ID_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_QTDE_VOLUME.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_QTDE_VOLUME_NFE_'+lista_count_NFE+'" id="NFE_QTDE_VOLUME_NFE_'+lista_count_NFE+'" value="'+((NFE_QTDE_VOLUME.checked)?"1":"0")+'">';
				} else if (NFE_QTDE_VOLUME.type == 'file') {
					v_campo_file = document.forms[0].NFE_QTDE_VOLUME;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_QTDE_VOLUME_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_QTDE_VOLUME_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_QTDE_VOLUME';
					v_file_input.id = 'NFE_QTDE_VOLUME';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_QTDE_VOLUME.value;
				
					lista_inputs += '<input type="hidden" name="NFE_QTDE_VOLUME_NFE_'+lista_count_NFE+'" id="NFE_QTDE_VOLUME_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_PESO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_NFE_'+lista_count_NFE+'" id="NFE_PESO_NFE_'+lista_count_NFE+'" value="'+((NFE_PESO.checked)?"1":"0")+'">';
				} else if (NFE_PESO.type == 'file') {
					v_campo_file = document.forms[0].NFE_PESO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_PESO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_PESO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_PESO';
					v_file_input.id = 'NFE_PESO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_PESO.value;
				
					lista_inputs += '<input type="hidden" name="NFE_PESO_NFE_'+lista_count_NFE+'" id="NFE_PESO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_COD_UNIDADE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_COD_UNIDADE_NFE_'+lista_count_NFE+'" id="NFE_COD_UNIDADE_NFE_'+lista_count_NFE+'" value="'+((NFE_COD_UNIDADE.checked)?"1":"0")+'">';
				} else if (NFE_COD_UNIDADE.type == 'file') {
					v_campo_file = document.forms[0].NFE_COD_UNIDADE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_COD_UNIDADE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_COD_UNIDADE_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_COD_UNIDADE';
					v_file_input.id = 'NFE_COD_UNIDADE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_COD_UNIDADE.value;
				
					lista_inputs += '<input type="hidden" name="NFE_COD_UNIDADE_NFE_'+lista_count_NFE+'" id="NFE_COD_UNIDADE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_M3.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_M3_NFE_'+lista_count_NFE+'" id="NFE_M3_NFE_'+lista_count_NFE+'" value="'+((NFE_M3.checked)?"1":"0")+'">';
				} else if (NFE_M3.type == 'file') {
					v_campo_file = document.forms[0].NFE_M3;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_M3_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_M3_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_M3';
					v_file_input.id = 'NFE_M3';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_M3.value;
				
					lista_inputs += '<input type="hidden" name="NFE_M3_NFE_'+lista_count_NFE+'" id="NFE_M3_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_PESO_CUBADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_CUBADO_NFE_'+lista_count_NFE+'" id="NFE_PESO_CUBADO_NFE_'+lista_count_NFE+'" value="'+((NFE_PESO_CUBADO.checked)?"1":"0")+'">';
				} else if (NFE_PESO_CUBADO.type == 'file') {
					v_campo_file = document.forms[0].NFE_PESO_CUBADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_PESO_CUBADO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_PESO_CUBADO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_PESO_CUBADO';
					v_file_input.id = 'NFE_PESO_CUBADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_PESO_CUBADO.value;
				
					lista_inputs += '<input type="hidden" name="NFE_PESO_CUBADO_NFE_'+lista_count_NFE+'" id="NFE_PESO_CUBADO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_CUBAGEM_SUGERIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_SUGERIDA_NFE_'+lista_count_NFE+'" id="NFE_CUBAGEM_SUGERIDA_NFE_'+lista_count_NFE+'" value="'+((NFE_CUBAGEM_SUGERIDA.checked)?"1":"0")+'">';
				} else if (NFE_CUBAGEM_SUGERIDA.type == 'file') {
					v_campo_file = document.forms[0].NFE_CUBAGEM_SUGERIDA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_CUBAGEM_SUGERIDA_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_CUBAGEM_SUGERIDA_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_CUBAGEM_SUGERIDA';
					v_file_input.id = 'NFE_CUBAGEM_SUGERIDA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_CUBAGEM_SUGERIDA.value;
				
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_SUGERIDA_NFE_'+lista_count_NFE+'" id="NFE_CUBAGEM_SUGERIDA_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_PESO_KG_CONVERTIDO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_KG_CONVERTIDO_NFE_'+lista_count_NFE+'" id="NFE_PESO_KG_CONVERTIDO_NFE_'+lista_count_NFE+'" value="'+((NFE_PESO_KG_CONVERTIDO.checked)?"1":"0")+'">';
				} else if (NFE_PESO_KG_CONVERTIDO.type == 'file') {
					v_campo_file = document.forms[0].NFE_PESO_KG_CONVERTIDO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_PESO_KG_CONVERTIDO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_PESO_KG_CONVERTIDO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_PESO_KG_CONVERTIDO';
					v_file_input.id = 'NFE_PESO_KG_CONVERTIDO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_PESO_KG_CONVERTIDO.value;
				
					lista_inputs += '<input type="hidden" name="NFE_PESO_KG_CONVERTIDO_NFE_'+lista_count_NFE+'" id="NFE_PESO_KG_CONVERTIDO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_NUM_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_NUM_NATUREZA_NFE_'+lista_count_NFE+'" id="NFE_NUM_NATUREZA_NFE_'+lista_count_NFE+'" value="'+((NFE_NUM_NATUREZA.checked)?"1":"0")+'">';
				} else if (NFE_NUM_NATUREZA.type == 'file') {
					v_campo_file = document.forms[0].NFE_NUM_NATUREZA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_NUM_NATUREZA_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_NUM_NATUREZA_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_NUM_NATUREZA';
					v_file_input.id = 'NFE_NUM_NATUREZA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_NUM_NATUREZA.value;
				
					lista_inputs += '<input type="hidden" name="NFE_NUM_NATUREZA_NFE_'+lista_count_NFE+'" id="NFE_NUM_NATUREZA_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_NATUREZA_NFE_'+lista_count_NFE+'" id="NFE_NATUREZA_NFE_'+lista_count_NFE+'" value="'+((NFE_NATUREZA.checked)?"1":"0")+'">';
				} else if (NFE_NATUREZA.type == 'file') {
					v_campo_file = document.forms[0].NFE_NATUREZA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_NATUREZA_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_NATUREZA_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_NATUREZA';
					v_file_input.id = 'NFE_NATUREZA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_NATUREZA.value;
				
					lista_inputs += '<input type="hidden" name="NFE_NATUREZA_NFE_'+lista_count_NFE+'" id="NFE_NATUREZA_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_COMPLEMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_COMPLEMENTO_NFE_'+lista_count_NFE+'" id="NFE_COMPLEMENTO_NFE_'+lista_count_NFE+'" value="'+((NFE_COMPLEMENTO.checked)?"1":"0")+'">';
				} else if (NFE_COMPLEMENTO.type == 'file') {
					v_campo_file = document.forms[0].NFE_COMPLEMENTO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_COMPLEMENTO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_COMPLEMENTO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_COMPLEMENTO';
					v_file_input.id = 'NFE_COMPLEMENTO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_COMPLEMENTO.value;
				
					lista_inputs += '<input type="hidden" name="NFE_COMPLEMENTO_NFE_'+lista_count_NFE+'" id="NFE_COMPLEMENTO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_NUM_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_NUM_ESPECIE_NFE_'+lista_count_NFE+'" id="NFE_NUM_ESPECIE_NFE_'+lista_count_NFE+'" value="'+((NFE_NUM_ESPECIE.checked)?"1":"0")+'">';
				} else if (NFE_NUM_ESPECIE.type == 'file') {
					v_campo_file = document.forms[0].NFE_NUM_ESPECIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_NUM_ESPECIE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_NUM_ESPECIE_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_NUM_ESPECIE';
					v_file_input.id = 'NFE_NUM_ESPECIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_NUM_ESPECIE.value;
				
					lista_inputs += '<input type="hidden" name="NFE_NUM_ESPECIE_NFE_'+lista_count_NFE+'" id="NFE_NUM_ESPECIE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ESPECIE_NFE_'+lista_count_NFE+'" id="NFE_ESPECIE_NFE_'+lista_count_NFE+'" value="'+((NFE_ESPECIE.checked)?"1":"0")+'">';
				} else if (NFE_ESPECIE.type == 'file') {
					v_campo_file = document.forms[0].NFE_ESPECIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_ESPECIE_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_ESPECIE_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_ESPECIE';
					v_file_input.id = 'NFE_ESPECIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_ESPECIE.value;
				
					lista_inputs += '<input type="hidden" name="NFE_ESPECIE_NFE_'+lista_count_NFE+'" id="NFE_ESPECIE_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_ALTURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ALTURA_NFE_'+lista_count_NFE+'" id="NFE_ALTURA_NFE_'+lista_count_NFE+'" value="'+((NFE_ALTURA.checked)?"1":"0")+'">';
				} else if (NFE_ALTURA.type == 'file') {
					v_campo_file = document.forms[0].NFE_ALTURA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_ALTURA_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_ALTURA_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_ALTURA';
					v_file_input.id = 'NFE_ALTURA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_ALTURA.value;
				
					lista_inputs += '<input type="hidden" name="NFE_ALTURA_NFE_'+lista_count_NFE+'" id="NFE_ALTURA_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_COMPRIMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_COMPRIMENTO_NFE_'+lista_count_NFE+'" id="NFE_COMPRIMENTO_NFE_'+lista_count_NFE+'" value="'+((NFE_COMPRIMENTO.checked)?"1":"0")+'">';
				} else if (NFE_COMPRIMENTO.type == 'file') {
					v_campo_file = document.forms[0].NFE_COMPRIMENTO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_COMPRIMENTO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_COMPRIMENTO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_COMPRIMENTO';
					v_file_input.id = 'NFE_COMPRIMENTO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_COMPRIMENTO.value;
				
					lista_inputs += '<input type="hidden" name="NFE_COMPRIMENTO_NFE_'+lista_count_NFE+'" id="NFE_COMPRIMENTO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_LARGURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_LARGURA_NFE_'+lista_count_NFE+'" id="NFE_LARGURA_NFE_'+lista_count_NFE+'" value="'+((NFE_LARGURA.checked)?"1":"0")+'">';
				} else if (NFE_LARGURA.type == 'file') {
					v_campo_file = document.forms[0].NFE_LARGURA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_LARGURA_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_LARGURA_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_LARGURA';
					v_file_input.id = 'NFE_LARGURA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_LARGURA.value;
				
					lista_inputs += '<input type="hidden" name="NFE_LARGURA_NFE_'+lista_count_NFE+'" id="NFE_LARGURA_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_CUBAGEM.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_NFE_'+lista_count_NFE+'" id="NFE_CUBAGEM_NFE_'+lista_count_NFE+'" value="'+((NFE_CUBAGEM.checked)?"1":"0")+'">';
				} else if (NFE_CUBAGEM.type == 'file') {
					v_campo_file = document.forms[0].NFE_CUBAGEM;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_CUBAGEM_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_CUBAGEM_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_CUBAGEM';
					v_file_input.id = 'NFE_CUBAGEM';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_CUBAGEM.value;
				
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_NFE_'+lista_count_NFE+'" id="NFE_CUBAGEM_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_PESO_COBRADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_COBRADO_NFE_'+lista_count_NFE+'" id="NFE_PESO_COBRADO_NFE_'+lista_count_NFE+'" value="'+((NFE_PESO_COBRADO.checked)?"1":"0")+'">';
				} else if (NFE_PESO_COBRADO.type == 'file') {
					v_campo_file = document.forms[0].NFE_PESO_COBRADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_PESO_COBRADO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_PESO_COBRADO_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_PESO_COBRADO';
					v_file_input.id = 'NFE_PESO_COBRADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_PESO_COBRADO.value;
				
					lista_inputs += '<input type="hidden" name="NFE_PESO_COBRADO_NFE_'+lista_count_NFE+'" id="NFE_PESO_COBRADO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_ORDEM_COMPRA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ORDEM_COMPRA_NFE_'+lista_count_NFE+'" id="NFE_ORDEM_COMPRA_NFE_'+lista_count_NFE+'" value="'+((NFE_ORDEM_COMPRA.checked)?"1":"0")+'">';
				} else if (NFE_ORDEM_COMPRA.type == 'file') {
					v_campo_file = document.forms[0].NFE_ORDEM_COMPRA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_ORDEM_COMPRA_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_ORDEM_COMPRA_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_ORDEM_COMPRA';
					v_file_input.id = 'NFE_ORDEM_COMPRA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_ORDEM_COMPRA.value;
				
					lista_inputs += '<input type="hidden" name="NFE_ORDEM_COMPRA_NFE_'+lista_count_NFE+'" id="NFE_ORDEM_COMPRA_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NFE_CFOP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_CFOP_NFE_'+lista_count_NFE+'" id="NFE_CFOP_NFE_'+lista_count_NFE+'" value="'+((NFE_CFOP.checked)?"1":"0")+'">';
				} else if (NFE_CFOP.type == 'file') {
					v_campo_file = document.forms[0].NFE_CFOP;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NFE_CFOP_NFE_'+lista_count_NFE;
					v_campo_file.name = 'NFE_CFOP_NFE_'+lista_count_NFE;
					v_file_input.name = 'NFE_CFOP';
					v_file_input.id = 'NFE_CFOP';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NFE_CFOP.value;
				
					lista_inputs += '<input type="hidden" name="NFE_CFOP_NFE_'+lista_count_NFE+'" id="NFE_CFOP_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				if (ICMS_PARTILHADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ICMS_PARTILHADO_NFE_'+lista_count_NFE+'" id="ICMS_PARTILHADO_NFE_'+lista_count_NFE+'" value="'+((ICMS_PARTILHADO.checked)?"1":"0")+'">';
				} else if (ICMS_PARTILHADO.type == 'file') {
					v_campo_file = document.forms[0].ICMS_PARTILHADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'ICMS_PARTILHADO_NFE_'+lista_count_NFE;
					v_campo_file.name = 'ICMS_PARTILHADO_NFE_'+lista_count_NFE;
					v_file_input.name = 'ICMS_PARTILHADO';
					v_file_input.id = 'ICMS_PARTILHADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = ICMS_PARTILHADO.value;
				
					lista_inputs += '<input type="hidden" name="ICMS_PARTILHADO_NFE_'+lista_count_NFE+'" id="ICMS_PARTILHADO_NFE_'+lista_count_NFE+'">';
				}
//				v_td.appendChild(v_input)
				
				v_dv1.innerHTML = '<img id="lista_padrao_NFE_'+lista_count_NFE+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				v_td.width = 16;
				
				v_td.style.display = 'none';
				
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+NUMERO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+MODELO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+SERIE_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+DATA_EMISSAO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+CHAVE_ACESSO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+NFE_VALOR.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				tbody.appendChild(v_tr);
				
				if (NF_CONHECIMENTO_ID.type != 'checkbox' && NF_CONHECIMENTO_ID.type != 'file') {
					document.getElementById('NF_CONHECIMENTO_ID_NFE_'+lista_count_NFE).value = NF_CONHECIMENTO_ID.value;
				}
				
				if (NFE_ID.type != 'checkbox' && NFE_ID.type != 'file') {
					document.getElementById('NFE_ID_NFE_'+lista_count_NFE).value = NFE_ID.value;
				}
				
				if (CHAVE_ACESSO_NFE.type != 'checkbox' && CHAVE_ACESSO_NFE.type != 'file') {
					document.getElementById('CHAVE_ACESSO_NFE_NFE_'+lista_count_NFE).value = CHAVE_ACESSO_NFE.value;
				}
				
				if (NFE_VALOR.type != 'checkbox' && NFE_VALOR.type != 'file') {
					document.getElementById('NFE_VALOR_NFE_'+lista_count_NFE).value = NFE_VALOR.value;
				}
				
				if (NFE_VALOR_SEGURADO.type != 'checkbox' && NFE_VALOR_SEGURADO.type != 'file') {
					document.getElementById('NFE_VALOR_SEGURADO_NFE_'+lista_count_NFE).value = NFE_VALOR_SEGURADO.value;
				}
				
				if (PIN_SUFRAMA_NFE.type != 'checkbox' && PIN_SUFRAMA_NFE.type != 'file') {
					document.getElementById('PIN_SUFRAMA_NFE_NFE_'+lista_count_NFE).value = PIN_SUFRAMA_NFE.value;
				}
				
				if (REMETENTE_NFE.type != 'checkbox' && REMETENTE_NFE.type != 'file') {
					document.getElementById('REMETENTE_NFE_NFE_'+lista_count_NFE).value = REMETENTE_NFE.value;
				}
				
				if (CNPJ_REMETENTE_NFE.type != 'checkbox' && CNPJ_REMETENTE_NFE.type != 'file') {
					document.getElementById('CNPJ_REMETENTE_NFE_NFE_'+lista_count_NFE).value = CNPJ_REMETENTE_NFE.value;
				}
				
				if (DESTINATARIO_NFE.type != 'checkbox' && DESTINATARIO_NFE.type != 'file') {
					document.getElementById('DESTINATARIO_NFE_NFE_'+lista_count_NFE).value = DESTINATARIO_NFE.value;
				}
				
				if (CNPJ_DESTINATARIO_NFE.type != 'checkbox' && CNPJ_DESTINATARIO_NFE.type != 'file') {
					document.getElementById('CNPJ_DESTINATARIO_NFE_NFE_'+lista_count_NFE).value = CNPJ_DESTINATARIO_NFE.value;
				}
				
				if (NOME_ARQUIVO.type != 'checkbox' && NOME_ARQUIVO.type != 'file') {
					document.getElementById('NOME_ARQUIVO_NFE_'+lista_count_NFE).value = NOME_ARQUIVO.value;
				}
				
				if (NUMERO_NFE.type != 'checkbox' && NUMERO_NFE.type != 'file') {
					document.getElementById('NUMERO_NFE_NFE_'+lista_count_NFE).value = NUMERO_NFE.value;
				}
				
				if (MODELO_NFE.type != 'checkbox' && MODELO_NFE.type != 'file') {
					document.getElementById('MODELO_NFE_NFE_'+lista_count_NFE).value = MODELO_NFE.value;
				}
				
				if (SERIE_NFE.type != 'checkbox' && SERIE_NFE.type != 'file') {
					document.getElementById('SERIE_NFE_NFE_'+lista_count_NFE).value = SERIE_NFE.value;
				}
				
				if (DATA_EMISSAO_NFE.type != 'checkbox' && DATA_EMISSAO_NFE.type != 'file') {
					document.getElementById('DATA_EMISSAO_NFE_NFE_'+lista_count_NFE).value = DATA_EMISSAO_NFE.value;
				}
				
				if (NFE_DOCUMENTO_ID.type != 'checkbox' && NFE_DOCUMENTO_ID.type != 'file') {
					document.getElementById('NFE_DOCUMENTO_ID_NFE_'+lista_count_NFE).value = NFE_DOCUMENTO_ID.value;
				}
				
				if (NFE_QTDE_VOLUME.type != 'checkbox' && NFE_QTDE_VOLUME.type != 'file') {
					document.getElementById('NFE_QTDE_VOLUME_NFE_'+lista_count_NFE).value = NFE_QTDE_VOLUME.value;
				}
				
				if (NFE_PESO.type != 'checkbox' && NFE_PESO.type != 'file') {
					document.getElementById('NFE_PESO_NFE_'+lista_count_NFE).value = NFE_PESO.value;
				}
				
				if (NFE_COD_UNIDADE.type != 'checkbox' && NFE_COD_UNIDADE.type != 'file') {
					document.getElementById('NFE_COD_UNIDADE_NFE_'+lista_count_NFE).value = NFE_COD_UNIDADE.value;
				}
				
				if (NFE_M3.type != 'checkbox' && NFE_M3.type != 'file') {
					document.getElementById('NFE_M3_NFE_'+lista_count_NFE).value = NFE_M3.value;
				}
				
				if (NFE_PESO_CUBADO.type != 'checkbox' && NFE_PESO_CUBADO.type != 'file') {
					document.getElementById('NFE_PESO_CUBADO_NFE_'+lista_count_NFE).value = NFE_PESO_CUBADO.value;
				}
				
				if (NFE_CUBAGEM_SUGERIDA.type != 'checkbox' && NFE_CUBAGEM_SUGERIDA.type != 'file') {
					document.getElementById('NFE_CUBAGEM_SUGERIDA_NFE_'+lista_count_NFE).value = NFE_CUBAGEM_SUGERIDA.value;
				}
				
				if (NFE_PESO_KG_CONVERTIDO.type != 'checkbox' && NFE_PESO_KG_CONVERTIDO.type != 'file') {
					document.getElementById('NFE_PESO_KG_CONVERTIDO_NFE_'+lista_count_NFE).value = NFE_PESO_KG_CONVERTIDO.value;
				}
				
				if (NFE_NUM_NATUREZA.type != 'checkbox' && NFE_NUM_NATUREZA.type != 'file') {
					document.getElementById('NFE_NUM_NATUREZA_NFE_'+lista_count_NFE).value = NFE_NUM_NATUREZA.value;
				}
				
				if (NFE_NATUREZA.type != 'checkbox' && NFE_NATUREZA.type != 'file') {
					document.getElementById('NFE_NATUREZA_NFE_'+lista_count_NFE).value = NFE_NATUREZA.value;
				}
				
				if (NFE_COMPLEMENTO.type != 'checkbox' && NFE_COMPLEMENTO.type != 'file') {
					document.getElementById('NFE_COMPLEMENTO_NFE_'+lista_count_NFE).value = NFE_COMPLEMENTO.value;
				}
				
				if (NFE_NUM_ESPECIE.type != 'checkbox' && NFE_NUM_ESPECIE.type != 'file') {
					document.getElementById('NFE_NUM_ESPECIE_NFE_'+lista_count_NFE).value = NFE_NUM_ESPECIE.value;
				}
				
				if (NFE_ESPECIE.type != 'checkbox' && NFE_ESPECIE.type != 'file') {
					document.getElementById('NFE_ESPECIE_NFE_'+lista_count_NFE).value = NFE_ESPECIE.value;
				}
				
				if (NFE_ALTURA.type != 'checkbox' && NFE_ALTURA.type != 'file') {
					document.getElementById('NFE_ALTURA_NFE_'+lista_count_NFE).value = NFE_ALTURA.value;
				}
				
				if (NFE_COMPRIMENTO.type != 'checkbox' && NFE_COMPRIMENTO.type != 'file') {
					document.getElementById('NFE_COMPRIMENTO_NFE_'+lista_count_NFE).value = NFE_COMPRIMENTO.value;
				}
				
				if (NFE_LARGURA.type != 'checkbox' && NFE_LARGURA.type != 'file') {
					document.getElementById('NFE_LARGURA_NFE_'+lista_count_NFE).value = NFE_LARGURA.value;
				}
				
				if (NFE_CUBAGEM.type != 'checkbox' && NFE_CUBAGEM.type != 'file') {
					document.getElementById('NFE_CUBAGEM_NFE_'+lista_count_NFE).value = NFE_CUBAGEM.value;
				}
				
				if (NFE_PESO_COBRADO.type != 'checkbox' && NFE_PESO_COBRADO.type != 'file') {
					document.getElementById('NFE_PESO_COBRADO_NFE_'+lista_count_NFE).value = NFE_PESO_COBRADO.value;
				}
				
				if (NFE_ORDEM_COMPRA.type != 'checkbox' && NFE_ORDEM_COMPRA.type != 'file') {
					document.getElementById('NFE_ORDEM_COMPRA_NFE_'+lista_count_NFE).value = NFE_ORDEM_COMPRA.value;
				}
				
				if (NFE_CFOP.type != 'checkbox' && NFE_CFOP.type != 'file') {
					document.getElementById('NFE_CFOP_NFE_'+lista_count_NFE).value = NFE_CFOP.value;
				}
				
				if (ICMS_PARTILHADO.type != 'checkbox' && ICMS_PARTILHADO.type != 'file') {
					document.getElementById('ICMS_PARTILHADO_NFE_'+lista_count_NFE).value = ICMS_PARTILHADO.value;
				}
				

				lista_count_NFE++;
				f_atualiza_campos_escravos_NFE();
				f_incluir_NFE();
			} else {
				var v_tr = document.getElementById('tr_lista_NFE_'+lista_selected_NFE.value);
				padrao = (document.getElementById('PADRAO_NFE_'+lista_selected_NFE.value).value == 1);
				lista_inputs = '<input type="hidden" name="PADRAO_NFE_'+lista_selected_NFE.value+'" value="'+((padrao)?1:0)+'">';
				
				if (NF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NFE_'+lista_selected_NFE.value+'" value="'+((NF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
					document.getElementById('NF_CONHECIMENTO_ID_NFE_'+lista_selected_NFE.value).value = ((NF_CONHECIMENTO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_NFE_'+lista_selected_NFE.value+'" value="'+NF_CONHECIMENTO_ID.value+'">';
					document.getElementById('NF_CONHECIMENTO_ID_NFE_'+lista_selected_NFE.value).value = NF_CONHECIMENTO_ID.value;
				}
				
				if (NFE_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ID_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_ID.checked)?"1":"0")+'">';
					document.getElementById('NFE_ID_NFE_'+lista_selected_NFE.value).value = ((NFE_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_ID_NFE_'+lista_selected_NFE.value+'" value="'+NFE_ID.value+'">';
					document.getElementById('NFE_ID_NFE_'+lista_selected_NFE.value).value = NFE_ID.value;
				}
				
				if (CHAVE_ACESSO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CHAVE_ACESSO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((CHAVE_ACESSO_NFE.checked)?"1":"0")+'">';
					document.getElementById('CHAVE_ACESSO_NFE_NFE_'+lista_selected_NFE.value).value = ((CHAVE_ACESSO_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CHAVE_ACESSO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+CHAVE_ACESSO_NFE.value+'">';
					document.getElementById('CHAVE_ACESSO_NFE_NFE_'+lista_selected_NFE.value).value = CHAVE_ACESSO_NFE.value;
				}
				
				if (NFE_VALOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_VALOR_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_VALOR.checked)?"1":"0")+'">';
					document.getElementById('NFE_VALOR_NFE_'+lista_selected_NFE.value).value = ((NFE_VALOR.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_VALOR_NFE_'+lista_selected_NFE.value+'" value="'+NFE_VALOR.value+'">';
					document.getElementById('NFE_VALOR_NFE_'+lista_selected_NFE.value).value = NFE_VALOR.value;
				}
				
				if (NFE_VALOR_SEGURADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_VALOR_SEGURADO_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_VALOR_SEGURADO.checked)?"1":"0")+'">';
					document.getElementById('NFE_VALOR_SEGURADO_NFE_'+lista_selected_NFE.value).value = ((NFE_VALOR_SEGURADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_VALOR_SEGURADO_NFE_'+lista_selected_NFE.value+'" value="'+NFE_VALOR_SEGURADO.value+'">';
					document.getElementById('NFE_VALOR_SEGURADO_NFE_'+lista_selected_NFE.value).value = NFE_VALOR_SEGURADO.value;
				}
				
				if (PIN_SUFRAMA_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="PIN_SUFRAMA_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((PIN_SUFRAMA_NFE.checked)?"1":"0")+'">';
					document.getElementById('PIN_SUFRAMA_NFE_NFE_'+lista_selected_NFE.value).value = ((PIN_SUFRAMA_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="PIN_SUFRAMA_NFE_NFE_'+lista_selected_NFE.value+'" value="'+PIN_SUFRAMA_NFE.value+'">';
					document.getElementById('PIN_SUFRAMA_NFE_NFE_'+lista_selected_NFE.value).value = PIN_SUFRAMA_NFE.value;
				}
				
				if (REMETENTE_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REMETENTE_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((REMETENTE_NFE.checked)?"1":"0")+'">';
					document.getElementById('REMETENTE_NFE_NFE_'+lista_selected_NFE.value).value = ((REMETENTE_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="REMETENTE_NFE_NFE_'+lista_selected_NFE.value+'" value="'+REMETENTE_NFE.value+'">';
					document.getElementById('REMETENTE_NFE_NFE_'+lista_selected_NFE.value).value = REMETENTE_NFE.value;
				}
				
				if (CNPJ_REMETENTE_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CNPJ_REMETENTE_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((CNPJ_REMETENTE_NFE.checked)?"1":"0")+'">';
					document.getElementById('CNPJ_REMETENTE_NFE_NFE_'+lista_selected_NFE.value).value = ((CNPJ_REMETENTE_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CNPJ_REMETENTE_NFE_NFE_'+lista_selected_NFE.value+'" value="'+CNPJ_REMETENTE_NFE.value+'">';
					document.getElementById('CNPJ_REMETENTE_NFE_NFE_'+lista_selected_NFE.value).value = CNPJ_REMETENTE_NFE.value;
				}
				
				if (DESTINATARIO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((DESTINATARIO_NFE.checked)?"1":"0")+'">';
					document.getElementById('DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value).value = ((DESTINATARIO_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+DESTINATARIO_NFE.value+'">';
					document.getElementById('DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value).value = DESTINATARIO_NFE.value;
				}
				
				if (CNPJ_DESTINATARIO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CNPJ_DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((CNPJ_DESTINATARIO_NFE.checked)?"1":"0")+'">';
					document.getElementById('CNPJ_DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value).value = ((CNPJ_DESTINATARIO_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CNPJ_DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+CNPJ_DESTINATARIO_NFE.value+'">';
					document.getElementById('CNPJ_DESTINATARIO_NFE_NFE_'+lista_selected_NFE.value).value = CNPJ_DESTINATARIO_NFE.value;
				}
				
				if (NOME_ARQUIVO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NOME_ARQUIVO_NFE_'+lista_selected_NFE.value+'" value="'+((NOME_ARQUIVO.checked)?"1":"0")+'">';
					document.getElementById('NOME_ARQUIVO_NFE_'+lista_selected_NFE.value).value = ((NOME_ARQUIVO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NOME_ARQUIVO_NFE_'+lista_selected_NFE.value+'" value="'+NOME_ARQUIVO.value+'">';
					document.getElementById('NOME_ARQUIVO_NFE_'+lista_selected_NFE.value).value = NOME_ARQUIVO.value;
				}
				
				if (NUMERO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NUMERO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((NUMERO_NFE.checked)?"1":"0")+'">';
					document.getElementById('NUMERO_NFE_NFE_'+lista_selected_NFE.value).value = ((NUMERO_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NUMERO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+NUMERO_NFE.value+'">';
					document.getElementById('NUMERO_NFE_NFE_'+lista_selected_NFE.value).value = NUMERO_NFE.value;
				}
				
				if (MODELO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="MODELO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((MODELO_NFE.checked)?"1":"0")+'">';
					document.getElementById('MODELO_NFE_NFE_'+lista_selected_NFE.value).value = ((MODELO_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="MODELO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+MODELO_NFE.value+'">';
					document.getElementById('MODELO_NFE_NFE_'+lista_selected_NFE.value).value = MODELO_NFE.value;
				}
				
				if (SERIE_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="SERIE_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((SERIE_NFE.checked)?"1":"0")+'">';
					document.getElementById('SERIE_NFE_NFE_'+lista_selected_NFE.value).value = ((SERIE_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="SERIE_NFE_NFE_'+lista_selected_NFE.value+'" value="'+SERIE_NFE.value+'">';
					document.getElementById('SERIE_NFE_NFE_'+lista_selected_NFE.value).value = SERIE_NFE.value;
				}
				
				if (DATA_EMISSAO_NFE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DATA_EMISSAO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+((DATA_EMISSAO_NFE.checked)?"1":"0")+'">';
					document.getElementById('DATA_EMISSAO_NFE_NFE_'+lista_selected_NFE.value).value = ((DATA_EMISSAO_NFE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DATA_EMISSAO_NFE_NFE_'+lista_selected_NFE.value+'" value="'+DATA_EMISSAO_NFE.value+'">';
					document.getElementById('DATA_EMISSAO_NFE_NFE_'+lista_selected_NFE.value).value = DATA_EMISSAO_NFE.value;
				}
				
				if (NFE_DOCUMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_DOCUMENTO_ID_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_DOCUMENTO_ID.checked)?"1":"0")+'">';
					document.getElementById('NFE_DOCUMENTO_ID_NFE_'+lista_selected_NFE.value).value = ((NFE_DOCUMENTO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_DOCUMENTO_ID_NFE_'+lista_selected_NFE.value+'" value="'+NFE_DOCUMENTO_ID.value+'">';
					document.getElementById('NFE_DOCUMENTO_ID_NFE_'+lista_selected_NFE.value).value = NFE_DOCUMENTO_ID.value;
				}
				
				if (NFE_QTDE_VOLUME.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_QTDE_VOLUME_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_QTDE_VOLUME.checked)?"1":"0")+'">';
					document.getElementById('NFE_QTDE_VOLUME_NFE_'+lista_selected_NFE.value).value = ((NFE_QTDE_VOLUME.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_QTDE_VOLUME_NFE_'+lista_selected_NFE.value+'" value="'+NFE_QTDE_VOLUME.value+'">';
					document.getElementById('NFE_QTDE_VOLUME_NFE_'+lista_selected_NFE.value).value = NFE_QTDE_VOLUME.value;
				}
				
				if (NFE_PESO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_PESO.checked)?"1":"0")+'">';
					document.getElementById('NFE_PESO_NFE_'+lista_selected_NFE.value).value = ((NFE_PESO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_PESO_NFE_'+lista_selected_NFE.value+'" value="'+NFE_PESO.value+'">';
					document.getElementById('NFE_PESO_NFE_'+lista_selected_NFE.value).value = NFE_PESO.value;
				}
				
				if (NFE_COD_UNIDADE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_COD_UNIDADE_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_COD_UNIDADE.checked)?"1":"0")+'">';
					document.getElementById('NFE_COD_UNIDADE_NFE_'+lista_selected_NFE.value).value = ((NFE_COD_UNIDADE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_COD_UNIDADE_NFE_'+lista_selected_NFE.value+'" value="'+NFE_COD_UNIDADE.value+'">';
					document.getElementById('NFE_COD_UNIDADE_NFE_'+lista_selected_NFE.value).value = NFE_COD_UNIDADE.value;
				}
				
				if (NFE_M3.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_M3_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_M3.checked)?"1":"0")+'">';
					document.getElementById('NFE_M3_NFE_'+lista_selected_NFE.value).value = ((NFE_M3.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_M3_NFE_'+lista_selected_NFE.value+'" value="'+NFE_M3.value+'">';
					document.getElementById('NFE_M3_NFE_'+lista_selected_NFE.value).value = NFE_M3.value;
				}
				
				if (NFE_PESO_CUBADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_CUBADO_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_PESO_CUBADO.checked)?"1":"0")+'">';
					document.getElementById('NFE_PESO_CUBADO_NFE_'+lista_selected_NFE.value).value = ((NFE_PESO_CUBADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_PESO_CUBADO_NFE_'+lista_selected_NFE.value+'" value="'+NFE_PESO_CUBADO.value+'">';
					document.getElementById('NFE_PESO_CUBADO_NFE_'+lista_selected_NFE.value).value = NFE_PESO_CUBADO.value;
				}
				
				if (NFE_CUBAGEM_SUGERIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_SUGERIDA_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_CUBAGEM_SUGERIDA.checked)?"1":"0")+'">';
					document.getElementById('NFE_CUBAGEM_SUGERIDA_NFE_'+lista_selected_NFE.value).value = ((NFE_CUBAGEM_SUGERIDA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_SUGERIDA_NFE_'+lista_selected_NFE.value+'" value="'+NFE_CUBAGEM_SUGERIDA.value+'">';
					document.getElementById('NFE_CUBAGEM_SUGERIDA_NFE_'+lista_selected_NFE.value).value = NFE_CUBAGEM_SUGERIDA.value;
				}
				
				if (NFE_PESO_KG_CONVERTIDO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_KG_CONVERTIDO_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_PESO_KG_CONVERTIDO.checked)?"1":"0")+'">';
					document.getElementById('NFE_PESO_KG_CONVERTIDO_NFE_'+lista_selected_NFE.value).value = ((NFE_PESO_KG_CONVERTIDO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_PESO_KG_CONVERTIDO_NFE_'+lista_selected_NFE.value+'" value="'+NFE_PESO_KG_CONVERTIDO.value+'">';
					document.getElementById('NFE_PESO_KG_CONVERTIDO_NFE_'+lista_selected_NFE.value).value = NFE_PESO_KG_CONVERTIDO.value;
				}
				
				if (NFE_NUM_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_NUM_NATUREZA_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_NUM_NATUREZA.checked)?"1":"0")+'">';
					document.getElementById('NFE_NUM_NATUREZA_NFE_'+lista_selected_NFE.value).value = ((NFE_NUM_NATUREZA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_NUM_NATUREZA_NFE_'+lista_selected_NFE.value+'" value="'+NFE_NUM_NATUREZA.value+'">';
					document.getElementById('NFE_NUM_NATUREZA_NFE_'+lista_selected_NFE.value).value = NFE_NUM_NATUREZA.value;
				}
				
				if (NFE_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_NATUREZA_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_NATUREZA.checked)?"1":"0")+'">';
					document.getElementById('NFE_NATUREZA_NFE_'+lista_selected_NFE.value).value = ((NFE_NATUREZA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_NATUREZA_NFE_'+lista_selected_NFE.value+'" value="'+NFE_NATUREZA.value+'">';
					document.getElementById('NFE_NATUREZA_NFE_'+lista_selected_NFE.value).value = NFE_NATUREZA.value;
				}
				
				if (NFE_COMPLEMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_COMPLEMENTO_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_COMPLEMENTO.checked)?"1":"0")+'">';
					document.getElementById('NFE_COMPLEMENTO_NFE_'+lista_selected_NFE.value).value = ((NFE_COMPLEMENTO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_COMPLEMENTO_NFE_'+lista_selected_NFE.value+'" value="'+NFE_COMPLEMENTO.value+'">';
					document.getElementById('NFE_COMPLEMENTO_NFE_'+lista_selected_NFE.value).value = NFE_COMPLEMENTO.value;
				}
				
				if (NFE_NUM_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_NUM_ESPECIE_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_NUM_ESPECIE.checked)?"1":"0")+'">';
					document.getElementById('NFE_NUM_ESPECIE_NFE_'+lista_selected_NFE.value).value = ((NFE_NUM_ESPECIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_NUM_ESPECIE_NFE_'+lista_selected_NFE.value+'" value="'+NFE_NUM_ESPECIE.value+'">';
					document.getElementById('NFE_NUM_ESPECIE_NFE_'+lista_selected_NFE.value).value = NFE_NUM_ESPECIE.value;
				}
				
				if (NFE_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ESPECIE_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_ESPECIE.checked)?"1":"0")+'">';
					document.getElementById('NFE_ESPECIE_NFE_'+lista_selected_NFE.value).value = ((NFE_ESPECIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_ESPECIE_NFE_'+lista_selected_NFE.value+'" value="'+NFE_ESPECIE.value+'">';
					document.getElementById('NFE_ESPECIE_NFE_'+lista_selected_NFE.value).value = NFE_ESPECIE.value;
				}
				
				if (NFE_ALTURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ALTURA_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_ALTURA.checked)?"1":"0")+'">';
					document.getElementById('NFE_ALTURA_NFE_'+lista_selected_NFE.value).value = ((NFE_ALTURA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_ALTURA_NFE_'+lista_selected_NFE.value+'" value="'+NFE_ALTURA.value+'">';
					document.getElementById('NFE_ALTURA_NFE_'+lista_selected_NFE.value).value = NFE_ALTURA.value;
				}
				
				if (NFE_COMPRIMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_COMPRIMENTO_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_COMPRIMENTO.checked)?"1":"0")+'">';
					document.getElementById('NFE_COMPRIMENTO_NFE_'+lista_selected_NFE.value).value = ((NFE_COMPRIMENTO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_COMPRIMENTO_NFE_'+lista_selected_NFE.value+'" value="'+NFE_COMPRIMENTO.value+'">';
					document.getElementById('NFE_COMPRIMENTO_NFE_'+lista_selected_NFE.value).value = NFE_COMPRIMENTO.value;
				}
				
				if (NFE_LARGURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_LARGURA_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_LARGURA.checked)?"1":"0")+'">';
					document.getElementById('NFE_LARGURA_NFE_'+lista_selected_NFE.value).value = ((NFE_LARGURA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_LARGURA_NFE_'+lista_selected_NFE.value+'" value="'+NFE_LARGURA.value+'">';
					document.getElementById('NFE_LARGURA_NFE_'+lista_selected_NFE.value).value = NFE_LARGURA.value;
				}
				
				if (NFE_CUBAGEM.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_CUBAGEM.checked)?"1":"0")+'">';
					document.getElementById('NFE_CUBAGEM_NFE_'+lista_selected_NFE.value).value = ((NFE_CUBAGEM.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_CUBAGEM_NFE_'+lista_selected_NFE.value+'" value="'+NFE_CUBAGEM.value+'">';
					document.getElementById('NFE_CUBAGEM_NFE_'+lista_selected_NFE.value).value = NFE_CUBAGEM.value;
				}
				
				if (NFE_PESO_COBRADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_PESO_COBRADO_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_PESO_COBRADO.checked)?"1":"0")+'">';
					document.getElementById('NFE_PESO_COBRADO_NFE_'+lista_selected_NFE.value).value = ((NFE_PESO_COBRADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_PESO_COBRADO_NFE_'+lista_selected_NFE.value+'" value="'+NFE_PESO_COBRADO.value+'">';
					document.getElementById('NFE_PESO_COBRADO_NFE_'+lista_selected_NFE.value).value = NFE_PESO_COBRADO.value;
				}
				
				if (NFE_ORDEM_COMPRA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_ORDEM_COMPRA_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_ORDEM_COMPRA.checked)?"1":"0")+'">';
					document.getElementById('NFE_ORDEM_COMPRA_NFE_'+lista_selected_NFE.value).value = ((NFE_ORDEM_COMPRA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_ORDEM_COMPRA_NFE_'+lista_selected_NFE.value+'" value="'+NFE_ORDEM_COMPRA.value+'">';
					document.getElementById('NFE_ORDEM_COMPRA_NFE_'+lista_selected_NFE.value).value = NFE_ORDEM_COMPRA.value;
				}
				
				if (NFE_CFOP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NFE_CFOP_NFE_'+lista_selected_NFE.value+'" value="'+((NFE_CFOP.checked)?"1":"0")+'">';
					document.getElementById('NFE_CFOP_NFE_'+lista_selected_NFE.value).value = ((NFE_CFOP.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NFE_CFOP_NFE_'+lista_selected_NFE.value+'" value="'+NFE_CFOP.value+'">';
					document.getElementById('NFE_CFOP_NFE_'+lista_selected_NFE.value).value = NFE_CFOP.value;
				}
				
				if (ICMS_PARTILHADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ICMS_PARTILHADO_NFE_'+lista_selected_NFE.value+'" value="'+((ICMS_PARTILHADO.checked)?"1":"0")+'">';
					document.getElementById('ICMS_PARTILHADO_NFE_'+lista_selected_NFE.value).value = ((ICMS_PARTILHADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="ICMS_PARTILHADO_NFE_'+lista_selected_NFE.value+'" value="'+ICMS_PARTILHADO.value+'">';
					document.getElementById('ICMS_PARTILHADO_NFE_'+lista_selected_NFE.value).value = ICMS_PARTILHADO.value;
				}
				
//				v_tr.cells[0].innerHTML = '<img id="lista_padrao_NFE_'+lista_selected_NFE.value+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				
					var v_td = v_tr.cells[1];
					v_td.innerHTML = ''+NUMERO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[2];
					v_td.innerHTML = ''+MODELO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[3];
					v_td.innerHTML = ''+SERIE_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[4];
					v_td.innerHTML = ''+DATA_EMISSAO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[5];
					v_td.innerHTML = ''+CHAVE_ACESSO_NFE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[6];
					v_td.innerHTML = ''+NFE_VALOR.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
								
				f_atualiza_campos_escravos_NFE();
				f_incluir_NFE();
			}
		}
			
		
		f_on_salva_lista_NFE();
	}
}
function f_cancelar_NFE() {
	var tbody = document.getElementById('tb_lista_NFE');		
	for(var i=0;i<tbody.rows.length;i++) {
		for(var j=0;j<tbody.rows[i].cells.length;j++) {
			tbody.rows[i].cells[j].className = 'linha_1';
		}
	}
	with(document.forms[0]) {
	
		

		if(document.getElementById('NF_CONHECIMENTO_ID').getAttribute('type') != 'file') {
		  if (!NF_CONHECIMENTO_ID.getAttribute('manter') || NF_CONHECIMENTO_ID.getAttribute('manter') == 0) {
				if(NF_CONHECIMENTO_ID.type == 'checkbox') {
					NF_CONHECIMENTO_ID.checked = false;
				} else if(NF_CONHECIMENTO_ID.type == 'select-one') {
					NF_CONHECIMENTO_ID.selectedIndex = 0;
				} else {
					NF_CONHECIMENTO_ID.value = '';
				}
				
				try {
					NF_CONHECIMENTO_ID.focus();
				} catch(e) {
				}
				
			}
		}
		

		if(document.getElementById('NFE_ID').getAttribute('type') != 'file') {
		  if (!NFE_ID.getAttribute('manter') || NFE_ID.getAttribute('manter') == 0) {
				if(NFE_ID.type == 'checkbox') {
					NFE_ID.checked = false;
				} else if(NFE_ID.type == 'select-one') {
					NFE_ID.selectedIndex = 0;
				} else {
					NFE_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CHAVE_ACESSO_NFE').getAttribute('type') != 'file') {
		  if (!CHAVE_ACESSO_NFE.getAttribute('manter') || CHAVE_ACESSO_NFE.getAttribute('manter') == 0) {
				if(CHAVE_ACESSO_NFE.type == 'checkbox') {
					CHAVE_ACESSO_NFE.checked = false;
				} else if(CHAVE_ACESSO_NFE.type == 'select-one') {
					CHAVE_ACESSO_NFE.selectedIndex = 0;
				} else {
					CHAVE_ACESSO_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_VALOR').getAttribute('type') != 'file') {
		  if (!NFE_VALOR.getAttribute('manter') || NFE_VALOR.getAttribute('manter') == 0) {
				if(NFE_VALOR.type == 'checkbox') {
					NFE_VALOR.checked = false;
				} else if(NFE_VALOR.type == 'select-one') {
					NFE_VALOR.selectedIndex = 0;
				} else {
					NFE_VALOR.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_VALOR_SEGURADO').getAttribute('type') != 'file') {
		  if (!NFE_VALOR_SEGURADO.getAttribute('manter') || NFE_VALOR_SEGURADO.getAttribute('manter') == 0) {
				if(NFE_VALOR_SEGURADO.type == 'checkbox') {
					NFE_VALOR_SEGURADO.checked = false;
				} else if(NFE_VALOR_SEGURADO.type == 'select-one') {
					NFE_VALOR_SEGURADO.selectedIndex = 0;
				} else {
					NFE_VALOR_SEGURADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('PIN_SUFRAMA_NFE').getAttribute('type') != 'file') {
		  if (!PIN_SUFRAMA_NFE.getAttribute('manter') || PIN_SUFRAMA_NFE.getAttribute('manter') == 0) {
				if(PIN_SUFRAMA_NFE.type == 'checkbox') {
					PIN_SUFRAMA_NFE.checked = false;
				} else if(PIN_SUFRAMA_NFE.type == 'select-one') {
					PIN_SUFRAMA_NFE.selectedIndex = 0;
				} else {
					PIN_SUFRAMA_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('REMETENTE_NFE').getAttribute('type') != 'file') {
		  if (!REMETENTE_NFE.getAttribute('manter') || REMETENTE_NFE.getAttribute('manter') == 0) {
				if(REMETENTE_NFE.type == 'checkbox') {
					REMETENTE_NFE.checked = false;
				} else if(REMETENTE_NFE.type == 'select-one') {
					REMETENTE_NFE.selectedIndex = 0;
				} else {
					REMETENTE_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CNPJ_REMETENTE_NFE').getAttribute('type') != 'file') {
		  if (!CNPJ_REMETENTE_NFE.getAttribute('manter') || CNPJ_REMETENTE_NFE.getAttribute('manter') == 0) {
				if(CNPJ_REMETENTE_NFE.type == 'checkbox') {
					CNPJ_REMETENTE_NFE.checked = false;
				} else if(CNPJ_REMETENTE_NFE.type == 'select-one') {
					CNPJ_REMETENTE_NFE.selectedIndex = 0;
				} else {
					CNPJ_REMETENTE_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DESTINATARIO_NFE').getAttribute('type') != 'file') {
		  if (!DESTINATARIO_NFE.getAttribute('manter') || DESTINATARIO_NFE.getAttribute('manter') == 0) {
				if(DESTINATARIO_NFE.type == 'checkbox') {
					DESTINATARIO_NFE.checked = false;
				} else if(DESTINATARIO_NFE.type == 'select-one') {
					DESTINATARIO_NFE.selectedIndex = 0;
				} else {
					DESTINATARIO_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CNPJ_DESTINATARIO_NFE').getAttribute('type') != 'file') {
		  if (!CNPJ_DESTINATARIO_NFE.getAttribute('manter') || CNPJ_DESTINATARIO_NFE.getAttribute('manter') == 0) {
				if(CNPJ_DESTINATARIO_NFE.type == 'checkbox') {
					CNPJ_DESTINATARIO_NFE.checked = false;
				} else if(CNPJ_DESTINATARIO_NFE.type == 'select-one') {
					CNPJ_DESTINATARIO_NFE.selectedIndex = 0;
				} else {
					CNPJ_DESTINATARIO_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NOME_ARQUIVO').getAttribute('type') != 'file') {
		  if (!NOME_ARQUIVO.getAttribute('manter') || NOME_ARQUIVO.getAttribute('manter') == 0) {
				if(NOME_ARQUIVO.type == 'checkbox') {
					NOME_ARQUIVO.checked = false;
				} else if(NOME_ARQUIVO.type == 'select-one') {
					NOME_ARQUIVO.selectedIndex = 0;
				} else {
					NOME_ARQUIVO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NUMERO_NFE').getAttribute('type') != 'file') {
		  if (!NUMERO_NFE.getAttribute('manter') || NUMERO_NFE.getAttribute('manter') == 0) {
				if(NUMERO_NFE.type == 'checkbox') {
					NUMERO_NFE.checked = false;
				} else if(NUMERO_NFE.type == 'select-one') {
					NUMERO_NFE.selectedIndex = 0;
				} else {
					NUMERO_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('MODELO_NFE').getAttribute('type') != 'file') {
		  if (!MODELO_NFE.getAttribute('manter') || MODELO_NFE.getAttribute('manter') == 0) {
				if(MODELO_NFE.type == 'checkbox') {
					MODELO_NFE.checked = false;
				} else if(MODELO_NFE.type == 'select-one') {
					MODELO_NFE.selectedIndex = 0;
				} else {
					MODELO_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('SERIE_NFE').getAttribute('type') != 'file') {
		  if (!SERIE_NFE.getAttribute('manter') || SERIE_NFE.getAttribute('manter') == 0) {
				if(SERIE_NFE.type == 'checkbox') {
					SERIE_NFE.checked = false;
				} else if(SERIE_NFE.type == 'select-one') {
					SERIE_NFE.selectedIndex = 0;
				} else {
					SERIE_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DATA_EMISSAO_NFE').getAttribute('type') != 'file') {
		  if (!DATA_EMISSAO_NFE.getAttribute('manter') || DATA_EMISSAO_NFE.getAttribute('manter') == 0) {
				if(DATA_EMISSAO_NFE.type == 'checkbox') {
					DATA_EMISSAO_NFE.checked = false;
				} else if(DATA_EMISSAO_NFE.type == 'select-one') {
					DATA_EMISSAO_NFE.selectedIndex = 0;
				} else {
					DATA_EMISSAO_NFE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_DOCUMENTO_ID').getAttribute('type') != 'file') {
		  if (!NFE_DOCUMENTO_ID.getAttribute('manter') || NFE_DOCUMENTO_ID.getAttribute('manter') == 0) {
				if(NFE_DOCUMENTO_ID.type == 'checkbox') {
					NFE_DOCUMENTO_ID.checked = false;
				} else if(NFE_DOCUMENTO_ID.type == 'select-one') {
					NFE_DOCUMENTO_ID.selectedIndex = 0;
				} else {
					NFE_DOCUMENTO_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_QTDE_VOLUME').getAttribute('type') != 'file') {
		  if (!NFE_QTDE_VOLUME.getAttribute('manter') || NFE_QTDE_VOLUME.getAttribute('manter') == 0) {
				if(NFE_QTDE_VOLUME.type == 'checkbox') {
					NFE_QTDE_VOLUME.checked = false;
				} else if(NFE_QTDE_VOLUME.type == 'select-one') {
					NFE_QTDE_VOLUME.selectedIndex = 0;
				} else {
					NFE_QTDE_VOLUME.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_PESO').getAttribute('type') != 'file') {
		  if (!NFE_PESO.getAttribute('manter') || NFE_PESO.getAttribute('manter') == 0) {
				if(NFE_PESO.type == 'checkbox') {
					NFE_PESO.checked = false;
				} else if(NFE_PESO.type == 'select-one') {
					NFE_PESO.selectedIndex = 0;
				} else {
					NFE_PESO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_COD_UNIDADE').getAttribute('type') != 'file') {
		  if (!NFE_COD_UNIDADE.getAttribute('manter') || NFE_COD_UNIDADE.getAttribute('manter') == 0) {
				if(NFE_COD_UNIDADE.type == 'checkbox') {
					NFE_COD_UNIDADE.checked = false;
				} else if(NFE_COD_UNIDADE.type == 'select-one') {
					NFE_COD_UNIDADE.selectedIndex = 0;
				} else {
					NFE_COD_UNIDADE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_M3').getAttribute('type') != 'file') {
		  if (!NFE_M3.getAttribute('manter') || NFE_M3.getAttribute('manter') == 0) {
				if(NFE_M3.type == 'checkbox') {
					NFE_M3.checked = false;
				} else if(NFE_M3.type == 'select-one') {
					NFE_M3.selectedIndex = 0;
				} else {
					NFE_M3.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_PESO_CUBADO').getAttribute('type') != 'file') {
		  if (!NFE_PESO_CUBADO.getAttribute('manter') || NFE_PESO_CUBADO.getAttribute('manter') == 0) {
				if(NFE_PESO_CUBADO.type == 'checkbox') {
					NFE_PESO_CUBADO.checked = false;
				} else if(NFE_PESO_CUBADO.type == 'select-one') {
					NFE_PESO_CUBADO.selectedIndex = 0;
				} else {
					NFE_PESO_CUBADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_CUBAGEM_SUGERIDA').getAttribute('type') != 'file') {
		  if (!NFE_CUBAGEM_SUGERIDA.getAttribute('manter') || NFE_CUBAGEM_SUGERIDA.getAttribute('manter') == 0) {
				if(NFE_CUBAGEM_SUGERIDA.type == 'checkbox') {
					NFE_CUBAGEM_SUGERIDA.checked = false;
				} else if(NFE_CUBAGEM_SUGERIDA.type == 'select-one') {
					NFE_CUBAGEM_SUGERIDA.selectedIndex = 0;
				} else {
					NFE_CUBAGEM_SUGERIDA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_PESO_KG_CONVERTIDO').getAttribute('type') != 'file') {
		  if (!NFE_PESO_KG_CONVERTIDO.getAttribute('manter') || NFE_PESO_KG_CONVERTIDO.getAttribute('manter') == 0) {
				if(NFE_PESO_KG_CONVERTIDO.type == 'checkbox') {
					NFE_PESO_KG_CONVERTIDO.checked = false;
				} else if(NFE_PESO_KG_CONVERTIDO.type == 'select-one') {
					NFE_PESO_KG_CONVERTIDO.selectedIndex = 0;
				} else {
					NFE_PESO_KG_CONVERTIDO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_NUM_NATUREZA').getAttribute('type') != 'file') {
		  if (!NFE_NUM_NATUREZA.getAttribute('manter') || NFE_NUM_NATUREZA.getAttribute('manter') == 0) {
				if(NFE_NUM_NATUREZA.type == 'checkbox') {
					NFE_NUM_NATUREZA.checked = false;
				} else if(NFE_NUM_NATUREZA.type == 'select-one') {
					NFE_NUM_NATUREZA.selectedIndex = 0;
				} else {
					NFE_NUM_NATUREZA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_NATUREZA').getAttribute('type') != 'file') {
		  if (!NFE_NATUREZA.getAttribute('manter') || NFE_NATUREZA.getAttribute('manter') == 0) {
				if(NFE_NATUREZA.type == 'checkbox') {
					NFE_NATUREZA.checked = false;
				} else if(NFE_NATUREZA.type == 'select-one') {
					NFE_NATUREZA.selectedIndex = 0;
				} else {
					NFE_NATUREZA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_COMPLEMENTO').getAttribute('type') != 'file') {
		  if (!NFE_COMPLEMENTO.getAttribute('manter') || NFE_COMPLEMENTO.getAttribute('manter') == 0) {
				if(NFE_COMPLEMENTO.type == 'checkbox') {
					NFE_COMPLEMENTO.checked = false;
				} else if(NFE_COMPLEMENTO.type == 'select-one') {
					NFE_COMPLEMENTO.selectedIndex = 0;
				} else {
					NFE_COMPLEMENTO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_NUM_ESPECIE').getAttribute('type') != 'file') {
		  if (!NFE_NUM_ESPECIE.getAttribute('manter') || NFE_NUM_ESPECIE.getAttribute('manter') == 0) {
				if(NFE_NUM_ESPECIE.type == 'checkbox') {
					NFE_NUM_ESPECIE.checked = false;
				} else if(NFE_NUM_ESPECIE.type == 'select-one') {
					NFE_NUM_ESPECIE.selectedIndex = 0;
				} else {
					NFE_NUM_ESPECIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_ESPECIE').getAttribute('type') != 'file') {
		  if (!NFE_ESPECIE.getAttribute('manter') || NFE_ESPECIE.getAttribute('manter') == 0) {
				if(NFE_ESPECIE.type == 'checkbox') {
					NFE_ESPECIE.checked = false;
				} else if(NFE_ESPECIE.type == 'select-one') {
					NFE_ESPECIE.selectedIndex = 0;
				} else {
					NFE_ESPECIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_ALTURA').getAttribute('type') != 'file') {
		  if (!NFE_ALTURA.getAttribute('manter') || NFE_ALTURA.getAttribute('manter') == 0) {
				if(NFE_ALTURA.type == 'checkbox') {
					NFE_ALTURA.checked = false;
				} else if(NFE_ALTURA.type == 'select-one') {
					NFE_ALTURA.selectedIndex = 0;
				} else {
					NFE_ALTURA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_COMPRIMENTO').getAttribute('type') != 'file') {
		  if (!NFE_COMPRIMENTO.getAttribute('manter') || NFE_COMPRIMENTO.getAttribute('manter') == 0) {
				if(NFE_COMPRIMENTO.type == 'checkbox') {
					NFE_COMPRIMENTO.checked = false;
				} else if(NFE_COMPRIMENTO.type == 'select-one') {
					NFE_COMPRIMENTO.selectedIndex = 0;
				} else {
					NFE_COMPRIMENTO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_LARGURA').getAttribute('type') != 'file') {
		  if (!NFE_LARGURA.getAttribute('manter') || NFE_LARGURA.getAttribute('manter') == 0) {
				if(NFE_LARGURA.type == 'checkbox') {
					NFE_LARGURA.checked = false;
				} else if(NFE_LARGURA.type == 'select-one') {
					NFE_LARGURA.selectedIndex = 0;
				} else {
					NFE_LARGURA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_CUBAGEM').getAttribute('type') != 'file') {
		  if (!NFE_CUBAGEM.getAttribute('manter') || NFE_CUBAGEM.getAttribute('manter') == 0) {
				if(NFE_CUBAGEM.type == 'checkbox') {
					NFE_CUBAGEM.checked = false;
				} else if(NFE_CUBAGEM.type == 'select-one') {
					NFE_CUBAGEM.selectedIndex = 0;
				} else {
					NFE_CUBAGEM.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_PESO_COBRADO').getAttribute('type') != 'file') {
		  if (!NFE_PESO_COBRADO.getAttribute('manter') || NFE_PESO_COBRADO.getAttribute('manter') == 0) {
				if(NFE_PESO_COBRADO.type == 'checkbox') {
					NFE_PESO_COBRADO.checked = false;
				} else if(NFE_PESO_COBRADO.type == 'select-one') {
					NFE_PESO_COBRADO.selectedIndex = 0;
				} else {
					NFE_PESO_COBRADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_ORDEM_COMPRA').getAttribute('type') != 'file') {
		  if (!NFE_ORDEM_COMPRA.getAttribute('manter') || NFE_ORDEM_COMPRA.getAttribute('manter') == 0) {
				if(NFE_ORDEM_COMPRA.type == 'checkbox') {
					NFE_ORDEM_COMPRA.checked = false;
				} else if(NFE_ORDEM_COMPRA.type == 'select-one') {
					NFE_ORDEM_COMPRA.selectedIndex = 0;
				} else {
					NFE_ORDEM_COMPRA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NFE_CFOP').getAttribute('type') != 'file') {
		  if (!NFE_CFOP.getAttribute('manter') || NFE_CFOP.getAttribute('manter') == 0) {
				if(NFE_CFOP.type == 'checkbox') {
					NFE_CFOP.checked = false;
				} else if(NFE_CFOP.type == 'select-one') {
					NFE_CFOP.selectedIndex = 0;
				} else {
					NFE_CFOP.value = '';
				}
				
			}
		}
		

		if(document.getElementById('ICMS_PARTILHADO').getAttribute('type') != 'file') {
		  if (!ICMS_PARTILHADO.getAttribute('manter') || ICMS_PARTILHADO.getAttribute('manter') == 0) {
				if(ICMS_PARTILHADO.type == 'checkbox') {
					ICMS_PARTILHADO.checked = false;
				} else if(ICMS_PARTILHADO.type == 'select-one') {
					ICMS_PARTILHADO.selectedIndex = 0;
				} else {
					ICMS_PARTILHADO.value = '';
				}
				
			}
		}
		
		lista_selected_NFE.value = -1;
	}
	f_desabilitar_botao_lista_NFE('padrao');
	f_desabilitar_botao_lista_NFE('excluir');
		
	f_on_incluir_NFE();
}
function f_habilitar_botao_lista_NFE(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_NFE');
	if(obj != null) {
		obj.disabled = false;
		img_obj = document.getElementById('img_lista_'+v_botao+'_NFE');
		img_obj.src = img_obj.src.replace('_disable.gif', '.gif');
	}
}
function f_desabilitar_botao_lista_NFE(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_NFE');
	if(obj != null) {
		obj.disabled = true;
		img_obj = document.getElementById('img_lista_'+v_botao+'_NFE');
		if(img_obj.src.indexOf('_disable') == -1) {
			img_obj.src = img_obj.src.replace('.gif', '_disable.gif');
		}
	}
}
function f_seleciona_NFE(v_nro) {
	
	if(!document.getElementById('btn_lista_incluir_NFE').disabled) {
	
		f_before_selecionar_NFE();
		f_cancelar_NFE();
		var tbody = document.getElementById('tb_lista_NFE');		
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_NFE_'+v_nro) {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_1';
				}			
			} else {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_over';
				}
			}
		}
		with (document.forms[0]) {
			
			if(NF_CONHECIMENTO_ID.type == 'checkbox') {
				NF_CONHECIMENTO_ID.checked = (document.getElementById('NF_CONHECIMENTO_ID_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NF_CONHECIMENTO_ID').type == 'file') {
				v_campo_valor = document.getElementById('NF_CONHECIMENTO_ID_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NF_CONHECIMENTO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NF_CONHECIMENTO_ID';
				v_campo_valor.name = 'NF_CONHECIMENTO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NF_CONHECIMENTO_ID.value = document.getElementById('NF_CONHECIMENTO_ID_NFE_'+v_nro).value;
			}
			
			if(NFE_ID.type == 'checkbox') {
				NFE_ID.checked = (document.getElementById('NFE_ID_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_ID').type == 'file') {
				v_campo_valor = document.getElementById('NFE_ID_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_ID';
				v_campo_valor.name = 'NFE_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_ID.value = document.getElementById('NFE_ID_NFE_'+v_nro).value;
			}
			
			if(CHAVE_ACESSO_NFE.type == 'checkbox') {
				CHAVE_ACESSO_NFE.checked = (document.getElementById('CHAVE_ACESSO_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('CHAVE_ACESSO_NFE').type == 'file') {
				v_campo_valor = document.getElementById('CHAVE_ACESSO_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('CHAVE_ACESSO_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CHAVE_ACESSO_NFE';
				v_campo_valor.name = 'CHAVE_ACESSO_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CHAVE_ACESSO_NFE.value = document.getElementById('CHAVE_ACESSO_NFE_NFE_'+v_nro).value;
			}
			
			if(NFE_VALOR.type == 'checkbox') {
				NFE_VALOR.checked = (document.getElementById('NFE_VALOR_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_VALOR').type == 'file') {
				v_campo_valor = document.getElementById('NFE_VALOR_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_VALOR');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_VALOR';
				v_campo_valor.name = 'NFE_VALOR';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_VALOR.value = document.getElementById('NFE_VALOR_NFE_'+v_nro).value;
			}
			
			if(NFE_VALOR_SEGURADO.type == 'checkbox') {
				NFE_VALOR_SEGURADO.checked = (document.getElementById('NFE_VALOR_SEGURADO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_VALOR_SEGURADO').type == 'file') {
				v_campo_valor = document.getElementById('NFE_VALOR_SEGURADO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_VALOR_SEGURADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_VALOR_SEGURADO';
				v_campo_valor.name = 'NFE_VALOR_SEGURADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_VALOR_SEGURADO.value = document.getElementById('NFE_VALOR_SEGURADO_NFE_'+v_nro).value;
			}
			
			if(PIN_SUFRAMA_NFE.type == 'checkbox') {
				PIN_SUFRAMA_NFE.checked = (document.getElementById('PIN_SUFRAMA_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('PIN_SUFRAMA_NFE').type == 'file') {
				v_campo_valor = document.getElementById('PIN_SUFRAMA_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('PIN_SUFRAMA_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'PIN_SUFRAMA_NFE';
				v_campo_valor.name = 'PIN_SUFRAMA_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				PIN_SUFRAMA_NFE.value = document.getElementById('PIN_SUFRAMA_NFE_NFE_'+v_nro).value;
			}
			
			if(REMETENTE_NFE.type == 'checkbox') {
				REMETENTE_NFE.checked = (document.getElementById('REMETENTE_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('REMETENTE_NFE').type == 'file') {
				v_campo_valor = document.getElementById('REMETENTE_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('REMETENTE_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'REMETENTE_NFE';
				v_campo_valor.name = 'REMETENTE_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				REMETENTE_NFE.value = document.getElementById('REMETENTE_NFE_NFE_'+v_nro).value;
			}
			
			if(CNPJ_REMETENTE_NFE.type == 'checkbox') {
				CNPJ_REMETENTE_NFE.checked = (document.getElementById('CNPJ_REMETENTE_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('CNPJ_REMETENTE_NFE').type == 'file') {
				v_campo_valor = document.getElementById('CNPJ_REMETENTE_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('CNPJ_REMETENTE_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CNPJ_REMETENTE_NFE';
				v_campo_valor.name = 'CNPJ_REMETENTE_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CNPJ_REMETENTE_NFE.value = document.getElementById('CNPJ_REMETENTE_NFE_NFE_'+v_nro).value;
			}
			
			if(DESTINATARIO_NFE.type == 'checkbox') {
				DESTINATARIO_NFE.checked = (document.getElementById('DESTINATARIO_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('DESTINATARIO_NFE').type == 'file') {
				v_campo_valor = document.getElementById('DESTINATARIO_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('DESTINATARIO_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DESTINATARIO_NFE';
				v_campo_valor.name = 'DESTINATARIO_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DESTINATARIO_NFE.value = document.getElementById('DESTINATARIO_NFE_NFE_'+v_nro).value;
			}
			
			if(CNPJ_DESTINATARIO_NFE.type == 'checkbox') {
				CNPJ_DESTINATARIO_NFE.checked = (document.getElementById('CNPJ_DESTINATARIO_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('CNPJ_DESTINATARIO_NFE').type == 'file') {
				v_campo_valor = document.getElementById('CNPJ_DESTINATARIO_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('CNPJ_DESTINATARIO_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CNPJ_DESTINATARIO_NFE';
				v_campo_valor.name = 'CNPJ_DESTINATARIO_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CNPJ_DESTINATARIO_NFE.value = document.getElementById('CNPJ_DESTINATARIO_NFE_NFE_'+v_nro).value;
			}
			
			if(NOME_ARQUIVO.type == 'checkbox') {
				NOME_ARQUIVO.checked = (document.getElementById('NOME_ARQUIVO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NOME_ARQUIVO').type == 'file') {
				v_campo_valor = document.getElementById('NOME_ARQUIVO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NOME_ARQUIVO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NOME_ARQUIVO';
				v_campo_valor.name = 'NOME_ARQUIVO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NOME_ARQUIVO.value = document.getElementById('NOME_ARQUIVO_NFE_'+v_nro).value;
			}
			
			if(NUMERO_NFE.type == 'checkbox') {
				NUMERO_NFE.checked = (document.getElementById('NUMERO_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NUMERO_NFE').type == 'file') {
				v_campo_valor = document.getElementById('NUMERO_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NUMERO_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NUMERO_NFE';
				v_campo_valor.name = 'NUMERO_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NUMERO_NFE.value = document.getElementById('NUMERO_NFE_NFE_'+v_nro).value;
			}
			
			if(MODELO_NFE.type == 'checkbox') {
				MODELO_NFE.checked = (document.getElementById('MODELO_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('MODELO_NFE').type == 'file') {
				v_campo_valor = document.getElementById('MODELO_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('MODELO_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'MODELO_NFE';
				v_campo_valor.name = 'MODELO_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				MODELO_NFE.value = document.getElementById('MODELO_NFE_NFE_'+v_nro).value;
			}
			
			if(SERIE_NFE.type == 'checkbox') {
				SERIE_NFE.checked = (document.getElementById('SERIE_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('SERIE_NFE').type == 'file') {
				v_campo_valor = document.getElementById('SERIE_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('SERIE_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'SERIE_NFE';
				v_campo_valor.name = 'SERIE_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				SERIE_NFE.value = document.getElementById('SERIE_NFE_NFE_'+v_nro).value;
			}
			
			if(DATA_EMISSAO_NFE.type == 'checkbox') {
				DATA_EMISSAO_NFE.checked = (document.getElementById('DATA_EMISSAO_NFE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('DATA_EMISSAO_NFE').type == 'file') {
				v_campo_valor = document.getElementById('DATA_EMISSAO_NFE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('DATA_EMISSAO_NFE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DATA_EMISSAO_NFE';
				v_campo_valor.name = 'DATA_EMISSAO_NFE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DATA_EMISSAO_NFE.value = document.getElementById('DATA_EMISSAO_NFE_NFE_'+v_nro).value;
			}
			
			if(NFE_DOCUMENTO_ID.type == 'checkbox') {
				NFE_DOCUMENTO_ID.checked = (document.getElementById('NFE_DOCUMENTO_ID_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_DOCUMENTO_ID').type == 'file') {
				v_campo_valor = document.getElementById('NFE_DOCUMENTO_ID_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_DOCUMENTO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_DOCUMENTO_ID';
				v_campo_valor.name = 'NFE_DOCUMENTO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_DOCUMENTO_ID.value = document.getElementById('NFE_DOCUMENTO_ID_NFE_'+v_nro).value;
			}
			
			if(NFE_QTDE_VOLUME.type == 'checkbox') {
				NFE_QTDE_VOLUME.checked = (document.getElementById('NFE_QTDE_VOLUME_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_QTDE_VOLUME').type == 'file') {
				v_campo_valor = document.getElementById('NFE_QTDE_VOLUME_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_QTDE_VOLUME');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_QTDE_VOLUME';
				v_campo_valor.name = 'NFE_QTDE_VOLUME';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_QTDE_VOLUME.value = document.getElementById('NFE_QTDE_VOLUME_NFE_'+v_nro).value;
			}
			
			if(NFE_PESO.type == 'checkbox') {
				NFE_PESO.checked = (document.getElementById('NFE_PESO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_PESO').type == 'file') {
				v_campo_valor = document.getElementById('NFE_PESO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_PESO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_PESO';
				v_campo_valor.name = 'NFE_PESO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_PESO.value = document.getElementById('NFE_PESO_NFE_'+v_nro).value;
			}
			
			if(NFE_COD_UNIDADE.type == 'checkbox') {
				NFE_COD_UNIDADE.checked = (document.getElementById('NFE_COD_UNIDADE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_COD_UNIDADE').type == 'file') {
				v_campo_valor = document.getElementById('NFE_COD_UNIDADE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_COD_UNIDADE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_COD_UNIDADE';
				v_campo_valor.name = 'NFE_COD_UNIDADE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_COD_UNIDADE.value = document.getElementById('NFE_COD_UNIDADE_NFE_'+v_nro).value;
			}
			
			if(NFE_M3.type == 'checkbox') {
				NFE_M3.checked = (document.getElementById('NFE_M3_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_M3').type == 'file') {
				v_campo_valor = document.getElementById('NFE_M3_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_M3');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_M3';
				v_campo_valor.name = 'NFE_M3';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_M3.value = document.getElementById('NFE_M3_NFE_'+v_nro).value;
			}
			
			if(NFE_PESO_CUBADO.type == 'checkbox') {
				NFE_PESO_CUBADO.checked = (document.getElementById('NFE_PESO_CUBADO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_PESO_CUBADO').type == 'file') {
				v_campo_valor = document.getElementById('NFE_PESO_CUBADO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_PESO_CUBADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_PESO_CUBADO';
				v_campo_valor.name = 'NFE_PESO_CUBADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_PESO_CUBADO.value = document.getElementById('NFE_PESO_CUBADO_NFE_'+v_nro).value;
			}
			
			if(NFE_CUBAGEM_SUGERIDA.type == 'checkbox') {
				NFE_CUBAGEM_SUGERIDA.checked = (document.getElementById('NFE_CUBAGEM_SUGERIDA_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_CUBAGEM_SUGERIDA').type == 'file') {
				v_campo_valor = document.getElementById('NFE_CUBAGEM_SUGERIDA_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_CUBAGEM_SUGERIDA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_CUBAGEM_SUGERIDA';
				v_campo_valor.name = 'NFE_CUBAGEM_SUGERIDA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_CUBAGEM_SUGERIDA.value = document.getElementById('NFE_CUBAGEM_SUGERIDA_NFE_'+v_nro).value;
			}
			
			if(NFE_PESO_KG_CONVERTIDO.type == 'checkbox') {
				NFE_PESO_KG_CONVERTIDO.checked = (document.getElementById('NFE_PESO_KG_CONVERTIDO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_PESO_KG_CONVERTIDO').type == 'file') {
				v_campo_valor = document.getElementById('NFE_PESO_KG_CONVERTIDO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_PESO_KG_CONVERTIDO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_PESO_KG_CONVERTIDO';
				v_campo_valor.name = 'NFE_PESO_KG_CONVERTIDO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_PESO_KG_CONVERTIDO.value = document.getElementById('NFE_PESO_KG_CONVERTIDO_NFE_'+v_nro).value;
			}
			
			if(NFE_NUM_NATUREZA.type == 'checkbox') {
				NFE_NUM_NATUREZA.checked = (document.getElementById('NFE_NUM_NATUREZA_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_NUM_NATUREZA').type == 'file') {
				v_campo_valor = document.getElementById('NFE_NUM_NATUREZA_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_NUM_NATUREZA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_NUM_NATUREZA';
				v_campo_valor.name = 'NFE_NUM_NATUREZA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_NUM_NATUREZA.value = document.getElementById('NFE_NUM_NATUREZA_NFE_'+v_nro).value;
			}
			
			if(NFE_NATUREZA.type == 'checkbox') {
				NFE_NATUREZA.checked = (document.getElementById('NFE_NATUREZA_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_NATUREZA').type == 'file') {
				v_campo_valor = document.getElementById('NFE_NATUREZA_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_NATUREZA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_NATUREZA';
				v_campo_valor.name = 'NFE_NATUREZA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_NATUREZA.value = document.getElementById('NFE_NATUREZA_NFE_'+v_nro).value;
			}
			
			if(NFE_COMPLEMENTO.type == 'checkbox') {
				NFE_COMPLEMENTO.checked = (document.getElementById('NFE_COMPLEMENTO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_COMPLEMENTO').type == 'file') {
				v_campo_valor = document.getElementById('NFE_COMPLEMENTO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_COMPLEMENTO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_COMPLEMENTO';
				v_campo_valor.name = 'NFE_COMPLEMENTO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_COMPLEMENTO.value = document.getElementById('NFE_COMPLEMENTO_NFE_'+v_nro).value;
			}
			
			if(NFE_NUM_ESPECIE.type == 'checkbox') {
				NFE_NUM_ESPECIE.checked = (document.getElementById('NFE_NUM_ESPECIE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_NUM_ESPECIE').type == 'file') {
				v_campo_valor = document.getElementById('NFE_NUM_ESPECIE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_NUM_ESPECIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_NUM_ESPECIE';
				v_campo_valor.name = 'NFE_NUM_ESPECIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_NUM_ESPECIE.value = document.getElementById('NFE_NUM_ESPECIE_NFE_'+v_nro).value;
			}
			
			if(NFE_ESPECIE.type == 'checkbox') {
				NFE_ESPECIE.checked = (document.getElementById('NFE_ESPECIE_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_ESPECIE').type == 'file') {
				v_campo_valor = document.getElementById('NFE_ESPECIE_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_ESPECIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_ESPECIE';
				v_campo_valor.name = 'NFE_ESPECIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_ESPECIE.value = document.getElementById('NFE_ESPECIE_NFE_'+v_nro).value;
			}
			
			if(NFE_ALTURA.type == 'checkbox') {
				NFE_ALTURA.checked = (document.getElementById('NFE_ALTURA_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_ALTURA').type == 'file') {
				v_campo_valor = document.getElementById('NFE_ALTURA_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_ALTURA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_ALTURA';
				v_campo_valor.name = 'NFE_ALTURA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_ALTURA.value = document.getElementById('NFE_ALTURA_NFE_'+v_nro).value;
			}
			
			if(NFE_COMPRIMENTO.type == 'checkbox') {
				NFE_COMPRIMENTO.checked = (document.getElementById('NFE_COMPRIMENTO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_COMPRIMENTO').type == 'file') {
				v_campo_valor = document.getElementById('NFE_COMPRIMENTO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_COMPRIMENTO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_COMPRIMENTO';
				v_campo_valor.name = 'NFE_COMPRIMENTO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_COMPRIMENTO.value = document.getElementById('NFE_COMPRIMENTO_NFE_'+v_nro).value;
			}
			
			if(NFE_LARGURA.type == 'checkbox') {
				NFE_LARGURA.checked = (document.getElementById('NFE_LARGURA_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_LARGURA').type == 'file') {
				v_campo_valor = document.getElementById('NFE_LARGURA_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_LARGURA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_LARGURA';
				v_campo_valor.name = 'NFE_LARGURA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_LARGURA.value = document.getElementById('NFE_LARGURA_NFE_'+v_nro).value;
			}
			
			if(NFE_CUBAGEM.type == 'checkbox') {
				NFE_CUBAGEM.checked = (document.getElementById('NFE_CUBAGEM_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_CUBAGEM').type == 'file') {
				v_campo_valor = document.getElementById('NFE_CUBAGEM_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_CUBAGEM');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_CUBAGEM';
				v_campo_valor.name = 'NFE_CUBAGEM';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_CUBAGEM.value = document.getElementById('NFE_CUBAGEM_NFE_'+v_nro).value;
			}
			
			if(NFE_PESO_COBRADO.type == 'checkbox') {
				NFE_PESO_COBRADO.checked = (document.getElementById('NFE_PESO_COBRADO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_PESO_COBRADO').type == 'file') {
				v_campo_valor = document.getElementById('NFE_PESO_COBRADO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_PESO_COBRADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_PESO_COBRADO';
				v_campo_valor.name = 'NFE_PESO_COBRADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_PESO_COBRADO.value = document.getElementById('NFE_PESO_COBRADO_NFE_'+v_nro).value;
			}
			
			if(NFE_ORDEM_COMPRA.type == 'checkbox') {
				NFE_ORDEM_COMPRA.checked = (document.getElementById('NFE_ORDEM_COMPRA_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_ORDEM_COMPRA').type == 'file') {
				v_campo_valor = document.getElementById('NFE_ORDEM_COMPRA_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_ORDEM_COMPRA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_ORDEM_COMPRA';
				v_campo_valor.name = 'NFE_ORDEM_COMPRA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_ORDEM_COMPRA.value = document.getElementById('NFE_ORDEM_COMPRA_NFE_'+v_nro).value;
			}
			
			if(NFE_CFOP.type == 'checkbox') {
				NFE_CFOP.checked = (document.getElementById('NFE_CFOP_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('NFE_CFOP').type == 'file') {
				v_campo_valor = document.getElementById('NFE_CFOP_NFE_'+v_nro);
				v_campo_atual = document.getElementById('NFE_CFOP');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NFE_CFOP';
				v_campo_valor.name = 'NFE_CFOP';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NFE_CFOP.value = document.getElementById('NFE_CFOP_NFE_'+v_nro).value;
			}
			
			if(ICMS_PARTILHADO.type == 'checkbox') {
				ICMS_PARTILHADO.checked = (document.getElementById('ICMS_PARTILHADO_NFE_'+v_nro).value == 1)
			} else if(document.getElementById('ICMS_PARTILHADO').type == 'file') {
				v_campo_valor = document.getElementById('ICMS_PARTILHADO_NFE_'+v_nro);
				v_campo_atual = document.getElementById('ICMS_PARTILHADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'ICMS_PARTILHADO';
				v_campo_valor.name = 'ICMS_PARTILHADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				ICMS_PARTILHADO.value = document.getElementById('ICMS_PARTILHADO_NFE_'+v_nro).value;
			}
			
			lista_selected_NFE.value = v_nro;
		}
		f_habilitar_botao_lista_NFE('padrao');
		f_habilitar_botao_lista_NFE('excluir');
		f_habilitar_botao_lista_NFE('salvar');
		f_on_seleciona_NFE();
	
	}
	
}
function f_padrao_NFE(v_nro) {
	if(v_nro == -1) {
		return;
	}
	var tbody = document.getElementById('tb_lista_NFE');		
	with(document.forms[0]) {
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_NFE_'+v_nro) {
				var row_id = tbody.rows[i].id.replace('tr_lista_NFE_', '');
				document.getElementById('lista_padrao_NFE_'+row_id).style.display = 'none';
				document.getElementById('PADRAO_NFE_'+row_id).value = 0;
			}
		}
	}
	document.getElementById('lista_padrao_NFE_'+v_nro).style.display = '';
	document.getElementById('PADRAO_NFE_'+v_nro).value = 1;
}	

function f_total_campo_NFE(v_campo) {
	var tbody = document.getElementById('tb_lista_NFE');
	var soma = 0;
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NFE_', '');
		with(document.forms[0]) {
			try {
				soma += (eval("document.forms[0]."+v_campo+"_NFE_"+id_linha+".value")*1);
			} catch(e) {
			}
		}
	}
	return soma;
}
function f_atualiza_campos_escravos_NFE() {

}

function f_atualiza_campo_escravo_NFE(v_valor_mestre, v_campo_escravo, v_value) {
	var tbody = document.getElementById('tb_lista_NFE');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NFE_', '');
		with(document.forms[0]) {
			try {
				if (eval("document.forms[0]._NFE_"+id_linha).value == v_valor_mestre) {
					eval("document.forms[0]."+v_campo_escravo+"_NFE_"+id_linha).value = v_value;
				}				
			} catch(e) {
			}
		}
	}
}

function f_register(p_id) {
	this.id = p_id;

	this.NF_CONHECIMENTO_ID = '';

	this.NFE_ID = '';

	this.CHAVE_ACESSO_NFE = '';

	this.NFE_VALOR = '';

	this.NFE_VALOR_SEGURADO = '';

	this.PIN_SUFRAMA_NFE = '';

	this.REMETENTE_NFE = '';

	this.CNPJ_REMETENTE_NFE = '';

	this.DESTINATARIO_NFE = '';

	this.CNPJ_DESTINATARIO_NFE = '';

	this.NOME_ARQUIVO = '';

	this.NUMERO_NFE = '';

	this.MODELO_NFE = '';

	this.SERIE_NFE = '';

	this.DATA_EMISSAO_NFE = '';

	this.NFE_DOCUMENTO_ID = '';

	this.NFE_QTDE_VOLUME = '';

	this.NFE_PESO = '';

	this.NFE_COD_UNIDADE = '';

	this.NFE_M3 = '';

	this.NFE_PESO_CUBADO = '';

	this.NFE_CUBAGEM_SUGERIDA = '';

	this.NFE_PESO_KG_CONVERTIDO = '';

	this.NFE_NUM_NATUREZA = '';

	this.NFE_NATUREZA = '';

	this.NFE_COMPLEMENTO = '';

	this.NFE_NUM_ESPECIE = '';

	this.NFE_ESPECIE = '';

	this.NFE_ALTURA = '';

	this.NFE_COMPRIMENTO = '';

	this.NFE_LARGURA = '';

	this.NFE_CUBAGEM = '';

	this.NFE_PESO_COBRADO = '';

	this.NFE_ORDEM_COMPRA = '';

	this.NFE_CFOP = '';

	this.ICMS_PARTILHADO = '';
}
//busca todos os registros
function f_listagem_NFE() {
	var tbody = document.getElementById('tb_lista_NFE');
	var result = new Array();
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NFE_', '');
		result[result.length] = new f_register(id_linha);
	
		try {
			result[result.length-1].NF_CONHECIMENTO_ID = eval("document.forms[0].NF_CONHECIMENTO_ID_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_ID = eval("document.forms[0].NFE_ID_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CHAVE_ACESSO_NFE = eval("document.forms[0].CHAVE_ACESSO_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_VALOR = eval("document.forms[0].NFE_VALOR_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_VALOR_SEGURADO = eval("document.forms[0].NFE_VALOR_SEGURADO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].PIN_SUFRAMA_NFE = eval("document.forms[0].PIN_SUFRAMA_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].REMETENTE_NFE = eval("document.forms[0].REMETENTE_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CNPJ_REMETENTE_NFE = eval("document.forms[0].CNPJ_REMETENTE_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DESTINATARIO_NFE = eval("document.forms[0].DESTINATARIO_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CNPJ_DESTINATARIO_NFE = eval("document.forms[0].CNPJ_DESTINATARIO_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NOME_ARQUIVO = eval("document.forms[0].NOME_ARQUIVO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NUMERO_NFE = eval("document.forms[0].NUMERO_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].MODELO_NFE = eval("document.forms[0].MODELO_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].SERIE_NFE = eval("document.forms[0].SERIE_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DATA_EMISSAO_NFE = eval("document.forms[0].DATA_EMISSAO_NFE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_DOCUMENTO_ID = eval("document.forms[0].NFE_DOCUMENTO_ID_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_QTDE_VOLUME = eval("document.forms[0].NFE_QTDE_VOLUME_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_PESO = eval("document.forms[0].NFE_PESO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_COD_UNIDADE = eval("document.forms[0].NFE_COD_UNIDADE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_M3 = eval("document.forms[0].NFE_M3_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_PESO_CUBADO = eval("document.forms[0].NFE_PESO_CUBADO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_CUBAGEM_SUGERIDA = eval("document.forms[0].NFE_CUBAGEM_SUGERIDA_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_PESO_KG_CONVERTIDO = eval("document.forms[0].NFE_PESO_KG_CONVERTIDO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_NUM_NATUREZA = eval("document.forms[0].NFE_NUM_NATUREZA_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_NATUREZA = eval("document.forms[0].NFE_NATUREZA_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_COMPLEMENTO = eval("document.forms[0].NFE_COMPLEMENTO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_NUM_ESPECIE = eval("document.forms[0].NFE_NUM_ESPECIE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_ESPECIE = eval("document.forms[0].NFE_ESPECIE_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_ALTURA = eval("document.forms[0].NFE_ALTURA_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_COMPRIMENTO = eval("document.forms[0].NFE_COMPRIMENTO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_LARGURA = eval("document.forms[0].NFE_LARGURA_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_CUBAGEM = eval("document.forms[0].NFE_CUBAGEM_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_PESO_COBRADO = eval("document.forms[0].NFE_PESO_COBRADO_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_ORDEM_COMPRA = eval("document.forms[0].NFE_ORDEM_COMPRA_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NFE_CFOP = eval("document.forms[0].NFE_CFOP_NFE_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].ICMS_PARTILHADO = eval("document.forms[0].ICMS_PARTILHADO_NFE_"+id_linha).value;
		} catch(e) {}
	
	}
	return result;
}

function f_busca_campo_escravo_NFE(v_valor_mestre, v_campo_escravo) {
	var tbody = document.getElementById('tb_lista_NFE');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_NFE_', '');
		with(document.forms[0]) {
				if (eval("document.forms[0]._NFE_"+id_linha).value == v_valor_mestre) {
					return eval("document.forms[0]."+v_campo_escravo+"_NFE_"+id_linha).value;
				}				
		}
	}
	return '';
}
function f_set_lista_min_NFE(value) {

}

function f_before_selecionar_NFE() {}
function f_on_seleciona_NFE() {}
function f_on_salva_lista_NFE() {}
function f_before_salvar_NFE() { return true; }
function f_on_incluir_NFE() {}
function f_on_excluir_NFE() {}
</script>

<table width="100%" height="100%" align="left" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr id="tr_lista_botoes_NFE">
    <td><table border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>

		
          <td><button tabindex="335" class="botao" id="btn_lista_incluir_NFE" onclick="f_incluir_NFE()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_incluir_NFE" src="/_imagens/botoes/16x16/incluir.gif">&nbsp;Novo</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="336" class="botao" id="btn_lista_excluir_NFE" onclick="f_excluir_NFE(document.forms[0].lista_selected_NFE.value)" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_excluir_NFE" src="https://levolog.kmm.com.br/_imagens/botoes/16x16/excluir_disable.gif">&nbsp;Excluir</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="337" class="botao" id="btn_lista_salvar_NFE" onclick="f_salvar_NFE()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_salvar_NFE" src="/_imagens/botoes/16x16/confirmar.gif">&nbsp;Salvar</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="338" class="botao" id="btn_lista_cancelar_NFE" onclick="f_cancelar_NFE()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_cancelar_NFE" src="/_imagens/botoes/16x16/cancelar.gif">&nbsp;Cancelar</button></td>
          <td style="width: 4px;">&nbsp;</td>
		  
        </tr>
      </tbody></table></td>
  </tr>
  <tr><td height="4"></td></tr>
  <input name="lista_selected_NFE" tabindex="339" id="lista_selected_NFE" type="hidden" value="-1" fixo="1">
  <input name="lista_deleted_NFE" tabindex="340" id="lista_deleted_NFE" type="hidden" value="" fixo="1">
  <tr>
  
    <td height="200">
	<div class="lista" style="width: 100%; -ms-overflow-x: scroll;">
	<table width="100%" style="-ms-overflow-y: scroll;" border="0" cellspacing="1" cellpadding="3">
	<thead>
  <tr class="titulo_3" style="cursor: pointer;" onclick="sortColumn(event)">
    <td width="16" class="titulo_3" style="display: none;">&nbsp;</td>
  	
    <td width="10%" align="right" class="titulo_3" type="caseinsensitivestring">Nº Nota</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring"> Modelo</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring"> Série</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Data de Emissão</td>
	
    <td width="40%" align="right" class="titulo_3" type="caseinsensitivestring">Chave de Acesso</td>
	
    <td width="20%" align="left" class="titulo_3" type="caseinsensitivestring">Valor</td>
	
  </tr>
  </thead>
  <tbody id="tb_lista_NFE">
  <tr id="tr_lista_NFE_0" style="cursor: pointer;"><td width="16" class="linha_1" style="display: none;"><div><img width="16" height="16" id="lista_padrao_NFE_0" src="/_imagens/botoes/16x16/padrao.gif"><input name="PADRAO_NFE_0" id="PADRAO_NFE_0" type="hidden" value="1"><input name="NF_CONHECIMENTO_ID_NFE_0" id="NF_CONHECIMENTO_ID_NFE_0" type="hidden" value="1042461"><input name="NFE_ID_NFE_0" id="NFE_ID_NFE_0" type="hidden" value=""><input name="CHAVE_ACESSO_NFE_NFE_0" id="CHAVE_ACESSO_NFE_NFE_0" type="hidden" value="31251161074506002426550000002561311949712644"><input name="NFE_VALOR_NFE_0" id="NFE_VALOR_NFE_0" type="hidden" value="95653.72"><input name="NFE_VALOR_SEGURADO_NFE_0" id="NFE_VALOR_SEGURADO_NFE_0" type="hidden" value="95653.72"><input name="PIN_SUFRAMA_NFE_NFE_0" id="PIN_SUFRAMA_NFE_NFE_0" type="hidden" value=""><input name="REMETENTE_NFE_NFE_0" id="REMETENTE_NFE_NFE_0" type="hidden" value="Belgo Bekaert Arames LTDA"><input name="CNPJ_REMETENTE_NFE_NFE_0" id="CNPJ_REMETENTE_NFE_NFE_0" type="hidden" value="61.074.506/0024-26"><input name="DESTINATARIO_NFE_NFE_0" id="DESTINATARIO_NFE_NFE_0" type="hidden" value="JOST AGRICULTURE &amp; CONSTRUCTION SOUTH AMERICA LTDA"><input name="CNPJ_DESTINATARIO_NFE_NFE_0" id="CNPJ_DESTINATARIO_NFE_NFE_0" type="hidden" value="15.090.456/0001-67"><input name="NOME_ARQUIVO_NFE_0" id="NOME_ARQUIVO_NFE_0" type="hidden" value="nfe_31251161074506002426550000002561311949712644.xml"><input name="NUMERO_NFE_NFE_0" id="NUMERO_NFE_NFE_0" type="hidden" value="256131"><input name="MODELO_NFE_NFE_0" id="MODELO_NFE_NFE_0" type="hidden" value="55"><input name="SERIE_NFE_NFE_0" id="SERIE_NFE_NFE_0" type="hidden" value="0"><input name="DATA_EMISSAO_NFE_NFE_0" id="DATA_EMISSAO_NFE_NFE_0" type="hidden" value="28/11/2025"><input name="NFE_DOCUMENTO_ID_NFE_0" id="NFE_DOCUMENTO_ID_NFE_0" type="hidden" value=""><input name="NFE_QTDE_VOLUME_NFE_0" id="NFE_QTDE_VOLUME_NFE_0" type="hidden" value="7"><input name="NFE_PESO_NFE_0" id="NFE_PESO_NFE_0" type="hidden" value="0"><input name="NFE_COD_UNIDADE_NFE_0" id="NFE_COD_UNIDADE_NFE_0" type="hidden" value="Kg"><input name="NFE_M3_NFE_0" id="NFE_M3_NFE_0" type="hidden" value=""><input name="NFE_PESO_CUBADO_NFE_0" id="NFE_PESO_CUBADO_NFE_0" type="hidden" value="0"><input name="NFE_CUBAGEM_SUGERIDA_NFE_0" id="NFE_CUBAGEM_SUGERIDA_NFE_0" type="hidden" value="2100"><input name="NFE_PESO_KG_CONVERTIDO_NFE_0" id="NFE_PESO_KG_CONVERTIDO_NFE_0" type="hidden" value="0"><input name="NFE_NUM_NATUREZA_NFE_0" id="NFE_NUM_NATUREZA_NFE_0" type="hidden" value="9"><input name="NFE_NATUREZA_NFE_0" id="NFE_NATUREZA_NFE_0" type="hidden" value="AR COB MIGMAG 1,00 KK 18kg RC BMEC4"><input name="NFE_COMPLEMENTO_NFE_0" id="NFE_COMPLEMENTO_NFE_0" type="hidden" value=""><input name="NFE_NUM_ESPECIE_NFE_0" id="NFE_NUM_ESPECIE_NFE_0" type="hidden" value="7"><input name="NFE_ESPECIE_NFE_0" id="NFE_ESPECIE_NFE_0" type="hidden" value="AMARRADO"><input name="NFE_ALTURA_NFE_0" id="NFE_ALTURA_NFE_0" type="hidden" value="1"><input name="NFE_COMPRIMENTO_NFE_0" id="NFE_COMPRIMENTO_NFE_0" type="hidden" value="1"><input name="NFE_LARGURA_NFE_0" id="NFE_LARGURA_NFE_0" type="hidden" value="1"><input name="NFE_CUBAGEM_NFE_0" id="NFE_CUBAGEM_NFE_0" type="hidden" value="0"><input name="NFE_PESO_COBRADO_NFE_0" id="NFE_PESO_COBRADO_NFE_0" type="hidden" value="7840"><input name="NFE_ORDEM_COMPRA_NFE_0" id="NFE_ORDEM_COMPRA_NFE_0" type="hidden" value="0014693539"><input name="NFE_CFOP_NFE_0" id="NFE_CFOP_NFE_0" type="hidden" value="5102"><input name="ICMS_PARTILHADO_NFE_0" id="ICMS_PARTILHADO_NFE_0" type="hidden" value="0"></div></td><td align="right" class="linha_1" valign="top">256131</td><td align="left" class="linha_1" valign="top">55</td><td align="left" class="linha_1" valign="top">0</td><td align="left" class="linha_1" valign="top">28/11/2025</td><td align="right" class="linha_1" valign="top">31251161074506002426550000002561311949712644</td><td align="left" class="linha_1" valign="top">95653.72</td></tr></tbody>
</table>

	</div></td>
  </tr>
</tbody></table>
                        
                            
                            <script type="text/javascript">	
								var v_num_especie_notas = '';
								var v_num_natureza_notas = '';
								var v_cod_unidade_notas = '';
								function f_on_incluir_NFE() {
									with(document.forms[0]) {
										NFE_ALTURA.value = 0;
										NFE_LARGURA.value = 0;
										NFE_COMPRIMENTO.value = 0;
										
										if (!v_edicao){
											NFE_COMPRIMENTO.onchange();
										}
										
										v_lista = f_listagem_NFE();
										if(v_lista.length > 0){
											NFE_NUM_NATUREZA.value = v_nota_num_natureza;
											NFE_NUM_NATUREZA.onchange();
											NFE_NUM_ESPECIE.value = v_nota_num_especie;
											NFE_NUM_ESPECIE.onchange();
										}
										
										NFE_QTDE_VOLUME.value = 1;
										NFE_ORDEM_COMPRA.value = NFE_ORDEM_COMPRA.value + PEDIDO_SHIPMENT_SOLICITACAO.value;
										
										f_valor_segurado_automatico('NFE', 0);
										
										v_edicao = false;
									}
								}
								function f_on_salva_lista_NFE() {
									with(document.forms[0]) {
										v_lista = f_listagem_NFE();
										if(v_lista.length > 0){
										    //Segundo regra, se a natureza veio da solicitação, não deve ser substituida pela natureza da nota.
											if (SOLICITACAO_NUM_NATUREZA.value == '') {
											   NUM_NATUREZA.value = v_lista[0].NFE_NUM_NATUREZA;
											   NUM_NATUREZA.onchange();
											}
											NUM_ESPECIE.value = v_lista[0].NFE_NUM_ESPECIE;
											NUM_ESPECIE.onchange();
										}
										VALOR_MERCADORIA.value = f_total_campo_NFE('NFE_VALOR');
										PESO.value = f_total_campo_NFE('NFE_PESO_COBRADO');
										M3.value = f_total_campo_NFE('NFE_M3')
										CUBAGEM.value = f_total_campo_NFE('NFE_CUBAGEM')
										PESO_KG.value = f_total_campo_NFE('NFE_PESO_KG_CONVERTIDO');
										var v_lista = f_listagem_NFE();
										NOTAS.value = '';
										for(var i=0;i<v_lista.length;i++) {
											if(NOTAS.value == ''){
												NOTAS.value = v_lista[i].NFE_NUMERO;						
											}else{
												NOTAS.value += ' , '+v_lista[i].NFE_NUMERO;						
											}
										}
						//				alert(PESO_KG.value);
						
										f_preenche_constantes_cfop_mercadoria();
										try{
										f_preenche_observacao();
										} catch(e) {}
										COD_UNIDADE.value = 'Kg';
										VOLUME.value = f_total_campo_NFE('NFE_QTDE_VOLUME');
										
										if(POPULANDO_DADOS.value == 0){
										   f_calculos();
										}
										PESO_REAL.value = f_total_campo_NFE('NFE_PESO');
										f_atualiza_peso_cte_ref();
										if (f_listagem_CTES_REF().length > 0) {
										   f_seleciona_CTES_REF(0);
										}
									}
								}
								function f_before_salvar_NFE() {
									with(document.forms[0]) {
										if(f_ajax_running() > 0 && v_inserida == 0) {
											alert('Aguarde o término do processamento antes de salvar.');
											return false;
										}
										if(NFE_NUM_ESPECIE.value != '' && NFE_ESPECIE.value == '') {
											alert('A espécie selecionada não é válida!');
											return false;
										}
										if(NFE_NUM_NATUREZA.value != '' && NFE_NATUREZA.value == '') {
											alert('A natureza selecionada não é válida!');
											return false;
										}
										if(Number(CHAVE_ACESSO_NFE.value.length) != 44) {
											alert('A Chave de Acesso da NFE não é válida.');
											return false;
										}
										v_lista = f_listagem_NFE();
										if(v_lista.length == 0){
											v_nota_num_natureza = NFE_NUM_NATUREZA.value;
											v_nota_num_especie = NFE_NUM_ESPECIE.value;
										}
										
										return true;
									}
								}
								function f_on_excluir_NFE(){
									v_listagem = f_listagem_NFE();
									if(v_listagem.length == 0)
										f_controla_tipo_docto_frete();
								}
								function f_before_selecionar_NFE(){								
									v_edicao = true;			
									with(document.forms[0]) {
										MODELO_NFE.readOnly = false;
										NUMERO_NFE.readOnly = false;
										SERIE_NFE.readOnly = false;

										if(CHAVE_ACESSO_NFE.value != ''){
										   MODELO_NFE.readOnly = true;
										   NUMERO_NFE.readOnly = true;
										   SERIE_NFE.readOnly = true;
										}
									}
								}								
							</script>
                            </td>
                            </tr>
                            </tbody></table>
                        </td>
                    </tr>
                </tbody></table>
        	</fieldset>
    	</td>
	</tr>    
</tbody></table>

<table width="90%" border="0" cellspacing="0" cellpadding="1">
	<tbody><tr>
    	<td width="90%">
        	<fieldset tabindex="341" id="fs_outros" style="display: none;"><legend>Outros Documentos</legend>
                <table width="90%" border="0" cellspacing="3" cellpadding="1">
                    <tbody><tr>
                      <td width="1%" class="texto" nowrap="">Número:</td>
                      <td width="1%" class="texto" nowrap="" colspan="2"><input name="OUTROS_ID" tabindex="342" id="OUTROS_ID" type="hidden" value="">
                      <input name="OUTROS_NUMERO" tabindex="343" class="requerido_form" id="OUTROS_NUMERO" style="width: 85px;" type="text" maxlength="20" display="NÚMERO DO DOCUMENTO" obrigatorio="1" secao="OUTROS">
                      <nobr>Data de Emissão:</nobr>
                      <input name="OUTROS_DATA_EMISSAO" tabindex="344" class="requerido_form" id="OUTROS_DATA_EMISSAO" style="width: 85px;" onkeypress="return f_formata(this, '00/00/0000')" type="text" maxlength="10" display="OUTROS DOCUMENTOS / DATA DE EMISSÃO" obrigatorio="1" tipo="data" secao="OUTROS">
                        <button tabindex="345" class="botao-16x16" id="BTN_OUTROS_DATA_EMISSAO" type="button"><img width="16" height="16" title="Data" align="absmiddle" alt="Data" src="/_imagens/botoes/16x16/calendario.gif"></button>
                      <script type="text/javascript"> 
                                Calendar.setup( {
                                    inputField  : "OUTROS_DATA_EMISSAO",      // ID of the input field
                                    ifFormat    : "%d/%m/%Y",               // the date format
                                    button      : "BTN_OUTROS_DATA_EMISSAO",  // ID of the button
                                    range       : [2001,2050]
                                } );
                            </script>
                      <nobr>Valor do Documento:</nobr>
                      <input name="OUTROS_VALOR" tabindex="346" class="requerido_form" id="OUTROS_VALOR" style="width: 85px;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value).toFixed(2);  f_valor_segurado_automatico('OUTROS', 1);" type="text" maxlength="15" display="OUTROS DOCUMENTOS / VALOR" obrigatorio="1" tipo="numerico" secao="OUTROS">
                      <nobr>Valor do Segurado:</nobr>
                      <input name="OUTROS_VALOR_SEGURADO" tabindex="347" class="requerido_form" id="OUTROS_VALOR_SEGURADO" style="width: 85px;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value).toFixed(2);" type="text" maxlength="15" display="OUTROS DOCUMENTOS / VALOR SEGURADO" obrigatorio="1" tipo="numerico" secao="OUTROS"></td>
                    </tr>
                    <tr>
                      <td width="1%" class="texto" nowrap="">Descrição: </td>
                      <td width="97%" class="texto" nowrap=""><input name="OUTROS_DESCRICAO" tabindex="348" class="requerido_form" id="OUTROS_DESCRICAO" style="width: 500px;" type="text" display="OUTROS DOCUMENTOS / DESCRIÇÃO DO DOCUMENTO" obrigatorio="1" secao="OUTROS"></td>
                    </tr>
                    <tr>
                       <td class="texto" nowrap="" valign="top"><nobr>Pedido/Shipment:</nobr></td>
                       <td class="texto" nowrap="" valign="top"><textarea name="OUTROS_ORDEM_COMPRA" tabindex="349" id="OUTROS_ORDEM_COMPRA" style="width: 500px; height: 45px; resize: none;" onkeypress="if (this.value.length >= 160) return false;" onblur="if (this.value.length > 160) this.value = this.value.substr(0, 160);" cols="60" readonly="" display="OUTROS DOCUMENTOS / PEDIDO/SHIPMENT" obrigatorio="0" secao="OUTROS" row="4"></textarea></td>
                    </tr>
					<tr><td class="texto" nowrap="" style="width: 1%;">Tipo de doc. para Outros: </td>
                      <td class="texto" nowrap="" style="width: 1%;">
                      <select name="TIPO_DOC_OUTROS" tabindex="350" id="TIPO_DOC_OUTROS" style="width: 200px;" display="TIPO DOCUMENTO OUTROS">
					  
                        	<option value="00">00 - Declaração</option>                        
                      
                        	<option value="10">10 - Dutoviário</option>                        
                      
                        	<option value="59">59 - CF-e SAT</option>                        
                      
                        	<option value="65">65 - NFC-e</option>                        
                      
                        	<option value="99">99 - Outros</option>                        
                      
                      </select></td>
                    <tr>
                     	<td height="1" nowrap="" style="padding: 0px;" colspan="7"><fieldset tabindex="351">
                         <legend>Mercadoria</legend>
                         <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                  <tbody><tr>
                                    <td width="8%" class="texto">Volumes:</td>
                                    <td width="12%" class="texto"><input name="OUTROS_QTDE_VOLUME" tabindex="352" class="requerido_form" id="OUTROS_QTDE_VOLUME" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_calcula_cubagem('OUTROS');" type="text" size="15" maxlength="10" display="OUTROS DOCUMENTOS / QUANTIDADE" obrigatorio="1" tipo="numerico" secao="OUTROS"></td>
                                    <td class="texto">Peso:
                                      <input name="OUTROS_PESO" tabindex="353" class="requerido_form" id="OUTROS_PESO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_sanitizar_numero(this); f_calcula_peso_kg('OUTROS')" type="text" size="10" maxlength="10" display="OUTROS DOCUMENTOS / PESO" obrigatorio="1" tipo="numerico" secao="OUTROS">
                                      <select name="OUTROS_COD_UNIDADE" tabindex="354" class="requerido_form" id="OUTROS_COD_UNIDADE" onchange="f_calcula_peso_kg('OUTROS')" fixo="1" display="OUTROS DOCUMENTOS / UNIDADE" obrigatorio="1" secao="OUTROS" manter="1">
                                          <option value="">-- Selecione --</option>
										  
										  <option value="CX 10">Caixa c/ 10</option>
										  
										  <option value="GAL22L">Galão 22 Litros</option>
										  
										  <option value="PAR">Pares</option>
										  
										  <option value="GR">Gramas</option>
										  
										  <option value="MTS">Metros</option>
										  
										  <option value="ML">Mililitros</option>
										  
										  <option value="GAL15L">Galão 15 Litros</option>
										  
										  <option value="GAL25L">Galão 25 Litros</option>
										  
										  <option value="GL10LT">Galão 10l</option>
										  
										  <option value="GL10LTS">Galão 10 Litros</option>
										  
										  <option value="GL20LTS">Galão 20 Litros</option>
										  
										  <option value="GL5LTS">Galão 5 Litros</option>
										  
										  <option value="Kg" selected="">Kilogramas</option>
										  
										  <option value="LT">Litros</option>
										  
										  <option value="M3">metros cubicos</option>
										  
										  <option value="TON">Toneladas</option>
										  
										  <option value="UN">Unidade</option>
										  
										  <option value="CX 100">Cx c/ 100</option>
										  
										  <option value="RL">Rolo</option>
										  
										  <option value="CX">Caixa</option>
										  
										  <option value="PCT">Pacote</option>
										  
                                      </select>
                                      <input name="OUTROS_M3" tabindex="355" id="OUTROS_M3" type="hidden" value="0.00" fixo="1">
                                      <input name="OUTROS_PESO_CUBADO" tabindex="356" id="OUTROS_PESO_CUBADO" type="hidden" value="0" fixo="1">
                                      <input name="OUTROS_PESO_KG_CONVERTIDO" tabindex="357" id="OUTROS_PESO_KG_CONVERTIDO" type="hidden" size="10" maxlength="10" value="" display="OUTROS DOCUMENTOS / PESO" obrigatorio="0" tipo="numerico" secao="OUTROS"></td>
                                  </tr>
                                  <tr>
                                    <td class="texto">Natureza:</td>
                                    <td class="texto" colspan="2"><input name="OUTROS_NUM_NATUREZA" tabindex="358" class="requerido_form" id="OUTROS_NUM_NATUREZA" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_natureza('OUTROS')" type="text" display="OUTROS DOCUMENTOS / NATUREZA" obrigatorio="1" secao="OUTROS">
                                      <input name="OUTROS_NATUREZA" tabindex="359" class="requerido_form" id="OUTROS_NATUREZA" style="width: 200px;" type="text" readonly="true" display="OUTROS DOCUMENTOS / NATUREZA" obrigatorio="1" secao="OUTROS">
                                      <button tabindex="360" class="botao-16x16" onclick="NewWindow('localizar_natureza.cfm?num_natureza=OUTROS_NUM_NATUREZA&amp;natureza=OUTROS_NATUREZA&amp;operacao_id=' + OPERACAO_ID_CTRC.value,'_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button>                                      
                                      &nbsp;
                                    <input name="OUTROS_COMPLEMENTO" tabindex="361" id="OUTROS_COMPLEMENTO" style="width: 177px;" type="text" display="OUTROS DOCUMENTOS / COMPLEMENTO" secao="OUTROS"></td>
                                  </tr>
                                  <tr>
                                    <td class="texto">Espécie:</td>
                                    <td class="texto" colspan="2"><input name="OUTROS_NUM_ESPECIE" tabindex="362" class="requerido_form" id="OUTROS_NUM_ESPECIE" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_especie('OUTROS')" type="text" display="OUTROS DOCUMENTOS / ESPECIE" obrigatorio="1" secao="OUTROS">
                                      <input name="OUTROS_ESPECIE" tabindex="363" class="requerido_form" id="OUTROS_ESPECIE" style="width: 200px;" type="text" readonly="true" display="OUTROS DOCUMENTOS / ESPECIE" obrigatorio="1" secao="OUTROS">
                                      <button tabindex="364" class="botao-16x16" onclick="NewWindow('/_consultas/localizar_especie.cfm?num_ESPECIE=OUTROS_NUM_ESPECIE&amp;ESPECIE=OUTROS_ESPECIE','_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button></td>
                                  </tr>
                                  <tr>
                                    <td class="texto">Altura:</td>
                                    <td class="texto" colspan="2"><input name="OUTROS_ALTURA" tabindex="365" id="OUTROS_ALTURA" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('OUTROS');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / ALTURA" obrigatorio="0" tipo="numerico" secao="OUTROS">
                                      Comprimento:
                                        <input name="OUTROS_COMPRIMENTO" tabindex="366" id="OUTROS_COMPRIMENTO" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('OUTROS');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / COMPRIMENTO" obrigatorio="0" tipo="numerico" secao="OUTROS">
                                        Largura:
                                        <input name="OUTROS_LARGURA" tabindex="367" id="OUTROS_LARGURA" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_cubagem('OUTROS');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / LARGURA" obrigatorio="0" tipo="numerico" secao="OUTROS">
                                    </td>
                                  </tr>
                                  <tr>
                                  	<td class="texto">Cubagem sugerida:</td>
                                    <td class="texto" colspan="2"><input name="OUTROS_CUBAGEM_SUGERIDA" tabindex="368" id="OUTROS_CUBAGEM_SUGERIDA" onkeypress="return f_formata_numero_decimal(this,event);" type="text" size="15" maxlength="10" readonly="true" fixo="1" display="NOTA FISCAL / CUBAGEM SUGERIDA" obrigatorio="0" tipo="numerico" secao="OUTROS">
                                        Cubagem total:
                                    <input name="OUTROS_CUBAGEM" tabindex="369" id="OUTROS_CUBAGEM" onkeypress="return f_formata_numero_decimal(this,event);" onchange="f_calcula_peso_cobrado('OUTROS');" type="text" size="15" maxlength="10" fixo="1" display="NOTA FISCAL / CUBAGEM" obrigatorio="0" tipo="numerico" secao="OUTROS">
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="texto"><nobr>Peso Cobrado: </nobr> </td>
                                    <td class="texto" colspan="2"><input name="OUTROS_PESO_COBRADO" tabindex="370" class="requerido_form" id="OUTROS_PESO_COBRADO" style="width: 90px;" onkeypress="return f_formata_numero_decimal(this,event)" type="text" display="OUTROS DOCUMENTOS / PESO COBRADO" obrigatorio="1" secao="OUTROS">
                                      Kg</td>
                                  </tr>
                          </tbody></table></fieldset></td>
                   </tr>
                </tbody></table>
                <table width="90%" border="0" cellspacing="3" cellpadding="1">
                	<tbody><tr>
                        <td width="90%" style="padding-top: 5px;">
                            <table width="90%" border="0" cellspacing="3" cellpadding="1">
                            <tbody><tr><td>
                            
<script src="/_scripts/tablesort.js"></script>
<script language="javascript1.2">
var DOUBLE_QUOTES = new RegExp( '"([^"]*)"', 'g' );


function f_ordenar_OUTROS(campo, desc, tipo) {
//	try {
		if(!tipo) 
			tipo = 'caseinsensitivestring';
		v_tb = document.getElementById('tb_lista_OUTROS');
		v_rows2 = new Array();
		for(var i=0;i<v_tb.rows.length;i++) 
			v_rows2.push(v_tb.rows[i]);
		v_rows2.sort(function(a,b) {
				v_id_a = a.id.replace('tr_lista_OUTROS_','');
				v_id_b = b.id.replace('tr_lista_OUTROS_','');
				if(tipo == 'number') {
					if( Number(document.getElementById(campo+'_OUTROS_'+v_id_a).value) < Number(document.getElementById(campo+'_OUTROS_'+v_id_b).value)) 
						return desc ? +1 : -1;
					if( Number(document.getElementById(campo+'_OUTROS_'+v_id_a).value) > Number(document.getElementById(campo+'_OUTROS_'+v_id_b).value)) 
						return desc ? -1 : +1;
				} else if(tipo == 'caseinsensitivestring') {
					if(document.getElementById(campo+'_OUTROS_'+v_id_a).value < document.getElementById(campo+'_OUTROS_'+v_id_b).value) 
						return desc ? +1 : -1;
					if(document.getElementById(campo+'_OUTROS_'+v_id_a).value > document.getElementById(campo+'_OUTROS_'+v_id_b).value) 
						return desc ? -1 : +1;
				}
				return 0;
			});
		for(var i=0;i<v_rows2.length;i++) {
			v_tb.appendChild(v_rows2[i]);
		}
//	} catch(e) {}
}

function f_incluir_OUTROS() {
	with(document.forms[0]) {
		
		f_cancelar_OUTROS();
	}
}

function f_excluir_OUTROS(v_nro, v_nao_mostra_confirmar) {
	if(v_nro == -1) {
		return;
	}
	if(!v_nao_mostra_confirmar) {
		if(!confirm('Clique OK para confirmar a exclusão do registro!')) {
			return;
		}
	}
	with (document.forms[0]) {
		
			lista_deleted_OUTROS.value = lista_deleted_OUTROS.value+','+document.getElementById('OUTROS_NUMERO_OUTROS_'+v_nro).value;
		
	}
	var tbody = document.getElementById('tb_lista_OUTROS');		
	for(var i=0;i<tbody.rows.length;i++) {
		if(tbody.rows[i].id == 'tr_lista_OUTROS_'+v_nro) {
			tbody.deleteRow(i);
			f_cancelar_OUTROS();
			break;
		}
	}
		
	
	f_cancelar_OUTROS();
	f_on_salva_lista_OUTROS();
	f_on_excluir_OUTROS();
}
function f_limpar_OUTROS() {
	var tbody = document.getElementById('tb_lista_OUTROS');	
	while (tbody.rows.length > 0) {
		tbody.deleteRow(0);
	}
		
	
	document.forms[0].lista_selected_OUTROS.value = -1;
}
var lista_count_OUTROS = 0;


function f_testa_existencia_OUTROS(chave, linha_atual, selectable) {
	var listagem = f_listagem_OUTROS();
	for(var i=0;i<listagem.length;i++) {
		var items = chave.split('|');
		var igual = true;
		for(var j=0;j<items.length;j++) {
			if(eval('listagem['+i+'].'+items[j]) != eval('document.forms[0].'+items[j]+'.value') || listagem[i].id == linha_atual) {
					igual = false;
			}
		}
		if (igual) {
			return true;
		}
	}
}
function f_salvar_OUTROS() {
	
	if (!f_before_salvar_OUTROS()) {
	   return;
	}	
	if(f_verifica_form(document.forms[0], 'OUTROS'))	{
		var padrao = true;
		var tbody = document.getElementById('tb_lista_OUTROS');
		for(var i=0;i<tbody.rows.length;i++) {
			var row_id = tbody.rows[i].id.replace('tr_lista_OUTROS_', '');
			if(document.getElementById('lista_padrao_OUTROS_'+row_id).style.display == '') {
				padrao = false;
			}
		}
		with(document.forms[0]) {
			
			if(lista_selected_OUTROS.value == -1) {
				var v_tr = document.createElement('TR');
				v_tr.id = 'tr_lista_OUTROS_'+lista_count_OUTROS;
				var temp_count = lista_count_OUTROS;
				v_tr.style.cursor = 'pointer';
				v_tr.onclick = function() {
					f_seleciona_OUTROS(temp_count);
				}
				var v_td = document.createElement('TD');
				var v_dv1 = document.createElement('div');
				v_td.appendChild(v_dv1);
				v_td.className = 'linha_1';
				lista_inputs = '<input type="hidden" name="PADRAO_OUTROS_'+lista_count_OUTROS+'" id="PADRAO_OUTROS_'+lista_count_OUTROS+'" value="'+((padrao)?1:0)+'">';
				
				if (NF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_OUTROS_'+lista_count_OUTROS+'" id="NF_CONHECIMENTO_ID_OUTROS_'+lista_count_OUTROS+'" value="'+((NF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
				} else if (NF_CONHECIMENTO_ID.type == 'file') {
					v_campo_file = document.forms[0].NF_CONHECIMENTO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NF_CONHECIMENTO_ID_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'NF_CONHECIMENTO_ID_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'NF_CONHECIMENTO_ID';
					v_file_input.id = 'NF_CONHECIMENTO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NF_CONHECIMENTO_ID.value;
				
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_OUTROS_'+lista_count_OUTROS+'" id="NF_CONHECIMENTO_ID_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ID_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ID_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_ID.checked)?"1":"0")+'">';
				} else if (OUTROS_ID.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_ID_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_ID_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_ID';
					v_file_input.id = 'OUTROS_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_ID.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_ID_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ID_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NUMERO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NUMERO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_NUMERO.checked)?"1":"0")+'">';
				} else if (OUTROS_NUMERO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_NUMERO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_NUMERO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_NUMERO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_NUMERO';
					v_file_input.id = 'OUTROS_NUMERO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_NUMERO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_NUMERO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NUMERO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_DATA_EMISSAO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_DATA_EMISSAO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_DATA_EMISSAO.checked)?"1":"0")+'">';
				} else if (OUTROS_DATA_EMISSAO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_DATA_EMISSAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_DATA_EMISSAO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_DATA_EMISSAO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_DATA_EMISSAO';
					v_file_input.id = 'OUTROS_DATA_EMISSAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_DATA_EMISSAO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_DATA_EMISSAO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_DATA_EMISSAO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_DESCRICAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_DESCRICAO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_DESCRICAO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_DESCRICAO.checked)?"1":"0")+'">';
				} else if (OUTROS_DESCRICAO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_DESCRICAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_DESCRICAO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_DESCRICAO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_DESCRICAO';
					v_file_input.id = 'OUTROS_DESCRICAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_DESCRICAO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_DESCRICAO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_DESCRICAO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_VALOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_VALOR_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_VALOR.checked)?"1":"0")+'">';
				} else if (OUTROS_VALOR.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_VALOR;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_VALOR_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_VALOR_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_VALOR';
					v_file_input.id = 'OUTROS_VALOR';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_VALOR.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_VALOR_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_VALOR_SEGURADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_SEGURADO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_VALOR_SEGURADO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_VALOR_SEGURADO.checked)?"1":"0")+'">';
				} else if (OUTROS_VALOR_SEGURADO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_VALOR_SEGURADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_VALOR_SEGURADO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_VALOR_SEGURADO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_VALOR_SEGURADO';
					v_file_input.id = 'OUTROS_VALOR_SEGURADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_VALOR_SEGURADO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_SEGURADO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_VALOR_SEGURADO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_QTDE_VOLUME.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_QTDE_VOLUME_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_QTDE_VOLUME_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_QTDE_VOLUME.checked)?"1":"0")+'">';
				} else if (OUTROS_QTDE_VOLUME.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_QTDE_VOLUME;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_QTDE_VOLUME_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_QTDE_VOLUME_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_QTDE_VOLUME';
					v_file_input.id = 'OUTROS_QTDE_VOLUME';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_QTDE_VOLUME.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_QTDE_VOLUME_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_QTDE_VOLUME_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_PESO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_PESO.checked)?"1":"0")+'">';
				} else if (OUTROS_PESO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_PESO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_PESO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_PESO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_PESO';
					v_file_input.id = 'OUTROS_PESO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_PESO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_COD_UNIDADE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_COD_UNIDADE_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_COD_UNIDADE_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_COD_UNIDADE.checked)?"1":"0")+'">';
				} else if (OUTROS_COD_UNIDADE.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_COD_UNIDADE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_COD_UNIDADE_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_COD_UNIDADE_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_COD_UNIDADE';
					v_file_input.id = 'OUTROS_COD_UNIDADE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_COD_UNIDADE.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_COD_UNIDADE_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_COD_UNIDADE_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_M3.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_M3_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_M3_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_M3.checked)?"1":"0")+'">';
				} else if (OUTROS_M3.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_M3;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_M3_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_M3_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_M3';
					v_file_input.id = 'OUTROS_M3';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_M3.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_M3_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_M3_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_PESO_CUBADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_CUBADO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_CUBADO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_PESO_CUBADO.checked)?"1":"0")+'">';
				} else if (OUTROS_PESO_CUBADO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_PESO_CUBADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_PESO_CUBADO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_PESO_CUBADO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_PESO_CUBADO';
					v_file_input.id = 'OUTROS_PESO_CUBADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_PESO_CUBADO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_CUBADO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_CUBADO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_PESO_KG_CONVERTIDO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_PESO_KG_CONVERTIDO.checked)?"1":"0")+'">';
				} else if (OUTROS_PESO_KG_CONVERTIDO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_PESO_KG_CONVERTIDO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_PESO_KG_CONVERTIDO';
					v_file_input.id = 'OUTROS_PESO_KG_CONVERTIDO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_PESO_KG_CONVERTIDO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_NUM_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_NATUREZA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NUM_NATUREZA_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_NUM_NATUREZA.checked)?"1":"0")+'">';
				} else if (OUTROS_NUM_NATUREZA.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_NUM_NATUREZA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_NUM_NATUREZA_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_NUM_NATUREZA_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_NUM_NATUREZA';
					v_file_input.id = 'OUTROS_NUM_NATUREZA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_NUM_NATUREZA.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_NATUREZA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NUM_NATUREZA_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NATUREZA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NATUREZA_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_NATUREZA.checked)?"1":"0")+'">';
				} else if (OUTROS_NATUREZA.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_NATUREZA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_NATUREZA_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_NATUREZA_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_NATUREZA';
					v_file_input.id = 'OUTROS_NATUREZA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_NATUREZA.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_NATUREZA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NATUREZA_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_COMPLEMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_COMPLEMENTO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_COMPLEMENTO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_COMPLEMENTO.checked)?"1":"0")+'">';
				} else if (OUTROS_COMPLEMENTO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_COMPLEMENTO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_COMPLEMENTO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_COMPLEMENTO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_COMPLEMENTO';
					v_file_input.id = 'OUTROS_COMPLEMENTO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_COMPLEMENTO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_COMPLEMENTO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_COMPLEMENTO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_NUM_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_ESPECIE_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NUM_ESPECIE_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_NUM_ESPECIE.checked)?"1":"0")+'">';
				} else if (OUTROS_NUM_ESPECIE.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_NUM_ESPECIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_NUM_ESPECIE_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_NUM_ESPECIE_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_NUM_ESPECIE';
					v_file_input.id = 'OUTROS_NUM_ESPECIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_NUM_ESPECIE.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_ESPECIE_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_NUM_ESPECIE_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ESPECIE_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ESPECIE_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_ESPECIE.checked)?"1":"0")+'">';
				} else if (OUTROS_ESPECIE.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_ESPECIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_ESPECIE_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_ESPECIE_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_ESPECIE';
					v_file_input.id = 'OUTROS_ESPECIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_ESPECIE.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_ESPECIE_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ESPECIE_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_ALTURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ALTURA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ALTURA_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_ALTURA.checked)?"1":"0")+'">';
				} else if (OUTROS_ALTURA.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_ALTURA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_ALTURA_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_ALTURA_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_ALTURA';
					v_file_input.id = 'OUTROS_ALTURA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_ALTURA.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_ALTURA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ALTURA_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_COMPRIMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_COMPRIMENTO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_COMPRIMENTO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_COMPRIMENTO.checked)?"1":"0")+'">';
				} else if (OUTROS_COMPRIMENTO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_COMPRIMENTO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_COMPRIMENTO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_COMPRIMENTO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_COMPRIMENTO';
					v_file_input.id = 'OUTROS_COMPRIMENTO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_COMPRIMENTO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_COMPRIMENTO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_COMPRIMENTO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_LARGURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_LARGURA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_LARGURA_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_LARGURA.checked)?"1":"0")+'">';
				} else if (OUTROS_LARGURA.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_LARGURA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_LARGURA_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_LARGURA_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_LARGURA';
					v_file_input.id = 'OUTROS_LARGURA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_LARGURA.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_LARGURA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_LARGURA_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_CUBAGEM.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_CUBAGEM_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_CUBAGEM.checked)?"1":"0")+'">';
				} else if (OUTROS_CUBAGEM.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_CUBAGEM;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_CUBAGEM_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_CUBAGEM_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_CUBAGEM';
					v_file_input.id = 'OUTROS_CUBAGEM';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_CUBAGEM.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_CUBAGEM_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_CUBAGEM_SUGERIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_CUBAGEM_SUGERIDA.checked)?"1":"0")+'">';
				} else if (OUTROS_CUBAGEM_SUGERIDA.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_CUBAGEM_SUGERIDA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_CUBAGEM_SUGERIDA';
					v_file_input.id = 'OUTROS_CUBAGEM_SUGERIDA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_CUBAGEM_SUGERIDA.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_PESO_COBRADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_COBRADO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_COBRADO_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_PESO_COBRADO.checked)?"1":"0")+'">';
				} else if (OUTROS_PESO_COBRADO.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_PESO_COBRADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_PESO_COBRADO_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_PESO_COBRADO_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_PESO_COBRADO';
					v_file_input.id = 'OUTROS_PESO_COBRADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_PESO_COBRADO.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_COBRADO_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_PESO_COBRADO_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OUTROS_ORDEM_COMPRA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ORDEM_COMPRA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ORDEM_COMPRA_OUTROS_'+lista_count_OUTROS+'" value="'+((OUTROS_ORDEM_COMPRA.checked)?"1":"0")+'">';
				} else if (OUTROS_ORDEM_COMPRA.type == 'file') {
					v_campo_file = document.forms[0].OUTROS_ORDEM_COMPRA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OUTROS_ORDEM_COMPRA_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'OUTROS_ORDEM_COMPRA_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'OUTROS_ORDEM_COMPRA';
					v_file_input.id = 'OUTROS_ORDEM_COMPRA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OUTROS_ORDEM_COMPRA.value;
				
					lista_inputs += '<input type="hidden" name="OUTROS_ORDEM_COMPRA_OUTROS_'+lista_count_OUTROS+'" id="OUTROS_ORDEM_COMPRA_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (TIPO_DOC_OUTROS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="TIPO_DOC_OUTROS_OUTROS_'+lista_count_OUTROS+'" id="TIPO_DOC_OUTROS_OUTROS_'+lista_count_OUTROS+'" value="'+((TIPO_DOC_OUTROS.checked)?"1":"0")+'">';
				} else if (TIPO_DOC_OUTROS.type == 'file') {
					v_campo_file = document.forms[0].TIPO_DOC_OUTROS;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'TIPO_DOC_OUTROS_OUTROS_'+lista_count_OUTROS;
					v_campo_file.name = 'TIPO_DOC_OUTROS_OUTROS_'+lista_count_OUTROS;
					v_file_input.name = 'TIPO_DOC_OUTROS';
					v_file_input.id = 'TIPO_DOC_OUTROS';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = TIPO_DOC_OUTROS.value;
				
					lista_inputs += '<input type="hidden" name="TIPO_DOC_OUTROS_OUTROS_'+lista_count_OUTROS+'" id="TIPO_DOC_OUTROS_OUTROS_'+lista_count_OUTROS+'">';
				}
//				v_td.appendChild(v_input)
				
				v_dv1.innerHTML = '<img id="lista_padrao_OUTROS_'+lista_count_OUTROS+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				v_td.width = 16;
				
				v_td.style.display = 'none';
				
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+OUTROS_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+OUTROS_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+OUTROS_DESCRICAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+OUTROS_VALOR.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+TIPO_DOC_OUTROS.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				tbody.appendChild(v_tr);
				
				if (NF_CONHECIMENTO_ID.type != 'checkbox' && NF_CONHECIMENTO_ID.type != 'file') {
					document.getElementById('NF_CONHECIMENTO_ID_OUTROS_'+lista_count_OUTROS).value = NF_CONHECIMENTO_ID.value;
				}
				
				if (OUTROS_ID.type != 'checkbox' && OUTROS_ID.type != 'file') {
					document.getElementById('OUTROS_ID_OUTROS_'+lista_count_OUTROS).value = OUTROS_ID.value;
				}
				
				if (OUTROS_NUMERO.type != 'checkbox' && OUTROS_NUMERO.type != 'file') {
					document.getElementById('OUTROS_NUMERO_OUTROS_'+lista_count_OUTROS).value = OUTROS_NUMERO.value;
				}
				
				if (OUTROS_DATA_EMISSAO.type != 'checkbox' && OUTROS_DATA_EMISSAO.type != 'file') {
					document.getElementById('OUTROS_DATA_EMISSAO_OUTROS_'+lista_count_OUTROS).value = OUTROS_DATA_EMISSAO.value;
				}
				
				if (OUTROS_DESCRICAO.type != 'checkbox' && OUTROS_DESCRICAO.type != 'file') {
					document.getElementById('OUTROS_DESCRICAO_OUTROS_'+lista_count_OUTROS).value = OUTROS_DESCRICAO.value;
				}
				
				if (OUTROS_VALOR.type != 'checkbox' && OUTROS_VALOR.type != 'file') {
					document.getElementById('OUTROS_VALOR_OUTROS_'+lista_count_OUTROS).value = OUTROS_VALOR.value;
				}
				
				if (OUTROS_VALOR_SEGURADO.type != 'checkbox' && OUTROS_VALOR_SEGURADO.type != 'file') {
					document.getElementById('OUTROS_VALOR_SEGURADO_OUTROS_'+lista_count_OUTROS).value = OUTROS_VALOR_SEGURADO.value;
				}
				
				if (OUTROS_QTDE_VOLUME.type != 'checkbox' && OUTROS_QTDE_VOLUME.type != 'file') {
					document.getElementById('OUTROS_QTDE_VOLUME_OUTROS_'+lista_count_OUTROS).value = OUTROS_QTDE_VOLUME.value;
				}
				
				if (OUTROS_PESO.type != 'checkbox' && OUTROS_PESO.type != 'file') {
					document.getElementById('OUTROS_PESO_OUTROS_'+lista_count_OUTROS).value = OUTROS_PESO.value;
				}
				
				if (OUTROS_COD_UNIDADE.type != 'checkbox' && OUTROS_COD_UNIDADE.type != 'file') {
					document.getElementById('OUTROS_COD_UNIDADE_OUTROS_'+lista_count_OUTROS).value = OUTROS_COD_UNIDADE.value;
				}
				
				if (OUTROS_M3.type != 'checkbox' && OUTROS_M3.type != 'file') {
					document.getElementById('OUTROS_M3_OUTROS_'+lista_count_OUTROS).value = OUTROS_M3.value;
				}
				
				if (OUTROS_PESO_CUBADO.type != 'checkbox' && OUTROS_PESO_CUBADO.type != 'file') {
					document.getElementById('OUTROS_PESO_CUBADO_OUTROS_'+lista_count_OUTROS).value = OUTROS_PESO_CUBADO.value;
				}
				
				if (OUTROS_PESO_KG_CONVERTIDO.type != 'checkbox' && OUTROS_PESO_KG_CONVERTIDO.type != 'file') {
					document.getElementById('OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_count_OUTROS).value = OUTROS_PESO_KG_CONVERTIDO.value;
				}
				
				if (OUTROS_NUM_NATUREZA.type != 'checkbox' && OUTROS_NUM_NATUREZA.type != 'file') {
					document.getElementById('OUTROS_NUM_NATUREZA_OUTROS_'+lista_count_OUTROS).value = OUTROS_NUM_NATUREZA.value;
				}
				
				if (OUTROS_NATUREZA.type != 'checkbox' && OUTROS_NATUREZA.type != 'file') {
					document.getElementById('OUTROS_NATUREZA_OUTROS_'+lista_count_OUTROS).value = OUTROS_NATUREZA.value;
				}
				
				if (OUTROS_COMPLEMENTO.type != 'checkbox' && OUTROS_COMPLEMENTO.type != 'file') {
					document.getElementById('OUTROS_COMPLEMENTO_OUTROS_'+lista_count_OUTROS).value = OUTROS_COMPLEMENTO.value;
				}
				
				if (OUTROS_NUM_ESPECIE.type != 'checkbox' && OUTROS_NUM_ESPECIE.type != 'file') {
					document.getElementById('OUTROS_NUM_ESPECIE_OUTROS_'+lista_count_OUTROS).value = OUTROS_NUM_ESPECIE.value;
				}
				
				if (OUTROS_ESPECIE.type != 'checkbox' && OUTROS_ESPECIE.type != 'file') {
					document.getElementById('OUTROS_ESPECIE_OUTROS_'+lista_count_OUTROS).value = OUTROS_ESPECIE.value;
				}
				
				if (OUTROS_ALTURA.type != 'checkbox' && OUTROS_ALTURA.type != 'file') {
					document.getElementById('OUTROS_ALTURA_OUTROS_'+lista_count_OUTROS).value = OUTROS_ALTURA.value;
				}
				
				if (OUTROS_COMPRIMENTO.type != 'checkbox' && OUTROS_COMPRIMENTO.type != 'file') {
					document.getElementById('OUTROS_COMPRIMENTO_OUTROS_'+lista_count_OUTROS).value = OUTROS_COMPRIMENTO.value;
				}
				
				if (OUTROS_LARGURA.type != 'checkbox' && OUTROS_LARGURA.type != 'file') {
					document.getElementById('OUTROS_LARGURA_OUTROS_'+lista_count_OUTROS).value = OUTROS_LARGURA.value;
				}
				
				if (OUTROS_CUBAGEM.type != 'checkbox' && OUTROS_CUBAGEM.type != 'file') {
					document.getElementById('OUTROS_CUBAGEM_OUTROS_'+lista_count_OUTROS).value = OUTROS_CUBAGEM.value;
				}
				
				if (OUTROS_CUBAGEM_SUGERIDA.type != 'checkbox' && OUTROS_CUBAGEM_SUGERIDA.type != 'file') {
					document.getElementById('OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_count_OUTROS).value = OUTROS_CUBAGEM_SUGERIDA.value;
				}
				
				if (OUTROS_PESO_COBRADO.type != 'checkbox' && OUTROS_PESO_COBRADO.type != 'file') {
					document.getElementById('OUTROS_PESO_COBRADO_OUTROS_'+lista_count_OUTROS).value = OUTROS_PESO_COBRADO.value;
				}
				
				if (OUTROS_ORDEM_COMPRA.type != 'checkbox' && OUTROS_ORDEM_COMPRA.type != 'file') {
					document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_'+lista_count_OUTROS).value = OUTROS_ORDEM_COMPRA.value;
				}
				
				if (TIPO_DOC_OUTROS.type != 'checkbox' && TIPO_DOC_OUTROS.type != 'file') {
					document.getElementById('TIPO_DOC_OUTROS_OUTROS_'+lista_count_OUTROS).value = TIPO_DOC_OUTROS.value;
				}
				

				lista_count_OUTROS++;
				f_atualiza_campos_escravos_OUTROS();
				f_incluir_OUTROS();
			} else {
				var v_tr = document.getElementById('tr_lista_OUTROS_'+lista_selected_OUTROS.value);
				padrao = (document.getElementById('PADRAO_OUTROS_'+lista_selected_OUTROS.value).value == 1);
				lista_inputs = '<input type="hidden" name="PADRAO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((padrao)?1:0)+'">';
				
				if (NF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((NF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
					document.getElementById('NF_CONHECIMENTO_ID_OUTROS_'+lista_selected_OUTROS.value).value = ((NF_CONHECIMENTO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NF_CONHECIMENTO_ID_OUTROS_'+lista_selected_OUTROS.value+'" value="'+NF_CONHECIMENTO_ID.value+'">';
					document.getElementById('NF_CONHECIMENTO_ID_OUTROS_'+lista_selected_OUTROS.value).value = NF_CONHECIMENTO_ID.value;
				}
				
				if (OUTROS_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ID_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_ID.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_ID_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_ID_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_ID.value+'">';
					document.getElementById('OUTROS_ID_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_ID.value;
				}
				
				if (OUTROS_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NUMERO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_NUMERO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_NUMERO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_NUMERO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_NUMERO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_NUMERO.value+'">';
					document.getElementById('OUTROS_NUMERO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_NUMERO.value;
				}
				
				if (OUTROS_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_DATA_EMISSAO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_DATA_EMISSAO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_DATA_EMISSAO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_DATA_EMISSAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_DATA_EMISSAO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_DATA_EMISSAO.value+'">';
					document.getElementById('OUTROS_DATA_EMISSAO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_DATA_EMISSAO.value;
				}
				
				if (OUTROS_DESCRICAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_DESCRICAO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_DESCRICAO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_DESCRICAO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_DESCRICAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_DESCRICAO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_DESCRICAO.value+'">';
					document.getElementById('OUTROS_DESCRICAO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_DESCRICAO.value;
				}
				
				if (OUTROS_VALOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_VALOR.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_VALOR_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_VALOR.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_VALOR.value+'">';
					document.getElementById('OUTROS_VALOR_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_VALOR.value;
				}
				
				if (OUTROS_VALOR_SEGURADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_SEGURADO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_VALOR_SEGURADO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_VALOR_SEGURADO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_VALOR_SEGURADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_VALOR_SEGURADO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_VALOR_SEGURADO.value+'">';
					document.getElementById('OUTROS_VALOR_SEGURADO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_VALOR_SEGURADO.value;
				}
				
				if (OUTROS_QTDE_VOLUME.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_QTDE_VOLUME_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_QTDE_VOLUME.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_QTDE_VOLUME_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_QTDE_VOLUME.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_QTDE_VOLUME_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_QTDE_VOLUME.value+'">';
					document.getElementById('OUTROS_QTDE_VOLUME_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_QTDE_VOLUME.value;
				}
				
				if (OUTROS_PESO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_PESO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_PESO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_PESO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_PESO.value+'">';
					document.getElementById('OUTROS_PESO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_PESO.value;
				}
				
				if (OUTROS_COD_UNIDADE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_COD_UNIDADE_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_COD_UNIDADE.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_COD_UNIDADE_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_COD_UNIDADE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_COD_UNIDADE_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_COD_UNIDADE.value+'">';
					document.getElementById('OUTROS_COD_UNIDADE_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_COD_UNIDADE.value;
				}
				
				if (OUTROS_M3.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_M3_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_M3.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_M3_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_M3.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_M3_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_M3.value+'">';
					document.getElementById('OUTROS_M3_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_M3.value;
				}
				
				if (OUTROS_PESO_CUBADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_CUBADO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_PESO_CUBADO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_PESO_CUBADO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_PESO_CUBADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_CUBADO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_PESO_CUBADO.value+'">';
					document.getElementById('OUTROS_PESO_CUBADO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_PESO_CUBADO.value;
				}
				
				if (OUTROS_PESO_KG_CONVERTIDO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_PESO_KG_CONVERTIDO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_PESO_KG_CONVERTIDO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_PESO_KG_CONVERTIDO.value+'">';
					document.getElementById('OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_PESO_KG_CONVERTIDO.value;
				}
				
				if (OUTROS_NUM_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_NATUREZA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_NUM_NATUREZA.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_NUM_NATUREZA_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_NUM_NATUREZA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_NATUREZA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_NUM_NATUREZA.value+'">';
					document.getElementById('OUTROS_NUM_NATUREZA_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_NUM_NATUREZA.value;
				}
				
				if (OUTROS_NATUREZA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NATUREZA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_NATUREZA.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_NATUREZA_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_NATUREZA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_NATUREZA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_NATUREZA.value+'">';
					document.getElementById('OUTROS_NATUREZA_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_NATUREZA.value;
				}
				
				if (OUTROS_COMPLEMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_COMPLEMENTO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_COMPLEMENTO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_COMPLEMENTO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_COMPLEMENTO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_COMPLEMENTO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_COMPLEMENTO.value+'">';
					document.getElementById('OUTROS_COMPLEMENTO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_COMPLEMENTO.value;
				}
				
				if (OUTROS_NUM_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_ESPECIE_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_NUM_ESPECIE.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_NUM_ESPECIE_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_NUM_ESPECIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_NUM_ESPECIE_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_NUM_ESPECIE.value+'">';
					document.getElementById('OUTROS_NUM_ESPECIE_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_NUM_ESPECIE.value;
				}
				
				if (OUTROS_ESPECIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ESPECIE_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_ESPECIE.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_ESPECIE_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_ESPECIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_ESPECIE_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_ESPECIE.value+'">';
					document.getElementById('OUTROS_ESPECIE_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_ESPECIE.value;
				}
				
				if (OUTROS_ALTURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ALTURA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_ALTURA.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_ALTURA_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_ALTURA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_ALTURA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_ALTURA.value+'">';
					document.getElementById('OUTROS_ALTURA_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_ALTURA.value;
				}
				
				if (OUTROS_COMPRIMENTO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_COMPRIMENTO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_COMPRIMENTO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_COMPRIMENTO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_COMPRIMENTO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_COMPRIMENTO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_COMPRIMENTO.value+'">';
					document.getElementById('OUTROS_COMPRIMENTO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_COMPRIMENTO.value;
				}
				
				if (OUTROS_LARGURA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_LARGURA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_LARGURA.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_LARGURA_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_LARGURA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_LARGURA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_LARGURA.value+'">';
					document.getElementById('OUTROS_LARGURA_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_LARGURA.value;
				}
				
				if (OUTROS_CUBAGEM.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_CUBAGEM.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_CUBAGEM_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_CUBAGEM.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_CUBAGEM.value+'">';
					document.getElementById('OUTROS_CUBAGEM_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_CUBAGEM.value;
				}
				
				if (OUTROS_CUBAGEM_SUGERIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_CUBAGEM_SUGERIDA.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_CUBAGEM_SUGERIDA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_CUBAGEM_SUGERIDA.value+'">';
					document.getElementById('OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_CUBAGEM_SUGERIDA.value;
				}
				
				if (OUTROS_PESO_COBRADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_COBRADO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_PESO_COBRADO.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_PESO_COBRADO_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_PESO_COBRADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_PESO_COBRADO_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_PESO_COBRADO.value+'">';
					document.getElementById('OUTROS_PESO_COBRADO_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_PESO_COBRADO.value;
				}
				
				if (OUTROS_ORDEM_COMPRA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OUTROS_ORDEM_COMPRA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((OUTROS_ORDEM_COMPRA.checked)?"1":"0")+'">';
					document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_'+lista_selected_OUTROS.value).value = ((OUTROS_ORDEM_COMPRA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OUTROS_ORDEM_COMPRA_OUTROS_'+lista_selected_OUTROS.value+'" value="'+OUTROS_ORDEM_COMPRA.value+'">';
					document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_'+lista_selected_OUTROS.value).value = OUTROS_ORDEM_COMPRA.value;
				}
				
				if (TIPO_DOC_OUTROS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="TIPO_DOC_OUTROS_OUTROS_'+lista_selected_OUTROS.value+'" value="'+((TIPO_DOC_OUTROS.checked)?"1":"0")+'">';
					document.getElementById('TIPO_DOC_OUTROS_OUTROS_'+lista_selected_OUTROS.value).value = ((TIPO_DOC_OUTROS.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="TIPO_DOC_OUTROS_OUTROS_'+lista_selected_OUTROS.value+'" value="'+TIPO_DOC_OUTROS.value+'">';
					document.getElementById('TIPO_DOC_OUTROS_OUTROS_'+lista_selected_OUTROS.value).value = TIPO_DOC_OUTROS.value;
				}
				
//				v_tr.cells[0].innerHTML = '<img id="lista_padrao_OUTROS_'+lista_selected_OUTROS.value+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				
					var v_td = v_tr.cells[1];
					v_td.innerHTML = ''+OUTROS_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[2];
					v_td.innerHTML = ''+OUTROS_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[3];
					v_td.innerHTML = ''+OUTROS_DESCRICAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[4];
					v_td.innerHTML = ''+OUTROS_VALOR.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[5];
					v_td.innerHTML = ''+TIPO_DOC_OUTROS.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
								
				f_atualiza_campos_escravos_OUTROS();
				f_incluir_OUTROS();
			}
		}
			
		
		f_on_salva_lista_OUTROS();
	}
}
function f_cancelar_OUTROS() {
	var tbody = document.getElementById('tb_lista_OUTROS');		
	for(var i=0;i<tbody.rows.length;i++) {
		for(var j=0;j<tbody.rows[i].cells.length;j++) {
			tbody.rows[i].cells[j].className = 'linha_1';
		}
	}
	with(document.forms[0]) {
	
		

		if(document.getElementById('NF_CONHECIMENTO_ID').getAttribute('type') != 'file') {
		  if (!NF_CONHECIMENTO_ID.getAttribute('manter') || NF_CONHECIMENTO_ID.getAttribute('manter') == 0) {
				if(NF_CONHECIMENTO_ID.type == 'checkbox') {
					NF_CONHECIMENTO_ID.checked = false;
				} else if(NF_CONHECIMENTO_ID.type == 'select-one') {
					NF_CONHECIMENTO_ID.selectedIndex = 0;
				} else {
					NF_CONHECIMENTO_ID.value = '';
				}
				
				try {
					NF_CONHECIMENTO_ID.focus();
				} catch(e) {
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_ID').getAttribute('type') != 'file') {
		  if (!OUTROS_ID.getAttribute('manter') || OUTROS_ID.getAttribute('manter') == 0) {
				if(OUTROS_ID.type == 'checkbox') {
					OUTROS_ID.checked = false;
				} else if(OUTROS_ID.type == 'select-one') {
					OUTROS_ID.selectedIndex = 0;
				} else {
					OUTROS_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_NUMERO').getAttribute('type') != 'file') {
		  if (!OUTROS_NUMERO.getAttribute('manter') || OUTROS_NUMERO.getAttribute('manter') == 0) {
				if(OUTROS_NUMERO.type == 'checkbox') {
					OUTROS_NUMERO.checked = false;
				} else if(OUTROS_NUMERO.type == 'select-one') {
					OUTROS_NUMERO.selectedIndex = 0;
				} else {
					OUTROS_NUMERO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_DATA_EMISSAO').getAttribute('type') != 'file') {
		  if (!OUTROS_DATA_EMISSAO.getAttribute('manter') || OUTROS_DATA_EMISSAO.getAttribute('manter') == 0) {
				if(OUTROS_DATA_EMISSAO.type == 'checkbox') {
					OUTROS_DATA_EMISSAO.checked = false;
				} else if(OUTROS_DATA_EMISSAO.type == 'select-one') {
					OUTROS_DATA_EMISSAO.selectedIndex = 0;
				} else {
					OUTROS_DATA_EMISSAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_DESCRICAO').getAttribute('type') != 'file') {
		  if (!OUTROS_DESCRICAO.getAttribute('manter') || OUTROS_DESCRICAO.getAttribute('manter') == 0) {
				if(OUTROS_DESCRICAO.type == 'checkbox') {
					OUTROS_DESCRICAO.checked = false;
				} else if(OUTROS_DESCRICAO.type == 'select-one') {
					OUTROS_DESCRICAO.selectedIndex = 0;
				} else {
					OUTROS_DESCRICAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_VALOR').getAttribute('type') != 'file') {
		  if (!OUTROS_VALOR.getAttribute('manter') || OUTROS_VALOR.getAttribute('manter') == 0) {
				if(OUTROS_VALOR.type == 'checkbox') {
					OUTROS_VALOR.checked = false;
				} else if(OUTROS_VALOR.type == 'select-one') {
					OUTROS_VALOR.selectedIndex = 0;
				} else {
					OUTROS_VALOR.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_VALOR_SEGURADO').getAttribute('type') != 'file') {
		  if (!OUTROS_VALOR_SEGURADO.getAttribute('manter') || OUTROS_VALOR_SEGURADO.getAttribute('manter') == 0) {
				if(OUTROS_VALOR_SEGURADO.type == 'checkbox') {
					OUTROS_VALOR_SEGURADO.checked = false;
				} else if(OUTROS_VALOR_SEGURADO.type == 'select-one') {
					OUTROS_VALOR_SEGURADO.selectedIndex = 0;
				} else {
					OUTROS_VALOR_SEGURADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_QTDE_VOLUME').getAttribute('type') != 'file') {
		  if (!OUTROS_QTDE_VOLUME.getAttribute('manter') || OUTROS_QTDE_VOLUME.getAttribute('manter') == 0) {
				if(OUTROS_QTDE_VOLUME.type == 'checkbox') {
					OUTROS_QTDE_VOLUME.checked = false;
				} else if(OUTROS_QTDE_VOLUME.type == 'select-one') {
					OUTROS_QTDE_VOLUME.selectedIndex = 0;
				} else {
					OUTROS_QTDE_VOLUME.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_PESO').getAttribute('type') != 'file') {
		  if (!OUTROS_PESO.getAttribute('manter') || OUTROS_PESO.getAttribute('manter') == 0) {
				if(OUTROS_PESO.type == 'checkbox') {
					OUTROS_PESO.checked = false;
				} else if(OUTROS_PESO.type == 'select-one') {
					OUTROS_PESO.selectedIndex = 0;
				} else {
					OUTROS_PESO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_COD_UNIDADE').getAttribute('type') != 'file') {
		  if (!OUTROS_COD_UNIDADE.getAttribute('manter') || OUTROS_COD_UNIDADE.getAttribute('manter') == 0) {
				if(OUTROS_COD_UNIDADE.type == 'checkbox') {
					OUTROS_COD_UNIDADE.checked = false;
				} else if(OUTROS_COD_UNIDADE.type == 'select-one') {
					OUTROS_COD_UNIDADE.selectedIndex = 0;
				} else {
					OUTROS_COD_UNIDADE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_M3').getAttribute('type') != 'file') {
		  if (!OUTROS_M3.getAttribute('manter') || OUTROS_M3.getAttribute('manter') == 0) {
				if(OUTROS_M3.type == 'checkbox') {
					OUTROS_M3.checked = false;
				} else if(OUTROS_M3.type == 'select-one') {
					OUTROS_M3.selectedIndex = 0;
				} else {
					OUTROS_M3.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_PESO_CUBADO').getAttribute('type') != 'file') {
		  if (!OUTROS_PESO_CUBADO.getAttribute('manter') || OUTROS_PESO_CUBADO.getAttribute('manter') == 0) {
				if(OUTROS_PESO_CUBADO.type == 'checkbox') {
					OUTROS_PESO_CUBADO.checked = false;
				} else if(OUTROS_PESO_CUBADO.type == 'select-one') {
					OUTROS_PESO_CUBADO.selectedIndex = 0;
				} else {
					OUTROS_PESO_CUBADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_PESO_KG_CONVERTIDO').getAttribute('type') != 'file') {
		  if (!OUTROS_PESO_KG_CONVERTIDO.getAttribute('manter') || OUTROS_PESO_KG_CONVERTIDO.getAttribute('manter') == 0) {
				if(OUTROS_PESO_KG_CONVERTIDO.type == 'checkbox') {
					OUTROS_PESO_KG_CONVERTIDO.checked = false;
				} else if(OUTROS_PESO_KG_CONVERTIDO.type == 'select-one') {
					OUTROS_PESO_KG_CONVERTIDO.selectedIndex = 0;
				} else {
					OUTROS_PESO_KG_CONVERTIDO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_NUM_NATUREZA').getAttribute('type') != 'file') {
		  if (!OUTROS_NUM_NATUREZA.getAttribute('manter') || OUTROS_NUM_NATUREZA.getAttribute('manter') == 0) {
				if(OUTROS_NUM_NATUREZA.type == 'checkbox') {
					OUTROS_NUM_NATUREZA.checked = false;
				} else if(OUTROS_NUM_NATUREZA.type == 'select-one') {
					OUTROS_NUM_NATUREZA.selectedIndex = 0;
				} else {
					OUTROS_NUM_NATUREZA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_NATUREZA').getAttribute('type') != 'file') {
		  if (!OUTROS_NATUREZA.getAttribute('manter') || OUTROS_NATUREZA.getAttribute('manter') == 0) {
				if(OUTROS_NATUREZA.type == 'checkbox') {
					OUTROS_NATUREZA.checked = false;
				} else if(OUTROS_NATUREZA.type == 'select-one') {
					OUTROS_NATUREZA.selectedIndex = 0;
				} else {
					OUTROS_NATUREZA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_COMPLEMENTO').getAttribute('type') != 'file') {
		  if (!OUTROS_COMPLEMENTO.getAttribute('manter') || OUTROS_COMPLEMENTO.getAttribute('manter') == 0) {
				if(OUTROS_COMPLEMENTO.type == 'checkbox') {
					OUTROS_COMPLEMENTO.checked = false;
				} else if(OUTROS_COMPLEMENTO.type == 'select-one') {
					OUTROS_COMPLEMENTO.selectedIndex = 0;
				} else {
					OUTROS_COMPLEMENTO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_NUM_ESPECIE').getAttribute('type') != 'file') {
		  if (!OUTROS_NUM_ESPECIE.getAttribute('manter') || OUTROS_NUM_ESPECIE.getAttribute('manter') == 0) {
				if(OUTROS_NUM_ESPECIE.type == 'checkbox') {
					OUTROS_NUM_ESPECIE.checked = false;
				} else if(OUTROS_NUM_ESPECIE.type == 'select-one') {
					OUTROS_NUM_ESPECIE.selectedIndex = 0;
				} else {
					OUTROS_NUM_ESPECIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_ESPECIE').getAttribute('type') != 'file') {
		  if (!OUTROS_ESPECIE.getAttribute('manter') || OUTROS_ESPECIE.getAttribute('manter') == 0) {
				if(OUTROS_ESPECIE.type == 'checkbox') {
					OUTROS_ESPECIE.checked = false;
				} else if(OUTROS_ESPECIE.type == 'select-one') {
					OUTROS_ESPECIE.selectedIndex = 0;
				} else {
					OUTROS_ESPECIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_ALTURA').getAttribute('type') != 'file') {
		  if (!OUTROS_ALTURA.getAttribute('manter') || OUTROS_ALTURA.getAttribute('manter') == 0) {
				if(OUTROS_ALTURA.type == 'checkbox') {
					OUTROS_ALTURA.checked = false;
				} else if(OUTROS_ALTURA.type == 'select-one') {
					OUTROS_ALTURA.selectedIndex = 0;
				} else {
					OUTROS_ALTURA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_COMPRIMENTO').getAttribute('type') != 'file') {
		  if (!OUTROS_COMPRIMENTO.getAttribute('manter') || OUTROS_COMPRIMENTO.getAttribute('manter') == 0) {
				if(OUTROS_COMPRIMENTO.type == 'checkbox') {
					OUTROS_COMPRIMENTO.checked = false;
				} else if(OUTROS_COMPRIMENTO.type == 'select-one') {
					OUTROS_COMPRIMENTO.selectedIndex = 0;
				} else {
					OUTROS_COMPRIMENTO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_LARGURA').getAttribute('type') != 'file') {
		  if (!OUTROS_LARGURA.getAttribute('manter') || OUTROS_LARGURA.getAttribute('manter') == 0) {
				if(OUTROS_LARGURA.type == 'checkbox') {
					OUTROS_LARGURA.checked = false;
				} else if(OUTROS_LARGURA.type == 'select-one') {
					OUTROS_LARGURA.selectedIndex = 0;
				} else {
					OUTROS_LARGURA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_CUBAGEM').getAttribute('type') != 'file') {
		  if (!OUTROS_CUBAGEM.getAttribute('manter') || OUTROS_CUBAGEM.getAttribute('manter') == 0) {
				if(OUTROS_CUBAGEM.type == 'checkbox') {
					OUTROS_CUBAGEM.checked = false;
				} else if(OUTROS_CUBAGEM.type == 'select-one') {
					OUTROS_CUBAGEM.selectedIndex = 0;
				} else {
					OUTROS_CUBAGEM.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_CUBAGEM_SUGERIDA').getAttribute('type') != 'file') {
		  if (!OUTROS_CUBAGEM_SUGERIDA.getAttribute('manter') || OUTROS_CUBAGEM_SUGERIDA.getAttribute('manter') == 0) {
				if(OUTROS_CUBAGEM_SUGERIDA.type == 'checkbox') {
					OUTROS_CUBAGEM_SUGERIDA.checked = false;
				} else if(OUTROS_CUBAGEM_SUGERIDA.type == 'select-one') {
					OUTROS_CUBAGEM_SUGERIDA.selectedIndex = 0;
				} else {
					OUTROS_CUBAGEM_SUGERIDA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_PESO_COBRADO').getAttribute('type') != 'file') {
		  if (!OUTROS_PESO_COBRADO.getAttribute('manter') || OUTROS_PESO_COBRADO.getAttribute('manter') == 0) {
				if(OUTROS_PESO_COBRADO.type == 'checkbox') {
					OUTROS_PESO_COBRADO.checked = false;
				} else if(OUTROS_PESO_COBRADO.type == 'select-one') {
					OUTROS_PESO_COBRADO.selectedIndex = 0;
				} else {
					OUTROS_PESO_COBRADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OUTROS_ORDEM_COMPRA').getAttribute('type') != 'file') {
		  if (!OUTROS_ORDEM_COMPRA.getAttribute('manter') || OUTROS_ORDEM_COMPRA.getAttribute('manter') == 0) {
				if(OUTROS_ORDEM_COMPRA.type == 'checkbox') {
					OUTROS_ORDEM_COMPRA.checked = false;
				} else if(OUTROS_ORDEM_COMPRA.type == 'select-one') {
					OUTROS_ORDEM_COMPRA.selectedIndex = 0;
				} else {
					OUTROS_ORDEM_COMPRA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('TIPO_DOC_OUTROS').getAttribute('type') != 'file') {
		  if (!TIPO_DOC_OUTROS.getAttribute('manter') || TIPO_DOC_OUTROS.getAttribute('manter') == 0) {
				if(TIPO_DOC_OUTROS.type == 'checkbox') {
					TIPO_DOC_OUTROS.checked = false;
				} else if(TIPO_DOC_OUTROS.type == 'select-one') {
					TIPO_DOC_OUTROS.selectedIndex = 0;
				} else {
					TIPO_DOC_OUTROS.value = '';
				}
				
			}
		}
		
		lista_selected_OUTROS.value = -1;
	}
	f_desabilitar_botao_lista_OUTROS('padrao');
	f_desabilitar_botao_lista_OUTROS('excluir');
		
	f_on_incluir_OUTROS();
}
function f_habilitar_botao_lista_OUTROS(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_OUTROS');
	if(obj != null) {
		obj.disabled = false;
		img_obj = document.getElementById('img_lista_'+v_botao+'_OUTROS');
		img_obj.src = img_obj.src.replace('_disable.gif', '.gif');
	}
}
function f_desabilitar_botao_lista_OUTROS(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_OUTROS');
	if(obj != null) {
		obj.disabled = true;
		img_obj = document.getElementById('img_lista_'+v_botao+'_OUTROS');
		if(img_obj.src.indexOf('_disable') == -1) {
			img_obj.src = img_obj.src.replace('.gif', '_disable.gif');
		}
	}
}
function f_seleciona_OUTROS(v_nro) {
	
	if(!document.getElementById('btn_lista_incluir_OUTROS').disabled) {
	
		f_before_selecionar_OUTROS();
		f_cancelar_OUTROS();
		var tbody = document.getElementById('tb_lista_OUTROS');		
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_OUTROS_'+v_nro) {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_1';
				}			
			} else {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_over';
				}
			}
		}
		with (document.forms[0]) {
			
			if(NF_CONHECIMENTO_ID.type == 'checkbox') {
				NF_CONHECIMENTO_ID.checked = (document.getElementById('NF_CONHECIMENTO_ID_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('NF_CONHECIMENTO_ID').type == 'file') {
				v_campo_valor = document.getElementById('NF_CONHECIMENTO_ID_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('NF_CONHECIMENTO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NF_CONHECIMENTO_ID';
				v_campo_valor.name = 'NF_CONHECIMENTO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NF_CONHECIMENTO_ID.value = document.getElementById('NF_CONHECIMENTO_ID_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_ID.type == 'checkbox') {
				OUTROS_ID.checked = (document.getElementById('OUTROS_ID_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_ID').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_ID_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_ID';
				v_campo_valor.name = 'OUTROS_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_ID.value = document.getElementById('OUTROS_ID_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_NUMERO.type == 'checkbox') {
				OUTROS_NUMERO.checked = (document.getElementById('OUTROS_NUMERO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_NUMERO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_NUMERO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_NUMERO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_NUMERO';
				v_campo_valor.name = 'OUTROS_NUMERO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_NUMERO.value = document.getElementById('OUTROS_NUMERO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_DATA_EMISSAO.type == 'checkbox') {
				OUTROS_DATA_EMISSAO.checked = (document.getElementById('OUTROS_DATA_EMISSAO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_DATA_EMISSAO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_DATA_EMISSAO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_DATA_EMISSAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_DATA_EMISSAO';
				v_campo_valor.name = 'OUTROS_DATA_EMISSAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_DATA_EMISSAO.value = document.getElementById('OUTROS_DATA_EMISSAO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_DESCRICAO.type == 'checkbox') {
				OUTROS_DESCRICAO.checked = (document.getElementById('OUTROS_DESCRICAO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_DESCRICAO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_DESCRICAO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_DESCRICAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_DESCRICAO';
				v_campo_valor.name = 'OUTROS_DESCRICAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_DESCRICAO.value = document.getElementById('OUTROS_DESCRICAO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_VALOR.type == 'checkbox') {
				OUTROS_VALOR.checked = (document.getElementById('OUTROS_VALOR_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_VALOR').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_VALOR_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_VALOR');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_VALOR';
				v_campo_valor.name = 'OUTROS_VALOR';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_VALOR.value = document.getElementById('OUTROS_VALOR_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_VALOR_SEGURADO.type == 'checkbox') {
				OUTROS_VALOR_SEGURADO.checked = (document.getElementById('OUTROS_VALOR_SEGURADO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_VALOR_SEGURADO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_VALOR_SEGURADO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_VALOR_SEGURADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_VALOR_SEGURADO';
				v_campo_valor.name = 'OUTROS_VALOR_SEGURADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_VALOR_SEGURADO.value = document.getElementById('OUTROS_VALOR_SEGURADO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_QTDE_VOLUME.type == 'checkbox') {
				OUTROS_QTDE_VOLUME.checked = (document.getElementById('OUTROS_QTDE_VOLUME_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_QTDE_VOLUME').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_QTDE_VOLUME_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_QTDE_VOLUME');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_QTDE_VOLUME';
				v_campo_valor.name = 'OUTROS_QTDE_VOLUME';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_QTDE_VOLUME.value = document.getElementById('OUTROS_QTDE_VOLUME_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_PESO.type == 'checkbox') {
				OUTROS_PESO.checked = (document.getElementById('OUTROS_PESO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_PESO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_PESO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_PESO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_PESO';
				v_campo_valor.name = 'OUTROS_PESO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_PESO.value = document.getElementById('OUTROS_PESO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_COD_UNIDADE.type == 'checkbox') {
				OUTROS_COD_UNIDADE.checked = (document.getElementById('OUTROS_COD_UNIDADE_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_COD_UNIDADE').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_COD_UNIDADE_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_COD_UNIDADE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_COD_UNIDADE';
				v_campo_valor.name = 'OUTROS_COD_UNIDADE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_COD_UNIDADE.value = document.getElementById('OUTROS_COD_UNIDADE_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_M3.type == 'checkbox') {
				OUTROS_M3.checked = (document.getElementById('OUTROS_M3_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_M3').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_M3_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_M3');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_M3';
				v_campo_valor.name = 'OUTROS_M3';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_M3.value = document.getElementById('OUTROS_M3_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_PESO_CUBADO.type == 'checkbox') {
				OUTROS_PESO_CUBADO.checked = (document.getElementById('OUTROS_PESO_CUBADO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_PESO_CUBADO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_PESO_CUBADO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_PESO_CUBADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_PESO_CUBADO';
				v_campo_valor.name = 'OUTROS_PESO_CUBADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_PESO_CUBADO.value = document.getElementById('OUTROS_PESO_CUBADO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_PESO_KG_CONVERTIDO.type == 'checkbox') {
				OUTROS_PESO_KG_CONVERTIDO.checked = (document.getElementById('OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_PESO_KG_CONVERTIDO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_PESO_KG_CONVERTIDO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_PESO_KG_CONVERTIDO';
				v_campo_valor.name = 'OUTROS_PESO_KG_CONVERTIDO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_PESO_KG_CONVERTIDO.value = document.getElementById('OUTROS_PESO_KG_CONVERTIDO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_NUM_NATUREZA.type == 'checkbox') {
				OUTROS_NUM_NATUREZA.checked = (document.getElementById('OUTROS_NUM_NATUREZA_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_NUM_NATUREZA').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_NUM_NATUREZA_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_NUM_NATUREZA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_NUM_NATUREZA';
				v_campo_valor.name = 'OUTROS_NUM_NATUREZA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_NUM_NATUREZA.value = document.getElementById('OUTROS_NUM_NATUREZA_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_NATUREZA.type == 'checkbox') {
				OUTROS_NATUREZA.checked = (document.getElementById('OUTROS_NATUREZA_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_NATUREZA').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_NATUREZA_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_NATUREZA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_NATUREZA';
				v_campo_valor.name = 'OUTROS_NATUREZA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_NATUREZA.value = document.getElementById('OUTROS_NATUREZA_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_COMPLEMENTO.type == 'checkbox') {
				OUTROS_COMPLEMENTO.checked = (document.getElementById('OUTROS_COMPLEMENTO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_COMPLEMENTO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_COMPLEMENTO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_COMPLEMENTO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_COMPLEMENTO';
				v_campo_valor.name = 'OUTROS_COMPLEMENTO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_COMPLEMENTO.value = document.getElementById('OUTROS_COMPLEMENTO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_NUM_ESPECIE.type == 'checkbox') {
				OUTROS_NUM_ESPECIE.checked = (document.getElementById('OUTROS_NUM_ESPECIE_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_NUM_ESPECIE').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_NUM_ESPECIE_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_NUM_ESPECIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_NUM_ESPECIE';
				v_campo_valor.name = 'OUTROS_NUM_ESPECIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_NUM_ESPECIE.value = document.getElementById('OUTROS_NUM_ESPECIE_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_ESPECIE.type == 'checkbox') {
				OUTROS_ESPECIE.checked = (document.getElementById('OUTROS_ESPECIE_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_ESPECIE').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_ESPECIE_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_ESPECIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_ESPECIE';
				v_campo_valor.name = 'OUTROS_ESPECIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_ESPECIE.value = document.getElementById('OUTROS_ESPECIE_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_ALTURA.type == 'checkbox') {
				OUTROS_ALTURA.checked = (document.getElementById('OUTROS_ALTURA_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_ALTURA').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_ALTURA_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_ALTURA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_ALTURA';
				v_campo_valor.name = 'OUTROS_ALTURA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_ALTURA.value = document.getElementById('OUTROS_ALTURA_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_COMPRIMENTO.type == 'checkbox') {
				OUTROS_COMPRIMENTO.checked = (document.getElementById('OUTROS_COMPRIMENTO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_COMPRIMENTO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_COMPRIMENTO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_COMPRIMENTO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_COMPRIMENTO';
				v_campo_valor.name = 'OUTROS_COMPRIMENTO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_COMPRIMENTO.value = document.getElementById('OUTROS_COMPRIMENTO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_LARGURA.type == 'checkbox') {
				OUTROS_LARGURA.checked = (document.getElementById('OUTROS_LARGURA_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_LARGURA').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_LARGURA_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_LARGURA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_LARGURA';
				v_campo_valor.name = 'OUTROS_LARGURA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_LARGURA.value = document.getElementById('OUTROS_LARGURA_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_CUBAGEM.type == 'checkbox') {
				OUTROS_CUBAGEM.checked = (document.getElementById('OUTROS_CUBAGEM_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_CUBAGEM').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_CUBAGEM_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_CUBAGEM');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_CUBAGEM';
				v_campo_valor.name = 'OUTROS_CUBAGEM';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_CUBAGEM.value = document.getElementById('OUTROS_CUBAGEM_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_CUBAGEM_SUGERIDA.type == 'checkbox') {
				OUTROS_CUBAGEM_SUGERIDA.checked = (document.getElementById('OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_CUBAGEM_SUGERIDA').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_CUBAGEM_SUGERIDA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_CUBAGEM_SUGERIDA';
				v_campo_valor.name = 'OUTROS_CUBAGEM_SUGERIDA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_CUBAGEM_SUGERIDA.value = document.getElementById('OUTROS_CUBAGEM_SUGERIDA_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_PESO_COBRADO.type == 'checkbox') {
				OUTROS_PESO_COBRADO.checked = (document.getElementById('OUTROS_PESO_COBRADO_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_PESO_COBRADO').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_PESO_COBRADO_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_PESO_COBRADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_PESO_COBRADO';
				v_campo_valor.name = 'OUTROS_PESO_COBRADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_PESO_COBRADO.value = document.getElementById('OUTROS_PESO_COBRADO_OUTROS_'+v_nro).value;
			}
			
			if(OUTROS_ORDEM_COMPRA.type == 'checkbox') {
				OUTROS_ORDEM_COMPRA.checked = (document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('OUTROS_ORDEM_COMPRA').type == 'file') {
				v_campo_valor = document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('OUTROS_ORDEM_COMPRA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OUTROS_ORDEM_COMPRA';
				v_campo_valor.name = 'OUTROS_ORDEM_COMPRA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OUTROS_ORDEM_COMPRA.value = document.getElementById('OUTROS_ORDEM_COMPRA_OUTROS_'+v_nro).value;
			}
			
			if(TIPO_DOC_OUTROS.type == 'checkbox') {
				TIPO_DOC_OUTROS.checked = (document.getElementById('TIPO_DOC_OUTROS_OUTROS_'+v_nro).value == 1)
			} else if(document.getElementById('TIPO_DOC_OUTROS').type == 'file') {
				v_campo_valor = document.getElementById('TIPO_DOC_OUTROS_OUTROS_'+v_nro);
				v_campo_atual = document.getElementById('TIPO_DOC_OUTROS');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'TIPO_DOC_OUTROS';
				v_campo_valor.name = 'TIPO_DOC_OUTROS';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				TIPO_DOC_OUTROS.value = document.getElementById('TIPO_DOC_OUTROS_OUTROS_'+v_nro).value;
			}
			
			lista_selected_OUTROS.value = v_nro;
		}
		f_habilitar_botao_lista_OUTROS('padrao');
		f_habilitar_botao_lista_OUTROS('excluir');
		f_habilitar_botao_lista_OUTROS('salvar');
		f_on_seleciona_OUTROS();
	
	}
	
}
function f_padrao_OUTROS(v_nro) {
	if(v_nro == -1) {
		return;
	}
	var tbody = document.getElementById('tb_lista_OUTROS');		
	with(document.forms[0]) {
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_OUTROS_'+v_nro) {
				var row_id = tbody.rows[i].id.replace('tr_lista_OUTROS_', '');
				document.getElementById('lista_padrao_OUTROS_'+row_id).style.display = 'none';
				document.getElementById('PADRAO_OUTROS_'+row_id).value = 0;
			}
		}
	}
	document.getElementById('lista_padrao_OUTROS_'+v_nro).style.display = '';
	document.getElementById('PADRAO_OUTROS_'+v_nro).value = 1;
}	

function f_total_campo_OUTROS(v_campo) {
	var tbody = document.getElementById('tb_lista_OUTROS');
	var soma = 0;
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_OUTROS_', '');
		with(document.forms[0]) {
			try {
				soma += (eval("document.forms[0]."+v_campo+"_OUTROS_"+id_linha+".value")*1);
			} catch(e) {
			}
		}
	}
	return soma;
}
function f_atualiza_campos_escravos_OUTROS() {

}

function f_atualiza_campo_escravo_OUTROS(v_valor_mestre, v_campo_escravo, v_value) {
	var tbody = document.getElementById('tb_lista_OUTROS');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_OUTROS_', '');
		with(document.forms[0]) {
			try {
				if (eval("document.forms[0]._OUTROS_"+id_linha).value == v_valor_mestre) {
					eval("document.forms[0]."+v_campo_escravo+"_OUTROS_"+id_linha).value = v_value;
				}				
			} catch(e) {
			}
		}
	}
}

function f_register(p_id) {
	this.id = p_id;

	this.NF_CONHECIMENTO_ID = '';

	this.OUTROS_ID = '';

	this.OUTROS_NUMERO = '';

	this.OUTROS_DATA_EMISSAO = '';

	this.OUTROS_DESCRICAO = '';

	this.OUTROS_VALOR = '';

	this.OUTROS_VALOR_SEGURADO = '';

	this.OUTROS_QTDE_VOLUME = '';

	this.OUTROS_PESO = '';

	this.OUTROS_COD_UNIDADE = '';

	this.OUTROS_M3 = '';

	this.OUTROS_PESO_CUBADO = '';

	this.OUTROS_PESO_KG_CONVERTIDO = '';

	this.OUTROS_NUM_NATUREZA = '';

	this.OUTROS_NATUREZA = '';

	this.OUTROS_COMPLEMENTO = '';

	this.OUTROS_NUM_ESPECIE = '';

	this.OUTROS_ESPECIE = '';

	this.OUTROS_ALTURA = '';

	this.OUTROS_COMPRIMENTO = '';

	this.OUTROS_LARGURA = '';

	this.OUTROS_CUBAGEM = '';

	this.OUTROS_CUBAGEM_SUGERIDA = '';

	this.OUTROS_PESO_COBRADO = '';

	this.OUTROS_ORDEM_COMPRA = '';

	this.TIPO_DOC_OUTROS = '';
}
//busca todos os registros
function f_listagem_OUTROS() {
	var tbody = document.getElementById('tb_lista_OUTROS');
	var result = new Array();
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_OUTROS_', '');
		result[result.length] = new f_register(id_linha);
	
		try {
			result[result.length-1].NF_CONHECIMENTO_ID = eval("document.forms[0].NF_CONHECIMENTO_ID_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_ID = eval("document.forms[0].OUTROS_ID_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_NUMERO = eval("document.forms[0].OUTROS_NUMERO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_DATA_EMISSAO = eval("document.forms[0].OUTROS_DATA_EMISSAO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_DESCRICAO = eval("document.forms[0].OUTROS_DESCRICAO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_VALOR = eval("document.forms[0].OUTROS_VALOR_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_VALOR_SEGURADO = eval("document.forms[0].OUTROS_VALOR_SEGURADO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_QTDE_VOLUME = eval("document.forms[0].OUTROS_QTDE_VOLUME_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_PESO = eval("document.forms[0].OUTROS_PESO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_COD_UNIDADE = eval("document.forms[0].OUTROS_COD_UNIDADE_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_M3 = eval("document.forms[0].OUTROS_M3_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_PESO_CUBADO = eval("document.forms[0].OUTROS_PESO_CUBADO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_PESO_KG_CONVERTIDO = eval("document.forms[0].OUTROS_PESO_KG_CONVERTIDO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_NUM_NATUREZA = eval("document.forms[0].OUTROS_NUM_NATUREZA_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_NATUREZA = eval("document.forms[0].OUTROS_NATUREZA_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_COMPLEMENTO = eval("document.forms[0].OUTROS_COMPLEMENTO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_NUM_ESPECIE = eval("document.forms[0].OUTROS_NUM_ESPECIE_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_ESPECIE = eval("document.forms[0].OUTROS_ESPECIE_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_ALTURA = eval("document.forms[0].OUTROS_ALTURA_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_COMPRIMENTO = eval("document.forms[0].OUTROS_COMPRIMENTO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_LARGURA = eval("document.forms[0].OUTROS_LARGURA_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_CUBAGEM = eval("document.forms[0].OUTROS_CUBAGEM_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_CUBAGEM_SUGERIDA = eval("document.forms[0].OUTROS_CUBAGEM_SUGERIDA_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_PESO_COBRADO = eval("document.forms[0].OUTROS_PESO_COBRADO_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OUTROS_ORDEM_COMPRA = eval("document.forms[0].OUTROS_ORDEM_COMPRA_OUTROS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].TIPO_DOC_OUTROS = eval("document.forms[0].TIPO_DOC_OUTROS_OUTROS_"+id_linha).value;
		} catch(e) {}
	
	}
	return result;
}

function f_busca_campo_escravo_OUTROS(v_valor_mestre, v_campo_escravo) {
	var tbody = document.getElementById('tb_lista_OUTROS');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_OUTROS_', '');
		with(document.forms[0]) {
				if (eval("document.forms[0]._OUTROS_"+id_linha).value == v_valor_mestre) {
					return eval("document.forms[0]."+v_campo_escravo+"_OUTROS_"+id_linha).value;
				}				
		}
	}
	return '';
}
function f_set_lista_min_OUTROS(value) {

}

function f_before_selecionar_OUTROS() {}
function f_on_seleciona_OUTROS() {}
function f_on_salva_lista_OUTROS() {}
function f_before_salvar_OUTROS() { return true; }
function f_on_incluir_OUTROS() {}
function f_on_excluir_OUTROS() {}
</script>

<table width="100%" height="100%" align="left" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr id="tr_lista_botoes_OUTROS">
    <td><table border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>

		
          <td><button tabindex="371" class="botao" id="btn_lista_incluir_OUTROS" onclick="f_incluir_OUTROS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_incluir_OUTROS" src="/_imagens/botoes/16x16/incluir.gif">&nbsp;Novo</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="372" class="botao" id="btn_lista_excluir_OUTROS" onclick="f_excluir_OUTROS(document.forms[0].lista_selected_OUTROS.value)" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_excluir_OUTROS" src="https://levolog.kmm.com.br/_imagens/botoes/16x16/excluir_disable.gif">&nbsp;Excluir</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="373" class="botao" id="btn_lista_salvar_OUTROS" onclick="f_salvar_OUTROS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_salvar_OUTROS" src="/_imagens/botoes/16x16/confirmar.gif">&nbsp;Salvar</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="374" class="botao" id="btn_lista_cancelar_OUTROS" onclick="f_cancelar_OUTROS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_cancelar_OUTROS" src="/_imagens/botoes/16x16/cancelar.gif">&nbsp;Cancelar</button></td>
          <td style="width: 4px;">&nbsp;</td>
		  
        </tr>
      </tbody></table></td>
  </tr>
  <tr><td height="4"></td></tr>
  <input name="lista_selected_OUTROS" tabindex="375" id="lista_selected_OUTROS" type="hidden" value="-1" fixo="1">
  <input name="lista_deleted_OUTROS" tabindex="376" id="lista_deleted_OUTROS" type="hidden" value="" fixo="1">
  <tr>
  
    <td height="200">
	<div class="lista" style="width: 100%; -ms-overflow-x: scroll;">
	<table width="100%" style="-ms-overflow-y: scroll;" border="0" cellspacing="1" cellpadding="3">
	<thead>
  <tr class="titulo_3" style="cursor: pointer;" onclick="sortColumn(event)">
    <td width="16" class="titulo_3" style="display: none;">&nbsp;</td>
  	
    <td width="10%" align="right" class="titulo_3" type="caseinsensitivestring">Nº do Documento</td>
	
    <td width="10%" align="right" class="titulo_3" type="caseinsensitivestring">Data de Emissão</td>
	
    <td width="60%" align="left" class="titulo_3" type="caseinsensitivestring">Descrição</td>
	
    <td width="10%" align="right" class="titulo_3" type="caseinsensitivestring">Valor</td>
	
    <td width="10%" align="right" class="titulo_3" type="caseinsensitivestring">Tipo Doc. Outros</td>
	
  </tr>
  </thead>
  <tbody id="tb_lista_OUTROS">
  </tbody>
</table>

	</div></td>
  </tr>
</tbody></table>
                        
                            
                            <script type="text/javascript">	 
								var v_num_especie_notas = '';
								var v_num_natureza_notas = '';
								var v_cod_unidade_notas = '';
								function f_on_incluir_OUTROS() {
									with(document.forms[0]) {
										OUTROS_ALTURA.value = 0;
										OUTROS_LARGURA.value = 0;
										OUTROS_COMPRIMENTO.value = 0;
										
										if (!v_edicao){
											OUTROS_COMPRIMENTO.onchange();
										}
										
										v_lista = f_listagem_OUTROS();
										if(v_lista.length > 0){
											OUTROS_NUM_ESPECIE.value = v_num_especie_notas;
											OUTROS_NUM_ESPECIE.onchange();
											OUTROS_NUM_NATUREZA.value = v_num_natureza_notas;
											OUTROS_NUM_NATUREZA.onchange();
										}
										
										OUTROS_QTDE_VOLUME.value = 1;
										
										f_valor_segurado_automatico('OUTROS', 0);
										
										v_edicao = false;
									}
								}
								function f_on_salva_lista_OUTROS() {
									with(document.forms[0]) {
										v_lista = f_listagem_OUTROS();
										if(v_lista.length > 0){
											//Segundo regra, se a natureza veio da solicitação, não deve ser substituida pela natureza da nota.
											if (SOLICITACAO_NUM_NATUREZA.value == '') {
											   NUM_NATUREZA.value = v_lista[0].OUTROS_NUM_NATUREZA;
											   NUM_NATUREZA.onchange();
											}
											NUM_ESPECIE.value = v_lista[0].OUTROS_NUM_ESPECIE;
											NUM_ESPECIE.onchange();
										}
										VALOR_MERCADORIA.value = f_total_campo_OUTROS('OUTROS_VALOR');
										PESO.value = f_total_campo_OUTROS('OUTROS_PESO_COBRADO');
										M3.value = f_total_campo_OUTROS('OUTROS_M3')
										CUBAGEM.value = f_total_campo_OUTROS('OUTROS_CUBAGEM')
										PESO_KG.value = f_total_campo_OUTROS('OUTROS_PESO_KG_CONVERTIDO');
										var v_lista = f_listagem_OUTROS();
										NOTAS.value = '';
										for(var i=0;i<v_lista.length;i++) {
											if(NOTAS.value == ''){
												NOTAS.value = v_lista[i].OUTROS_NUMERO;						
											}else{
												NOTAS.value += ' , '+v_lista[i].OUTROS_NUMERO;						
											}
										}
						
										f_preenche_constantes_cfop_mercadoria();
										try{
										f_preenche_observacao();
										} catch(e) {}
										COD_UNIDADE.value = 'Kg';
										VOLUME.value = f_total_campo_OUTROS('OUTROS_QTDE_VOLUME');
										
										if(POPULANDO_DADOS.value == 0){
										   f_calculos();
										}
										PESO_REAL.value = f_total_campo_OUTROS('OUTROS_PESO');
										f_atualiza_peso_cte_ref();
										if (f_listagem_CTES_REF().length > 0) {
										   f_seleciona_CTES_REF(0);
										}
									}
								}
								function f_before_salvar_OUTROS() {
									with(document.forms[0]) {
										if(f_ajax_running() > 0 && v_inserida == 0) {
											alert('Aguarde o término do processamento antes de salvar.');
											return false;
										}
										if(OUTROS_NUM_ESPECIE.value != '' && OUTROS_ESPECIE.value == '') {
											alert('A espécie selecionada não é válida!');
											return false;
										}
										if(OUTROS_NUM_NATUREZA.value != '' && OUTROS_NATUREZA.value == '') {
											alert('A natureza selecionada não é válida!');
											return false;
										}
										return true;
									}
								}
								function f_on_excluir_OUTROS(){
									v_listagem = f_listagem_OUTROS();
									if(v_listagem.length == 0)
										f_controla_tipo_docto_frete();
								}
								function f_before_selecionar_OUTROS(){
									v_edicao = true;			
								}	
							</script>
                            </td>
                            </tr>
                            </tbody></table>
                        </td>
                  </tr>
              </tbody></table>
        	</fieldset>
    	</td>
	</tr>    
</tbody></table>
<script>
Calendar.setup(
    {
      inputField  : "NOTA_DATA_EMISSAO",      // ID of the input field
      ifFormat    :    "%d/%m/%Y",    // the date format
      button      : "trigger",    // ID of the button
	  range       : [2001,2050]
    }
  );
</script>

                                </fieldset>
                            </td>
               </tr>

               <tr style="display: none;">
                            <td class="td_aba_corpo" valign="top" colspan="10">
                            	<fieldset tabindex="377" id="fds_mercadorias" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                            		<script>
	setReadOnly['negociacao'] = function(value) {
		with(document.forms[0]) {
			
			    FRETE_UNITARIO_DESC.readOnly = false;
			
			AD_VALOREM.readOnly = value;
			SEC_CAT.readOnly = value;
			DESPACHO.readOnly = value;
			PEDAGIO.readOnly = value; 
			GRIS.readOnly = value;
			COLETA_ENTREGA.readOnly = false;
			PESO.readOnly = value;	
			if (value) {
				document.getElementById('fld_negociacao').style.display = '';
				document.getElementById('fld_negociacao').disabled = 0;
				FRETE_UNITARIO.value = FRETE_UNITARIO_DESC.value;
			} else {		
				document.getElementById('fld_negociacao').style.display = 'none';
				document.getElementById('fld_negociacao').disabled = 1;
			}
		}
	}

	setReadOnly['mercadorias'] = function(value) {
		with(document.forms[0]) {
			setReadOnly['mercadorias_dados'](value);
			setReadOnly['mercadorias_frete'](value);
		}
	}

	setReadOnly['mercadorias_dados'] = function(value) {
		with(document.forms[0]) {
			NUM_NATUREZA.readOnly 	= value;
			NUM_ESPECIE.readOnly 	= value; 
			
			VOLUME.readOnly 		= value;
			
		}
	}

	setReadOnly['mercadorias_frete'] = function(value) {
		with(document.forms[0]) {
			
		}
	}
	setReadOnly['mercadorias_calculos'] = function(value) {
		with(document.forms[0]) {
			FRETE_PESO.readOnly 		= value;
			FRETE_VALOR.readOnly 		= value;
			BASE_CALCULO_ICMS.readOnly 	= value;
			ALIQUOTA_ICMS.readOnly	 	= value;
			VALOR_ICMS.readOnly 		= value;
			VALOR_ICMS_SUBSTIT.readOnly = value;
			TOTAL_CONHECIMENTO.readOnly = value;
		}
	}
	var v_sem_icms = 0;
	
	function f_calculos() {}
	
	function f_calculos_tabela_frete() {
		with(document.forms[0]) {
			f_ocultar_div();
			var v_action;
			var v_parametros = 0;
			v_tot_nf = f_listagem_NOTAS_FISCAIS();
			v_tot_nfe = f_listagem_NFE();
			v_tot_outros = f_listagem_OUTROS();
			
			document.getElementById('spam_imposto_info').style.display = '';
			document.getElementById('tb_impostos').style.display = 'none';
			f_limpar_IMPOSTOS();
			
			f_desabilitar_botao('confirmar');
			
			if( (Number(v_tot_nf.length) + Number(v_tot_nfe.length) + Number(v_tot_outros.length) ) == 0){
				document.getElementById('td_negociacao_info').innerHTML = 'Por favor, informe pelo menos uma nota fiscal para buscar a tabela de frete a ser utilizada.';
				document.getElementById('tr_negociacao_carregando').style.display = 'none';
				
				return;
			}
			
			if(!(COD_PESSOA_FILIAL.value || COD_DEPARTAMENTO.value || COD_SETOR.value || COD_CENTRO_CUSTO.value)) {
				document.getElementById('td_negociacao_info').innerHTML = 'Por favor, selecione o organograma.';
				document.getElementById('tr_negociacao_carregando').style.display = 'none';
				
				return;
			}
			
			if(!COLETA_MUNICIPIO_ID.value) {
				
				return;
			}
			if(!RED_MUNICIPIO_ID.value) {
				
				
				return;
			}
			
			
				if(UF_FILIAL_EMISSAO.value == ''){
					UF_FILIAL_EMISSAO.value = 'MG';
				}
			

			
			f_muda_tipo_frete();		
				
			if(!NUM_PRODUTO.value && TIPO_FRETE.value == '') {
				NUM_PRODUTO.options[0].selected = true;
			}
			
			if(NUM_PRODUTO.value == ''){
				alert('O Tipo de Frete "'+TIPO_FRETE_DESC.value+'" definido na operação não é permitido para esta emissão.');
				document.getElementById('td_negociacao_info').innerHTML = 'O Tipo de Frete "'+TIPO_FRETE_DESC.value+'" definido na operação não é permitido para esta emissão.';
				return;	
			}else{
				document.getElementById('td_negociacao_info').innerHTML = '';
			}
			
			CONSULTA.value = 6;
			FRETE_UNITARIO.value = '0.00';
			FRETE_UNITARIO_DESC.value = '0.00';
			NUM_PRODUTO.disabled = false;
			
			v_pagador_disabled = PAGADOR.disabled;
			PAGADOR.disabled = false;
		    
			
				v_tipo_disabled = CONHECIMENTO_TIPO_ID.disabled;
				CONHECIMENTO_TIPO_ID.disabled = false;
			
				
			
		   REGRA_FISCAL.disabled = false;

		   v_rem_cnpj_cpf_disabled = REM_CNPJ_CPF.disabled;
		   REM_CNPJ_CPF.disabled = false;
		   v_dest_cnpj_cpf_disabled = DEST_CNPJ_CPF.disabled;
		   DEST_CNPJ_CPF.disabled = false;
		   v_coleta_cnpj_cpf_disabled = COLETA_CNPJ_CPF.disabled;
		   COLETA_CNPJ_CPF.disabled = false;
		   v_red_cnpj_cpf_disabled = RED_CNPJ_CPF.disabled;
		   RED_CNPJ_CPF.disabled = false;
		   v_cob_cnpj_cpf_disabled = COB_CNPJ_CPF.disabled;
		   COB_CNPJ_CPF.disabled = false;
		   v_neg_cnpj_cpf_disabled = NEG_CNPJ_CPF.disabled;
		   NEG_CNPJ_CPF.disabled = false;
           v_tipo_docto_disabled = TIPO_DOCUMENTO_ID.disabled;
           TIPO_DOCUMENTO_ID.disabled = false;                    
		   
			target = 'consultas';
			
			v_action = 'consultas.cfm';
			
				if(v_parametros == 1) {
					v_action += '&';
				}
				else {
					v_action += '?';
				}
				
				v_action += 'COMPLEMENTO=1';
			
			
			action = v_action;
			
		    f_habilita_todos_campos();
			
			submit();
			
			
			PAGADOR.disabled = v_pagador_disabled;
			
			
				CONHECIMENTO_TIPO_ID.disabled = v_tipo_disabled;
			

		    REM_CNPJ_CPF.disabled = v_rem_cnpj_cpf_disabled;
		    DEST_CNPJ_CPF.disabled = v_dest_cnpj_cpf_disabled;
		    COLETA_CNPJ_CPF.disabled = v_coleta_cnpj_cpf_disabled;
		    RED_CNPJ_CPF.disabled = v_red_cnpj_cpf_disabled;	
		    COB_CNPJ_CPF.disabled = v_cob_cnpj_cpf_disabled;
            NEG_CNPJ_CPF.disabled = v_neg_cnpj_cpf_disabled;
    	    TIPO_DOCUMENTO_ID.disabled = v_tipo_docto_disabled;

			
	
			document.getElementById('tr_negociacao_carregando').style.display = '';
		}
	}
	
	function f_calculos_convencional(){ 
			with(document.forms[0]) {
				document.getElementById('spam_imposto_info').style.display = '';
				document.getElementById('tb_impostos').style.display = 'none';
				f_limpar_IMPOSTOS();
				
				f_desabilitar_botao('confirmar');
				

					if(COLETA_MUNICIPIO_ID.value == '') {
						
						return;
					}
					if(RED_MUNICIPIO_ID.value == '') {
						
						return;
					}

				
				f_muda_tipo_frete(1);
				NUM_PRODUTO.disabled = false;
			
			}
	}
	
	function f_calcula_frete_convencional(){
		with(document.form_transportes) {
				
				
				
				if (FRETE_ULT_ENTREGA==1 && !MUNICIPIO_ULT_ENTREGA_ID.value) {
					alert('O local da última entrega deve ser informado.');
					return false;
				}
				
				
					if(UF_FILIAL_EMISSAO.value == ''){
						UF_FILIAL_EMISSAO.value = 'MG';
					}
				
				ST_ICMS_ID.value = '';

				v_total_outros = f_listagem_OUTROS();
				v_nota = 1;
				if (v_total_outros != 0) {
					v_nota = 0;
				}

  				   f_query_wddx("/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=calcula_ctrc_comercial"
							   , 'NUM_ROMANEIO='		 +NUM_ROMANEIO.value+
								 '&ITEM_ID='			 +ITEM_ID.value+
								 '&COD_REMETENTE='		 +COD_REMETENTE.value+
								 '&COD_DESTINATARIO='	 +COD_DESTINATARIO.value+
								 '&PESO='				 +PESO.value+
								 '&DESPACHO='			 +DESPACHO_CALC.value+
								 '&SEC_CAT='			 +SEC_CAT_CALC.value+
								 '&GRIS='				 +GRIS_CALC.value+
								 '&PEDAGIO='			 +PEDAGIO_CALC.value+
								 '&PRODUTO_ID='			 +NUM_PRODUTO.value+
								 '&PAGADOR='			 +PAGADOR.value+ 
								 '&COLETA_ENTREGA='		 +COLETA_ENTREGA_CALC.value+
								 '&FRETE_UNITARIO='		 +FRETE_UNITARIO.value+
								 '&VALOR_MERCADORIA='	 +VALOR_MERCADORIA.value+
								 '&AD_VALOREM='			 +AD_VALOREM.value+
								 '&ST_ICMS_ID='			 +ST_ICMS_ID.value+
								 '&ENTREGA_UF='			 +RED_UF.value+
								 '&COLETA_UF='			 +COLETA_UF.value+
								 '&COD_UNIDADE='		 +COD_UNIDADE.value+
								 '&COB_UF='		      	 +COB_UF.value+
								 '&COLETA_MUNICIPIO_ID=' +COLETA_MUNICIPIO_ID.value+
								 '&ENTREGA_MUNICIPIO_ID='+((Number(FRETE_ULT_ENTREGA.value)==0)?RED_MUNICIPIO_ID.value:MUNICIPIO_ULT_ENTREGA_ID.value)+
								 '&SEM_ICMS='            +v_sem_icms+
								 '&COD_CLIENTE_COBRANCA='+COD_CLIENTE_COBRANCA.value+
								 '&OPERACAO_ID='		 +OPERACAO_ID.value +
								 '&UF_EMITENTE='         +UF_FILIAL_EMISSAO.value +
								 '&COD_NEGOCIADOR='		 +COD_NEGOCIADOR.value +
								 '&FRACIONADO='		 	 +FRACIONADO.value +
								 '&NUM_NATUREZA='		 +NUM_NATUREZA.value +
								 '&COD_TABELA_FRETE=' 	 +COD_TABELA_FRETE.value +
								 '&VALOR_TOTAL_NOTA=' 	 +VALOR_MERCADORIA.value +
								 '&FLAG_COLETA='		 +FLAG_COLETA.value +
								 '&NUM_EIXOS='		 	 +NUM_EIXOS.value +
								 '&FLAG_URGENTE='	 	 +FLAG_URGENTE.value +
								 '&FLAG_TRUCK='		 	 +FLAG_TRUCK.value +
								 '&NUM_AJUDANTES='		 +NUM_AJUDANTES.value +
								 '&NUM_ENTREGAS='	 	 +NUM_ENTREGAS_PAGAS.value +
								 '&FLAG_LOTACAO='	 	 +FLAG_LOTACAO.value +
								 '&REGRA_FISCAL_ID='	 +REGRA_FISCAL.value +
								 '&M3='		 	 		 +M3.value +
								 '&CTRC_COMPLEMENTAR='   +'1' + 
								 '&ADEME='		 	     +ADEME.value +
								 '&NOTA_FISCAL='		 +v_nota +
								 '&FRETE_EM='		     +FRETE_EM.value +
								 '&FRETE_VALOR='		 +FRETE_VALOR.value +
								 '&QUANTIDADE='		 	 +VOLUME.value +
								 '&COD_ATIVIDADE_TOMA='	 +COB_COD_ATIVIDADE_FISCAL.value +
								 '&COD_ATIVIDADE_REM='	 +REM_COD_ATIVIDADE_FISCAL.value +
								 '&COD_ATIVIDADE_DEST='	 +DEST_COD_ATIVIDADE_FISCAL.value
								 
								  
							   ,f_calculos_convencional_result);
			}
	}	
	

	v_st_icms_id_calculada = '';
	function f_calculos_convencional_result(obj){ //callback functions always take one argument. This is the result passed back from the server.
		if(obj.ajax.readyState == 4 && obj.ajax.status == 200) { // Quando estiver tudo pronto.
			if (obj.struct.erro == 'true') {
					alert(obj.struct.mensagem_str);
				return false;
			}
			with(document.forms[0]) {				
				if (!obj.struct.frete_unitario){
					FRETE_UNITARIO_DESC.value = 0.0;
				}else{
					FRETE_UNITARIO_DESC.value = toCurrency(obj.struct.frete_unitario);
				}

				if (document.getElementById('TABELA_FRETE_MODELO_ID').value == 1) {
					try {
						
							if(document.forms[0].TIPO_COMPLEMENTO_ID && document.forms[0].TIPO_COMPLEMENTO_ID.value != 1 && document.forms[0].TIPO_COMPLEMENTO_ID.value != 3) {
								ST_ICMS_ID.value        = obj.struct.st_icms_id;
								ST_ICMS_ID_COMBO.value  = String(obj.struct.st_icms_id).replace(/ /g,'');
							} else if (!document.forms[0].TIPO_COMPLEMENTO_ID) {
								ST_ICMS_ID.value       = obj.struct.st_icms_id;
								ST_ICMS_ID_COMBO.value = String(obj.struct.st_icms_id).replace(/ /g,'');
								ST_ICMS_ID_COMBO.disabled = true;
								ST_ICMS_ID_COMBO.onchange = function() {
									
								}
							}
							v_st_icms_id_calculada 	 = obj.struct.st_icms_id;
						
					} catch(e) {}
				}
				PESO.value     	 = obj.struct.peso;
				FRETE_PESO.value     	 = toCurrency(obj.struct.frete_peso);
				
				   if(TIPO_COMPLEMENTO_ID.value == 1){
          			   document.getElementById('tr_zerar_frete').style.display = '';
					   if(ZERAR_FRETE.value == 1){
   					      TOTAL_CONHECIMENTO.value = 0;
						  TOTAL_CONHECIMENTO.readOnly = true;
					   }else{
					      TOTAL_CONHECIMENTO.value = toCurrency(obj.struct.valor_icms);
						  TOTAL_CONHECIMENTO.readOnly = false;
					   }
				   }else{
					   TOTAL_CONHECIMENTO.value = toCurrency(obj.struct.total_conhecimento);
		               document.getElementById('tr_zerar_frete').style.display = 'none';
				   }
				
				
					BASE_CALCULO_ICMS.value  = toCurrency(obj.struct.base_calculo_icms);
					ALIQUOTA_ICMS.value      = toCurrency(obj.struct.aliquota_icms);
					VALOR_ICMS.value 		 = toCurrency(obj.struct.valor_icms);
				FRETE_VALOR.value 		 = toCurrency(obj.struct.frete_valor);

				if (document.getElementById('TABELA_FRETE_MODELO_ID').value == 1) {
					VALOR_ICMS_SUBSTIT.value = toCurrency(obj.struct.valor_icms_substit);
				}
				
				AD_VALOREM.value = toCurrency(obj.struct.ad_valorem);
				DESPACHO.value = toCurrency(obj.struct.despacho);
				PEDAGIO.value = toCurrency(obj.struct.pedagio);
				SEC_CAT.value = toCurrency(obj.struct.sec_cat);
				GRIS.value = toCurrency(obj.struct.gris);
				COLETA_ENTREGA.value = toCurrency(obj.struct.coleta_entrega);
				
				/*
				29008 - CFOP incorreto na tela de emissão de CTe (Beta) - Rafael
				Somente deve preencher o CFOP quando tiver ao menos uma Nota Fiscal vinculada
				*/
				v_tot_nf = f_listagem_NOTAS_FISCAIS();
				v_tot_nfe = f_listagem_NFE();
				v_tot_outros = f_listagem_OUTROS();

				if (document.getElementById('TABELA_FRETE_MODELO_ID').value == 1) {
					if ((Number(v_tot_nf.length) + Number(v_tot_nfe.length) + Number(v_tot_outros.length) ) != 0) {
							CFOP.value    = obj.struct.cfop;
							CFOP_ID.value = obj.struct.cfop_id;
					}else{
						CFOP.value                = '';
						CFOP_ID.value             = '';
					}
					
					NATUREZA_OPERACAO.value   = obj.struct.natureza_operacao;
					
					if (!v_num_produto && TIPO_FRETE.value == '') {
						NUM_PRODUTO.value 	      = obj.struct.num_produto;
					}		
	
					
				}
				
				if (!FUNDAMENTACAO_LEGAL.value) 
				   FUNDAMENTACAO_LEGAL.style.display = 'none';
				else
				   FUNDAMENTACAO_LEGAL.style.display = '';
				
				if (document.getElementById('TABELA_FRETE_MODELO_ID').value == 1) {
					if ( obj.struct.valor_icms_substit > 0) 
						document.getElementById("tr_icms_substit").style.display = '';
					else
						document.getElementById("tr_icms_substit").style.display = 'none';
					
					
						if (COLETA_MUNICIPIO_ID.value == RED_MUNICIPIO_ID.value && Number(ALIQUOTA_ICMS.value) > 0 && REGRA_FISCAL.value != 13) {
							ST_ICMS_ID.value = '90';
							ST_ICMS_ID_COMBO.value = '90';
						}
					
				}
				
				if (obj.struct.descricao_contrato) {
					document.getElementById('td_tabela').innerHTML = 'Tabela: ' + 	obj.struct.descricao_contrato;
					COLETA_ENTREGA.value = Number(obj.struct.outros);
					PESO.value = Number(obj.struct.peso_cobrado);
					COD_TABELA_FRETE_RET.value = obj.struct.cod_tabela_frete_ret;
					
					setReadOnly['negociacao'](true);
				} else {
					document.getElementById('td_tabela').innerHTML = 'Fora de tabela';
				    setReadOnly['negociacao'](false);
				}
				
				f_frete_em(FRETE_EM.value);
				
				f_habilitar_botao('confirmar', 'f_confirmar()');
			}	
		}
	}
	function f_altera_frete_valor(){
		with(document.forms[0]){
			FRETE_UNITARIO.value = FRETE_UNITARIO_DESC.value;
			f_calculos();			
		}
	}
	
	function f_muda_imposto(v_imposto) {
		switch(String(v_imposto).toLowerCase()) {
			case 'iss':
				document.getElementById('sp_base_calc').innerHTML = 'Base Calc. ISS';
				document.getElementById('sp_icms').innerHTML = 'ISS';
				break;
			case 'icms':
			default:
				document.getElementById('sp_base_calc').innerHTML = 'Base Calc. ICMS';
				document.getElementById('sp_icms').innerHTML = 'ICMS';
				break;
		}
	}
	
	function f_busca_natureza_conhecimento() {
		with(document.forms[0]) {
			if(POPULANDO_DADOS.value == 1){
			   return;
			}
			
			if(NUM_NATUREZA.value){
				f_query_wddx('/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_natureza'
							,'num_natureza='+NUM_NATUREZA.value
							,function(obj){
								if(obj.ajax.readyState == 4 && obj.ajax.status == 200){
									if(obj.struct.num_natureza.length > 0){
										NATUREZA.value = obj.struct.descricao[0];
									}else
										NATUREZA.value = '';
									}
							});
			}else
				NATUREZA.value = '';
		}
	}
	
	function f_busca_especie_conhecimento() {
		with(document.forms[0]) {
			if(POPULANDO_DADOS.value == 1){
			   return;
			}
			
			if(NUM_ESPECIE.value){
				f_query_wddx('/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_especie'
							,'num_especie='+NUM_ESPECIE.value
							,function(obj){
								if(obj.ajax.readyState == 4 && obj.ajax.status == 200){
									if(obj.struct.num_especie.length > 0){
										ESPECIE.value = obj.struct.descricao[0];
									}else
										ESPECIE.value = '';
									}
							});
			}else
				ESPECIE.value = '';
	
		}
	}
		
	function f_observacao(){ 
		with(document.forms[0]) {
			f_query_wddx("/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_observacao"
						,'num_romaneio='	+NUM_ROMANEIO.value+
						 'observacao='		+OBSERVACAO.value+
						 'placa_controle='	+PLACA_CONTROLE.value
						,function (obj) {
							if(obj.ajax.readyState == 4) { // Quando estiver tudo pronto.
								with(document.forms[0]) {
		
									if(TIPO_COMPLEMENTO_ID.value == 2)
										OBSERVACAO.value = v_observacao_base+''+obj.struct.observacao;
		
								}
							}
						});
		}
	}
	
	
	function f_frete_em(p_tipo) {
		with (document.forms[0]) {
			VOLUME.className = 'campo';
			M3.className = 'campo';
			PESO.className = 'campo';
			FRETE_UNITARIO_DESC.className = 'campo';
			switch(p_tipo) {
				case 'LOTACAO':
								FRETE_UNITARIO_DESC.className = 'campo_destaque';
								break;
				case 'PESO':
				                PESO.className = 'campo_destaque';
								break;
				case 'M3':
				                M3.className = 'campo_destaque';
								break;
				case 'VOLUME':
				                VOLUME.className = 'campo_destaque';
								break;
			}
			  
		}
	}
	
	function f_busca_tipo_calculo() {
		with(document.forms[0]) {
			f_calculos = function() {};
			v_emite_tabela_frete = -1;
			f_habilitar_botao('confirmar', 'f_confirmar()');
			var emitir_por_tabela_frete_value = document.getElementById('EMITIR_POR_TABELA_FRETE') != null ? document.getElementById('EMITIR_POR_TABELA_FRETE').value : 0;
			var dispensado_tabela_frete_value = document.getElementById('DISPENSADO_TABELA_FRETE') != null ? document.getElementById('DISPENSADO_TABELA_FRETE').value : 0;
			var cod_tipo_conhecimento_diaria  = document.getElementById('COD_TIPO_CONHECIMENTO_DIARIA') != null ? document.getElementById('COD_TIPO_CONHECIMENTO_DIARIA').value : 0;			
			var complemento_value			  = document.getElementById('COMPLEMENTO') != null ? document.getElementById('COMPLEMENTO').value : '';
			var conhecimento_tipo_id		  = document.getElementById('CONHECIMENTO_TIPO_ID') != null ? document.getElementById('CONHECIMENTO_TIPO_ID').value : '';

			if(COD_NEGOCIADOR.value){			
				f_query_wddx('/modulos/cte/_componentes/consulta/comercial/cfc_tabela_frete.cfc?method=get_grupo_negociador_pessoa'
							,'cod_pessoa=' + COD_NEGOCIADOR.value
							,function(obj) {
								if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {						
									if(obj.struct.grupo_id.length > 0) {
										if(obj.struct.grupo_id.length == 1) {
											TABELA_FRETE_MODELO_ID.value = obj.struct.modelo_id[0];
											var tabela_frete_modelo_id		  =  document.getElementById('TABELA_FRETE_MODELO_ID') != null ? document.getElementById('TABELA_FRETE_MODELO_ID').value : 2;
											
											if (tabela_frete_modelo_id == 1 && complemento_value == 1 && (emitir_por_tabela_frete_value == 0 || emitir_por_tabela_frete_value == 1 && conhecimento_tipo_id != cod_tipo_conhecimento_diaria)){
												f_calculos = f_calculos_convencional;
												
												document.getElementById('tr_negociacao_carregando').style.display = 'none';
												document.getElementById('tr_negociacao_info').style.display = 'none';
												document.getElementById('tr_negociacao_tabela_frete').style.display = 'none';
												document.getElementById('tr_negociacao_convencional').style.display = '';
												document.getElementById('ALIQUOTA_ICMS').readOnly = false;				
												document.getElementById('VALOR_ICMS').readOnly = false;				
												document.getElementById('TOTAL_CONHECIMENTO').readOnly = false;								
												v_emite_tabela_frete = 0;
												DISPENSADO_TABELA_FRETE.value = 1;				
												f_calculos();
												
												return;
											}
											else{
												if(!COD_NEGOCIADOR.value) {
													document.getElementById('td_negociacao_info').innerHTML = 'Por favor, informe o negociador para buscar qual forma ir&aacute; utilizar para executar os c&aacute;lculos.';
													
													document.getElementById('tr_negociacao_carregando').style.display = 'none';
													document.getElementById('tr_negociacao_info').style.display = '';
													document.getElementById('tr_negociacao_tabela_frete').style.display = 'none';
													document.getElementById('tr_negociacao_convencional').style.display = 'none';
													
													return;
												}
												else {
													document.getElementById('td_negociacao_info').innerHTML = 'Por favor, aguarde. O sistema est&aacute; buscando qual forma ir&aacute; utilizar para executar os c&aacute;lculos.';
													
													document.getElementById('tr_negociacao_carregando').style.display = '';
													document.getElementById('tr_negociacao_info').style.display = '';
													document.getElementById('tr_negociacao_tabela_frete').style.display = 'none';
													document.getElementById('tr_negociacao_convencional').style.display = 'none';
												}
											}
											
											if((obj.struct.modelo_id[0] == 1 && Number(obj.struct.emite_tabela_frete[0]) == 0) || dispensado_tabela_frete_value == 1) { // Cálculo Convencional e ignora qualquer configuração para emitir CTe de Diária por tabela de frete
												f_calculos = f_calculos_convencional;
												
												document.getElementById('tr_negociacao_carregando').style.display = 'none';
												document.getElementById('tr_negociacao_info').style.display = 'none';
												document.getElementById('tr_negociacao_tabela_frete').style.display = 'none';
												document.getElementById('tr_negociacao_convencional').style.display = '';
											}
											else { // Cálculo por Tabela de Frete
												f_calculos = f_calculos_tabela_frete;
											}
											
											v_emite_tabela_frete = Number(obj.struct.emite_tabela_frete[0]);

											//Verifica se o parametro dispensa o uso de tabela de frete
											if(obj.struct.modelo_id[0] == 1 && v_emite_tabela_frete != 0 &&  (CONHECIMENTO_TIPO_ID.options[CONHECIMENTO_TIPO_ID.selectedIndex].getAttribute('dispensa_tabela').toString() == 1) ){
												f_calculos = f_calculos_convencional;
												
												DISPENSADO_TABELA_FRETE.value = 1;
												
												document.getElementById('tr_negociacao_carregando').style.display = 'none';
												document.getElementById('tr_negociacao_info').style.display = 'none';
												document.getElementById('tr_negociacao_tabela_frete').style.display = 'none';
												document.getElementById('tr_negociacao_convencional').style.display = '';
												
											}else{
												DISPENSADO_TABELA_FRETE.value = 0;
											}
											f_calculos();
										}
										else if (COD_NEGOCIADOR.value) {
											document.getElementById('td_negociacao_info').innerHTML = 'O negociador informando pertence a mais de um grupo. Entre em contato com o departamento Comercial.';
											document.getElementById('tr_negociacao_carregando').style.display = 'none';
											
											alert('O negociador informando pertence a mais de um grupo. Entre em contato com o departamento Comercial.');
										}
									}
									else {
										document.getElementById('td_negociacao_info').innerHTML = 'O negociador informando não pertence a nenhum grupo. Entre em contato com o departamento Comercial.';
										document.getElementById('tr_negociacao_carregando').style.display = 'none';
										
										alert('O negociador informando não pertence a nenhum grupo. Entre em contato com o departamento Comercial.');
									}
									
									v_quantidade_grupo = obj.struct.grupo_id.length;
								}
							});							
			}
			
			f_busca_tipo_servico();
			
			}
		
	}	

	var v_num_produto = '';
	
	document.forms[0].NUM_PRODUTO.onchange = function() { 
														  v_num_produto = document.forms[0].NUM_PRODUTO.value; 
														  f_calculos();
														} 
	
	function f_busca_produto_frete(p_executa_calculos) {
			with(document.forms[0]) {
				if(COLETA_MUNICIPIO_ID.value != '' && RED_MUNICIPIO_ID.value != ''){
					f_query_wddx("/modulos/cte/_componentes/consulta/cfc_emissao_documentos.cfc?method=get_produto_frete"
								,'municipio_id_origem='	+COLETA_MUNICIPIO_ID.value+
								 '&municipio_id_destino='+RED_MUNICIPIO_ID.value
								,function (obj) {
									if(obj.ajax.readyState == 4) { // Quando estiver tudo pronto.
										f_limpa_select(NUM_PRODUTO);
										if(obj.struct.produto_id.length > 0) {
											for (var i=0; i < obj.struct.produto_id.length; i++) {
											   f_cria_option(obj.struct.produto_id[i],obj.struct.produto[i], NUM_PRODUTO);
											}
											if(!NUM_PRODUTO.value) {
												NUM_PRODUTO.options[0].selected = true;
											} 
											if (v_num_produto) {
												NUM_PRODUTO.value = v_num_produto;
											}
											
											//Verifica se a Operação tem Produto de Frete Definido
											if(TIPO_FRETE.value != ''){
												NUM_PRODUTO.value = TIPO_FRETE.value;
												NUM_PRODUTO.disabled = true;
												
												if(NUM_PRODUTO.value != TIPO_FRETE.value){
													document.getElementById('sp_produto_definido').innerHTML = 'O Tipo de Frete "'+ TIPO_FRETE_DESC.value +'" definido na operação não é permitido para esta emissão.';
												}else{
													document.getElementById('sp_produto_definido').innerHTML = 'Definido na Opera&ccedil;&atilde;o';
												}
												
												document.getElementById('sp_produto_definido').style.display = '';
											}else{
												document.getElementById('sp_produto_definido').style.display = 'none';
												NUM_PRODUTO.disabled = false;
											}
										}
									
										//Verifica se deve efetuar o cálculo do conhecimento após a busca
										if(p_executa_calculos == '1'){
											if(v_emite_tabela_frete == 0 || DISPENSADO_TABELA_FRETE.value == '1'){
												f_calcula_frete_convencional();
											}else{
												f_calculos();
											}
										}
									
									}
								});
				}
			}
	}		
	
	function f_exibir_tabelas(p_tipo, p_ids) {
		f_ocultar_div();
		document.getElementById('lb_cabecalho').innerHTML = '';
		document.getElementById('div_conteudo').innerHTML = '';
		
		obj = document.getElementById('div_info');
		f_get_scroll();
		
		if(obj.style.display == 'none') {
			//setTimeout("document.getElementById('div_info').style.display = '';", 100);
			document.getElementById('div_info').style.display = '';
			obj.style.top = window.event.clientY + scrOfY;
			obj.style.left = window.event.clientX + scrOfX;
		}

		document.getElementById('lb_cabecalho').innerHTML = 'Tabelas encontradas';
		
		f_buscar_tabelas_frete(p_tipo, p_ids);
	}
	
	function f_buscar_tabelas_frete(p_tipo, p_ids) {
		f_query_ajax('/modulos/cte/emitir/consultas.cfm' +
					'?consulta=22' +
					'&tipo=' + p_tipo +
					'&ids=' + p_ids
					,function(obj) {
						document.getElementById('div_conteudo').innerHTML = obj;
					});
	}

	
	function f_ocultar_div() {
		document.getElementById('div_info').style.display = 'none';
//		document.getElementById('div_info').style.width = '90%';
	}

</script>
<div id="div_info" style="width: 500px; height: 150px; display: none; position: absolute;">
    <table width="100%" height="250" class="borda" border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>
            <td width="99%" height="1%" class="texto_negrito" id="cabecalho_interno"><img width="5" height="16" title="" align="absmiddle" alt="" src="/_imagens/uteis/pontinhos-1.gif">&nbsp;<img width="25" height="20" title="" align="absmiddle" alt="" src="/levolog/_imagens/logos/logo_kmm.jpg">&nbsp;<label id="lb_cabecalho"></label></td>
            <td width="1%" class="texto_negrito" id="cabecalho_interno"><button tabindex="378" class="botao-16x16" onclick="f_ocultar_div()" type="button"><img width="16" height="16" title="" align="absmiddle" alt="" src="/_imagens/botoes/16x16/fechar_tela.gif"></button></td>
        </tr>
        <tr>
            <td height="98%" colspan="2">
                <table width="100%" height="100%" border="0" cellspacing="1" cellpadding="3">
                    <tbody><tr>
                        <td height="100%" class="texto" valign="top"><div id="div_conteudo" style="width: auto; height: 380px; overflow: scroll;"></div></td>
                    </tr>                   
                </tbody></table>
            </td>
        </tr>
        <tr>
            <td height="1%" align="right" class="texto" id="barra_botoes_bottom" colspan="2"><button tabindex="379" class="botao" onclick="f_ocultar_div()" type="button"><nobr><img width="16" height="16" title="" align="absmiddle" alt="" src="/_imagens/botoes/16x16/fechar_tela.gif">&nbsp;Fechar</nobr></button></td>
        </tr>
    </tbody></table>
</div>

<table width="100%" border="0" cellspacing="0" cellpadding="0">
	<tbody><tr id="tr_negociacao_carregando" style="display: none;">
    	<td id="td_negociacao_carregando" style="padding: 5px;"><img title="" alt="" src="/_imagens/uteis/carregando.gif"></td>
    </tr>
	<tr id="tr_negociacao_info" style="display: none;">
    	<td class="obrigatorio" id="td_negociacao_info" style="padding: 5px;"></td>
    </tr>
    <tr id="tr_negociacao_tabela_frete">
    	<td id="td_negociacao_tabela_frete" style="padding: 5px;">
                    <table border="0" cellspacing="0" cellpadding="0">
                        <tbody><tr>
                            <td valign="top">
                            	<table border="0">
                                    <tbody><tr>
                                        <td valign="top">
                                            <table class="borda" border="0" cellspacing="1" cellpadding="3">
                                                <tbody><tr class="titulo_1">
                                                    <td align="left" nowrap="">Descrição</td>
                                                    <td align="left" nowrap="">Valor</td>
                                                    <td align="center" nowrap="">Tipo</td>
                                                </tr>
                                                
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Peso Total Transportado (Kg)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PESOCARGA" id="VARIAVEL_PESOCARGA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="PESO TOTAL TRANSPORTADO (KG)" tipo="numerico">
                                                            <input name="VARIAVEL_PESOCARGA_CALC" id="VARIAVEL_PESOCARGA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PESOCARGA.value = VARIAVEL_PESOCARGA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="PESO TOTAL TRANSPORTADO (KG)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Serviço de Carga</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_SERVICO_CARGA" id="VARIAVEL_SERVICO_CARGA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); f_calculos();" type="hidden" maxlength="15" value="0" display="SERVIÇO DE CARGA" obrigatorio="1" tipo="numerico">
                                                            <input name="VARIAVEL_SERVICO_CARGA_CALC" id="VARIAVEL_SERVICO_CARGA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_SERVICO_CARGA.value = VARIAVEL_SERVICO_CARGA_CALC.value;  f_calculos();" type="text" maxlength="15" value="0.00" display="SERVIÇO DE CARGA" obrigatorio="1" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Emissão do Documento" align="absmiddle" alt="Valor - Informando na Emissão do Documento" src="/_imagens/botoes/16x16/editar.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Serviço de Descarga</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_SERVICO_DESCARGA" id="VARIAVEL_SERVICO_DESCARGA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); f_calculos();" type="hidden" maxlength="15" value="0" display="SERVIÇO DE DESCARGA" obrigatorio="1" tipo="numerico">
                                                            <input name="VARIAVEL_SERVICO_DESCARGA_CALC" id="VARIAVEL_SERVICO_DESCARGA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_SERVICO_DESCARGA.value = VARIAVEL_SERVICO_DESCARGA_CALC.value;  f_calculos();" type="text" maxlength="15" value="0.00" display="SERVIÇO DE DESCARGA" obrigatorio="1" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Emissão do Documento" align="absmiddle" alt="Valor - Informando na Emissão do Documento" src="/_imagens/botoes/16x16/editar.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Serviço de Peação</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_SERVICO_PEACAO" id="VARIAVEL_SERVICO_PEACAO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); f_calculos();" type="hidden" maxlength="15" value="0" display="SERVIÇO DE PEAÇÃO" obrigatorio="1" tipo="numerico">
                                                            <input name="VARIAVEL_SERVICO_PEACAO_CALC" id="VARIAVEL_SERVICO_PEACAO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_SERVICO_PEACAO.value = VARIAVEL_SERVICO_PEACAO_CALC.value;  f_calculos();" type="text" maxlength="15" value="0.00" display="SERVIÇO DE PEAÇÃO" obrigatorio="1" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Emissão do Documento" align="absmiddle" alt="Valor - Informando na Emissão do Documento" src="/_imagens/botoes/16x16/editar.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Taxa de Ajudante (1 - Sim e 0 - Não)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_TAXA_AJUDANTE" id="VARIAVEL_TAXA_AJUDANTE" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="TAXA DE AJUDANTE (1 - SIM E 0 - NÃO)" tipo="numerico">
                                                            <input name="VARIAVEL_TAXA_AJUDANTE_CALC" id="VARIAVEL_TAXA_AJUDANTE_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_TAXA_AJUDANTE.value = VARIAVEL_TAXA_AJUDANTE_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="TAXA DE AJUDANTE (1 - SIM E 0 - NÃO)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Taxa de Coleta (1 - Sim e 0 - Não)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_TAXA_COLETA" id="VARIAVEL_TAXA_COLETA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="TAXA DE COLETA (1 - SIM E 0 - NÃO)" tipo="numerico">
                                                            <input name="VARIAVEL_TAXA_COLETA_CALC" id="VARIAVEL_TAXA_COLETA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_TAXA_COLETA.value = VARIAVEL_TAXA_COLETA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="TAXA DE COLETA (1 - SIM E 0 - NÃO)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Taxa de Entrega (1 - Sim e 0 - Não)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_TAXA_ENTREGA" id="VARIAVEL_TAXA_ENTREGA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="TAXA DE ENTREGA (1 - SIM E 0 - NÃO)" tipo="numerico">
                                                            <input name="VARIAVEL_TAXA_ENTREGA_CALC" id="VARIAVEL_TAXA_ENTREGA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_TAXA_ENTREGA.value = VARIAVEL_TAXA_ENTREGA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="TAXA DE ENTREGA (1 - SIM E 0 - NÃO)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Despacho</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_DESPACHO" id="VARIAVEL_DESPACHO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="DESPACHO" tipo="numerico">
                                                            <input name="VARIAVEL_DESPACHO_CALC" id="VARIAVEL_DESPACHO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_DESPACHO.value = VARIAVEL_DESPACHO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="DESPACHO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Peso Bruto (Kg)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PESOBRUTO" id="VARIAVEL_PESOBRUTO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="7840" display="PESO BRUTO (KG)" tipo="numerico">
                                                            <input name="VARIAVEL_PESOBRUTO_CALC" id="VARIAVEL_PESOBRUTO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PESOBRUTO.value = VARIAVEL_PESOBRUTO_CALC.value;  " type="text" maxlength="15" readonly="" value="7840.00" display="PESO BRUTO (KG)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Peso Cobrado (Kg)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PESOCOBRADO" id="VARIAVEL_PESOCOBRADO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="PESO COBRADO (KG)" tipo="numerico">
                                                            <input name="VARIAVEL_PESOCOBRADO_CALC" id="VARIAVEL_PESOCOBRADO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PESOCOBRADO.value = VARIAVEL_PESOCOBRADO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="PESO COBRADO (KG)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
														</tbody></table></td><td valign="top"><table class="borda" border="0" cellspacing="1" cellpadding="3">
                                                        <tbody><tr class="titulo_1">
                                                            <td align="left" nowrap="">Descrição</td>
                                                            <td align="left" nowrap="">Valor</td>
                                                            <td align="center" nowrap="">Tipo</td>
                                                        </tr>
                                                	
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor Frete Unitário</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORUNITARIOFRETE" id="VARIAVEL_VALORUNITARIOFRETE" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); f_calculos();" type="hidden" maxlength="15" value="0" display="VALOR FRETE UNITÁRIO" obrigatorio="1" tipo="numerico">
                                                            <input name="VARIAVEL_VALORUNITARIOFRETE_CALC" id="VARIAVEL_VALORUNITARIOFRETE_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORUNITARIOFRETE.value = VARIAVEL_VALORUNITARIOFRETE_CALC.value;  f_calculos();" type="text" maxlength="15" value="0.00" display="VALOR FRETE UNITÁRIO" obrigatorio="1" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Emissão do Documento" align="absmiddle" alt="Valor - Informando na Emissão do Documento" src="/_imagens/botoes/16x16/editar.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Frete Valor (%)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_FRACAOADVALOREM" id="VARIAVEL_FRACAOADVALOREM" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="FRETE VALOR (%)" tipo="numerico">
                                                            <input name="VARIAVEL_FRACAOADVALOREM_CALC" id="VARIAVEL_FRACAOADVALOREM_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_FRACAOADVALOREM.value = VARIAVEL_FRACAOADVALOREM_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="FRETE VALOR (%)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Frete Valor</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_FRETEVALOR" id="VARIAVEL_FRETEVALOR" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="FRETE VALOR" tipo="numerico">
                                                            <input name="VARIAVEL_FRETEVALOR_CALC" id="VARIAVEL_FRETEVALOR_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_FRETEVALOR.value = VARIAVEL_FRETEVALOR_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="FRETE VALOR" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor Unitário Pedágio</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORUNITARIOPEDAGIO" id="VARIAVEL_VALORUNITARIOPEDAGIO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR UNITÁRIO PEDÁGIO" tipo="numerico">
                                                            <input name="VARIAVEL_VALORUNITARIOPEDAGIO_CALC" id="VARIAVEL_VALORUNITARIOPEDAGIO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORUNITARIOPEDAGIO.value = VARIAVEL_VALORUNITARIOPEDAGIO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR UNITÁRIO PEDÁGIO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor Total do Serviço</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_TOTALCTRC" id="VARIAVEL_TOTALCTRC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR TOTAL DO SERVIÇO" tipo="numerico">
                                                            <input name="VARIAVEL_TOTALCTRC_CALC" id="VARIAVEL_TOTALCTRC_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_TOTALCTRC.value = VARIAVEL_TOTALCTRC_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR TOTAL DO SERVIÇO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">% ICMS Part Destino</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PORCENTAGEM_PARTILHA_DESTINO" id="VARIAVEL_PORCENTAGEM_PARTILHA_DESTINO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="100" display="% ICMS PART DESTINO" tipo="numerico">
                                                            <input name="VARIAVEL_PORCENTAGEM_PARTILHA_DESTINO_CALC" id="VARIAVEL_PORCENTAGEM_PARTILHA_DESTINO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PORCENTAGEM_PARTILHA_DESTINO.value = VARIAVEL_PORCENTAGEM_PARTILHA_DESTINO_CALC.value;  " type="text" maxlength="15" readonly="" value="100.00" display="% ICMS PART DESTINO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">% ICMS Part Origem</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PORCENTAGEM_PARTILHA_ORIGEM" id="VARIAVEL_PORCENTAGEM_PARTILHA_ORIGEM" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="% ICMS PART ORIGEM" tipo="numerico">
                                                            <input name="VARIAVEL_PORCENTAGEM_PARTILHA_ORIGEM_CALC" id="VARIAVEL_PORCENTAGEM_PARTILHA_ORIGEM_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PORCENTAGEM_PARTILHA_ORIGEM.value = VARIAVEL_PORCENTAGEM_PARTILHA_ORIGEM_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="% ICMS PART ORIGEM" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">CFOP</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_CFOP" id="VARIAVEL_CFOP" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="5352" display="CFOP" tipo="numerico">
                                                            <input name="VARIAVEL_CFOP_CALC" id="VARIAVEL_CFOP_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_CFOP.value = VARIAVEL_CFOP_CALC.value;  " type="text" maxlength="15" readonly="" value="5352.00" display="CFOP" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">CFOP_ID</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_CFOP_ID" id="VARIAVEL_CFOP_ID" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="CFOP_ID" tipo="numerico">
                                                            <input name="VARIAVEL_CFOP_ID_CALC" id="VARIAVEL_CFOP_ID_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_CFOP_ID.value = VARIAVEL_CFOP_ID_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="CFOP_ID" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Código da Situação Tributária</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_CST_ICMS" id="VARIAVEL_CST_ICMS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="40" display="CÓDIGO DA SITUAÇÃO TRIBUTÁRIA" tipo="numerico">
                                                            <input name="VARIAVEL_CST_ICMS_CALC" id="VARIAVEL_CST_ICMS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_CST_ICMS.value = VARIAVEL_CST_ICMS_CALC.value;  " type="text" maxlength="15" readonly="" value="40.00" display="CÓDIGO DA SITUAÇÃO TRIBUTÁRIA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Fundamentação legal do ICMS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ICMS_FUNDAMENTACAO_LEGAL" id="VARIAVEL_ICMS_FUNDAMENTACAO_LEGAL" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="Isento ICMS conf. item 144 da parte 1 do anexo I do RICMS/MG." display="FUNDAMENTAÇÃO LEGAL DO ICMS">
                                                            <input name="VARIAVEL_ICMS_FUNDAMENTACAO_LEGAL_CALC" id="VARIAVEL_ICMS_FUNDAMENTACAO_LEGAL_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ICMS_FUNDAMENTACAO_LEGAL.value = VARIAVEL_ICMS_FUNDAMENTACAO_LEGAL_CALC.value;  " type="text" maxlength="15" readonly="" value="Isento ICMS conf. item 144 da parte 1 do anexo I do RICMS/MG." display="FUNDAMENTAÇÃO LEGAL DO ICMS">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">NATUREZA_OPERACAO</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_NATUREZA_OPERACAO" id="VARIAVEL_NATUREZA_OPERACAO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="Prest. Serv. Estabelecimento Industrial" display="NATUREZA_OPERACAO">
                                                            <input name="VARIAVEL_NATUREZA_OPERACAO_CALC" id="VARIAVEL_NATUREZA_OPERACAO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_NATUREZA_OPERACAO.value = VARIAVEL_NATUREZA_OPERACAO_CALC.value;  " type="text" maxlength="15" readonly="" value="Prest. Serv. Estabelecimento Industrial" display="NATUREZA_OPERACAO">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor Total Tributável</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_TOTAL_TRIBUTAVEL" id="VARIAVEL_VALOR_TOTAL_TRIBUTAVEL" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR TOTAL TRIBUTÁVEL" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_TOTAL_TRIBUTAVEL_CALC" id="VARIAVEL_VALOR_TOTAL_TRIBUTAVEL_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_TOTAL_TRIBUTAVEL.value = VARIAVEL_VALOR_TOTAL_TRIBUTAVEL_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR TOTAL TRIBUTÁVEL" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Alíq ICMS FCP</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ALIQUOTA_ICMS_FCP" id="VARIAVEL_ALIQUOTA_ICMS_FCP" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ALÍQ ICMS FCP" tipo="numerico">
                                                            <input name="VARIAVEL_ALIQUOTA_ICMS_FCP_CALC" id="VARIAVEL_ALIQUOTA_ICMS_FCP_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ALIQUOTA_ICMS_FCP.value = VARIAVEL_ALIQUOTA_ICMS_FCP_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ALÍQ ICMS FCP" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Alíq ICMS Partilha</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ALIQUOTA_ICMS_PARTILHA" id="VARIAVEL_ALIQUOTA_ICMS_PARTILHA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ALÍQ ICMS PARTILHA" tipo="numerico">
                                                            <input name="VARIAVEL_ALIQUOTA_ICMS_PARTILHA_CALC" id="VARIAVEL_ALIQUOTA_ICMS_PARTILHA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ALIQUOTA_ICMS_PARTILHA.value = VARIAVEL_ALIQUOTA_ICMS_PARTILHA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ALÍQ ICMS PARTILHA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Alíquota do imposto aplicado</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ALIQUOTAIMPOSTO" id="VARIAVEL_ALIQUOTAIMPOSTO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ALÍQUOTA DO IMPOSTO APLICADO" tipo="numerico">
                                                            <input name="VARIAVEL_ALIQUOTAIMPOSTO_CALC" id="VARIAVEL_ALIQUOTAIMPOSTO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ALIQUOTAIMPOSTO.value = VARIAVEL_ALIQUOTAIMPOSTO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ALÍQUOTA DO IMPOSTO APLICADO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Total do ICMS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_ICMS_TOTAL" id="VARIAVEL_VALOR_ICMS_TOTAL" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="TOTAL DO ICMS" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_ICMS_TOTAL_CALC" id="VARIAVEL_VALOR_ICMS_TOTAL_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_ICMS_TOTAL.value = VARIAVEL_VALOR_ICMS_TOTAL_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="TOTAL DO ICMS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor do ISS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORISS" id="VARIAVEL_VALORISS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR DO ISS" tipo="numerico">
                                                            <input name="VARIAVEL_VALORISS_CALC" id="VARIAVEL_VALORISS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORISS.value = VARIAVEL_VALORISS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR DO ISS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor do Rateio do Pedágio</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_RATEIODOPEDAGIO" id="VARIAVEL_RATEIODOPEDAGIO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR DO RATEIO DO PEDÁGIO" tipo="numerico">
                                                            <input name="VARIAVEL_RATEIODOPEDAGIO_CALC" id="VARIAVEL_RATEIODOPEDAGIO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_RATEIODOPEDAGIO.value = VARIAVEL_RATEIODOPEDAGIO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR DO RATEIO DO PEDÁGIO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor ICMS FCP</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_ICMS_FCP" id="VARIAVEL_VALOR_ICMS_FCP" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR ICMS FCP" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_ICMS_FCP_CALC" id="VARIAVEL_VALOR_ICMS_FCP_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_ICMS_FCP.value = VARIAVEL_VALOR_ICMS_FCP_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR ICMS FCP" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor ICMS Partilha</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_ICMS_PARTILHA" id="VARIAVEL_VALOR_ICMS_PARTILHA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR ICMS PARTILHA" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_ICMS_PARTILHA_CALC" id="VARIAVEL_VALOR_ICMS_PARTILHA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_ICMS_PARTILHA.value = VARIAVEL_VALOR_ICMS_PARTILHA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR ICMS PARTILHA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor Máximo do Agregado</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_MAXIMO_AGREGADO" id="VARIAVEL_VALOR_MAXIMO_AGREGADO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR MÁXIMO DO AGREGADO" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_MAXIMO_AGREGADO_CALC" id="VARIAVEL_VALOR_MAXIMO_AGREGADO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_MAXIMO_AGREGADO.value = VARIAVEL_VALOR_MAXIMO_AGREGADO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR MÁXIMO DO AGREGADO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor Máximo do Terceiro</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_MAXIMO_TERCEIRO" id="VARIAVEL_VALOR_MAXIMO_TERCEIRO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); f_calculos();" type="hidden" maxlength="15" value="0" display="VALOR MÁXIMO DO TERCEIRO" obrigatorio="1" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_MAXIMO_TERCEIRO_CALC" id="VARIAVEL_VALOR_MAXIMO_TERCEIRO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_MAXIMO_TERCEIRO.value = VARIAVEL_VALOR_MAXIMO_TERCEIRO_CALC.value;  f_calculos();" type="text" maxlength="15" value="0.00" display="VALOR MÁXIMO DO TERCEIRO" obrigatorio="1" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Emissão do Documento" align="absmiddle" alt="Valor - Informando na Emissão do Documento" src="/_imagens/botoes/16x16/editar.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor Part Destino</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_DESTINO_PARTILHA" id="VARIAVEL_VALOR_DESTINO_PARTILHA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR PART DESTINO" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_DESTINO_PARTILHA_CALC" id="VARIAVEL_VALOR_DESTINO_PARTILHA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_DESTINO_PARTILHA.value = VARIAVEL_VALOR_DESTINO_PARTILHA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR PART DESTINO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor Part Origem</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_ORIGEM_PARTILHA" id="VARIAVEL_VALOR_ORIGEM_PARTILHA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR PART ORIGEM" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_ORIGEM_PARTILHA_CALC" id="VARIAVEL_VALOR_ORIGEM_PARTILHA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_ORIGEM_PARTILHA.value = VARIAVEL_VALOR_ORIGEM_PARTILHA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR PART ORIGEM" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor Total das Taxas</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_TOTAL_TAXAS" id="VARIAVEL_TOTAL_TAXAS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR TOTAL DAS TAXAS" tipo="numerico">
                                                            <input name="VARIAVEL_TOTAL_TAXAS_CALC" id="VARIAVEL_TOTAL_TAXAS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_TOTAL_TAXAS.value = VARIAVEL_TOTAL_TAXAS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR TOTAL DAS TAXAS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">% Taxa Adm Cliente</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PERC_TAXA_CLIENTE" id="VARIAVEL_PERC_TAXA_CLIENTE" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="% TAXA ADM CLIENTE" tipo="numerico">
                                                            <input name="VARIAVEL_PERC_TAXA_CLIENTE_CALC" id="VARIAVEL_PERC_TAXA_CLIENTE_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PERC_TAXA_CLIENTE.value = VARIAVEL_PERC_TAXA_CLIENTE_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="% TAXA ADM CLIENTE" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">ICMS Compõe Base de Cálculo</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ICMS_COMPOE_BASE_CALCULO" id="VARIAVEL_ICMS_COMPOE_BASE_CALCULO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="1" display="ICMS COMPÕE BASE DE CÁLCULO" tipo="numerico">
                                                            <input name="VARIAVEL_ICMS_COMPOE_BASE_CALCULO_CALC" id="VARIAVEL_ICMS_COMPOE_BASE_CALCULO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ICMS_COMPOE_BASE_CALCULO.value = VARIAVEL_ICMS_COMPOE_BASE_CALCULO_CALC.value;  " type="text" maxlength="15" readonly="" value="1.00" display="ICMS COMPÕE BASE DE CÁLCULO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">ICMS Partilha compõe base de cálculo</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ICMS_PART_COMPOE_BASE_CALCULO" id="VARIAVEL_ICMS_PART_COMPOE_BASE_CALCULO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ICMS PARTILHA COMPÕE BASE DE CÁLCULO" tipo="numerico">
                                                            <input name="VARIAVEL_ICMS_PART_COMPOE_BASE_CALCULO_CALC" id="VARIAVEL_ICMS_PART_COMPOE_BASE_CALCULO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ICMS_PART_COMPOE_BASE_CALCULO.value = VARIAVEL_ICMS_PART_COMPOE_BASE_CALCULO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ICMS PARTILHA COMPÕE BASE DE CÁLCULO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Margem do Agregado</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_MARGEM_AGREGADO" id="VARIAVEL_MARGEM_AGREGADO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="MARGEM DO AGREGADO" tipo="numerico">
                                                            <input name="VARIAVEL_MARGEM_AGREGADO_CALC" id="VARIAVEL_MARGEM_AGREGADO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_MARGEM_AGREGADO.value = VARIAVEL_MARGEM_AGREGADO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="MARGEM DO AGREGADO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Margem do Terceiro</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_MARGEM_TERCEIRO" id="VARIAVEL_MARGEM_TERCEIRO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="MARGEM DO TERCEIRO" tipo="numerico">
                                                            <input name="VARIAVEL_MARGEM_TERCEIRO_CALC" id="VARIAVEL_MARGEM_TERCEIRO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_MARGEM_TERCEIRO.value = VARIAVEL_MARGEM_TERCEIRO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="MARGEM DO TERCEIRO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            		
                                                        <script>
															with(parent.document.forms[0]) {
			                                                    BASE_CALC_MAIOR_TOTAL.value = '0';
															}
														</script>
                                                    
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Permite base de cálculo do ICMS maior que total do CTRC</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PERMITE_BASE_CALC_MAIOR_TOTAL" id="VARIAVEL_PERMITE_BASE_CALC_MAIOR_TOTAL" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="PERMITE BASE DE CÁLCULO DO ICMS MAIOR QUE TOTAL DO CTRC" tipo="numerico">
                                                            <input name="VARIAVEL_PERMITE_BASE_CALC_MAIOR_TOTAL_CALC" id="VARIAVEL_PERMITE_BASE_CALC_MAIOR_TOTAL_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PERMITE_BASE_CALC_MAIOR_TOTAL.value = VARIAVEL_PERMITE_BASE_CALC_MAIOR_TOTAL_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="PERMITE BASE DE CÁLCULO DO ICMS MAIOR QUE TOTAL DO CTRC" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Tipo desc. quebra de peso (MERCADORIA)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_TIPO_DESC_QUEBRA_MERCADORIA" id="VARIAVEL_TIPO_DESC_QUEBRA_MERCADORIA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="TIPO DESC. QUEBRA DE PESO (MERCADORIA)" tipo="numerico">
                                                            <input name="VARIAVEL_TIPO_DESC_QUEBRA_MERCADORIA_CALC" id="VARIAVEL_TIPO_DESC_QUEBRA_MERCADORIA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_TIPO_DESC_QUEBRA_MERCADORIA.value = VARIAVEL_TIPO_DESC_QUEBRA_MERCADORIA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="TIPO DESC. QUEBRA DE PESO (MERCADORIA)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Tolerância de horas de diária</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_DIARIA_TOLERANCIA" id="VARIAVEL_DIARIA_TOLERANCIA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="2" display="TOLERÂNCIA DE HORAS DE DIÁRIA" tipo="numerico">
                                                            <input name="VARIAVEL_DIARIA_TOLERANCIA_CALC" id="VARIAVEL_DIARIA_TOLERANCIA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_DIARIA_TOLERANCIA.value = VARIAVEL_DIARIA_TOLERANCIA_CALC.value;  " type="text" maxlength="15" readonly="" value="2.00" display="TOLERÂNCIA DE HORAS DE DIÁRIA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor da hora de diária (R$)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_DIARIA_VALOR_HORA" id="VARIAVEL_DIARIA_VALOR_HORA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR DA HORA DE DIÁRIA (R$)" tipo="numerico">
                                                            <input name="VARIAVEL_DIARIA_VALOR_HORA_CALC" id="VARIAVEL_DIARIA_VALOR_HORA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_DIARIA_VALOR_HORA.value = VARIAVEL_DIARIA_VALOR_HORA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR DA HORA DE DIÁRIA (R$)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor da Taxa de Ajudante</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_AJUDANTE" id="VARIAVEL_VALOR_AJUDANTE" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR DA TAXA DE AJUDANTE" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_AJUDANTE_CALC" id="VARIAVEL_VALOR_AJUDANTE_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_AJUDANTE.value = VARIAVEL_VALOR_AJUDANTE_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR DA TAXA DE AJUDANTE" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor da Taxa de Coleta</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_COLETA" id="VARIAVEL_VALOR_COLETA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR DA TAXA DE COLETA" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_COLETA_CALC" id="VARIAVEL_VALOR_COLETA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_COLETA.value = VARIAVEL_VALOR_COLETA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR DA TAXA DE COLETA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor da Taxa de Entrega</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_ENTREGA" id="VARIAVEL_VALOR_ENTREGA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR DA TAXA DE ENTREGA" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_ENTREGA_CALC" id="VARIAVEL_VALOR_ENTREGA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_ENTREGA.value = VARIAVEL_VALOR_ENTREGA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR DA TAXA DE ENTREGA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor Unitário Agregado</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_UNIT_AGREG" id="VARIAVEL_VALOR_UNIT_AGREG" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR UNITÁRIO AGREGADO" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_UNIT_AGREG_CALC" id="VARIAVEL_VALOR_UNIT_AGREG_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_UNIT_AGREG.value = VARIAVEL_VALOR_UNIT_AGREG_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR UNITÁRIO AGREGADO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor unitário do contrato de transporte</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_CT_VALOR_UNITARIO" id="VARIAVEL_CT_VALOR_UNITARIO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR UNITÁRIO DO CONTRATO DE TRANSPORTE" tipo="numerico">
                                                            <input name="VARIAVEL_CT_VALOR_UNITARIO_CALC" id="VARIAVEL_CT_VALOR_UNITARIO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_CT_VALOR_UNITARIO.value = VARIAVEL_CT_VALOR_UNITARIO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR UNITÁRIO DO CONTRATO DE TRANSPORTE" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor Unitário Terceiro</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALOR_UNIT_TERC" id="VARIAVEL_VALOR_UNIT_TERC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); f_calculos();" type="hidden" maxlength="15" value="0" display="VALOR UNITÁRIO TERCEIRO" obrigatorio="1" tipo="numerico">
                                                            <input name="VARIAVEL_VALOR_UNIT_TERC_CALC" id="VARIAVEL_VALOR_UNIT_TERC_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALOR_UNIT_TERC.value = VARIAVEL_VALOR_UNIT_TERC_CALC.value;  f_calculos();" type="text" maxlength="15" value="0.00" display="VALOR UNITÁRIO TERCEIRO" obrigatorio="1" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Emissão do Documento" align="absmiddle" alt="Valor - Informando na Emissão do Documento" src="/_imagens/botoes/16x16/editar.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">GRIS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_GRIS" id="VARIAVEL_GRIS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="GRIS" tipo="numerico">
                                                            <input name="VARIAVEL_GRIS_CALC" id="VARIAVEL_GRIS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_GRIS.value = VARIAVEL_GRIS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="GRIS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">ADEME</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ADEME" id="VARIAVEL_ADEME" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ADEME" tipo="numerico">
                                                            <input name="VARIAVEL_ADEME_CALC" id="VARIAVEL_ADEME_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ADEME.value = VARIAVEL_ADEME_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ADEME" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">SEC/CAT</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_SECCAT" id="VARIAVEL_SECCAT" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="SEC/CAT" tipo="numerico">
                                                            <input name="VARIAVEL_SECCAT_CALC" id="VARIAVEL_SECCAT_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_SECCAT.value = VARIAVEL_SECCAT_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="SEC/CAT" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">ADVALOREM</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ADVALOREM" id="VARIAVEL_ADVALOREM" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ADVALOREM" tipo="numerico">
                                                            <input name="VARIAVEL_ADVALOREM_CALC" id="VARIAVEL_ADVALOREM_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ADVALOREM.value = VARIAVEL_ADVALOREM_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ADVALOREM" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Outros</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_OUTROS" id="VARIAVEL_OUTROS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="OUTROS" tipo="numerico">
                                                            <input name="VARIAVEL_OUTROS_CALC" id="VARIAVEL_OUTROS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_OUTROS.value = VARIAVEL_OUTROS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="OUTROS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Frete Unitário Peso</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_FRETEUNITARIO" id="VARIAVEL_FRETEUNITARIO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); f_calculos();" type="hidden" maxlength="15" value="0" display="FRETE UNITÁRIO PESO" obrigatorio="1" tipo="numerico">
                                                            <input name="VARIAVEL_FRETEUNITARIO_CALC" id="VARIAVEL_FRETEUNITARIO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_FRETEUNITARIO.value = VARIAVEL_FRETEUNITARIO_CALC.value;  f_calculos();" type="text" maxlength="15" value="0.00" display="FRETE UNITÁRIO PESO" obrigatorio="1" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Emissão do Documento" align="absmiddle" alt="Valor - Informando na Emissão do Documento" src="/_imagens/botoes/16x16/editar.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Frete Peso</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_FRETEPESO" id="VARIAVEL_FRETEPESO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="FRETE PESO" tipo="numerico">
                                                            <input name="VARIAVEL_FRETEPESO_CALC" id="VARIAVEL_FRETEPESO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_FRETEPESO.value = VARIAVEL_FRETEPESO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="FRETE PESO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor da Mercadoria</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORMERCADORIA" id="VARIAVEL_VALORMERCADORIA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="95653.72" display="VALOR DA MERCADORIA" tipo="numerico">
                                                            <input name="VARIAVEL_VALORMERCADORIA_CALC" id="VARIAVEL_VALORMERCADORIA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORMERCADORIA.value = VARIAVEL_VALORMERCADORIA_CALC.value;  " type="text" maxlength="15" readonly="" value="95653.72" display="VALOR DA MERCADORIA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Pedágio</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PEDAGIO" id="VARIAVEL_PEDAGIO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="PEDÁGIO" tipo="numerico">
                                                            <input name="VARIAVEL_PEDAGIO_CALC" id="VARIAVEL_PEDAGIO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PEDAGIO.value = VARIAVEL_PEDAGIO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="PEDÁGIO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Base Cálculo ICMS Substituto</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_BASECALCULOICMSSUBSTITUTO" id="VARIAVEL_BASECALCULOICMSSUBSTITUTO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="BASE CÁLCULO ICMS SUBSTITUTO" tipo="numerico">
                                                            <input name="VARIAVEL_BASECALCULOICMSSUBSTITUTO_CALC" id="VARIAVEL_BASECALCULOICMSSUBSTITUTO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_BASECALCULOICMSSUBSTITUTO.value = VARIAVEL_BASECALCULOICMSSUBSTITUTO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="BASE CÁLCULO ICMS SUBSTITUTO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Redução Base ICMS Substituto</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_REDUCAOBASEICMSSUBSTITUTO" id="VARIAVEL_REDUCAOBASEICMSSUBSTITUTO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="REDUÇÃO BASE ICMS SUBSTITUTO" tipo="numerico">
                                                            <input name="VARIAVEL_REDUCAOBASEICMSSUBSTITUTO_CALC" id="VARIAVEL_REDUCAOBASEICMSSUBSTITUTO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_REDUCAOBASEICMSSUBSTITUTO.value = VARIAVEL_REDUCAOBASEICMSSUBSTITUTO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="REDUÇÃO BASE ICMS SUBSTITUTO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor ICMS Substituto</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORICMSSUBSTITUTO" id="VARIAVEL_VALORICMSSUBSTITUTO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR ICMS SUBSTITUTO" tipo="numerico">
                                                            <input name="VARIAVEL_VALORICMSSUBSTITUTO_CALC" id="VARIAVEL_VALORICMSSUBSTITUTO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORICMSSUBSTITUTO.value = VARIAVEL_VALORICMSSUBSTITUTO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR ICMS SUBSTITUTO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor ICMS Presumido</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORICMSPRESUMIDO" id="VARIAVEL_VALORICMSPRESUMIDO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR ICMS PRESUMIDO" tipo="numerico">
                                                            <input name="VARIAVEL_VALORICMSPRESUMIDO_CALC" id="VARIAVEL_VALORICMSPRESUMIDO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORICMSPRESUMIDO.value = VARIAVEL_VALORICMSPRESUMIDO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR ICMS PRESUMIDO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Alíquota ISS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ALIQUOTAISS" id="VARIAVEL_ALIQUOTAISS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ALÍQUOTA ISS" tipo="numerico">
                                                            <input name="VARIAVEL_ALIQUOTAISS_CALC" id="VARIAVEL_ALIQUOTAISS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ALIQUOTAISS.value = VARIAVEL_ALIQUOTAISS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ALÍQUOTA ISS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Base de Cálculo ISS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_BASECALCULOISS" id="VARIAVEL_BASECALCULOISS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="BASE DE CÁLCULO ISS" tipo="numerico">
                                                            <input name="VARIAVEL_BASECALCULOISS_CALC" id="VARIAVEL_BASECALCULOISS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_BASECALCULOISS.value = VARIAVEL_BASECALCULOISS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="BASE DE CÁLCULO ISS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">KM da Rota</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_KMROTA" id="VARIAVEL_KMROTA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="536" display="KM DA ROTA" tipo="numerico">
                                                            <input name="VARIAVEL_KMROTA_CALC" id="VARIAVEL_KMROTA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_KMROTA.value = VARIAVEL_KMROTA_CALC.value;  " type="text" maxlength="15" readonly="" value="536.00" display="KM DA ROTA" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Base de Cálculo ICMS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_BASECALCULOICMS" id="VARIAVEL_BASECALCULOICMS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="BASE DE CÁLCULO ICMS" tipo="numerico">
                                                            <input name="VARIAVEL_BASECALCULOICMS_CALC" id="VARIAVEL_BASECALCULOICMS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_BASECALCULOICMS.value = VARIAVEL_BASECALCULOICMS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="BASE DE CÁLCULO ICMS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Redução Base ICMS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_REDUCAOBASEICMS" id="VARIAVEL_REDUCAOBASEICMS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="REDUÇÃO BASE ICMS" tipo="numerico">
                                                            <input name="VARIAVEL_REDUCAOBASEICMS_CALC" id="VARIAVEL_REDUCAOBASEICMS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_REDUCAOBASEICMS.value = VARIAVEL_REDUCAOBASEICMS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="REDUÇÃO BASE ICMS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Alíquota ICMS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_ALIQUOTAICMS" id="VARIAVEL_ALIQUOTAICMS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="ALÍQUOTA ICMS" tipo="numerico">
                                                            <input name="VARIAVEL_ALIQUOTAICMS_CALC" id="VARIAVEL_ALIQUOTAICMS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_ALIQUOTAICMS.value = VARIAVEL_ALIQUOTAICMS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="ALÍQUOTA ICMS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Valor ICMS</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORICMS" id="VARIAVEL_VALORICMS" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR ICMS" tipo="numerico">
                                                            <input name="VARIAVEL_VALORICMS_CALC" id="VARIAVEL_VALORICMS_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORICMS.value = VARIAVEL_VALORICMS_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR ICMS" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Interna - Não Editável" align="absmiddle" alt="Interna - Não Editável" src="/_imagens/botoes/16x16/seta_matriz.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Placa Carreta</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PLACACARRETA" id="VARIAVEL_PLACACARRETA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="" display="PLACA CARRETA">
                                                            <input name="VARIAVEL_PLACACARRETA_CALC" id="VARIAVEL_PLACACARRETA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PLACACARRETA.value = VARIAVEL_PLACACARRETA_CALC.value;  " type="text" maxlength="15" readonly="" value="" display="PLACA CARRETA">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Desconto</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_DESCONTO" id="VARIAVEL_DESCONTO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="DESCONTO" tipo="numerico">
                                                            <input name="VARIAVEL_DESCONTO_CALC" id="VARIAVEL_DESCONTO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_DESCONTO.value = VARIAVEL_DESCONTO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="DESCONTO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">Valor do Faturamento</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_VALORFATURAMENTO" id="VARIAVEL_VALORFATURAMENTO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="VALOR DO FATURAMENTO" tipo="numerico">
                                                            <input name="VARIAVEL_VALORFATURAMENTO_CALC" id="VARIAVEL_VALORFATURAMENTO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_VALORFATURAMENTO.value = VARIAVEL_VALORFATURAMENTO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="VALOR DO FATURAMENTO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">KM Informado</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_KMINFORMADO" id="VARIAVEL_KMINFORMADO" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="KM INFORMADO" tipo="numerico">
                                                            <input name="VARIAVEL_KMINFORMADO_CALC" id="VARIAVEL_KMINFORMADO_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_KMINFORMADO.value = VARIAVEL_KMINFORMADO_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="KM INFORMADO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_1" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_1';">
                                                        <td align="left" nowrap="">% Tolerância Quebra Peso</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_PERC_TOLERANCIA_QUEBRA" id="VARIAVEL_PERC_TOLERANCIA_QUEBRA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0.25" display="% TOLERÂNCIA QUEBRA PESO" tipo="numerico">
                                                            <input name="VARIAVEL_PERC_TOLERANCIA_QUEBRA_CALC" id="VARIAVEL_PERC_TOLERANCIA_QUEBRA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_PERC_TOLERANCIA_QUEBRA.value = VARIAVEL_PERC_TOLERANCIA_QUEBRA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.25" display="% TOLERÂNCIA QUEBRA PESO" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Valor - Informando na Tabela" align="absmiddle" alt="Valor - Informando na Tabela" src="/_imagens/botoes/16x16/arquivo_detalhes.gif"></td>
                                                    </tr>
                                            	
                                                    
                                                    <tr class="linha_2" style="display: none;" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_2';">
                                                        <td align="left" nowrap="">Tipo desc. quebra de peso (FRETE)</td>
                                                        <td align="left" nowrap="">
                                                        	<input name="VARIAVEL_TIPO_DESC_QUEBRA" id="VARIAVEL_TIPO_DESC_QUEBRA" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); " type="hidden" maxlength="15" readonly="" value="0" display="TIPO DESC. QUEBRA DE PESO (FRETE)" tipo="numerico">
                                                            <input name="VARIAVEL_TIPO_DESC_QUEBRA_CALC" id="VARIAVEL_TIPO_DESC_QUEBRA_CALC" style="width: 85px; text-align: right;" onkeypress="return f_formata_numero_decimal(this, event)" onchange="this.value = Number(this.value); VARIAVEL_TIPO_DESC_QUEBRA.value = VARIAVEL_TIPO_DESC_QUEBRA_CALC.value;  " type="text" maxlength="15" readonly="" value="0.00" display="TIPO DESC. QUEBRA DE PESO (FRETE)" tipo="numerico">
                                                        </td>
                                                        <td align="center" nowrap=""><img width="16" height="16" title="Fórmula" align="absmiddle" alt="Fórmula" src="/_imagens/botoes/16x16/fx.gif"></td>
                                                    </tr>
                                            	
                                                <tr class="linha_#((qrCalculo.query.RecordCount + 1) Mod 2) + 1#" onmouseover="this.className = 'linha_over';" onmouseout="this.className = 'linha_#((qrCalculo.query.RecordCount + 1) Mod 2) + 1#';">
                                                    <td align="left" nowrap="" colspan="2">&nbsp;</td>
                                                    <td align="center" nowrap=""><button class="botao-16x16" onclick="f_calculos()" type="button"><img width="16" height="16" title="Executar Cálculos" align="absmiddle" alt="Executar Cálculos" src="/_imagens/botoes/16x16/calculadora.gif"></button></td>
                                                </tr>
                                            </tbody></table>
                                        </td>
                                	</tr>
                                </tbody></table>
                            </td>
                            <td valign="top" style="padding-left: 20px;">
                            	
    <table width="498" class="borda" style="margin-top: 2px;" border="0" cellspacing="1" cellpadding="3">                           
        <tbody><tr>
            <td align="center" class="titulo_1" style="border-bottom-color: rgb(145, 166, 185); border-bottom-width: 1px; border-bottom-style: solid;" colspan="4">Tabela de Frete</td>
        </tr>
        <tr class="texto" style="text-align: center; font-weight: bold;">
            <td width="20%" style="border-bottom-color: rgb(153, 173, 191); border-bottom-width: 1px; border-bottom-style: solid;">Itens</td>
            <td width="79%" style="border-bottom-color: rgb(153, 173, 191); border-bottom-width: 1px; border-bottom-style: solid;">Valores</td>
            <td width="10%" style="border-bottom-color: rgb(153, 173, 191); border-bottom-width: 1px; border-bottom-style: solid;"><nobr>Tabelas Encontradas</nobr></td>
            <td width="1%" style="border-bottom-color: rgb(153, 173, 191); border-bottom-width: 1px; border-bottom-style: solid;">&nbsp;</td>
        </tr>
        
        <tr class="linha_1">
            <td>Negociador</td>
            <td><nobr>Tabela aberta</nobr></td>
            <td align="center">2</td>
            <td><button class="botao-16x16" onclick="f_exibir_tabelas('TABELA_FRETE', '0200,201')" type="button"><img width="16" height="16" alt="Clique para exibir as tabelas encontradas" src="/_imagens/botoes/16x16/atencao.png"></button></td>
        </tr>
        
        <tr class="linha_2">
            <td>Tipo</td>
            <td><nobr>Nacional</nobr></td>
            <td align="center">2</td>
            <td><button class="botao-16x16" onclick="f_exibir_tabelas('TABELA_FRETE', '0200,201')" type="button"><img width="16" height="16" alt="Clique para exibir as tabelas encontradas" src="/_imagens/botoes/16x16/atencao.png"></button></td>
        </tr>
        
        <tr class="linha_1">
            <td><nobr>Tipo Serviço</nobr></td>
            <td>Conhecimento de Complemento</td>
            <td align="center">1</td>
            <td><button class="botao-16x16" onclick="f_exibir_tabelas('TABELA_FRETE', '0201')" type="button"><img width="16" height="16" alt="Clique para exibir as tabelas encontradas" src="/_imagens/botoes/16x16/confirmar_transp.gif"></button></td>
        </tr>
        
        <tr class="linha_2">
            <td>Vigência</td>
            <td>19/12/2025</td>
            <td align="center">1</td>
            <td><button class="botao-16x16" onclick="f_exibir_tabelas('VIGENCIA', '0245')" type="button"><img width="16" height="16" alt="Clique para exibir as tabelas encontradas" src="/_imagens/botoes/16x16/confirmar_transp.gif"></button></td>
        </tr>
        
        <tr class="linha_1">
            <td>Rota</td>
            
            	<td>Tabela aberta</td>
            
            <td align="center">1</td>
            
            	<td><button class="botao-16x16" onclick="f_exibir_tabelas('TABELA_FRETE', '0201')" type="button"><img width="16" height="16" alt="Clique para exibir as tabelas encontradas" src="/_imagens/botoes/16x16/confirmar_transp.gif"></button></td>
            
        </tr>
        
        <tr class="linha_2">
            <td>Mercadoria</td>
            <td>Tabela aberta</td>
            <td align="center">1</td>
            
            	<td><button class="botao-16x16" onclick="f_exibir_tabelas('TABELA_FRETE', '0201')" type="button"><img width="16" height="16" alt="Clique para exibir as tabelas encontradas" src="/_imagens/botoes/16x16/confirmar_transp.gif"></button></td>
            
        </tr>
        
        <tr class="linha_1">
            <td><nobr>Tipo do Veículo</nobr></td>
            <td>Tabela aberta</td>
            <td align="center">1</td>
    		
            	<td><button class="botao-16x16" onclick="f_exibir_tabelas('TABELA_FRETE', '0201')" type="button"><img width="16" height="16" alt="Clique para exibir as tabelas encontradas" src="/_imagens/botoes/16x16/confirmar_transp.gif"></button></td>
            
        </tr>
        <tr>
            <td height="30" align="center" class="texto" style="font-weight: bold; border-top-color: rgb(145, 166, 185); border-top-width: 1px; border-top-style: solid;" colspan="4">
            	
                    Tabela Selecionada: 201 - Tabela aberta: Conhecimento de Complemento 
            </td>
        </tr>
        <tr>
            <td style="border-top-color: rgb(145, 166, 185); border-top-width: 1px; border-top-style: solid;" colspan="4">
                <button class="botao_tbl_frete" style="width: 100%; text-align: center; margin-right: 5px;" onclick="f_busca_tipo_calculo()" type="button"><img width="16" height="16" title="Tentar Novamente" align="absmiddle" alt="Tentar Novamente" src="/_imagens/botoes/16x16/atualizar.gif">&nbsp;Reconsultar forma de Cálculo</button>
            </td>
        </tr>
        
    </tbody></table>
	

                            </td>
                        </tr>
                    </tbody></table>
                </td>
    </tr>
	<tr id="tr_negociacao_convencional" style="display: none;">
    	<td id="td_negociacao_convencional">
            <table border="0" cellspacing="1" cellpadding="3">
               <!--DWLayoutTable-->
               <tbody><tr>
                 <td class="texto" nowrap="" colspan="4"><fieldset tabindex="380" id="fld_negociacao" style="display: none;">
                 <legend>Parâmetros da Negociação</legend>
                 <table width="100%" class="texto" border="0" cellspacing="1" cellpadding="2">
                   <tbody><tr>
                     <td width="1%" nowrap="nowrap">Frete pago por lotação?</td>
                     <td width="99%"><select name="FLAG_LOTACAO" tabindex="381" class="requerido_form" id="FLAG_LOTACAO" display="FRETE LOTAÇÃO" obrigatorio="1">
                       <option value="1">Sim</option>
                       <option selected="selected" value="0">Não</option>
                     </select>         </td>
                    </tr>
                   <tr>
                     <td nowrap="nowrap">Informe o número de entregas:</td>
                     <td><input name="NUM_ENTREGAS_PAGAS" tabindex="382" class="requerido_form" id="NUM_ENTREGAS_PAGAS" type="text" size="3" maxlength="3" value="1" display="NUM. ENTREGA" obrigatorio="1"></td>
                    </tr>
                   <tr>
                     <td nowrap="nowrap">Ajudantes Carga/Descarga:</td>
                     <td><input name="NUM_AJUDANTES" tabindex="383" class="requerido_form" id="NUM_AJUDANTES" type="text" size="3" maxlength="3" value="0" display="NUM. AJUDANTES" obrigatorio="1"></td>
                    </tr>
                   <tr>
                     <td>Cobrar frete como TRUCK?</td>
                     <td><select name="FLAG_TRUCK" tabindex="384" class="requerido_form" id="FLAG_TRUCK" display="FRETE LOTAÇÃO" obrigatorio="1">
                       <option value="1">Sim</option>
                       <option selected="selected" value="0">Não</option>
                     </select></td>
                    </tr>
                   <tr>
                     <td>Frete com entrega URGENTE?</td>
                     <td><select name="FLAG_URGENTE" tabindex="385" class="requerido_form" id="FLAG_URGENTE" display="FRETE LOTAÇÃO" obrigatorio="1">
                       <option value="1">Sim</option>
                       <option selected="selected" value="0">Não</option>
                     </select></td>
                   </tr>
                   <tr>
                     <td>Número de eixos:</td>
                     <td><input name="NUM_EIXOS" tabindex="386" class="requerido_form" id="NUM_EIXOS" type="text" size="3" maxlength="3" value="0" display="NUM. EIXOS" obrigatorio="1"></td>
                   </tr>
                   <tr>
                     <td>Cobrar Coleta/Entrega?</td>
                     <td><select name="FLAG_COLETA" tabindex="387" class="requerido_form" id="FLAG_COLETA" display="FRETE LOTAÇÃO" obrigatorio="1">
                       <option value="1">Sim</option>
                       <option selected="selected" value="0">Não</option>
                     </select></td>
                   </tr>
                 </tbody></table>
                 </fieldset>     </td>
               </tr>
               <tr style="display: none;">
                  <td class="texto" nowrap="">Natureza:</td>
                  <td colspan="3"><input name="NUM_NATUREZA" tabindex="388" class="requerido_form" id="NUM_NATUREZA" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_natureza_conhecimento()" type="text" display="NATUREZA" obrigatorio="1">
                              <input name="NATUREZA" tabindex="389" id="NATUREZA" style="width: 200px;" type="text" readonly="true" display="NATUREZA" obrigatorio="0">
                              <button tabindex="390" class="botao-16x16" onclick="if(this.form.NUM_NATUREZA.readOnly) { return; } NewWindow('/_consultas/localizar_natureza.cfm?num_natureza=NUM_NATUREZA&amp;natureza=NATUREZA','_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button>
                   <input name="FRETE_UNITARIO" tabindex="391" type="hidden" value="0.00" display="VALOR UNITARIO" obrigatorio="1">
                   <input name="COD_TABELA_FRETE" tabindex="392" id="COD_TABELA_FRETE" type="hidden" size="15" maxlength="15" value="" fixo="1"></td>
               </tr>
               
               <tr style="display: none;">
                  <td class="texto" nowrap="">Espécie:</td>
                  <td colspan="3"><input name="NUM_ESPECIE" tabindex="393" class="requerido_form" id="NUM_ESPECIE" style="width: 40px;" onkeypress="return f_formata(this,event,'000000')" onchange="f_busca_especie_conhecimento()" type="text" display="ESPECIE" obrigatorio="1">
                              <input name="ESPECIE" tabindex="394" class="requerido_form" id="ESPECIE" style="width: 200px;" type="text" readonly="true" display="ESPECIE" obrigatorio="1">
                              <button tabindex="395" class="botao-16x16" onclick="if(this.form.NUM_ESPECIE.readOnly) { return; }NewWindow('/_consultas/localizar_especie.cfm?num_ESPECIE=NUM_ESPECIE&amp;ESPECIE=ESPECIE','_blank',600,400,'yes')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button>
            
                    <span class="texto">
                    <input name="ADEME" tabindex="396" id="ADEME" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="DESCONTO" tabindex="397" id="DESCONTO" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="IMPOSTOS" tabindex="398" id="IMPOSTOS" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="DESPACHO_CALC" tabindex="399" id="DESPACHO_CALC" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="PEDAGIO_CALC" tabindex="400" id="PEDAGIO_CALC" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="SEC_CAT_CALC" tabindex="401" id="SEC_CAT_CALC" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="GRIS_CALC" tabindex="402" id="GRIS_CALC" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="COLETA_ENTREGA_CALC" tabindex="403" id="COLETA_ENTREGA_CALC" type="hidden" size="15" maxlength="15" value="0.00" fixo="1">
                    <input name="COD_TABELA_FRETE_RET" tabindex="404" id="COD_TABELA_FRETE_RET" type="hidden" size="15" maxlength="15" value="" fixo="1">   
                    </span></td>
               </tr>
               <tr>  
                 <td height="30" class="texto" nowrap="nowrap">Valor Mercadoria: </td>
                 <td height="30"><input name="VALOR_MERCADORIA" tabindex="405" id="VALOR_MERCADORIA" type="text" size="15" maxlength="15" readonly="true" value="0.0" fixo="1"></td>
                 <td height="30" class="texto" nowrap="nowrap">Quantidade:</td>
                 <td height="30"><input name="VOLUME" tabindex="406" id="VOLUME" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_calculos()" type="text" size="15" maxlength="10" value="0" fixo="1"></td>
              </tr>
               <tr>
                 <td height="30" class="texto" nowrap="">Peso: </td>
                 <td height="30" class="texto"><input name="PESO_KG" tabindex="407" id="PESO_KG" type="text" size="12" readonly="true"> Kg</td>
                 <td height="30" class="texto" nowrap="nowrap">M³:</td>
                 <td height="30"><input name="M3" tabindex="408" id="M3" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_calculos()" type="text" size="15" maxlength="15" value="0" fixo="1"></td>
              </tr>
               <tr>
                  <td height="32" class="texto" nowrap="">Peso Cobrado:</td>
                  <td height="32"><input name="PESO" tabindex="409" id="PESO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="f_calculos()" type="text" size="12" maxlength="15" value="0" fixo="1">
                    <select name="COD_UNIDADE" tabindex="410" id="COD_UNIDADE" onchange="f_calculos()">
                        <option value="Kg">Kilogramas</option>
                   </select></td>
                  <td height="32" class="texto" nowrap="nowrap">Valor Unitário: </td>
                  <td height="32" class="texto"><nobr><input name="FRETE_UNITARIO_DESC" tabindex="411" class="requerido_form" id="FRETE_UNITARIO_DESC" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value); f_altera_frete_valor()" type="text" size="15" maxlength="15" value="" fixo="1" display="VALOR UNITARIO" obrigatorio="1">
                    <select name="FRETE_EM" tabindex="412" id="FRETE_EM" onchange="f_calculos();f_frete_em(this.value)">
                      <option value="PESO">Peso (Tonelada)</option>
                      <option value="LOTACAO">Viagem</option>
                      <option value="M3">Volume (M3)</option>
                      <option value="VOLUME">Volume (Quantidade)</option>
                    </select></nobr></td>
               </tr>
               <tr>
                 <td height="32" class="texto" nowrap="nowrap">Frete Peso: </td>
                 <td height="32"><input name="FRETE_PESO" tabindex="413" id="FRETE_PESO" onkeypress="return f_formata_numero_decimal(this,event)" type="text" size="15" maxlength="15" readonly="" value="0.0" fixo="1"></td>
                 <td height="32" class="texto" nowrap="nowrap">Ad Valorem: </td>
                 <td height="32" class="texto"><input name="AD_VALOREM" tabindex="414" class="requerido_form" id="AD_VALOREM" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value);f_altera_frete_valor()" type="text" size="15" maxlength="15" value="0.0" fixo="1" display="AD VALOREM" obrigatorio="1">


                 /1000</td>
               </tr>
               <tr>
                 <td class="texto" nowrap="nowrap">Frete Valor: </td>
                 <td><input name="FRETE_VALOR" tabindex="415" id="FRETE_VALOR" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value);f_altera_frete_valor()" type="text" size="15" maxlength="15" readonly="" value="0.0" fixo="1"></td>
                 <td class="texto" nowrap="nowrap">SEC/CAT:</td>
                 <td><input name="SEC_CAT" tabindex="416" id="SEC_CAT" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value);this.form.SEC_CAT_CALC.value=this.value;f_altera_frete_valor()" type="text" size="15" maxlength="15" value="0.0" fixo="1"></td>
               </tr>
               <tr>
                 <td class="texto" nowrap="nowrap">Despacho:</td>
                 <td><input name="DESPACHO" tabindex="417" id="DESPACHO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.form.DESPACHO_CALC.value=this.value;f_calculos();this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" value="0.0" fixo="1"></td>
                 <td class="texto" nowrap="nowrap">Pedágio:</td>
                 <td><input name="PEDAGIO" tabindex="418" id="PEDAGIO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.form.PEDAGIO_CALC.value=this.value;f_calculos();this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" value="0.0" fixo="1"></td>
               </tr>
               <tr>
                 <td class="texto" nowrap="nowrap">Seguro:</td>
                 <td><input name="GRIS" tabindex="419" id="GRIS" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.form.GRIS_CALC.value=this.value;f_calculos();this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" value="0.0" fixo="1"></td>
                 <td class="texto" nowrap="nowrap">Outros:</td>
                 <td><input name="COLETA_ENTREGA" tabindex="420" id="COLETA_ENTREGA" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.form.COLETA_ENTREGA_CALC.value=this.value;f_calculos();this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" value="0.0" fixo="1"></td>
               </tr>
               <tr>
                 <td class="texto" nowrap="nowrap"><span id="sp_base_calc">Base Calc. ICMS</span>: </td>
                 <td><input name="BASE_CALCULO_ICMS" tabindex="421" id="BASE_CALCULO_ICMS" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" readonly="" value="0.0" fixo="1"></td>
                 <td class="texto" nowrap="nowrap">Alíquota:</td>
                 <td><input name="ALIQUOTA_ICMS" tabindex="422" id="ALIQUOTA_ICMS" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" readonly="" value="0.0" fixo="1"></td>
               </tr>
               <tr>
                 <td class="texto" nowrap="nowrap"><span id="sp_icms">ICMS</span>:</td>
                 <td><input name="VALOR_ICMS" tabindex="423" id="VALOR_ICMS" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" readonly="" value="0.0" fixo="1">
              &nbsp;</td>
                 <td class="texto" nowrap="nowrap">Total Frete: </td>
                 <td><input name="TOTAL_CONHECIMENTO" tabindex="424" id="TOTAL_CONHECIMENTO" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" readonly="" value="0.0" fixo="1">
            
                 <button tabindex="425" class="botao-16x16" onclick="f_calculos()" type="button"><img width="16" height="16" align="absmiddle" alt="Executar Cálculos" src="/_imagens/botoes/16x16/calculadora.gif"></button>
            	 </td>
               </tr>
               <tr id="tr_zerar_frete">
                 <td class="texto" nowrap="nowrap">Zerar total do frete? </td>
                 <td><select name="ZERAR_FRETE" tabindex="426" id="ZERAR_FRETE" onchange="f_calculos()" type="text" display="ZERAR TOTAL DO FRETE">
                     <option value="1">Sim</option>
                       <option selected="selected" value="0">Não</option>
                     </select> </td>
               </tr>
               <tr id="tr_icms_substit" style="display: none;">
                  <td class="texto" nowrap="">ICMS Subst.: </td>
                  <td><input name="VALOR_ICMS_SUBSTIT" tabindex="427" id="VALOR_ICMS_SUBSTIT" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" readonly=""></td>
                  <td colspan="2"><span class="info">O Valor do ICMS Substit. deve ser destacado na Obs. </span></td>
               </tr>
               <tr style="display: none;">
                 <td class="texto">Cobrar pela última entrega?</td>
                 <td class="texto" colspan="3"><select name="FRETE_ULT_ENTREGA" tabindex="428" class="requerido_form" id="FRETE_ULT_ENTREGA" onchange="document.getElementById('sp_frete_ult_entrega').style.display=(this.value==1?'':'none')" display="COBRAR PELA ÚLTIMA ENTREGA" obrigatorio="1">
                     <option value="1">Sim</option>
                     <option selected="selected" value="0">Não</option>
                   </select>
                     <span id="sp_frete_ult_entrega" style="display: none;"> &nbsp;Local:
                       <input name="MUNICIPIO_ULT_ENTREGA" tabindex="429" id="MUNICIPIO_ULT_ENTREGA" type="text" size="40" maxlength="40" readonly="true" obrigatorio="0">
                     <input name="MUNICIPIO_ULT_ENTREGA_UF" tabindex="430" id="MUNICIPIO_ULT_ENTREGA_UF" type="text" size="4" maxlength="2" readonly="true" obrigatorio="0">
                     <button tabindex="431" class="botao-16x16" onclick="f_busca_cidade('MUNICIPIO_ULT_ENTREGA')" type="button"><img width="16" height="16" align="absmiddle" alt="" src="/_imagens/botoes/16x16/buscar.gif"></button>
                       <input name="MUNICIPIO_ULT_ENTREGA_ID" tabindex="432" id="MUNICIPIO_ULT_ENTREGA_ID" type="hidden" value="">
                     </span></td>
               </tr>
               <tr>
                 <td class="texto" id="td_tabela" nowrap="" colspan="4">Tabela:</td>
               </tr>
            </tbody></table>
		</td>
	</tr>
</tbody></table>

                                </fieldset>
                            </td>
               </tr>

               <tr style="display: none;">
                        	<td class="td_aba_corpo" valign="top" colspan="10">
                                <fieldset tabindex="433" id="fds_impostos" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	<script>
	function f_carregando_impostos(){
		f_cria_carregando_ajax();
	}
</script>

<input name="IMPOSTO_TIPO_ID" tabindex="434" id="IMPOSTO_TIPO_ID" type="hidden" value="">
<input name="DESCRICAO" tabindex="435" id="DESCRICAO" type="hidden" value="">
<input name="IMP_TIPO_DESC" tabindex="436" id="IMP_TIPO_DESC" type="hidden" value="">
<input name="ALIQUOTA" tabindex="437" id="ALIQUOTA" type="hidden" value="">
<input name="ALIQUOTA_FORMAT" tabindex="438" id="ALIQUOTA_FORMAT" type="hidden" value="">
<input name="REDUCAO_BASE" tabindex="439" id="REDUCAO_BASE" type="hidden" value="">
<input name="REDUCAO_BASE_FORMAT" tabindex="440" id="REDUCAO_BASE_FORMAT" type="hidden" value="">
<input name="BASE_CALCULO" tabindex="441" id="BASE_CALCULO" type="hidden" value="">
<input name="BASE_CALCULO_FORMAT" tabindex="442" id="BASE_CALCULO_FORMAT" type="hidden" value="">
<input name="IMPOSTO_TOTAL" tabindex="443" id="IMPOSTO_TOTAL" type="hidden" value="">
<input name="IMPOSTO_TOTAL_FORMAT" tabindex="444" id="IMPOSTO_TOTAL_FORMAT" type="hidden" value="">
<input name="IMPOSTO_SITUACAO_ID" tabindex="445" id="IMPOSTO_SITUACAO_ID" type="hidden" value="">
<input name="IMPOSTO_SITUACAO_TRIB_TIPO_ID" tabindex="446" id="IMPOSTO_SITUACAO_TRIB_TIPO_ID" type="hidden" value="">
<input name="RETIDO_FONTE" tabindex="447" id="RETIDO_FONTE" type="hidden" value="">
<input name="RETIDO_FONTE_DESC" tabindex="448" id="RETIDO_FONTE_DESC" type="hidden" value="">
<input name="IMPOSTO_COD_RETENCAO_ID" tabindex="449" id="IMPOSTO_COD_RETENCAO_ID" type="hidden" value="">
<input name="REGIME_CUMULATIVO" tabindex="450" id="REGIME_CUMULATIVO" type="hidden" value="">
<input name="REGIME_CUMULATIVO_DESC" tabindex="451" id="REGIME_CUMULATIVO_DESC" type="hidden" value="">
<input name="IMPOSTO_ORIGEM_ID" tabindex="452" id="IMPOSTO_ORIGEM_ID" type="hidden" value="">
<input name="IMPOSTO_NATUREZA_BC_ID" tabindex="453" id="IMPOSTO_NATUREZA_BC_ID" type="hidden" value="">
<input name="IMP_FUNDAMENTACAO_LEGAL" tabindex="454" id="IMP_FUNDAMENTACAO_LEGAL" type="hidden" value="">
<input name="RESERVADO_FISCO" tabindex="455" id="RESERVADO_FISCO" type="hidden" value="">
<input name="PRODUTO_DESCRICAO" tabindex="456" id="PRODUTO_DESCRICAO" type="hidden" value="">
<input name="IMP_COD_SITUACAO" tabindex="457" id="IMP_COD_SITUACAO" type="hidden" value="">
<input name="IND_ORIG_CRED" tabindex="458" id="IND_ORIG_CRED" type="hidden" value="">
<input name="NAT_BC_CRED" tabindex="459" id="NAT_BC_CRED" type="hidden" value="">
<input name="COD_RETENCAO" tabindex="460" id="COD_RETENCAO" type="hidden" value="">
<input name="BASE_CALCULO_REDUZIDA" tabindex="461" id="BASE_CALCULO_REDUZIDA" type="hidden" value="">
<input name="BASE_CALCULO_REDUZIDA_FORMAT" tabindex="462" id="BASE_CALCULO_REDUZIDA_FORMAT" type="hidden" value="">
<input name="GERA_CPG_ICMS_ANTECIPADO" tabindex="463" id="GERA_CPG_ICMS_ANTECIPADO" type="hidden" value="">
<input name="IMPOSTO_CONFIG_ID" tabindex="464" id="IMPOSTO_CONFIG_ID" type="hidden" value="">
<span class="obrigatorio" id="spam_imposto_info" style="padding: 5px; display: none;">Os impostos do conhecimentos serão carregados com a tabela frete.</span>
<table id="tb_impostos" style="width: 800px !important;" border="0" cellspacing="3" cellpadding="1">
	<tbody><tr>
      	<td class="texto" colspan="2">
		</td>
	</tr>
    <tr>
        <td width="90%" style="padding-top: 5px;">
            <table width="90%" border="0" cellspacing="3" cellpadding="1">
                <tbody><tr>
                    <td>
						
<script src="/_scripts/tablesort.js"></script>
<script language="javascript1.2">
var DOUBLE_QUOTES = new RegExp( '"([^"]*)"', 'g' );


function f_ordenar_IMPOSTOS(campo, desc, tipo) {
//	try {
		if(!tipo) 
			tipo = 'caseinsensitivestring';
		v_tb = document.getElementById('tb_lista_IMPOSTOS');
		v_rows2 = new Array();
		for(var i=0;i<v_tb.rows.length;i++) 
			v_rows2.push(v_tb.rows[i]);
		v_rows2.sort(function(a,b) {
				v_id_a = a.id.replace('tr_lista_IMPOSTOS_','');
				v_id_b = b.id.replace('tr_lista_IMPOSTOS_','');
				if(tipo == 'number') {
					if( Number(document.getElementById(campo+'_IMPOSTOS_'+v_id_a).value) < Number(document.getElementById(campo+'_IMPOSTOS_'+v_id_b).value)) 
						return desc ? +1 : -1;
					if( Number(document.getElementById(campo+'_IMPOSTOS_'+v_id_a).value) > Number(document.getElementById(campo+'_IMPOSTOS_'+v_id_b).value)) 
						return desc ? -1 : +1;
				} else if(tipo == 'caseinsensitivestring') {
					if(document.getElementById(campo+'_IMPOSTOS_'+v_id_a).value < document.getElementById(campo+'_IMPOSTOS_'+v_id_b).value) 
						return desc ? +1 : -1;
					if(document.getElementById(campo+'_IMPOSTOS_'+v_id_a).value > document.getElementById(campo+'_IMPOSTOS_'+v_id_b).value) 
						return desc ? -1 : +1;
				}
				return 0;
			});
		for(var i=0;i<v_rows2.length;i++) {
			v_tb.appendChild(v_rows2[i]);
		}
//	} catch(e) {}
}

function f_incluir_IMPOSTOS() {
	with(document.forms[0]) {
		
		f_cancelar_IMPOSTOS();
	}
}

function f_excluir_IMPOSTOS(v_nro, v_nao_mostra_confirmar) {
	if(v_nro == -1) {
		return;
	}
	if(!v_nao_mostra_confirmar) {
		if(!confirm('Clique OK para confirmar a exclusão do registro!')) {
			return;
		}
	}
	with (document.forms[0]) {
		
			lista_deleted_IMPOSTOS.value = lista_deleted_IMPOSTOS.value+','+document.getElementById('IMPOSTO_TIPO_ID_IMPOSTOS_'+v_nro).value;
		
	}
	var tbody = document.getElementById('tb_lista_IMPOSTOS');		
	for(var i=0;i<tbody.rows.length;i++) {
		if(tbody.rows[i].id == 'tr_lista_IMPOSTOS_'+v_nro) {
			tbody.deleteRow(i);
			f_cancelar_IMPOSTOS();
			break;
		}
	}
		
	
	f_cancelar_IMPOSTOS();
	f_on_salva_lista_IMPOSTOS();
	f_on_excluir_IMPOSTOS();
}
function f_limpar_IMPOSTOS() {
	var tbody = document.getElementById('tb_lista_IMPOSTOS');	
	while (tbody.rows.length > 0) {
		tbody.deleteRow(0);
	}
		
	
	document.forms[0].lista_selected_IMPOSTOS.value = -1;
}
var lista_count_IMPOSTOS = 0;


function f_testa_existencia_IMPOSTOS(chave, linha_atual, selectable) {
	var listagem = f_listagem_IMPOSTOS();
	for(var i=0;i<listagem.length;i++) {
		var items = chave.split('|');
		var igual = true;
		for(var j=0;j<items.length;j++) {
			if(eval('listagem['+i+'].'+items[j]) != eval('document.forms[0].'+items[j]+'.value') || listagem[i].id == linha_atual) {
					igual = false;
			}
		}
		if (igual) {
			return true;
		}
	}
}
function f_salvar_IMPOSTOS() {
	
	if (!f_before_salvar_IMPOSTOS()) {
	   return;
	}	
	if(f_verifica_form(document.forms[0], 'IMPOSTOS'))	{
		var padrao = true;
		var tbody = document.getElementById('tb_lista_IMPOSTOS');
		for(var i=0;i<tbody.rows.length;i++) {
			var row_id = tbody.rows[i].id.replace('tr_lista_IMPOSTOS_', '');
			if(document.getElementById('lista_padrao_IMPOSTOS_'+row_id).style.display == '') {
				padrao = false;
			}
		}
		with(document.forms[0]) {
			
			if(lista_selected_IMPOSTOS.value == -1) {
				var v_tr = document.createElement('TR');
				v_tr.id = 'tr_lista_IMPOSTOS_'+lista_count_IMPOSTOS;
				var temp_count = lista_count_IMPOSTOS;
				v_tr.style.cursor = 'pointer';
				v_tr.onclick = function() {
					f_seleciona_IMPOSTOS(temp_count);
				}
				var v_td = document.createElement('TD');
				var v_dv1 = document.createElement('div');
				v_td.appendChild(v_dv1);
				v_td.className = 'linha_1';
				lista_inputs = '<input type="hidden" name="PADRAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="PADRAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((padrao)?1:0)+'">';
				
				if (IMPOSTO_TIPO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_TIPO_ID.checked)?"1":"0")+'">';
				} else if (IMPOSTO_TIPO_ID.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_TIPO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_TIPO_ID';
					v_file_input.id = 'IMPOSTO_TIPO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_TIPO_ID.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMP_TIPO_DESC.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMP_TIPO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMP_TIPO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMP_TIPO_DESC.checked)?"1":"0")+'">';
				} else if (IMP_TIPO_DESC.type == 'file') {
					v_campo_file = document.forms[0].IMP_TIPO_DESC;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMP_TIPO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMP_TIPO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMP_TIPO_DESC';
					v_file_input.id = 'IMP_TIPO_DESC';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMP_TIPO_DESC.value;
				
					lista_inputs += '<input type="hidden" name="IMP_TIPO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMP_TIPO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DESCRICAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((DESCRICAO.checked)?"1":"0")+'">';
				} else if (DESCRICAO.type == 'file') {
					v_campo_file = document.forms[0].DESCRICAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'DESCRICAO';
					v_file_input.id = 'DESCRICAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DESCRICAO.value;
				
					lista_inputs += '<input type="hidden" name="DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (ALIQUOTA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ALIQUOTA_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="ALIQUOTA_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((ALIQUOTA.checked)?"1":"0")+'">';
				} else if (ALIQUOTA.type == 'file') {
					v_campo_file = document.forms[0].ALIQUOTA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'ALIQUOTA_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'ALIQUOTA_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'ALIQUOTA';
					v_file_input.id = 'ALIQUOTA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = ALIQUOTA.value;
				
					lista_inputs += '<input type="hidden" name="ALIQUOTA_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="ALIQUOTA_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (ALIQUOTA_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ALIQUOTA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="ALIQUOTA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((ALIQUOTA_FORMAT.checked)?"1":"0")+'">';
				} else if (ALIQUOTA_FORMAT.type == 'file') {
					v_campo_file = document.forms[0].ALIQUOTA_FORMAT;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'ALIQUOTA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'ALIQUOTA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'ALIQUOTA_FORMAT';
					v_file_input.id = 'ALIQUOTA_FORMAT';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = ALIQUOTA_FORMAT.value;
				
					lista_inputs += '<input type="hidden" name="ALIQUOTA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="ALIQUOTA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (REDUCAO_BASE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REDUCAO_BASE_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((REDUCAO_BASE.checked)?"1":"0")+'">';
				} else if (REDUCAO_BASE.type == 'file') {
					v_campo_file = document.forms[0].REDUCAO_BASE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'REDUCAO_BASE_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'REDUCAO_BASE_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'REDUCAO_BASE';
					v_file_input.id = 'REDUCAO_BASE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = REDUCAO_BASE.value;
				
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REDUCAO_BASE_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (REDUCAO_BASE_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((REDUCAO_BASE_FORMAT.checked)?"1":"0")+'">';
				} else if (REDUCAO_BASE_FORMAT.type == 'file') {
					v_campo_file = document.forms[0].REDUCAO_BASE_FORMAT;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'REDUCAO_BASE_FORMAT';
					v_file_input.id = 'REDUCAO_BASE_FORMAT';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = REDUCAO_BASE_FORMAT.value;
				
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (BASE_CALCULO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((BASE_CALCULO.checked)?"1":"0")+'">';
				} else if (BASE_CALCULO.type == 'file') {
					v_campo_file = document.forms[0].BASE_CALCULO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'BASE_CALCULO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'BASE_CALCULO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'BASE_CALCULO';
					v_file_input.id = 'BASE_CALCULO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = BASE_CALCULO.value;
				
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (BASE_CALCULO_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((BASE_CALCULO_FORMAT.checked)?"1":"0")+'">';
				} else if (BASE_CALCULO_FORMAT.type == 'file') {
					v_campo_file = document.forms[0].BASE_CALCULO_FORMAT;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'BASE_CALCULO_FORMAT';
					v_file_input.id = 'BASE_CALCULO_FORMAT';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = BASE_CALCULO_FORMAT.value;
				
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (BASE_CALCULO_REDUZIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((BASE_CALCULO_REDUZIDA.checked)?"1":"0")+'">';
				} else if (BASE_CALCULO_REDUZIDA.type == 'file') {
					v_campo_file = document.forms[0].BASE_CALCULO_REDUZIDA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'BASE_CALCULO_REDUZIDA';
					v_file_input.id = 'BASE_CALCULO_REDUZIDA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = BASE_CALCULO_REDUZIDA.value;
				
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (BASE_CALCULO_REDUZIDA_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((BASE_CALCULO_REDUZIDA_FORMAT.checked)?"1":"0")+'">';
				} else if (BASE_CALCULO_REDUZIDA_FORMAT.type == 'file') {
					v_campo_file = document.forms[0].BASE_CALCULO_REDUZIDA_FORMAT;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'BASE_CALCULO_REDUZIDA_FORMAT';
					v_file_input.id = 'BASE_CALCULO_REDUZIDA_FORMAT';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = BASE_CALCULO_REDUZIDA_FORMAT.value;
				
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_TOTAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_TOTAL_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_TOTAL.checked)?"1":"0")+'">';
				} else if (IMPOSTO_TOTAL.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_TOTAL;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_TOTAL_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_TOTAL_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_TOTAL';
					v_file_input.id = 'IMPOSTO_TOTAL';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_TOTAL.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_TOTAL_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_SITUACAO_TRIB_TIPO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_SITUACAO_TRIB_TIPO_ID.checked)?"1":"0")+'">';
				} else if (IMPOSTO_SITUACAO_TRIB_TIPO_ID.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_SITUACAO_TRIB_TIPO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_SITUACAO_TRIB_TIPO_ID';
					v_file_input.id = 'IMPOSTO_SITUACAO_TRIB_TIPO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_SITUACAO_TRIB_TIPO_ID.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMP_COD_SITUACAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMP_COD_SITUACAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMP_COD_SITUACAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMP_COD_SITUACAO.checked)?"1":"0")+'">';
				} else if (IMP_COD_SITUACAO.type == 'file') {
					v_campo_file = document.forms[0].IMP_COD_SITUACAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMP_COD_SITUACAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMP_COD_SITUACAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMP_COD_SITUACAO';
					v_file_input.id = 'IMP_COD_SITUACAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMP_COD_SITUACAO.value;
				
					lista_inputs += '<input type="hidden" name="IMP_COD_SITUACAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMP_COD_SITUACAO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (RETIDO_FONTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="RETIDO_FONTE_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((RETIDO_FONTE.checked)?"1":"0")+'">';
				} else if (RETIDO_FONTE.type == 'file') {
					v_campo_file = document.forms[0].RETIDO_FONTE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'RETIDO_FONTE_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'RETIDO_FONTE_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'RETIDO_FONTE';
					v_file_input.id = 'RETIDO_FONTE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = RETIDO_FONTE.value;
				
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="RETIDO_FONTE_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (RETIDO_FONTE_DESC.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="RETIDO_FONTE_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((RETIDO_FONTE_DESC.checked)?"1":"0")+'">';
				} else if (RETIDO_FONTE_DESC.type == 'file') {
					v_campo_file = document.forms[0].RETIDO_FONTE_DESC;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'RETIDO_FONTE_DESC_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'RETIDO_FONTE_DESC_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'RETIDO_FONTE_DESC';
					v_file_input.id = 'RETIDO_FONTE_DESC';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = RETIDO_FONTE_DESC.value;
				
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="RETIDO_FONTE_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_COD_RETENCAO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_COD_RETENCAO_ID.checked)?"1":"0")+'">';
				} else if (IMPOSTO_COD_RETENCAO_ID.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_COD_RETENCAO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_COD_RETENCAO_ID';
					v_file_input.id = 'IMPOSTO_COD_RETENCAO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_COD_RETENCAO_ID.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (COD_RETENCAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="COD_RETENCAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="COD_RETENCAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((COD_RETENCAO.checked)?"1":"0")+'">';
				} else if (COD_RETENCAO.type == 'file') {
					v_campo_file = document.forms[0].COD_RETENCAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'COD_RETENCAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'COD_RETENCAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'COD_RETENCAO';
					v_file_input.id = 'COD_RETENCAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = COD_RETENCAO.value;
				
					lista_inputs += '<input type="hidden" name="COD_RETENCAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="COD_RETENCAO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (REGIME_CUMULATIVO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REGIME_CUMULATIVO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((REGIME_CUMULATIVO.checked)?"1":"0")+'">';
				} else if (REGIME_CUMULATIVO.type == 'file') {
					v_campo_file = document.forms[0].REGIME_CUMULATIVO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'REGIME_CUMULATIVO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'REGIME_CUMULATIVO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'REGIME_CUMULATIVO';
					v_file_input.id = 'REGIME_CUMULATIVO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = REGIME_CUMULATIVO.value;
				
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REGIME_CUMULATIVO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (REGIME_CUMULATIVO_DESC.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((REGIME_CUMULATIVO_DESC.checked)?"1":"0")+'">';
				} else if (REGIME_CUMULATIVO_DESC.type == 'file') {
					v_campo_file = document.forms[0].REGIME_CUMULATIVO_DESC;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'REGIME_CUMULATIVO_DESC';
					v_file_input.id = 'REGIME_CUMULATIVO_DESC';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = REGIME_CUMULATIVO_DESC.value;
				
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_TOTAL_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_TOTAL_FORMAT.checked)?"1":"0")+'">';
				} else if (IMPOSTO_TOTAL_FORMAT.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_TOTAL_FORMAT;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_TOTAL_FORMAT';
					v_file_input.id = 'IMPOSTO_TOTAL_FORMAT';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_TOTAL_FORMAT.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_ORIGEM_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_ORIGEM_ID.checked)?"1":"0")+'">';
				} else if (IMPOSTO_ORIGEM_ID.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_ORIGEM_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_ORIGEM_ID';
					v_file_input.id = 'IMPOSTO_ORIGEM_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_ORIGEM_ID.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IND_ORIG_CRED.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IND_ORIG_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IND_ORIG_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IND_ORIG_CRED.checked)?"1":"0")+'">';
				} else if (IND_ORIG_CRED.type == 'file') {
					v_campo_file = document.forms[0].IND_ORIG_CRED;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IND_ORIG_CRED_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IND_ORIG_CRED_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IND_ORIG_CRED';
					v_file_input.id = 'IND_ORIG_CRED';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IND_ORIG_CRED.value;
				
					lista_inputs += '<input type="hidden" name="IND_ORIG_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IND_ORIG_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NAT_BC_CRED.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NAT_BC_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="NAT_BC_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((NAT_BC_CRED.checked)?"1":"0")+'">';
				} else if (NAT_BC_CRED.type == 'file') {
					v_campo_file = document.forms[0].NAT_BC_CRED;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NAT_BC_CRED_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'NAT_BC_CRED_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'NAT_BC_CRED';
					v_file_input.id = 'NAT_BC_CRED';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NAT_BC_CRED.value;
				
					lista_inputs += '<input type="hidden" name="NAT_BC_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="NAT_BC_CRED_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_NATUREZA_BC_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_NATUREZA_BC_ID.checked)?"1":"0")+'">';
				} else if (IMPOSTO_NATUREZA_BC_ID.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_NATUREZA_BC_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_NATUREZA_BC_ID';
					v_file_input.id = 'IMPOSTO_NATUREZA_BC_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_NATUREZA_BC_ID.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMP_FUNDAMENTACAO_LEGAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMP_FUNDAMENTACAO_LEGAL.checked)?"1":"0")+'">';
				} else if (IMP_FUNDAMENTACAO_LEGAL.type == 'file') {
					v_campo_file = document.forms[0].IMP_FUNDAMENTACAO_LEGAL;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMP_FUNDAMENTACAO_LEGAL';
					v_file_input.id = 'IMP_FUNDAMENTACAO_LEGAL';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMP_FUNDAMENTACAO_LEGAL.value;
				
					lista_inputs += '<input type="hidden" name="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (RESERVADO_FISCO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="RESERVADO_FISCO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="RESERVADO_FISCO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((RESERVADO_FISCO.checked)?"1":"0")+'">';
				} else if (RESERVADO_FISCO.type == 'file') {
					v_campo_file = document.forms[0].RESERVADO_FISCO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'RESERVADO_FISCO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'RESERVADO_FISCO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'RESERVADO_FISCO';
					v_file_input.id = 'RESERVADO_FISCO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = RESERVADO_FISCO.value;
				
					lista_inputs += '<input type="hidden" name="RESERVADO_FISCO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="RESERVADO_FISCO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (PRODUTO_DESCRICAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="PRODUTO_DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="PRODUTO_DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((PRODUTO_DESCRICAO.checked)?"1":"0")+'">';
				} else if (PRODUTO_DESCRICAO.type == 'file') {
					v_campo_file = document.forms[0].PRODUTO_DESCRICAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'PRODUTO_DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'PRODUTO_DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'PRODUTO_DESCRICAO';
					v_file_input.id = 'PRODUTO_DESCRICAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = PRODUTO_DESCRICAO.value;
				
					lista_inputs += '<input type="hidden" name="PRODUTO_DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="PRODUTO_DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_SITUACAO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_SITUACAO_ID.checked)?"1":"0")+'">';
				} else if (IMPOSTO_SITUACAO_ID.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_SITUACAO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_SITUACAO_ID';
					v_file_input.id = 'IMPOSTO_SITUACAO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_SITUACAO_ID.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (GERA_CPG_ICMS_ANTECIPADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((GERA_CPG_ICMS_ANTECIPADO.checked)?"1":"0")+'">';
				} else if (GERA_CPG_ICMS_ANTECIPADO.type == 'file') {
					v_campo_file = document.forms[0].GERA_CPG_ICMS_ANTECIPADO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'GERA_CPG_ICMS_ANTECIPADO';
					v_file_input.id = 'GERA_CPG_ICMS_ANTECIPADO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = GERA_CPG_ICMS_ANTECIPADO.value;
				
					lista_inputs += '<input type="hidden" name="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				if (IMPOSTO_CONFIG_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" value="'+((IMPOSTO_CONFIG_ID.checked)?"1":"0")+'">';
				} else if (IMPOSTO_CONFIG_ID.type == 'file') {
					v_campo_file = document.forms[0].IMPOSTO_CONFIG_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_campo_file.name = 'IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_count_IMPOSTOS;
					v_file_input.name = 'IMPOSTO_CONFIG_ID';
					v_file_input.id = 'IMPOSTO_CONFIG_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = IMPOSTO_CONFIG_ID.value;
				
					lista_inputs += '<input type="hidden" name="IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'" id="IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_count_IMPOSTOS+'">';
				}
//				v_td.appendChild(v_input)
				
				v_dv1.innerHTML = '<img id="lista_padrao_IMPOSTOS_'+lista_count_IMPOSTOS+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				v_td.width = 16;
				
				v_td.style.display = 'none';
				
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+IMP_TIPO_DESC.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+PRODUTO_DESCRICAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+DESCRICAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+ALIQUOTA_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+REDUCAO_BASE_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+BASE_CALCULO_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+BASE_CALCULO_REDUZIDA_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+IMPOSTO_TOTAL_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+REGIME_CUMULATIVO_DESC.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+RETIDO_FONTE_DESC.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+COD_RETENCAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+IMP_COD_SITUACAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+IND_ORIG_CRED.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+NAT_BC_CRED.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+IMP_FUNDAMENTACAO_LEGAL.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				tbody.appendChild(v_tr);
				
				if (IMPOSTO_TIPO_ID.type != 'checkbox' && IMPOSTO_TIPO_ID.type != 'file') {
					document.getElementById('IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_TIPO_ID.value;
				}
				
				if (IMP_TIPO_DESC.type != 'checkbox' && IMP_TIPO_DESC.type != 'file') {
					document.getElementById('IMP_TIPO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMP_TIPO_DESC.value;
				}
				
				if (DESCRICAO.type != 'checkbox' && DESCRICAO.type != 'file') {
					document.getElementById('DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS).value = DESCRICAO.value;
				}
				
				if (ALIQUOTA.type != 'checkbox' && ALIQUOTA.type != 'file') {
					document.getElementById('ALIQUOTA_IMPOSTOS_'+lista_count_IMPOSTOS).value = ALIQUOTA.value;
				}
				
				if (ALIQUOTA_FORMAT.type != 'checkbox' && ALIQUOTA_FORMAT.type != 'file') {
					document.getElementById('ALIQUOTA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS).value = ALIQUOTA_FORMAT.value;
				}
				
				if (REDUCAO_BASE.type != 'checkbox' && REDUCAO_BASE.type != 'file') {
					document.getElementById('REDUCAO_BASE_IMPOSTOS_'+lista_count_IMPOSTOS).value = REDUCAO_BASE.value;
				}
				
				if (REDUCAO_BASE_FORMAT.type != 'checkbox' && REDUCAO_BASE_FORMAT.type != 'file') {
					document.getElementById('REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS).value = REDUCAO_BASE_FORMAT.value;
				}
				
				if (BASE_CALCULO.type != 'checkbox' && BASE_CALCULO.type != 'file') {
					document.getElementById('BASE_CALCULO_IMPOSTOS_'+lista_count_IMPOSTOS).value = BASE_CALCULO.value;
				}
				
				if (BASE_CALCULO_FORMAT.type != 'checkbox' && BASE_CALCULO_FORMAT.type != 'file') {
					document.getElementById('BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS).value = BASE_CALCULO_FORMAT.value;
				}
				
				if (BASE_CALCULO_REDUZIDA.type != 'checkbox' && BASE_CALCULO_REDUZIDA.type != 'file') {
					document.getElementById('BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_count_IMPOSTOS).value = BASE_CALCULO_REDUZIDA.value;
				}
				
				if (BASE_CALCULO_REDUZIDA_FORMAT.type != 'checkbox' && BASE_CALCULO_REDUZIDA_FORMAT.type != 'file') {
					document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS).value = BASE_CALCULO_REDUZIDA_FORMAT.value;
				}
				
				if (IMPOSTO_TOTAL.type != 'checkbox' && IMPOSTO_TOTAL.type != 'file') {
					document.getElementById('IMPOSTO_TOTAL_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_TOTAL.value;
				}
				
				if (IMPOSTO_SITUACAO_TRIB_TIPO_ID.type != 'checkbox' && IMPOSTO_SITUACAO_TRIB_TIPO_ID.type != 'file') {
					document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_SITUACAO_TRIB_TIPO_ID.value;
				}
				
				if (IMP_COD_SITUACAO.type != 'checkbox' && IMP_COD_SITUACAO.type != 'file') {
					document.getElementById('IMP_COD_SITUACAO_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMP_COD_SITUACAO.value;
				}
				
				if (RETIDO_FONTE.type != 'checkbox' && RETIDO_FONTE.type != 'file') {
					document.getElementById('RETIDO_FONTE_IMPOSTOS_'+lista_count_IMPOSTOS).value = RETIDO_FONTE.value;
				}
				
				if (RETIDO_FONTE_DESC.type != 'checkbox' && RETIDO_FONTE_DESC.type != 'file') {
					document.getElementById('RETIDO_FONTE_DESC_IMPOSTOS_'+lista_count_IMPOSTOS).value = RETIDO_FONTE_DESC.value;
				}
				
				if (IMPOSTO_COD_RETENCAO_ID.type != 'checkbox' && IMPOSTO_COD_RETENCAO_ID.type != 'file') {
					document.getElementById('IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_COD_RETENCAO_ID.value;
				}
				
				if (COD_RETENCAO.type != 'checkbox' && COD_RETENCAO.type != 'file') {
					document.getElementById('COD_RETENCAO_IMPOSTOS_'+lista_count_IMPOSTOS).value = COD_RETENCAO.value;
				}
				
				if (REGIME_CUMULATIVO.type != 'checkbox' && REGIME_CUMULATIVO.type != 'file') {
					document.getElementById('REGIME_CUMULATIVO_IMPOSTOS_'+lista_count_IMPOSTOS).value = REGIME_CUMULATIVO.value;
				}
				
				if (REGIME_CUMULATIVO_DESC.type != 'checkbox' && REGIME_CUMULATIVO_DESC.type != 'file') {
					document.getElementById('REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_count_IMPOSTOS).value = REGIME_CUMULATIVO_DESC.value;
				}
				
				if (IMPOSTO_TOTAL_FORMAT.type != 'checkbox' && IMPOSTO_TOTAL_FORMAT.type != 'file') {
					document.getElementById('IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_TOTAL_FORMAT.value;
				}
				
				if (IMPOSTO_ORIGEM_ID.type != 'checkbox' && IMPOSTO_ORIGEM_ID.type != 'file') {
					document.getElementById('IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_ORIGEM_ID.value;
				}
				
				if (IND_ORIG_CRED.type != 'checkbox' && IND_ORIG_CRED.type != 'file') {
					document.getElementById('IND_ORIG_CRED_IMPOSTOS_'+lista_count_IMPOSTOS).value = IND_ORIG_CRED.value;
				}
				
				if (NAT_BC_CRED.type != 'checkbox' && NAT_BC_CRED.type != 'file') {
					document.getElementById('NAT_BC_CRED_IMPOSTOS_'+lista_count_IMPOSTOS).value = NAT_BC_CRED.value;
				}
				
				if (IMPOSTO_NATUREZA_BC_ID.type != 'checkbox' && IMPOSTO_NATUREZA_BC_ID.type != 'file') {
					document.getElementById('IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_NATUREZA_BC_ID.value;
				}
				
				if (IMP_FUNDAMENTACAO_LEGAL.type != 'checkbox' && IMP_FUNDAMENTACAO_LEGAL.type != 'file') {
					document.getElementById('IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMP_FUNDAMENTACAO_LEGAL.value;
				}
				
				if (RESERVADO_FISCO.type != 'checkbox' && RESERVADO_FISCO.type != 'file') {
					document.getElementById('RESERVADO_FISCO_IMPOSTOS_'+lista_count_IMPOSTOS).value = RESERVADO_FISCO.value;
				}
				
				if (PRODUTO_DESCRICAO.type != 'checkbox' && PRODUTO_DESCRICAO.type != 'file') {
					document.getElementById('PRODUTO_DESCRICAO_IMPOSTOS_'+lista_count_IMPOSTOS).value = PRODUTO_DESCRICAO.value;
				}
				
				if (IMPOSTO_SITUACAO_ID.type != 'checkbox' && IMPOSTO_SITUACAO_ID.type != 'file') {
					document.getElementById('IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_SITUACAO_ID.value;
				}
				
				if (GERA_CPG_ICMS_ANTECIPADO.type != 'checkbox' && GERA_CPG_ICMS_ANTECIPADO.type != 'file') {
					document.getElementById('GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_count_IMPOSTOS).value = GERA_CPG_ICMS_ANTECIPADO.value;
				}
				
				if (IMPOSTO_CONFIG_ID.type != 'checkbox' && IMPOSTO_CONFIG_ID.type != 'file') {
					document.getElementById('IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_count_IMPOSTOS).value = IMPOSTO_CONFIG_ID.value;
				}
				

				lista_count_IMPOSTOS++;
				f_atualiza_campos_escravos_IMPOSTOS();
				f_incluir_IMPOSTOS();
			} else {
				var v_tr = document.getElementById('tr_lista_IMPOSTOS_'+lista_selected_IMPOSTOS.value);
				padrao = (document.getElementById('PADRAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value == 1);
				lista_inputs = '<input type="hidden" name="PADRAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((padrao)?1:0)+'">';
				
				if (IMPOSTO_TIPO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_TIPO_ID.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_TIPO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_TIPO_ID.value+'">';
					document.getElementById('IMPOSTO_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_TIPO_ID.value;
				}
				
				if (IMP_TIPO_DESC.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMP_TIPO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMP_TIPO_DESC.checked)?"1":"0")+'">';
					document.getElementById('IMP_TIPO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMP_TIPO_DESC.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMP_TIPO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMP_TIPO_DESC.value+'">';
					document.getElementById('IMP_TIPO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMP_TIPO_DESC.value;
				}
				
				if (DESCRICAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((DESCRICAO.checked)?"1":"0")+'">';
					document.getElementById('DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((DESCRICAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+DESCRICAO.value+'">';
					document.getElementById('DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = DESCRICAO.value;
				}
				
				if (ALIQUOTA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ALIQUOTA_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((ALIQUOTA.checked)?"1":"0")+'">';
					document.getElementById('ALIQUOTA_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((ALIQUOTA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="ALIQUOTA_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+ALIQUOTA.value+'">';
					document.getElementById('ALIQUOTA_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ALIQUOTA.value;
				}
				
				if (ALIQUOTA_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ALIQUOTA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((ALIQUOTA_FORMAT.checked)?"1":"0")+'">';
					document.getElementById('ALIQUOTA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((ALIQUOTA_FORMAT.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="ALIQUOTA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+ALIQUOTA_FORMAT.value+'">';
					document.getElementById('ALIQUOTA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ALIQUOTA_FORMAT.value;
				}
				
				if (REDUCAO_BASE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((REDUCAO_BASE.checked)?"1":"0")+'">';
					document.getElementById('REDUCAO_BASE_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((REDUCAO_BASE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+REDUCAO_BASE.value+'">';
					document.getElementById('REDUCAO_BASE_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = REDUCAO_BASE.value;
				}
				
				if (REDUCAO_BASE_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((REDUCAO_BASE_FORMAT.checked)?"1":"0")+'">';
					document.getElementById('REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((REDUCAO_BASE_FORMAT.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+REDUCAO_BASE_FORMAT.value+'">';
					document.getElementById('REDUCAO_BASE_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = REDUCAO_BASE_FORMAT.value;
				}
				
				if (BASE_CALCULO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((BASE_CALCULO.checked)?"1":"0")+'">';
					document.getElementById('BASE_CALCULO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((BASE_CALCULO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+BASE_CALCULO.value+'">';
					document.getElementById('BASE_CALCULO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = BASE_CALCULO.value;
				}
				
				if (BASE_CALCULO_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((BASE_CALCULO_FORMAT.checked)?"1":"0")+'">';
					document.getElementById('BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((BASE_CALCULO_FORMAT.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+BASE_CALCULO_FORMAT.value+'">';
					document.getElementById('BASE_CALCULO_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = BASE_CALCULO_FORMAT.value;
				}
				
				if (BASE_CALCULO_REDUZIDA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((BASE_CALCULO_REDUZIDA.checked)?"1":"0")+'">';
					document.getElementById('BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((BASE_CALCULO_REDUZIDA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+BASE_CALCULO_REDUZIDA.value+'">';
					document.getElementById('BASE_CALCULO_REDUZIDA_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = BASE_CALCULO_REDUZIDA.value;
				}
				
				if (BASE_CALCULO_REDUZIDA_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((BASE_CALCULO_REDUZIDA_FORMAT.checked)?"1":"0")+'">';
					document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((BASE_CALCULO_REDUZIDA_FORMAT.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+BASE_CALCULO_REDUZIDA_FORMAT.value+'">';
					document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = BASE_CALCULO_REDUZIDA_FORMAT.value;
				}
				
				if (IMPOSTO_TOTAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_TOTAL.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_TOTAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_TOTAL.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_TOTAL.value+'">';
					document.getElementById('IMPOSTO_TOTAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_TOTAL.value;
				}
				
				if (IMPOSTO_SITUACAO_TRIB_TIPO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_SITUACAO_TRIB_TIPO_ID.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_SITUACAO_TRIB_TIPO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_SITUACAO_TRIB_TIPO_ID.value+'">';
					document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_SITUACAO_TRIB_TIPO_ID.value;
				}
				
				if (IMP_COD_SITUACAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMP_COD_SITUACAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMP_COD_SITUACAO.checked)?"1":"0")+'">';
					document.getElementById('IMP_COD_SITUACAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMP_COD_SITUACAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMP_COD_SITUACAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMP_COD_SITUACAO.value+'">';
					document.getElementById('IMP_COD_SITUACAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMP_COD_SITUACAO.value;
				}
				
				if (RETIDO_FONTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((RETIDO_FONTE.checked)?"1":"0")+'">';
					document.getElementById('RETIDO_FONTE_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((RETIDO_FONTE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+RETIDO_FONTE.value+'">';
					document.getElementById('RETIDO_FONTE_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = RETIDO_FONTE.value;
				}
				
				if (RETIDO_FONTE_DESC.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((RETIDO_FONTE_DESC.checked)?"1":"0")+'">';
					document.getElementById('RETIDO_FONTE_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((RETIDO_FONTE_DESC.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="RETIDO_FONTE_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+RETIDO_FONTE_DESC.value+'">';
					document.getElementById('RETIDO_FONTE_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = RETIDO_FONTE_DESC.value;
				}
				
				if (IMPOSTO_COD_RETENCAO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_COD_RETENCAO_ID.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_COD_RETENCAO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_COD_RETENCAO_ID.value+'">';
					document.getElementById('IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_COD_RETENCAO_ID.value;
				}
				
				if (COD_RETENCAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="COD_RETENCAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((COD_RETENCAO.checked)?"1":"0")+'">';
					document.getElementById('COD_RETENCAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((COD_RETENCAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="COD_RETENCAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+COD_RETENCAO.value+'">';
					document.getElementById('COD_RETENCAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = COD_RETENCAO.value;
				}
				
				if (REGIME_CUMULATIVO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((REGIME_CUMULATIVO.checked)?"1":"0")+'">';
					document.getElementById('REGIME_CUMULATIVO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((REGIME_CUMULATIVO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+REGIME_CUMULATIVO.value+'">';
					document.getElementById('REGIME_CUMULATIVO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = REGIME_CUMULATIVO.value;
				}
				
				if (REGIME_CUMULATIVO_DESC.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((REGIME_CUMULATIVO_DESC.checked)?"1":"0")+'">';
					document.getElementById('REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((REGIME_CUMULATIVO_DESC.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+REGIME_CUMULATIVO_DESC.value+'">';
					document.getElementById('REGIME_CUMULATIVO_DESC_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = REGIME_CUMULATIVO_DESC.value;
				}
				
				if (IMPOSTO_TOTAL_FORMAT.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_TOTAL_FORMAT.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_TOTAL_FORMAT.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_TOTAL_FORMAT.value+'">';
					document.getElementById('IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_TOTAL_FORMAT.value;
				}
				
				if (IMPOSTO_ORIGEM_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_ORIGEM_ID.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_ORIGEM_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_ORIGEM_ID.value+'">';
					document.getElementById('IMPOSTO_ORIGEM_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_ORIGEM_ID.value;
				}
				
				if (IND_ORIG_CRED.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IND_ORIG_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IND_ORIG_CRED.checked)?"1":"0")+'">';
					document.getElementById('IND_ORIG_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IND_ORIG_CRED.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IND_ORIG_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IND_ORIG_CRED.value+'">';
					document.getElementById('IND_ORIG_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IND_ORIG_CRED.value;
				}
				
				if (NAT_BC_CRED.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NAT_BC_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((NAT_BC_CRED.checked)?"1":"0")+'">';
					document.getElementById('NAT_BC_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((NAT_BC_CRED.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NAT_BC_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+NAT_BC_CRED.value+'">';
					document.getElementById('NAT_BC_CRED_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = NAT_BC_CRED.value;
				}
				
				if (IMPOSTO_NATUREZA_BC_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_NATUREZA_BC_ID.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_NATUREZA_BC_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_NATUREZA_BC_ID.value+'">';
					document.getElementById('IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_NATUREZA_BC_ID.value;
				}
				
				if (IMP_FUNDAMENTACAO_LEGAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMP_FUNDAMENTACAO_LEGAL.checked)?"1":"0")+'">';
					document.getElementById('IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMP_FUNDAMENTACAO_LEGAL.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMP_FUNDAMENTACAO_LEGAL.value+'">';
					document.getElementById('IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMP_FUNDAMENTACAO_LEGAL.value;
				}
				
				if (RESERVADO_FISCO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="RESERVADO_FISCO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((RESERVADO_FISCO.checked)?"1":"0")+'">';
					document.getElementById('RESERVADO_FISCO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((RESERVADO_FISCO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="RESERVADO_FISCO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+RESERVADO_FISCO.value+'">';
					document.getElementById('RESERVADO_FISCO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = RESERVADO_FISCO.value;
				}
				
				if (PRODUTO_DESCRICAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="PRODUTO_DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((PRODUTO_DESCRICAO.checked)?"1":"0")+'">';
					document.getElementById('PRODUTO_DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((PRODUTO_DESCRICAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="PRODUTO_DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+PRODUTO_DESCRICAO.value+'">';
					document.getElementById('PRODUTO_DESCRICAO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = PRODUTO_DESCRICAO.value;
				}
				
				if (IMPOSTO_SITUACAO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_SITUACAO_ID.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_SITUACAO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_SITUACAO_ID.value+'">';
					document.getElementById('IMPOSTO_SITUACAO_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_SITUACAO_ID.value;
				}
				
				if (GERA_CPG_ICMS_ANTECIPADO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((GERA_CPG_ICMS_ANTECIPADO.checked)?"1":"0")+'">';
					document.getElementById('GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((GERA_CPG_ICMS_ANTECIPADO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+GERA_CPG_ICMS_ANTECIPADO.value+'">';
					document.getElementById('GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = GERA_CPG_ICMS_ANTECIPADO.value;
				}
				
				if (IMPOSTO_CONFIG_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+((IMPOSTO_CONFIG_ID.checked)?"1":"0")+'">';
					document.getElementById('IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = ((IMPOSTO_CONFIG_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" value="'+IMPOSTO_CONFIG_ID.value+'">';
					document.getElementById('IMPOSTO_CONFIG_ID_IMPOSTOS_'+lista_selected_IMPOSTOS.value).value = IMPOSTO_CONFIG_ID.value;
				}
				
//				v_tr.cells[0].innerHTML = '<img id="lista_padrao_IMPOSTOS_'+lista_selected_IMPOSTOS.value+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				
					var v_td = v_tr.cells[1];
					v_td.innerHTML = ''+IMP_TIPO_DESC.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[2];
					v_td.innerHTML = ''+PRODUTO_DESCRICAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[3];
					v_td.innerHTML = ''+DESCRICAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[4];
					v_td.innerHTML = ''+ALIQUOTA_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[5];
					v_td.innerHTML = ''+REDUCAO_BASE_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[6];
					v_td.innerHTML = ''+BASE_CALCULO_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[7];
					v_td.innerHTML = ''+BASE_CALCULO_REDUZIDA_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[8];
					v_td.innerHTML = ''+IMPOSTO_TOTAL_FORMAT.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[9];
					v_td.innerHTML = ''+REGIME_CUMULATIVO_DESC.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[10];
					v_td.innerHTML = ''+RETIDO_FONTE_DESC.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[11];
					v_td.innerHTML = ''+COD_RETENCAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[12];
					v_td.innerHTML = ''+IMP_COD_SITUACAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[13];
					v_td.innerHTML = ''+IND_ORIG_CRED.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[14];
					v_td.innerHTML = ''+NAT_BC_CRED.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[15];
					v_td.innerHTML = ''+IMP_FUNDAMENTACAO_LEGAL.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
								
				f_atualiza_campos_escravos_IMPOSTOS();
				f_incluir_IMPOSTOS();
			}
		}
			
		
		f_on_salva_lista_IMPOSTOS();
	}
}
function f_cancelar_IMPOSTOS() {
	var tbody = document.getElementById('tb_lista_IMPOSTOS');		
	for(var i=0;i<tbody.rows.length;i++) {
		for(var j=0;j<tbody.rows[i].cells.length;j++) {
			tbody.rows[i].cells[j].className = 'linha_1';
		}
	}
	with(document.forms[0]) {
	
		

		if(document.getElementById('IMPOSTO_TIPO_ID').getAttribute('type') != 'file') {
		  if (!IMPOSTO_TIPO_ID.getAttribute('manter') || IMPOSTO_TIPO_ID.getAttribute('manter') == 0) {
				if(IMPOSTO_TIPO_ID.type == 'checkbox') {
					IMPOSTO_TIPO_ID.checked = false;
				} else if(IMPOSTO_TIPO_ID.type == 'select-one') {
					IMPOSTO_TIPO_ID.selectedIndex = 0;
				} else {
					IMPOSTO_TIPO_ID.value = '';
				}
				
				try {
					IMPOSTO_TIPO_ID.focus();
				} catch(e) {
				}
				
			}
		}
		

		if(document.getElementById('IMP_TIPO_DESC').getAttribute('type') != 'file') {
		  if (!IMP_TIPO_DESC.getAttribute('manter') || IMP_TIPO_DESC.getAttribute('manter') == 0) {
				if(IMP_TIPO_DESC.type == 'checkbox') {
					IMP_TIPO_DESC.checked = false;
				} else if(IMP_TIPO_DESC.type == 'select-one') {
					IMP_TIPO_DESC.selectedIndex = 0;
				} else {
					IMP_TIPO_DESC.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DESCRICAO').getAttribute('type') != 'file') {
		  if (!DESCRICAO.getAttribute('manter') || DESCRICAO.getAttribute('manter') == 0) {
				if(DESCRICAO.type == 'checkbox') {
					DESCRICAO.checked = false;
				} else if(DESCRICAO.type == 'select-one') {
					DESCRICAO.selectedIndex = 0;
				} else {
					DESCRICAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('ALIQUOTA').getAttribute('type') != 'file') {
		  if (!ALIQUOTA.getAttribute('manter') || ALIQUOTA.getAttribute('manter') == 0) {
				if(ALIQUOTA.type == 'checkbox') {
					ALIQUOTA.checked = false;
				} else if(ALIQUOTA.type == 'select-one') {
					ALIQUOTA.selectedIndex = 0;
				} else {
					ALIQUOTA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('ALIQUOTA_FORMAT').getAttribute('type') != 'file') {
		  if (!ALIQUOTA_FORMAT.getAttribute('manter') || ALIQUOTA_FORMAT.getAttribute('manter') == 0) {
				if(ALIQUOTA_FORMAT.type == 'checkbox') {
					ALIQUOTA_FORMAT.checked = false;
				} else if(ALIQUOTA_FORMAT.type == 'select-one') {
					ALIQUOTA_FORMAT.selectedIndex = 0;
				} else {
					ALIQUOTA_FORMAT.value = '';
				}
				
			}
		}
		

		if(document.getElementById('REDUCAO_BASE').getAttribute('type') != 'file') {
		  if (!REDUCAO_BASE.getAttribute('manter') || REDUCAO_BASE.getAttribute('manter') == 0) {
				if(REDUCAO_BASE.type == 'checkbox') {
					REDUCAO_BASE.checked = false;
				} else if(REDUCAO_BASE.type == 'select-one') {
					REDUCAO_BASE.selectedIndex = 0;
				} else {
					REDUCAO_BASE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('REDUCAO_BASE_FORMAT').getAttribute('type') != 'file') {
		  if (!REDUCAO_BASE_FORMAT.getAttribute('manter') || REDUCAO_BASE_FORMAT.getAttribute('manter') == 0) {
				if(REDUCAO_BASE_FORMAT.type == 'checkbox') {
					REDUCAO_BASE_FORMAT.checked = false;
				} else if(REDUCAO_BASE_FORMAT.type == 'select-one') {
					REDUCAO_BASE_FORMAT.selectedIndex = 0;
				} else {
					REDUCAO_BASE_FORMAT.value = '';
				}
				
			}
		}
		

		if(document.getElementById('BASE_CALCULO').getAttribute('type') != 'file') {
		  if (!BASE_CALCULO.getAttribute('manter') || BASE_CALCULO.getAttribute('manter') == 0) {
				if(BASE_CALCULO.type == 'checkbox') {
					BASE_CALCULO.checked = false;
				} else if(BASE_CALCULO.type == 'select-one') {
					BASE_CALCULO.selectedIndex = 0;
				} else {
					BASE_CALCULO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('BASE_CALCULO_FORMAT').getAttribute('type') != 'file') {
		  if (!BASE_CALCULO_FORMAT.getAttribute('manter') || BASE_CALCULO_FORMAT.getAttribute('manter') == 0) {
				if(BASE_CALCULO_FORMAT.type == 'checkbox') {
					BASE_CALCULO_FORMAT.checked = false;
				} else if(BASE_CALCULO_FORMAT.type == 'select-one') {
					BASE_CALCULO_FORMAT.selectedIndex = 0;
				} else {
					BASE_CALCULO_FORMAT.value = '';
				}
				
			}
		}
		

		if(document.getElementById('BASE_CALCULO_REDUZIDA').getAttribute('type') != 'file') {
		  if (!BASE_CALCULO_REDUZIDA.getAttribute('manter') || BASE_CALCULO_REDUZIDA.getAttribute('manter') == 0) {
				if(BASE_CALCULO_REDUZIDA.type == 'checkbox') {
					BASE_CALCULO_REDUZIDA.checked = false;
				} else if(BASE_CALCULO_REDUZIDA.type == 'select-one') {
					BASE_CALCULO_REDUZIDA.selectedIndex = 0;
				} else {
					BASE_CALCULO_REDUZIDA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT').getAttribute('type') != 'file') {
		  if (!BASE_CALCULO_REDUZIDA_FORMAT.getAttribute('manter') || BASE_CALCULO_REDUZIDA_FORMAT.getAttribute('manter') == 0) {
				if(BASE_CALCULO_REDUZIDA_FORMAT.type == 'checkbox') {
					BASE_CALCULO_REDUZIDA_FORMAT.checked = false;
				} else if(BASE_CALCULO_REDUZIDA_FORMAT.type == 'select-one') {
					BASE_CALCULO_REDUZIDA_FORMAT.selectedIndex = 0;
				} else {
					BASE_CALCULO_REDUZIDA_FORMAT.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_TOTAL').getAttribute('type') != 'file') {
		  if (!IMPOSTO_TOTAL.getAttribute('manter') || IMPOSTO_TOTAL.getAttribute('manter') == 0) {
				if(IMPOSTO_TOTAL.type == 'checkbox') {
					IMPOSTO_TOTAL.checked = false;
				} else if(IMPOSTO_TOTAL.type == 'select-one') {
					IMPOSTO_TOTAL.selectedIndex = 0;
				} else {
					IMPOSTO_TOTAL.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID').getAttribute('type') != 'file') {
		  if (!IMPOSTO_SITUACAO_TRIB_TIPO_ID.getAttribute('manter') || IMPOSTO_SITUACAO_TRIB_TIPO_ID.getAttribute('manter') == 0) {
				if(IMPOSTO_SITUACAO_TRIB_TIPO_ID.type == 'checkbox') {
					IMPOSTO_SITUACAO_TRIB_TIPO_ID.checked = false;
				} else if(IMPOSTO_SITUACAO_TRIB_TIPO_ID.type == 'select-one') {
					IMPOSTO_SITUACAO_TRIB_TIPO_ID.selectedIndex = 0;
				} else {
					IMPOSTO_SITUACAO_TRIB_TIPO_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMP_COD_SITUACAO').getAttribute('type') != 'file') {
		  if (!IMP_COD_SITUACAO.getAttribute('manter') || IMP_COD_SITUACAO.getAttribute('manter') == 0) {
				if(IMP_COD_SITUACAO.type == 'checkbox') {
					IMP_COD_SITUACAO.checked = false;
				} else if(IMP_COD_SITUACAO.type == 'select-one') {
					IMP_COD_SITUACAO.selectedIndex = 0;
				} else {
					IMP_COD_SITUACAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('RETIDO_FONTE').getAttribute('type') != 'file') {
		  if (!RETIDO_FONTE.getAttribute('manter') || RETIDO_FONTE.getAttribute('manter') == 0) {
				if(RETIDO_FONTE.type == 'checkbox') {
					RETIDO_FONTE.checked = false;
				} else if(RETIDO_FONTE.type == 'select-one') {
					RETIDO_FONTE.selectedIndex = 0;
				} else {
					RETIDO_FONTE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('RETIDO_FONTE_DESC').getAttribute('type') != 'file') {
		  if (!RETIDO_FONTE_DESC.getAttribute('manter') || RETIDO_FONTE_DESC.getAttribute('manter') == 0) {
				if(RETIDO_FONTE_DESC.type == 'checkbox') {
					RETIDO_FONTE_DESC.checked = false;
				} else if(RETIDO_FONTE_DESC.type == 'select-one') {
					RETIDO_FONTE_DESC.selectedIndex = 0;
				} else {
					RETIDO_FONTE_DESC.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_COD_RETENCAO_ID').getAttribute('type') != 'file') {
		  if (!IMPOSTO_COD_RETENCAO_ID.getAttribute('manter') || IMPOSTO_COD_RETENCAO_ID.getAttribute('manter') == 0) {
				if(IMPOSTO_COD_RETENCAO_ID.type == 'checkbox') {
					IMPOSTO_COD_RETENCAO_ID.checked = false;
				} else if(IMPOSTO_COD_RETENCAO_ID.type == 'select-one') {
					IMPOSTO_COD_RETENCAO_ID.selectedIndex = 0;
				} else {
					IMPOSTO_COD_RETENCAO_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('COD_RETENCAO').getAttribute('type') != 'file') {
		  if (!COD_RETENCAO.getAttribute('manter') || COD_RETENCAO.getAttribute('manter') == 0) {
				if(COD_RETENCAO.type == 'checkbox') {
					COD_RETENCAO.checked = false;
				} else if(COD_RETENCAO.type == 'select-one') {
					COD_RETENCAO.selectedIndex = 0;
				} else {
					COD_RETENCAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('REGIME_CUMULATIVO').getAttribute('type') != 'file') {
		  if (!REGIME_CUMULATIVO.getAttribute('manter') || REGIME_CUMULATIVO.getAttribute('manter') == 0) {
				if(REGIME_CUMULATIVO.type == 'checkbox') {
					REGIME_CUMULATIVO.checked = false;
				} else if(REGIME_CUMULATIVO.type == 'select-one') {
					REGIME_CUMULATIVO.selectedIndex = 0;
				} else {
					REGIME_CUMULATIVO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('REGIME_CUMULATIVO_DESC').getAttribute('type') != 'file') {
		  if (!REGIME_CUMULATIVO_DESC.getAttribute('manter') || REGIME_CUMULATIVO_DESC.getAttribute('manter') == 0) {
				if(REGIME_CUMULATIVO_DESC.type == 'checkbox') {
					REGIME_CUMULATIVO_DESC.checked = false;
				} else if(REGIME_CUMULATIVO_DESC.type == 'select-one') {
					REGIME_CUMULATIVO_DESC.selectedIndex = 0;
				} else {
					REGIME_CUMULATIVO_DESC.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_TOTAL_FORMAT').getAttribute('type') != 'file') {
		  if (!IMPOSTO_TOTAL_FORMAT.getAttribute('manter') || IMPOSTO_TOTAL_FORMAT.getAttribute('manter') == 0) {
				if(IMPOSTO_TOTAL_FORMAT.type == 'checkbox') {
					IMPOSTO_TOTAL_FORMAT.checked = false;
				} else if(IMPOSTO_TOTAL_FORMAT.type == 'select-one') {
					IMPOSTO_TOTAL_FORMAT.selectedIndex = 0;
				} else {
					IMPOSTO_TOTAL_FORMAT.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_ORIGEM_ID').getAttribute('type') != 'file') {
		  if (!IMPOSTO_ORIGEM_ID.getAttribute('manter') || IMPOSTO_ORIGEM_ID.getAttribute('manter') == 0) {
				if(IMPOSTO_ORIGEM_ID.type == 'checkbox') {
					IMPOSTO_ORIGEM_ID.checked = false;
				} else if(IMPOSTO_ORIGEM_ID.type == 'select-one') {
					IMPOSTO_ORIGEM_ID.selectedIndex = 0;
				} else {
					IMPOSTO_ORIGEM_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IND_ORIG_CRED').getAttribute('type') != 'file') {
		  if (!IND_ORIG_CRED.getAttribute('manter') || IND_ORIG_CRED.getAttribute('manter') == 0) {
				if(IND_ORIG_CRED.type == 'checkbox') {
					IND_ORIG_CRED.checked = false;
				} else if(IND_ORIG_CRED.type == 'select-one') {
					IND_ORIG_CRED.selectedIndex = 0;
				} else {
					IND_ORIG_CRED.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NAT_BC_CRED').getAttribute('type') != 'file') {
		  if (!NAT_BC_CRED.getAttribute('manter') || NAT_BC_CRED.getAttribute('manter') == 0) {
				if(NAT_BC_CRED.type == 'checkbox') {
					NAT_BC_CRED.checked = false;
				} else if(NAT_BC_CRED.type == 'select-one') {
					NAT_BC_CRED.selectedIndex = 0;
				} else {
					NAT_BC_CRED.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_NATUREZA_BC_ID').getAttribute('type') != 'file') {
		  if (!IMPOSTO_NATUREZA_BC_ID.getAttribute('manter') || IMPOSTO_NATUREZA_BC_ID.getAttribute('manter') == 0) {
				if(IMPOSTO_NATUREZA_BC_ID.type == 'checkbox') {
					IMPOSTO_NATUREZA_BC_ID.checked = false;
				} else if(IMPOSTO_NATUREZA_BC_ID.type == 'select-one') {
					IMPOSTO_NATUREZA_BC_ID.selectedIndex = 0;
				} else {
					IMPOSTO_NATUREZA_BC_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMP_FUNDAMENTACAO_LEGAL').getAttribute('type') != 'file') {
		  if (!IMP_FUNDAMENTACAO_LEGAL.getAttribute('manter') || IMP_FUNDAMENTACAO_LEGAL.getAttribute('manter') == 0) {
				if(IMP_FUNDAMENTACAO_LEGAL.type == 'checkbox') {
					IMP_FUNDAMENTACAO_LEGAL.checked = false;
				} else if(IMP_FUNDAMENTACAO_LEGAL.type == 'select-one') {
					IMP_FUNDAMENTACAO_LEGAL.selectedIndex = 0;
				} else {
					IMP_FUNDAMENTACAO_LEGAL.value = '';
				}
				
			}
		}
		

		if(document.getElementById('RESERVADO_FISCO').getAttribute('type') != 'file') {
		  if (!RESERVADO_FISCO.getAttribute('manter') || RESERVADO_FISCO.getAttribute('manter') == 0) {
				if(RESERVADO_FISCO.type == 'checkbox') {
					RESERVADO_FISCO.checked = false;
				} else if(RESERVADO_FISCO.type == 'select-one') {
					RESERVADO_FISCO.selectedIndex = 0;
				} else {
					RESERVADO_FISCO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('PRODUTO_DESCRICAO').getAttribute('type') != 'file') {
		  if (!PRODUTO_DESCRICAO.getAttribute('manter') || PRODUTO_DESCRICAO.getAttribute('manter') == 0) {
				if(PRODUTO_DESCRICAO.type == 'checkbox') {
					PRODUTO_DESCRICAO.checked = false;
				} else if(PRODUTO_DESCRICAO.type == 'select-one') {
					PRODUTO_DESCRICAO.selectedIndex = 0;
				} else {
					PRODUTO_DESCRICAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_SITUACAO_ID').getAttribute('type') != 'file') {
		  if (!IMPOSTO_SITUACAO_ID.getAttribute('manter') || IMPOSTO_SITUACAO_ID.getAttribute('manter') == 0) {
				if(IMPOSTO_SITUACAO_ID.type == 'checkbox') {
					IMPOSTO_SITUACAO_ID.checked = false;
				} else if(IMPOSTO_SITUACAO_ID.type == 'select-one') {
					IMPOSTO_SITUACAO_ID.selectedIndex = 0;
				} else {
					IMPOSTO_SITUACAO_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('GERA_CPG_ICMS_ANTECIPADO').getAttribute('type') != 'file') {
		  if (!GERA_CPG_ICMS_ANTECIPADO.getAttribute('manter') || GERA_CPG_ICMS_ANTECIPADO.getAttribute('manter') == 0) {
				if(GERA_CPG_ICMS_ANTECIPADO.type == 'checkbox') {
					GERA_CPG_ICMS_ANTECIPADO.checked = false;
				} else if(GERA_CPG_ICMS_ANTECIPADO.type == 'select-one') {
					GERA_CPG_ICMS_ANTECIPADO.selectedIndex = 0;
				} else {
					GERA_CPG_ICMS_ANTECIPADO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('IMPOSTO_CONFIG_ID').getAttribute('type') != 'file') {
		  if (!IMPOSTO_CONFIG_ID.getAttribute('manter') || IMPOSTO_CONFIG_ID.getAttribute('manter') == 0) {
				if(IMPOSTO_CONFIG_ID.type == 'checkbox') {
					IMPOSTO_CONFIG_ID.checked = false;
				} else if(IMPOSTO_CONFIG_ID.type == 'select-one') {
					IMPOSTO_CONFIG_ID.selectedIndex = 0;
				} else {
					IMPOSTO_CONFIG_ID.value = '';
				}
				
			}
		}
		
		lista_selected_IMPOSTOS.value = -1;
	}
	f_desabilitar_botao_lista_IMPOSTOS('padrao');
	f_desabilitar_botao_lista_IMPOSTOS('excluir');
		
	f_on_incluir_IMPOSTOS();
}
function f_habilitar_botao_lista_IMPOSTOS(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_IMPOSTOS');
	if(obj != null) {
		obj.disabled = false;
		img_obj = document.getElementById('img_lista_'+v_botao+'_IMPOSTOS');
		img_obj.src = img_obj.src.replace('_disable.gif', '.gif');
	}
}
function f_desabilitar_botao_lista_IMPOSTOS(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_IMPOSTOS');
	if(obj != null) {
		obj.disabled = true;
		img_obj = document.getElementById('img_lista_'+v_botao+'_IMPOSTOS');
		if(img_obj.src.indexOf('_disable') == -1) {
			img_obj.src = img_obj.src.replace('.gif', '_disable.gif');
		}
	}
}
function f_seleciona_IMPOSTOS(v_nro) {
	
	if(!document.getElementById('btn_lista_incluir_IMPOSTOS').disabled) {
	
		f_before_selecionar_IMPOSTOS();
		f_cancelar_IMPOSTOS();
		var tbody = document.getElementById('tb_lista_IMPOSTOS');		
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_IMPOSTOS_'+v_nro) {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_1';
				}			
			} else {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_over';
				}
			}
		}
		with (document.forms[0]) {
			
			if(IMPOSTO_TIPO_ID.type == 'checkbox') {
				IMPOSTO_TIPO_ID.checked = (document.getElementById('IMPOSTO_TIPO_ID_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_TIPO_ID').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_TIPO_ID_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_TIPO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_TIPO_ID';
				v_campo_valor.name = 'IMPOSTO_TIPO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_TIPO_ID.value = document.getElementById('IMPOSTO_TIPO_ID_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMP_TIPO_DESC.type == 'checkbox') {
				IMP_TIPO_DESC.checked = (document.getElementById('IMP_TIPO_DESC_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMP_TIPO_DESC').type == 'file') {
				v_campo_valor = document.getElementById('IMP_TIPO_DESC_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMP_TIPO_DESC');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMP_TIPO_DESC';
				v_campo_valor.name = 'IMP_TIPO_DESC';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMP_TIPO_DESC.value = document.getElementById('IMP_TIPO_DESC_IMPOSTOS_'+v_nro).value;
			}
			
			if(DESCRICAO.type == 'checkbox') {
				DESCRICAO.checked = (document.getElementById('DESCRICAO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('DESCRICAO').type == 'file') {
				v_campo_valor = document.getElementById('DESCRICAO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('DESCRICAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DESCRICAO';
				v_campo_valor.name = 'DESCRICAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DESCRICAO.value = document.getElementById('DESCRICAO_IMPOSTOS_'+v_nro).value;
			}
			
			if(ALIQUOTA.type == 'checkbox') {
				ALIQUOTA.checked = (document.getElementById('ALIQUOTA_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('ALIQUOTA').type == 'file') {
				v_campo_valor = document.getElementById('ALIQUOTA_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('ALIQUOTA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'ALIQUOTA';
				v_campo_valor.name = 'ALIQUOTA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				ALIQUOTA.value = document.getElementById('ALIQUOTA_IMPOSTOS_'+v_nro).value;
			}
			
			if(ALIQUOTA_FORMAT.type == 'checkbox') {
				ALIQUOTA_FORMAT.checked = (document.getElementById('ALIQUOTA_FORMAT_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('ALIQUOTA_FORMAT').type == 'file') {
				v_campo_valor = document.getElementById('ALIQUOTA_FORMAT_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('ALIQUOTA_FORMAT');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'ALIQUOTA_FORMAT';
				v_campo_valor.name = 'ALIQUOTA_FORMAT';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				ALIQUOTA_FORMAT.value = document.getElementById('ALIQUOTA_FORMAT_IMPOSTOS_'+v_nro).value;
			}
			
			if(REDUCAO_BASE.type == 'checkbox') {
				REDUCAO_BASE.checked = (document.getElementById('REDUCAO_BASE_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('REDUCAO_BASE').type == 'file') {
				v_campo_valor = document.getElementById('REDUCAO_BASE_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('REDUCAO_BASE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'REDUCAO_BASE';
				v_campo_valor.name = 'REDUCAO_BASE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				REDUCAO_BASE.value = document.getElementById('REDUCAO_BASE_IMPOSTOS_'+v_nro).value;
			}
			
			if(REDUCAO_BASE_FORMAT.type == 'checkbox') {
				REDUCAO_BASE_FORMAT.checked = (document.getElementById('REDUCAO_BASE_FORMAT_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('REDUCAO_BASE_FORMAT').type == 'file') {
				v_campo_valor = document.getElementById('REDUCAO_BASE_FORMAT_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('REDUCAO_BASE_FORMAT');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'REDUCAO_BASE_FORMAT';
				v_campo_valor.name = 'REDUCAO_BASE_FORMAT';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				REDUCAO_BASE_FORMAT.value = document.getElementById('REDUCAO_BASE_FORMAT_IMPOSTOS_'+v_nro).value;
			}
			
			if(BASE_CALCULO.type == 'checkbox') {
				BASE_CALCULO.checked = (document.getElementById('BASE_CALCULO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('BASE_CALCULO').type == 'file') {
				v_campo_valor = document.getElementById('BASE_CALCULO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('BASE_CALCULO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'BASE_CALCULO';
				v_campo_valor.name = 'BASE_CALCULO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				BASE_CALCULO.value = document.getElementById('BASE_CALCULO_IMPOSTOS_'+v_nro).value;
			}
			
			if(BASE_CALCULO_FORMAT.type == 'checkbox') {
				BASE_CALCULO_FORMAT.checked = (document.getElementById('BASE_CALCULO_FORMAT_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('BASE_CALCULO_FORMAT').type == 'file') {
				v_campo_valor = document.getElementById('BASE_CALCULO_FORMAT_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('BASE_CALCULO_FORMAT');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'BASE_CALCULO_FORMAT';
				v_campo_valor.name = 'BASE_CALCULO_FORMAT';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				BASE_CALCULO_FORMAT.value = document.getElementById('BASE_CALCULO_FORMAT_IMPOSTOS_'+v_nro).value;
			}
			
			if(BASE_CALCULO_REDUZIDA.type == 'checkbox') {
				BASE_CALCULO_REDUZIDA.checked = (document.getElementById('BASE_CALCULO_REDUZIDA_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('BASE_CALCULO_REDUZIDA').type == 'file') {
				v_campo_valor = document.getElementById('BASE_CALCULO_REDUZIDA_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('BASE_CALCULO_REDUZIDA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'BASE_CALCULO_REDUZIDA';
				v_campo_valor.name = 'BASE_CALCULO_REDUZIDA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				BASE_CALCULO_REDUZIDA.value = document.getElementById('BASE_CALCULO_REDUZIDA_IMPOSTOS_'+v_nro).value;
			}
			
			if(BASE_CALCULO_REDUZIDA_FORMAT.type == 'checkbox') {
				BASE_CALCULO_REDUZIDA_FORMAT.checked = (document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT').type == 'file') {
				v_campo_valor = document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'BASE_CALCULO_REDUZIDA_FORMAT';
				v_campo_valor.name = 'BASE_CALCULO_REDUZIDA_FORMAT';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				BASE_CALCULO_REDUZIDA_FORMAT.value = document.getElementById('BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_TOTAL.type == 'checkbox') {
				IMPOSTO_TOTAL.checked = (document.getElementById('IMPOSTO_TOTAL_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_TOTAL').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_TOTAL_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_TOTAL');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_TOTAL';
				v_campo_valor.name = 'IMPOSTO_TOTAL';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_TOTAL.value = document.getElementById('IMPOSTO_TOTAL_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_SITUACAO_TRIB_TIPO_ID.type == 'checkbox') {
				IMPOSTO_SITUACAO_TRIB_TIPO_ID.checked = (document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_SITUACAO_TRIB_TIPO_ID';
				v_campo_valor.name = 'IMPOSTO_SITUACAO_TRIB_TIPO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_SITUACAO_TRIB_TIPO_ID.value = document.getElementById('IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMP_COD_SITUACAO.type == 'checkbox') {
				IMP_COD_SITUACAO.checked = (document.getElementById('IMP_COD_SITUACAO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMP_COD_SITUACAO').type == 'file') {
				v_campo_valor = document.getElementById('IMP_COD_SITUACAO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMP_COD_SITUACAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMP_COD_SITUACAO';
				v_campo_valor.name = 'IMP_COD_SITUACAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMP_COD_SITUACAO.value = document.getElementById('IMP_COD_SITUACAO_IMPOSTOS_'+v_nro).value;
			}
			
			if(RETIDO_FONTE.type == 'checkbox') {
				RETIDO_FONTE.checked = (document.getElementById('RETIDO_FONTE_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('RETIDO_FONTE').type == 'file') {
				v_campo_valor = document.getElementById('RETIDO_FONTE_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('RETIDO_FONTE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'RETIDO_FONTE';
				v_campo_valor.name = 'RETIDO_FONTE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				RETIDO_FONTE.value = document.getElementById('RETIDO_FONTE_IMPOSTOS_'+v_nro).value;
			}
			
			if(RETIDO_FONTE_DESC.type == 'checkbox') {
				RETIDO_FONTE_DESC.checked = (document.getElementById('RETIDO_FONTE_DESC_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('RETIDO_FONTE_DESC').type == 'file') {
				v_campo_valor = document.getElementById('RETIDO_FONTE_DESC_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('RETIDO_FONTE_DESC');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'RETIDO_FONTE_DESC';
				v_campo_valor.name = 'RETIDO_FONTE_DESC';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				RETIDO_FONTE_DESC.value = document.getElementById('RETIDO_FONTE_DESC_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_COD_RETENCAO_ID.type == 'checkbox') {
				IMPOSTO_COD_RETENCAO_ID.checked = (document.getElementById('IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_COD_RETENCAO_ID').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_COD_RETENCAO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_COD_RETENCAO_ID';
				v_campo_valor.name = 'IMPOSTO_COD_RETENCAO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_COD_RETENCAO_ID.value = document.getElementById('IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_'+v_nro).value;
			}
			
			if(COD_RETENCAO.type == 'checkbox') {
				COD_RETENCAO.checked = (document.getElementById('COD_RETENCAO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('COD_RETENCAO').type == 'file') {
				v_campo_valor = document.getElementById('COD_RETENCAO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('COD_RETENCAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'COD_RETENCAO';
				v_campo_valor.name = 'COD_RETENCAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				COD_RETENCAO.value = document.getElementById('COD_RETENCAO_IMPOSTOS_'+v_nro).value;
			}
			
			if(REGIME_CUMULATIVO.type == 'checkbox') {
				REGIME_CUMULATIVO.checked = (document.getElementById('REGIME_CUMULATIVO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('REGIME_CUMULATIVO').type == 'file') {
				v_campo_valor = document.getElementById('REGIME_CUMULATIVO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('REGIME_CUMULATIVO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'REGIME_CUMULATIVO';
				v_campo_valor.name = 'REGIME_CUMULATIVO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				REGIME_CUMULATIVO.value = document.getElementById('REGIME_CUMULATIVO_IMPOSTOS_'+v_nro).value;
			}
			
			if(REGIME_CUMULATIVO_DESC.type == 'checkbox') {
				REGIME_CUMULATIVO_DESC.checked = (document.getElementById('REGIME_CUMULATIVO_DESC_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('REGIME_CUMULATIVO_DESC').type == 'file') {
				v_campo_valor = document.getElementById('REGIME_CUMULATIVO_DESC_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('REGIME_CUMULATIVO_DESC');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'REGIME_CUMULATIVO_DESC';
				v_campo_valor.name = 'REGIME_CUMULATIVO_DESC';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				REGIME_CUMULATIVO_DESC.value = document.getElementById('REGIME_CUMULATIVO_DESC_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_TOTAL_FORMAT.type == 'checkbox') {
				IMPOSTO_TOTAL_FORMAT.checked = (document.getElementById('IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_TOTAL_FORMAT').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_TOTAL_FORMAT');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_TOTAL_FORMAT';
				v_campo_valor.name = 'IMPOSTO_TOTAL_FORMAT';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_TOTAL_FORMAT.value = document.getElementById('IMPOSTO_TOTAL_FORMAT_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_ORIGEM_ID.type == 'checkbox') {
				IMPOSTO_ORIGEM_ID.checked = (document.getElementById('IMPOSTO_ORIGEM_ID_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_ORIGEM_ID').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_ORIGEM_ID_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_ORIGEM_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_ORIGEM_ID';
				v_campo_valor.name = 'IMPOSTO_ORIGEM_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_ORIGEM_ID.value = document.getElementById('IMPOSTO_ORIGEM_ID_IMPOSTOS_'+v_nro).value;
			}
			
			if(IND_ORIG_CRED.type == 'checkbox') {
				IND_ORIG_CRED.checked = (document.getElementById('IND_ORIG_CRED_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IND_ORIG_CRED').type == 'file') {
				v_campo_valor = document.getElementById('IND_ORIG_CRED_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IND_ORIG_CRED');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IND_ORIG_CRED';
				v_campo_valor.name = 'IND_ORIG_CRED';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IND_ORIG_CRED.value = document.getElementById('IND_ORIG_CRED_IMPOSTOS_'+v_nro).value;
			}
			
			if(NAT_BC_CRED.type == 'checkbox') {
				NAT_BC_CRED.checked = (document.getElementById('NAT_BC_CRED_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('NAT_BC_CRED').type == 'file') {
				v_campo_valor = document.getElementById('NAT_BC_CRED_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('NAT_BC_CRED');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NAT_BC_CRED';
				v_campo_valor.name = 'NAT_BC_CRED';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NAT_BC_CRED.value = document.getElementById('NAT_BC_CRED_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_NATUREZA_BC_ID.type == 'checkbox') {
				IMPOSTO_NATUREZA_BC_ID.checked = (document.getElementById('IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_NATUREZA_BC_ID').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_NATUREZA_BC_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_NATUREZA_BC_ID';
				v_campo_valor.name = 'IMPOSTO_NATUREZA_BC_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_NATUREZA_BC_ID.value = document.getElementById('IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMP_FUNDAMENTACAO_LEGAL.type == 'checkbox') {
				IMP_FUNDAMENTACAO_LEGAL.checked = (document.getElementById('IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMP_FUNDAMENTACAO_LEGAL').type == 'file') {
				v_campo_valor = document.getElementById('IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMP_FUNDAMENTACAO_LEGAL');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMP_FUNDAMENTACAO_LEGAL';
				v_campo_valor.name = 'IMP_FUNDAMENTACAO_LEGAL';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMP_FUNDAMENTACAO_LEGAL.value = document.getElementById('IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_'+v_nro).value;
			}
			
			if(RESERVADO_FISCO.type == 'checkbox') {
				RESERVADO_FISCO.checked = (document.getElementById('RESERVADO_FISCO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('RESERVADO_FISCO').type == 'file') {
				v_campo_valor = document.getElementById('RESERVADO_FISCO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('RESERVADO_FISCO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'RESERVADO_FISCO';
				v_campo_valor.name = 'RESERVADO_FISCO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				RESERVADO_FISCO.value = document.getElementById('RESERVADO_FISCO_IMPOSTOS_'+v_nro).value;
			}
			
			if(PRODUTO_DESCRICAO.type == 'checkbox') {
				PRODUTO_DESCRICAO.checked = (document.getElementById('PRODUTO_DESCRICAO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('PRODUTO_DESCRICAO').type == 'file') {
				v_campo_valor = document.getElementById('PRODUTO_DESCRICAO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('PRODUTO_DESCRICAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'PRODUTO_DESCRICAO';
				v_campo_valor.name = 'PRODUTO_DESCRICAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				PRODUTO_DESCRICAO.value = document.getElementById('PRODUTO_DESCRICAO_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_SITUACAO_ID.type == 'checkbox') {
				IMPOSTO_SITUACAO_ID.checked = (document.getElementById('IMPOSTO_SITUACAO_ID_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_SITUACAO_ID').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_SITUACAO_ID_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_SITUACAO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_SITUACAO_ID';
				v_campo_valor.name = 'IMPOSTO_SITUACAO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_SITUACAO_ID.value = document.getElementById('IMPOSTO_SITUACAO_ID_IMPOSTOS_'+v_nro).value;
			}
			
			if(GERA_CPG_ICMS_ANTECIPADO.type == 'checkbox') {
				GERA_CPG_ICMS_ANTECIPADO.checked = (document.getElementById('GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('GERA_CPG_ICMS_ANTECIPADO').type == 'file') {
				v_campo_valor = document.getElementById('GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('GERA_CPG_ICMS_ANTECIPADO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'GERA_CPG_ICMS_ANTECIPADO';
				v_campo_valor.name = 'GERA_CPG_ICMS_ANTECIPADO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				GERA_CPG_ICMS_ANTECIPADO.value = document.getElementById('GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_'+v_nro).value;
			}
			
			if(IMPOSTO_CONFIG_ID.type == 'checkbox') {
				IMPOSTO_CONFIG_ID.checked = (document.getElementById('IMPOSTO_CONFIG_ID_IMPOSTOS_'+v_nro).value == 1)
			} else if(document.getElementById('IMPOSTO_CONFIG_ID').type == 'file') {
				v_campo_valor = document.getElementById('IMPOSTO_CONFIG_ID_IMPOSTOS_'+v_nro);
				v_campo_atual = document.getElementById('IMPOSTO_CONFIG_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'IMPOSTO_CONFIG_ID';
				v_campo_valor.name = 'IMPOSTO_CONFIG_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				IMPOSTO_CONFIG_ID.value = document.getElementById('IMPOSTO_CONFIG_ID_IMPOSTOS_'+v_nro).value;
			}
			
			lista_selected_IMPOSTOS.value = v_nro;
		}
		f_habilitar_botao_lista_IMPOSTOS('padrao');
		f_habilitar_botao_lista_IMPOSTOS('excluir');
		f_habilitar_botao_lista_IMPOSTOS('salvar');
		f_on_seleciona_IMPOSTOS();
	
	}
	
}
function f_padrao_IMPOSTOS(v_nro) {
	if(v_nro == -1) {
		return;
	}
	var tbody = document.getElementById('tb_lista_IMPOSTOS');		
	with(document.forms[0]) {
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_IMPOSTOS_'+v_nro) {
				var row_id = tbody.rows[i].id.replace('tr_lista_IMPOSTOS_', '');
				document.getElementById('lista_padrao_IMPOSTOS_'+row_id).style.display = 'none';
				document.getElementById('PADRAO_IMPOSTOS_'+row_id).value = 0;
			}
		}
	}
	document.getElementById('lista_padrao_IMPOSTOS_'+v_nro).style.display = '';
	document.getElementById('PADRAO_IMPOSTOS_'+v_nro).value = 1;
}	

function f_total_campo_IMPOSTOS(v_campo) {
	var tbody = document.getElementById('tb_lista_IMPOSTOS');
	var soma = 0;
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_IMPOSTOS_', '');
		with(document.forms[0]) {
			try {
				soma += (eval("document.forms[0]."+v_campo+"_IMPOSTOS_"+id_linha+".value")*1);
			} catch(e) {
			}
		}
	}
	return soma;
}
function f_atualiza_campos_escravos_IMPOSTOS() {

}

function f_atualiza_campo_escravo_IMPOSTOS(v_valor_mestre, v_campo_escravo, v_value) {
	var tbody = document.getElementById('tb_lista_IMPOSTOS');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_IMPOSTOS_', '');
		with(document.forms[0]) {
			try {
				if (eval("document.forms[0]._IMPOSTOS_"+id_linha).value == v_valor_mestre) {
					eval("document.forms[0]."+v_campo_escravo+"_IMPOSTOS_"+id_linha).value = v_value;
				}				
			} catch(e) {
			}
		}
	}
}

function f_register(p_id) {
	this.id = p_id;

	this.IMPOSTO_TIPO_ID = '';

	this.IMP_TIPO_DESC = '';

	this.DESCRICAO = '';

	this.ALIQUOTA = '';

	this.ALIQUOTA_FORMAT = '';

	this.REDUCAO_BASE = '';

	this.REDUCAO_BASE_FORMAT = '';

	this.BASE_CALCULO = '';

	this.BASE_CALCULO_FORMAT = '';

	this.BASE_CALCULO_REDUZIDA = '';

	this.BASE_CALCULO_REDUZIDA_FORMAT = '';

	this.IMPOSTO_TOTAL = '';

	this.IMPOSTO_SITUACAO_TRIB_TIPO_ID = '';

	this.IMP_COD_SITUACAO = '';

	this.RETIDO_FONTE = '';

	this.RETIDO_FONTE_DESC = '';

	this.IMPOSTO_COD_RETENCAO_ID = '';

	this.COD_RETENCAO = '';

	this.REGIME_CUMULATIVO = '';

	this.REGIME_CUMULATIVO_DESC = '';

	this.IMPOSTO_TOTAL_FORMAT = '';

	this.IMPOSTO_ORIGEM_ID = '';

	this.IND_ORIG_CRED = '';

	this.NAT_BC_CRED = '';

	this.IMPOSTO_NATUREZA_BC_ID = '';

	this.IMP_FUNDAMENTACAO_LEGAL = '';

	this.RESERVADO_FISCO = '';

	this.PRODUTO_DESCRICAO = '';

	this.IMPOSTO_SITUACAO_ID = '';

	this.GERA_CPG_ICMS_ANTECIPADO = '';

	this.IMPOSTO_CONFIG_ID = '';
}
//busca todos os registros
function f_listagem_IMPOSTOS() {
	var tbody = document.getElementById('tb_lista_IMPOSTOS');
	var result = new Array();
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_IMPOSTOS_', '');
		result[result.length] = new f_register(id_linha);
	
		try {
			result[result.length-1].IMPOSTO_TIPO_ID = eval("document.forms[0].IMPOSTO_TIPO_ID_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMP_TIPO_DESC = eval("document.forms[0].IMP_TIPO_DESC_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DESCRICAO = eval("document.forms[0].DESCRICAO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].ALIQUOTA = eval("document.forms[0].ALIQUOTA_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].ALIQUOTA_FORMAT = eval("document.forms[0].ALIQUOTA_FORMAT_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].REDUCAO_BASE = eval("document.forms[0].REDUCAO_BASE_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].REDUCAO_BASE_FORMAT = eval("document.forms[0].REDUCAO_BASE_FORMAT_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].BASE_CALCULO = eval("document.forms[0].BASE_CALCULO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].BASE_CALCULO_FORMAT = eval("document.forms[0].BASE_CALCULO_FORMAT_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].BASE_CALCULO_REDUZIDA = eval("document.forms[0].BASE_CALCULO_REDUZIDA_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].BASE_CALCULO_REDUZIDA_FORMAT = eval("document.forms[0].BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_TOTAL = eval("document.forms[0].IMPOSTO_TOTAL_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_SITUACAO_TRIB_TIPO_ID = eval("document.forms[0].IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMP_COD_SITUACAO = eval("document.forms[0].IMP_COD_SITUACAO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].RETIDO_FONTE = eval("document.forms[0].RETIDO_FONTE_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].RETIDO_FONTE_DESC = eval("document.forms[0].RETIDO_FONTE_DESC_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_COD_RETENCAO_ID = eval("document.forms[0].IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].COD_RETENCAO = eval("document.forms[0].COD_RETENCAO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].REGIME_CUMULATIVO = eval("document.forms[0].REGIME_CUMULATIVO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].REGIME_CUMULATIVO_DESC = eval("document.forms[0].REGIME_CUMULATIVO_DESC_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_TOTAL_FORMAT = eval("document.forms[0].IMPOSTO_TOTAL_FORMAT_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_ORIGEM_ID = eval("document.forms[0].IMPOSTO_ORIGEM_ID_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IND_ORIG_CRED = eval("document.forms[0].IND_ORIG_CRED_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NAT_BC_CRED = eval("document.forms[0].NAT_BC_CRED_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_NATUREZA_BC_ID = eval("document.forms[0].IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMP_FUNDAMENTACAO_LEGAL = eval("document.forms[0].IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].RESERVADO_FISCO = eval("document.forms[0].RESERVADO_FISCO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].PRODUTO_DESCRICAO = eval("document.forms[0].PRODUTO_DESCRICAO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_SITUACAO_ID = eval("document.forms[0].IMPOSTO_SITUACAO_ID_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].GERA_CPG_ICMS_ANTECIPADO = eval("document.forms[0].GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].IMPOSTO_CONFIG_ID = eval("document.forms[0].IMPOSTO_CONFIG_ID_IMPOSTOS_"+id_linha).value;
		} catch(e) {}
	
	}
	return result;
}

function f_busca_campo_escravo_IMPOSTOS(v_valor_mestre, v_campo_escravo) {
	var tbody = document.getElementById('tb_lista_IMPOSTOS');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_IMPOSTOS_', '');
		with(document.forms[0]) {
				if (eval("document.forms[0]._IMPOSTOS_"+id_linha).value == v_valor_mestre) {
					return eval("document.forms[0]."+v_campo_escravo+"_IMPOSTOS_"+id_linha).value;
				}				
		}
	}
	return '';
}
function f_set_lista_min_IMPOSTOS(value) {

}

function f_before_selecionar_IMPOSTOS() {}
function f_on_seleciona_IMPOSTOS() {}
function f_on_salva_lista_IMPOSTOS() {}
function f_before_salvar_IMPOSTOS() { return true; }
function f_on_incluir_IMPOSTOS() {}
function f_on_excluir_IMPOSTOS() {}
</script>

<table width="100%" height="100%" align="left" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr id="tr_lista_botoes_IMPOSTOS">
    <td><table border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>

		
          <td style="display: none;"><button tabindex="465" class="botao" id="btn_lista_incluir_IMPOSTOS" onclick="f_incluir_IMPOSTOS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_incluir_IMPOSTOS" src="/_imagens/botoes/16x16/incluir.gif">&nbsp;Novo</button></td>
          <td style="display: none;">&nbsp;</td>
          <td style="display: none;"><button tabindex="466" disabled="" class="botao" id="btn_lista_excluir_IMPOSTOS" onclick="f_excluir_IMPOSTOS(document.forms[0].lista_selected_IMPOSTOS.value)" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_excluir_IMPOSTOS" src="https://levolog.kmm.com.br/_imagens/botoes/16x16/excluir_disable.gif">&nbsp;Excluir</button></td>
          <td style="display: none;">&nbsp;</td>
          <td style="display: none;"><button tabindex="467" class="botao" id="btn_lista_salvar_IMPOSTOS" onclick="f_salvar_IMPOSTOS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_salvar_IMPOSTOS" src="/_imagens/botoes/16x16/confirmar.gif">&nbsp;Salvar</button></td>
          <td style="display: none;">&nbsp;</td>
          <td style="display: none;"><button tabindex="468" class="botao" id="btn_lista_cancelar_IMPOSTOS" onclick="f_cancelar_IMPOSTOS()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_cancelar_IMPOSTOS" src="/_imagens/botoes/16x16/cancelar.gif">&nbsp;Cancelar</button></td>
          <td style="display: none;">&nbsp;</td>
		  
        </tr>
      </tbody></table></td>
  </tr>
  <tr><td height="4"></td></tr>
  <input name="lista_selected_IMPOSTOS" tabindex="469" id="lista_selected_IMPOSTOS" type="hidden" value="-1" fixo="1">
  <input name="lista_deleted_IMPOSTOS" tabindex="470" id="lista_deleted_IMPOSTOS" type="hidden" value="" fixo="1">
  <tr>
  
    <td height="200">
	<div class="lista" style="width: 115%; -ms-overflow-x: scroll;">
	<table width="100%" style="-ms-overflow-y: scroll;" border="0" cellspacing="1" cellpadding="3">
	<thead>
  <tr class="titulo_3" style="cursor: pointer;" onclick="sortColumn(event)">
    <td width="16" class="titulo_3" style="display: none;">&nbsp;</td>
  	
    <td width="5%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Tipo</nobr></td>
	
    <td width="12%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Produto</nobr></td>
	
    <td width="13%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Descrição</nobr></td>
	
    <td width="5%" align="right" class="titulo_3" type="caseinsensitivestring"><nobr>Alíquota %</nobr></td>
	
    <td width="8%" align="right" class="titulo_3" type="caseinsensitivestring"><nobr>Red. base de cálculo %</nobr></td>
	
    <td width="5%" align="right" class="titulo_3" type="caseinsensitivestring"><nobr>Base cálculo</nobr></td>
	
    <td width="5%" align="right" class="titulo_3" type="caseinsensitivestring"><nobr>Base cálculo reduzida</nobr></td>
	
    <td width="3%" align="right" class="titulo_3" type="caseinsensitivestring"><nobr>Valor</nobr></td>
	
    <td width="5%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Regime cumulativo</nobr></td>
	
    <td width="3%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Retido</nobr></td>
	
    <td width="5%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Cód. retenção</nobr></td>
	
    <td width="17%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Situação tributária</nobr></td>
	
    <td width="8%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Origem do crédito</nobr></td>
	
    <td width="8%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Natureza da base de crédito</nobr></td>
	
    <td width="13%" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Fundamentação legal</nobr></td>
	
  </tr>
  </thead>
  <tbody id="tb_lista_IMPOSTOS">
  <tr id="tr_lista_IMPOSTOS_0" style="cursor: pointer;"><td width="16" class="linha_1" style="display: none;"><div><img width="16" height="16" id="lista_padrao_IMPOSTOS_0" src="/_imagens/botoes/16x16/padrao.gif"><input name="PADRAO_IMPOSTOS_0" id="PADRAO_IMPOSTOS_0" type="hidden" value="1"><input name="IMPOSTO_TIPO_ID_IMPOSTOS_0" id="IMPOSTO_TIPO_ID_IMPOSTOS_0" type="hidden" value="1"><input name="IMP_TIPO_DESC_IMPOSTOS_0" id="IMP_TIPO_DESC_IMPOSTOS_0" type="hidden" value="ICMS"><input name="DESCRICAO_IMPOSTOS_0" id="DESCRICAO_IMPOSTOS_0" type="hidden" value="MG - ST 40 0% - Interna"><input name="ALIQUOTA_IMPOSTOS_0" id="ALIQUOTA_IMPOSTOS_0" type="hidden" value="0"><input name="ALIQUOTA_FORMAT_IMPOSTOS_0" id="ALIQUOTA_FORMAT_IMPOSTOS_0" type="hidden" value="  0,0000"><input name="REDUCAO_BASE_IMPOSTOS_0" id="REDUCAO_BASE_IMPOSTOS_0" type="hidden" value="0"><input name="REDUCAO_BASE_FORMAT_IMPOSTOS_0" id="REDUCAO_BASE_FORMAT_IMPOSTOS_0" type="hidden" value="  0,00"><input name="BASE_CALCULO_IMPOSTOS_0" id="BASE_CALCULO_IMPOSTOS_0" type="hidden" value="0"><input name="BASE_CALCULO_FORMAT_IMPOSTOS_0" id="BASE_CALCULO_FORMAT_IMPOSTOS_0" type="hidden" value="                 0,00"><input name="BASE_CALCULO_REDUZIDA_IMPOSTOS_0" id="BASE_CALCULO_REDUZIDA_IMPOSTOS_0" type="hidden" value="0"><input name="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_0" id="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_0" type="hidden" value="                 0,00"><input name="IMPOSTO_TOTAL_IMPOSTOS_0" id="IMPOSTO_TOTAL_IMPOSTOS_0" type="hidden" value="0"><input name="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_0" id="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_0" type="hidden" value="2"><input name="IMP_COD_SITUACAO_IMPOSTOS_0" id="IMP_COD_SITUACAO_IMPOSTOS_0" type="hidden" value="040 - Nacional, exceto as indicadas nos códigos 3, 4, 5 e 8 da Tabela A - Isenta"><input name="RETIDO_FONTE_IMPOSTOS_0" id="RETIDO_FONTE_IMPOSTOS_0" type="hidden" value="0"><input name="RETIDO_FONTE_DESC_IMPOSTOS_0" id="RETIDO_FONTE_DESC_IMPOSTOS_0" type="hidden" value="Não"><input name="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_0" id="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_0" type="hidden" value=""><input name="COD_RETENCAO_IMPOSTOS_0" id="COD_RETENCAO_IMPOSTOS_0" type="hidden" value=""><input name="REGIME_CUMULATIVO_IMPOSTOS_0" id="REGIME_CUMULATIVO_IMPOSTOS_0" type="hidden" value="0"><input name="REGIME_CUMULATIVO_DESC_IMPOSTOS_0" id="REGIME_CUMULATIVO_DESC_IMPOSTOS_0" type="hidden" value="Não"><input name="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_0" id="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_0" type="hidden" value="                 0,00"><input name="IMPOSTO_ORIGEM_ID_IMPOSTOS_0" id="IMPOSTO_ORIGEM_ID_IMPOSTOS_0" type="hidden" value="5"><input name="IND_ORIG_CRED_IMPOSTOS_0" id="IND_ORIG_CRED_IMPOSTOS_0" type="hidden" value="Nacional, exceto as indicadas nos códigos 3, 4, 5 e 8"><input name="NAT_BC_CRED_IMPOSTOS_0" id="NAT_BC_CRED_IMPOSTOS_0" type="hidden" value=""><input name="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_0" id="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_0" type="hidden" value=""><input name="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_0" id="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_0" type="hidden" value="Isento ICMS conf. item 144 da parte 1 do anexo I do RICMS/MG."><input name="RESERVADO_FISCO_IMPOSTOS_0" id="RESERVADO_FISCO_IMPOSTOS_0" type="hidden" value=""><input name="PRODUTO_DESCRICAO_IMPOSTOS_0" id="PRODUTO_DESCRICAO_IMPOSTOS_0" type="hidden" value="FRETE RODOVIARIO"><input name="IMPOSTO_SITUACAO_ID_IMPOSTOS_0" id="IMPOSTO_SITUACAO_ID_IMPOSTOS_0" type="hidden" value="184"><input name="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_0" id="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_0" type="hidden" value="0"><input name="IMPOSTO_CONFIG_ID_IMPOSTOS_0" id="IMPOSTO_CONFIG_ID_IMPOSTOS_0" type="hidden" value="219"></div></td><td align="left" class="linha_1" valign="top">ICMS</td><td align="left" class="linha_1" valign="top">FRETE&nbsp;RODOVIARIO</td><td align="left" class="linha_1" valign="top">MG&nbsp;-&nbsp;ST&nbsp;40&nbsp;0%&nbsp;-&nbsp;Interna</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;0,0000</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="left" class="linha_1" valign="top">Não</td><td align="left" class="linha_1" valign="top">Não</td><td align="left" class="linha_1" valign="top"></td><td align="left" class="linha_1" valign="top">040&nbsp;-&nbsp;Nacional,&nbsp;exceto&nbsp;as&nbsp;indicadas&nbsp;nos&nbsp;códigos&nbsp;3,&nbsp;4,&nbsp;5&nbsp;e&nbsp;8&nbsp;da&nbsp;Tabela&nbsp;A&nbsp;-&nbsp;Isenta</td><td align="left" class="linha_1" valign="top">Nacional,&nbsp;exceto&nbsp;as&nbsp;indicadas&nbsp;nos&nbsp;códigos&nbsp;3,&nbsp;4,&nbsp;5&nbsp;e&nbsp;8</td><td align="left" class="linha_1" valign="top"></td><td align="left" class="linha_1" valign="top">Isento&nbsp;ICMS&nbsp;conf.&nbsp;item&nbsp;144&nbsp;da&nbsp;parte&nbsp;1&nbsp;do&nbsp;anexo&nbsp;I&nbsp;do&nbsp;RICMS/MG.</td></tr><tr id="tr_lista_IMPOSTOS_1" style="cursor: pointer;"><td width="16" class="linha_1" style="display: none;"><div><img width="16" height="16" id="lista_padrao_IMPOSTOS_1" style="display: none;" src="/_imagens/botoes/16x16/padrao.gif"><input name="PADRAO_IMPOSTOS_1" id="PADRAO_IMPOSTOS_1" type="hidden" value="0"><input name="IMPOSTO_TIPO_ID_IMPOSTOS_1" id="IMPOSTO_TIPO_ID_IMPOSTOS_1" type="hidden" value="4"><input name="IMP_TIPO_DESC_IMPOSTOS_1" id="IMP_TIPO_DESC_IMPOSTOS_1" type="hidden" value="PIS"><input name="DESCRICAO_IMPOSTOS_1" id="DESCRICAO_IMPOSTOS_1" type="hidden" value="PIS 1,65%"><input name="ALIQUOTA_IMPOSTOS_1" id="ALIQUOTA_IMPOSTOS_1" type="hidden" value="1.65"><input name="ALIQUOTA_FORMAT_IMPOSTOS_1" id="ALIQUOTA_FORMAT_IMPOSTOS_1" type="hidden" value="  1,6500"><input name="REDUCAO_BASE_IMPOSTOS_1" id="REDUCAO_BASE_IMPOSTOS_1" type="hidden" value="0"><input name="REDUCAO_BASE_FORMAT_IMPOSTOS_1" id="REDUCAO_BASE_FORMAT_IMPOSTOS_1" type="hidden" value="  0,00"><input name="BASE_CALCULO_IMPOSTOS_1" id="BASE_CALCULO_IMPOSTOS_1" type="hidden" value="0"><input name="BASE_CALCULO_FORMAT_IMPOSTOS_1" id="BASE_CALCULO_FORMAT_IMPOSTOS_1" type="hidden" value="                 0,00"><input name="BASE_CALCULO_REDUZIDA_IMPOSTOS_1" id="BASE_CALCULO_REDUZIDA_IMPOSTOS_1" type="hidden" value="0"><input name="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_1" id="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_1" type="hidden" value="                 0,00"><input name="IMPOSTO_TOTAL_IMPOSTOS_1" id="IMPOSTO_TOTAL_IMPOSTOS_1" type="hidden" value="0"><input name="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_1" id="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_1" type="hidden" value="1"><input name="IMP_COD_SITUACAO_IMPOSTOS_1" id="IMP_COD_SITUACAO_IMPOSTOS_1" type="hidden" value="01 - Operação Tributável com Alíquota Básica"><input name="RETIDO_FONTE_IMPOSTOS_1" id="RETIDO_FONTE_IMPOSTOS_1" type="hidden" value="0"><input name="RETIDO_FONTE_DESC_IMPOSTOS_1" id="RETIDO_FONTE_DESC_IMPOSTOS_1" type="hidden" value="Não"><input name="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_1" id="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_1" type="hidden" value=""><input name="COD_RETENCAO_IMPOSTOS_1" id="COD_RETENCAO_IMPOSTOS_1" type="hidden" value=""><input name="REGIME_CUMULATIVO_IMPOSTOS_1" id="REGIME_CUMULATIVO_IMPOSTOS_1" type="hidden" value="0"><input name="REGIME_CUMULATIVO_DESC_IMPOSTOS_1" id="REGIME_CUMULATIVO_DESC_IMPOSTOS_1" type="hidden" value="Não"><input name="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_1" id="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_1" type="hidden" value="                 0,00"><input name="IMPOSTO_ORIGEM_ID_IMPOSTOS_1" id="IMPOSTO_ORIGEM_ID_IMPOSTOS_1" type="hidden" value="1"><input name="IND_ORIG_CRED_IMPOSTOS_1" id="IND_ORIG_CRED_IMPOSTOS_1" type="hidden" value="Operação no Mercado Interno"><input name="NAT_BC_CRED_IMPOSTOS_1" id="NAT_BC_CRED_IMPOSTOS_1" type="hidden" value=""><input name="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_1" id="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_1" type="hidden" value=""><input name="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_1" id="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_1" type="hidden" value=""><input name="RESERVADO_FISCO_IMPOSTOS_1" id="RESERVADO_FISCO_IMPOSTOS_1" type="hidden" value=""><input name="PRODUTO_DESCRICAO_IMPOSTOS_1" id="PRODUTO_DESCRICAO_IMPOSTOS_1" type="hidden" value="FRETE RODOVIARIO"><input name="IMPOSTO_SITUACAO_ID_IMPOSTOS_1" id="IMPOSTO_SITUACAO_ID_IMPOSTOS_1" type="hidden" value="114"><input name="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_1" id="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_1" type="hidden" value="0"><input name="IMPOSTO_CONFIG_ID_IMPOSTOS_1" id="IMPOSTO_CONFIG_ID_IMPOSTOS_1" type="hidden" value="215"></div></td><td align="left" class="linha_1" valign="top">PIS</td><td align="left" class="linha_1" valign="top">FRETE&nbsp;RODOVIARIO</td><td align="left" class="linha_1" valign="top">PIS&nbsp;1,65%</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;1,6500</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="left" class="linha_1" valign="top">Não</td><td align="left" class="linha_1" valign="top">Não</td><td align="left" class="linha_1" valign="top"></td><td align="left" class="linha_1" valign="top">01&nbsp;-&nbsp;Operação&nbsp;Tributável&nbsp;com&nbsp;Alíquota&nbsp;Básica</td><td align="left" class="linha_1" valign="top">Operação&nbsp;no&nbsp;Mercado&nbsp;Interno</td><td align="left" class="linha_1" valign="top"></td><td align="left" class="linha_1" valign="top"></td></tr><tr id="tr_lista_IMPOSTOS_2" style="cursor: pointer;"><td width="16" class="linha_1" style="display: none;"><div><img width="16" height="16" id="lista_padrao_IMPOSTOS_2" style="display: none;" src="/_imagens/botoes/16x16/padrao.gif"><input name="PADRAO_IMPOSTOS_2" id="PADRAO_IMPOSTOS_2" type="hidden" value="0"><input name="IMPOSTO_TIPO_ID_IMPOSTOS_2" id="IMPOSTO_TIPO_ID_IMPOSTOS_2" type="hidden" value="5"><input name="IMP_TIPO_DESC_IMPOSTOS_2" id="IMP_TIPO_DESC_IMPOSTOS_2" type="hidden" value="COFINS"><input name="DESCRICAO_IMPOSTOS_2" id="DESCRICAO_IMPOSTOS_2" type="hidden" value="COFINS 7,6%"><input name="ALIQUOTA_IMPOSTOS_2" id="ALIQUOTA_IMPOSTOS_2" type="hidden" value="7.6"><input name="ALIQUOTA_FORMAT_IMPOSTOS_2" id="ALIQUOTA_FORMAT_IMPOSTOS_2" type="hidden" value="  7,6000"><input name="REDUCAO_BASE_IMPOSTOS_2" id="REDUCAO_BASE_IMPOSTOS_2" type="hidden" value="0"><input name="REDUCAO_BASE_FORMAT_IMPOSTOS_2" id="REDUCAO_BASE_FORMAT_IMPOSTOS_2" type="hidden" value="  0,00"><input name="BASE_CALCULO_IMPOSTOS_2" id="BASE_CALCULO_IMPOSTOS_2" type="hidden" value="0"><input name="BASE_CALCULO_FORMAT_IMPOSTOS_2" id="BASE_CALCULO_FORMAT_IMPOSTOS_2" type="hidden" value="                 0,00"><input name="BASE_CALCULO_REDUZIDA_IMPOSTOS_2" id="BASE_CALCULO_REDUZIDA_IMPOSTOS_2" type="hidden" value="0"><input name="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_2" id="BASE_CALCULO_REDUZIDA_FORMAT_IMPOSTOS_2" type="hidden" value="                 0,00"><input name="IMPOSTO_TOTAL_IMPOSTOS_2" id="IMPOSTO_TOTAL_IMPOSTOS_2" type="hidden" value="0"><input name="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_2" id="IMPOSTO_SITUACAO_TRIB_TIPO_ID_IMPOSTOS_2" type="hidden" value="1"><input name="IMP_COD_SITUACAO_IMPOSTOS_2" id="IMP_COD_SITUACAO_IMPOSTOS_2" type="hidden" value="01 - Operação Tributável com Alíquota Básica"><input name="RETIDO_FONTE_IMPOSTOS_2" id="RETIDO_FONTE_IMPOSTOS_2" type="hidden" value="0"><input name="RETIDO_FONTE_DESC_IMPOSTOS_2" id="RETIDO_FONTE_DESC_IMPOSTOS_2" type="hidden" value="Não"><input name="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_2" id="IMPOSTO_COD_RETENCAO_ID_IMPOSTOS_2" type="hidden" value=""><input name="COD_RETENCAO_IMPOSTOS_2" id="COD_RETENCAO_IMPOSTOS_2" type="hidden" value=""><input name="REGIME_CUMULATIVO_IMPOSTOS_2" id="REGIME_CUMULATIVO_IMPOSTOS_2" type="hidden" value="0"><input name="REGIME_CUMULATIVO_DESC_IMPOSTOS_2" id="REGIME_CUMULATIVO_DESC_IMPOSTOS_2" type="hidden" value="Não"><input name="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_2" id="IMPOSTO_TOTAL_FORMAT_IMPOSTOS_2" type="hidden" value="                 0,00"><input name="IMPOSTO_ORIGEM_ID_IMPOSTOS_2" id="IMPOSTO_ORIGEM_ID_IMPOSTOS_2" type="hidden" value="3"><input name="IND_ORIG_CRED_IMPOSTOS_2" id="IND_ORIG_CRED_IMPOSTOS_2" type="hidden" value="Operação no Mercado Interno"><input name="NAT_BC_CRED_IMPOSTOS_2" id="NAT_BC_CRED_IMPOSTOS_2" type="hidden" value=""><input name="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_2" id="IMPOSTO_NATUREZA_BC_ID_IMPOSTOS_2" type="hidden" value=""><input name="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_2" id="IMP_FUNDAMENTACAO_LEGAL_IMPOSTOS_2" type="hidden" value=""><input name="RESERVADO_FISCO_IMPOSTOS_2" id="RESERVADO_FISCO_IMPOSTOS_2" type="hidden" value=""><input name="PRODUTO_DESCRICAO_IMPOSTOS_2" id="PRODUTO_DESCRICAO_IMPOSTOS_2" type="hidden" value="FRETE RODOVIARIO"><input name="IMPOSTO_SITUACAO_ID_IMPOSTOS_2" id="IMPOSTO_SITUACAO_ID_IMPOSTOS_2" type="hidden" value="147"><input name="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_2" id="GERA_CPG_ICMS_ANTECIPADO_IMPOSTOS_2" type="hidden" value="0"><input name="IMPOSTO_CONFIG_ID_IMPOSTOS_2" id="IMPOSTO_CONFIG_ID_IMPOSTOS_2" type="hidden" value="214"></div></td><td align="left" class="linha_1" valign="top">COFINS</td><td align="left" class="linha_1" valign="top">FRETE&nbsp;RODOVIARIO</td><td align="left" class="linha_1" valign="top">COFINS&nbsp;7,6%</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;7,6000</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="right" class="linha_1" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,00</td><td align="left" class="linha_1" valign="top">Não</td><td align="left" class="linha_1" valign="top">Não</td><td align="left" class="linha_1" valign="top"></td><td align="left" class="linha_1" valign="top">01&nbsp;-&nbsp;Operação&nbsp;Tributável&nbsp;com&nbsp;Alíquota&nbsp;Básica</td><td align="left" class="linha_1" valign="top">Operação&nbsp;no&nbsp;Mercado&nbsp;Interno</td><td align="left" class="linha_1" valign="top"></td><td align="left" class="linha_1" valign="top"></td></tr></tbody>
</table>

	</div></td>
  </tr>
</tbody></table>

                        
                    </td>
                </tr>
            </tbody></table>
        </td>
  </tr>
</tbody></table>

                                </fieldset>
                            </td>
               </tr>

               <tr style="display: none;">
                            <td class="td_aba_corpo" valign="top" colspan="10">
                                <fieldset tabindex="471" id="fds_auditoria_comercial" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	<script type="text/javascript">
	function f_busca_versoes() {
		with(document.forms[0]) {
			f_query_ajax('/aplicacoes/controle_documentos/cte/consultas.cfm' +
						'?consulta=7' +
						'&conhecimento_id=' + CONHECIMENTO_ID.value
						,function(obj) {
							document.getElementById('td_auditoria_comercial').innerHTML = obj;
						});
		}
	}
	
	function f_mostrar_tarifas(p_versao_id) {
		document.getElementById('BTN_MOSTRAR_TARIFAS_' + p_versao_id).style.display = 'none';
		document.getElementById('BTN_OCULTAR_TARIFAS_' + p_versao_id).style.display = '';
		
		document.getElementById('tr_versao_' + p_versao_id).style.display = '';
		
		f_busca_tarifas(p_versao_id);
	}
	
	function f_ocultar_tarifas(p_versao_id) {
		document.getElementById('BTN_MOSTRAR_TARIFAS_' + p_versao_id).style.display = '';
		document.getElementById('BTN_OCULTAR_TARIFAS_' + p_versao_id).style.display = 'none';
		
		document.getElementById('tr_versao_' + p_versao_id).style.display = 'none';
		
		document.getElementById('td_versao_' + p_versao_id).innerHTML = '';		
	}
	
	function f_busca_tarifas(p_versao_id) {
		f_query_ajax('/aplicacoes/controle_documentos/cte/consultas.cfm' +
					'?consulta=8' +
					'&versao_id=' + p_versao_id
					,function(obj) {
						document.getElementById('td_versao_' + p_versao_id).innerHTML = obj;
					});	
	}
</script>
<table width="100%" class="texto" border="0" cellspacing="0" cellpadding="0">
    <tbody><tr>
    	<td id="td_auditoria_comercial" style="padding: 5px;"></td>
    </tr>
</tbody></table>
                                </fieldset>
                            </td>
               </tr>

                   <tr style="display: none;">
                            <td class="td_aba_corpo" valign="top" colspan="10">
                                <fieldset tabindex="472" id="fds_observacoes" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	
<script type="text/javascript">
	function f_vale_pedagio(){
		with(document.forms[0]) {

			document.getElementById('NUM_CARTAO_VALE_PEDAGIO').value = '';
			document.getElementById('NUM_CARTAO_VALE_PEDAGIO_ANTIGO').value = '';
			document.getElementById('LBL_NUM_CARTAO_VALE_PEDAGIO').innerHTML = '';

			if(UTILIZA_VALE_PEDAGIO.value == 1){
				document.getElementById('tr_vale_pedagio').style.display = '';

				document.getElementById('CNPJ_OPERADORA').setAttribute('obrigatorio' ,1);
				document.getElementById('OPERADORA_RAZAO_SOCIAL').setAttribute('obrigatorio' ,1);
				document.getElementById('COD_PESSOA_OPERADORA').setAttribute('obrigatorio' ,1);
				document.getElementById('CNPJ_FORNECEDORA').setAttribute('obrigatorio' ,1);
				document.getElementById('FORNECEDORA_RAZAO_SOCIAL').setAttribute('obrigatorio' ,1);
				document.getElementById('COD_PESSOA_FORNECEDORA').setAttribute('obrigatorio' ,1);
				document.getElementById('NUM_COMPROVANTE').setAttribute('obrigatorio' ,0);
				document.getElementById('VALOR_COMPROVANTE').setAttribute('obrigatorio' ,0);
			}else{
				document.getElementById('tr_vale_pedagio').style.display = 'none';
				document.getElementById('CNPJ_OPERADORA').setAttribute('obrigatorio' ,0);
				document.getElementById('OPERADORA_RAZAO_SOCIAL').setAttribute('obrigatorio' ,0);
				document.getElementById('COD_PESSOA_OPERADORA').setAttribute('obrigatorio' ,0);
				document.getElementById('CNPJ_FORNECEDORA').setAttribute('obrigatorio' ,0);
				document.getElementById('FORNECEDORA_RAZAO_SOCIAL').setAttribute('obrigatorio' ,0);
				document.getElementById('COD_PESSOA_FORNECEDORA').setAttribute('obrigatorio' ,0);
				document.getElementById('NUM_COMPROVANTE').obrigatorio = 0;
				document.getElementById('VALOR_COMPROVANTE').setAttribute('obrigatorio' ,0);
			}
		}
	}
	
	function fnc_get_operacao(){
		with(document.forms[0]) {
			return OPERACAO_ID.value;
		}
	}

	function f_busca_operadora() {
		with(document.forms[0]) {
			COD_PESSOA_OPERADORA.value = '';
			OPERADORA_RAZAO_SOCIAL.value = '';

			if(!CNPJ_OPERADORA.value) {
				return;
			}

			OPERADORA_RAZAO_SOCIAL.value = 'Buscando operadora...';

			f_query_wddx('/_transportes/consulta/cfc_pessoa.cfc?method=getPessoa'
						,'tipo_pessoa=0&completo=1&cnpj_cpf=' + CNPJ_OPERADORA.value + '&vale_pedagio=1&operacao_id=' + OPERACAO_ID.value
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.cod_pessoa.length > 0) {
									COD_PESSOA_OPERADORA.value = obj.struct.cod_pessoa[0];
									OPERADORA_RAZAO_SOCIAL.value = obj.struct.razao_social[0];
									f_busca_vale_pedagio_conf();
								}
								else {
									OPERADORA_RAZAO_SOCIAL.value = 'Operadora não encontrada.'
								}
							}
						});
		}
	}

	function f_busca_fornecedora() {
		with(document.forms[0]) {
			COD_PESSOA_FORNECEDORA.value = '';
			FORNECEDORA_RAZAO_SOCIAL.value = '';

			if(!CNPJ_FORNECEDORA.value) {
				return;
			}

			FORNECEDORA_RAZAO_SOCIAL.value = 'Buscando fornecedora...';

			f_query_wddx('/_transportes/consulta/cfc_pessoa.cfc?method=getPessoa'
						,'tipo_pessoa=0&completo=1&cnpj_cpf=' + CNPJ_FORNECEDORA.value
						,function(obj) {
							if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
								if(obj.struct.cod_pessoa.length > 0) {
									COD_PESSOA_FORNECEDORA.value = obj.struct.cod_pessoa[0];
									FORNECEDORA_RAZAO_SOCIAL.value = obj.struct.razao_social[0];
									f_busca_vale_pedagio_conf();
								}
								else {
									FORNECEDORA_RAZAO_SOCIAL.value = 'Fornecedora não encontrada.'
								}
							}
						});
		}
	}

	function f_busca_vale_pedagio_conf() {
		with(document.forms[0]) {
			if(UTILIZA_VALE_PEDAGIO.disabled
			   && (!COD_PESSOA_FORNECEDORA.value || !COD_PESSOA_OPERADORA.value)) {
 			    document.getElementById('MENSAGEM_CONFIG_VALE_PEDAGIO').innerHTML = '';
				return;
			}

			CONSULTA.value = 23;
			target = 'consultas';
			action = 'consultas.cfm';
			submit();
		}
	}

	function f_muda_fornecedora(p_valor){
		with(document.forms[0]) {
			switch (Number(p_valor)){
				case 0 :
					//atribui valores
					CNPJ_FORNECEDORA.value 	  		= REM_CNPJ_CPF.value;
					FORNECEDORA_RAZAO_SOCIAL.value  = REM_RAZAO_SOCIAL.value;
					COD_PESSOA_FORNECEDORA.value 	= COD_REMETENTE.value;
					//desabilita campos
					CNPJ_FORNECEDORA.readOnly 			= true;
					COD_PESSOA_FORNECEDORA.readOnly 	= true;
					f_busca_vale_pedagio_conf();
					return;
				case 1 :
					//atribui valores
					CNPJ_FORNECEDORA.value 	  		= COLETA_CNPJ_CPF.value;
					FORNECEDORA_RAZAO_SOCIAL.value  = COLETA_RAZAO_SOCIAL.value;
					COD_PESSOA_FORNECEDORA.value 	= COLETA_COD_PESSOA.value;
					//desabilita campos
					CNPJ_FORNECEDORA.readOnly 			= true;
					COD_PESSOA_FORNECEDORA.readOnly 	= true;
					f_busca_vale_pedagio_conf();
					return;
				case 2 :
					//atribui valores
					CNPJ_FORNECEDORA.value 	  		= DEST_CNPJ_CPF.value;
					FORNECEDORA_RAZAO_SOCIAL.value  = DEST_RAZAO_SOCIAL.value;
					COD_PESSOA_FORNECEDORA.value 	= COD_DESTINATARIO.value;
					//desabilita campos
					CNPJ_FORNECEDORA.readOnly 			= true;
					COD_PESSOA_FORNECEDORA.readOnly 	= true;
					f_busca_vale_pedagio_conf();
					return;
				case 3 :
					//atribui valores
					CNPJ_FORNECEDORA.value 	  		= RED_CNPJ_CPF.value;
					FORNECEDORA_RAZAO_SOCIAL.value  = RED_RAZAO_SOCIAL.value;
					COD_PESSOA_FORNECEDORA.value 	= COD_REDESPACHO.value;
					//desabilita campos
					CNPJ_FORNECEDORA.readOnly 			= true;
					COD_PESSOA_FORNECEDORA.readOnly 	= true;
					f_busca_vale_pedagio_conf();
					return;
				case 4 :
					//atribui valores
					CNPJ_FORNECEDORA.value 	  		= COB_CNPJ_CPF.value;
					FORNECEDORA_RAZAO_SOCIAL.value  = COB_RAZAO_SOCIAL.value;
					COD_PESSOA_FORNECEDORA.value 	= COD_CLIENTE_COBRANCA.value;
					//desabilita campos
					CNPJ_FORNECEDORA.readOnly 			= true;
					COD_PESSOA_FORNECEDORA.readOnly 	= true;
					f_busca_vale_pedagio_conf();
					return;
			    case 6 :
					//atribui valores
					CNPJ_FORNECEDORA.value 	  		= CNPJ_TRANSPORTADORA.value;
					FORNECEDORA_RAZAO_SOCIAL.value  = NOME_TRANSPORTADORA.value;
					COD_PESSOA_FORNECEDORA.value 	= COD_TRANSPORTADORA.value;
					//desabilita campos
					CNPJ_FORNECEDORA.readOnly 			= true;
					COD_PESSOA_FORNECEDORA.readOnly 	= true;
					f_busca_vale_pedagio_conf();
					return;

				default:
					//atribui valores
					CNPJ_FORNECEDORA.value 	  		= '';
					FORNECEDORA_RAZAO_SOCIAL.value  = '';
					COD_PESSOA_FORNECEDORA.value 	= '';
					NUM_COMPROVANTE.value 			= '';
					VALOR_COMPROVANTE.value 		= '';

					//habilita campos
					CNPJ_FORNECEDORA.readOnly 			= false;
					COD_PESSOA_FORNECEDORA.readOnly 	= false;
					NUM_COMPROVANTE.readOnly 			= false;
					VALOR_COMPROVANTE.readOnly 			= false;

					NUM_COMPROVANTE.disabled 			= false;
					VALOR_COMPROVANTE.disabled 			= false;
					f_busca_vale_pedagio_conf();
					return;
			}
		}
	}

	function f_bloquear_valeped_operadora(p_bloqueado, p_bloqueia_fornecedora, p_bloqueia_operadora, p_bloqueia_comprovante, p_bloqueia_grid){
		with(document.forms[0]) {
			CNPJ_OPERADORA.readOnly			         = (p_bloqueado && p_bloqueia_operadora == 1);
			COD_PESSOA_OPERADORA.readOnly	         = (p_bloqueado && p_bloqueia_operadora == 1);
			FORNECEDOR_VALE_PEDAGIO_0.disabled       = p_bloqueado;
			FORNECEDOR_VALE_PEDAGIO_1.disabled       = p_bloqueado;
			FORNECEDOR_VALE_PEDAGIO_2.disabled       = p_bloqueado;
			FORNECEDOR_VALE_PEDAGIO_3.disabled       = p_bloqueado;
			FORNECEDOR_VALE_PEDAGIO_4.disabled       = p_bloqueado;
			FORNECEDOR_VALE_PEDAGIO_5.disabled       = p_bloqueado;
			FORNECEDOR_VALE_PEDAGIO_6.disabled       = p_bloqueado;
			CNPJ_FORNECEDORA.disabled	             = (p_bloqueado && p_bloqueia_fornecedora == 1);
			FORNECEDORA_RAZAO_SOCIAL.disabled        = (p_bloqueado && p_bloqueia_fornecedora == 1);
			COD_PESSOA_FORNECEDORA.disabled          = (p_bloqueado && p_bloqueia_fornecedora == 1);
			NUM_COMPROVANTE.disabled	             = (p_bloqueado && p_bloqueia_comprovante == 1);
			VALOR_COMPROVANTE.disabled			     = (p_bloqueado && p_bloqueia_comprovante == 1);
			tr_lista_botoes_VALE_PEDAGIO.disabled    = (p_bloqueado && p_bloqueia_grid == 1);
			btn_lista_incluir_VALE_PEDAGIO.disabled	 = (p_bloqueado && p_bloqueia_grid == 1);
			btn_lista_excluir_VALE_PEDAGIO.disabled	 = (p_bloqueado && p_bloqueia_grid == 1);
			btn_lista_salvar_VALE_PEDAGIO.disabled	 = (p_bloqueado && p_bloqueia_grid == 1);
			btn_lista_cancelar_VALE_PEDAGIO.disabled = (p_bloqueado && p_bloqueia_grid == 1);

			if (p_bloqueado && p_bloqueia_fornecedora == 1){
			    CNPJ_FORNECEDORA.setAttribute('obrigatorio', 0);
			    FORNECEDORA_RAZAO_SOCIAL.setAttribute('obrigatorio', 0);
			    COD_PESSOA_FORNECEDORA.setAttribute('obrigatorio', 0);
			}
		}
	}

	function f_bloquear_valeped_responsavel(p_bloqueado){
		with(document.forms[0]) {
			CNPJ_RESPONSAVEL.readOnly			= p_bloqueado;
			RESPONSAVEL_RAZAO_SOCIAL.readOnly	= p_bloqueado;
			COD_PESSOA_RESPONSAVEL.readOnly		= p_bloqueado;
		}
	}

	function f_desabilita_pedagio_check(p_valor){
		with(document.forms[0]) {
			document.getElementById('FORNECEDOR_VALE_PEDAGIO_0').disabled = p_valor;
			document.getElementById('FORNECEDOR_VALE_PEDAGIO_1').disabled = p_valor;
			document.getElementById('FORNECEDOR_VALE_PEDAGIO_2').disabled = p_valor;
			document.getElementById('FORNECEDOR_VALE_PEDAGIO_3').disabled = p_valor;
			document.getElementById('FORNECEDOR_VALE_PEDAGIO_4').disabled = p_valor;
			document.getElementById('FORNECEDOR_VALE_PEDAGIO_5').disabled = p_valor;
			document.getElementById('FORNECEDOR_VALE_PEDAGIO_6').disabled = p_valor;
		}
	}

	function f_limpa_vale_pedagio(){
		with(document.forms[0]) {
			document.getElementById('MENSAGEM_RETORNO_VALE_PEDAGIO').innerHTML = '';
			UTILIZA_VALE_PEDAGIO.value = 0;
			UTILIZA_VALE_PEDAGIO.onchange();
			f_limpar_VALE_PEDAGIO();
		}
	}

	function f_troca_cartao(){
	   with(document.forms[0]){
		   document.getElementById('NUM_CARTAO_VALE_PEDAGIO_ANTIGO').value = document.getElementById('NUM_CARTAO_VALE_PEDAGIO').oldvalue;
		   document.getElementById('LBL_NUM_CARTAO_vALE_PEDAGIO').innerHTML = '';
	   }
	}
</script>
<fieldset tabindex="473"><legend>Observações</legend>
<table width="100%" border="0" cellspacing="1" cellpadding="3">
   <tbody><tr>
      <td><span class="texto">
        <input name="FUNDAMENTACAO_LEGAL" tabindex="474" id="FUNDAMENTACAO_LEGAL" style="width: 100%;" type="text" readonly="readonly">
        </span>
     <textarea name="OBSERVACAO" tabindex="475" id="OBSERVACAO" style="width: 100%;" rows="5">CTe Complementar ao CTe: 147928/1
</textarea>
	 <textarea name="OBSERVACAO_AUTOMATICA" tabindex="476" id="OBSERVACAO_AUTOMATICA" style="width: 100%;" rows="5" readonly=""></textarea></td>
  </tr>
</tbody></table>
</fieldset>
<fieldset tabindex="477" id="fld_obs_globalizado" style="display: none;"><legend>Observação para CT-e globalizado</legend>
<table width="100%" border="0" cellspacing="1" cellpadding="3">
   <tbody><tr>
      <td><textarea name="OBSERVACAO_GLOBALIZADO" tabindex="478" id="OBSERVACAO_GLOBALIZADO" style="width: 100%;" rows="5"></textarea></td>
   </tr>
</tbody></table>
</fieldset>
</fieldset>
<fieldset tabindex="479"><legend>Rodapé</legend>
<table width="100%" border="0" cellspacing="1" cellpadding="3">
   <tbody><tr>
      <td><textarea name="RODAPE" tabindex="480" style="width: 100%;" rows="5"></textarea></td>
   </tr>
</tbody></table>
</fieldset>

<fieldset tabindex="481"><legend>Vale Pedágio</legend>
<table width="100%" border="0" cellspacing="1" cellpadding="3">
   <tbody><tr>
      <td class="texto">Utiliza vale Pedágio:
          <select name="UTILIZA_VALE_PEDAGIO" tabindex="482" class="requerido_form" id="UTILIZA_VALE_PEDAGIO" onchange="f_vale_pedagio();" display="UTILIZA VALE PEDÁGIO" obrigatorio="1">
              <option value="0">Não</option>
              <option value="1">Sim</option>
          </select>
          <label id="MENSAGEM_RETORNO_VALE_PEDAGIO" style="color: red;"></label>
      </td>
   </tr>
   <tr id="tr_vale_pedagio" style="display: none;">
      <td>
        <input name="CONHECIMENTO_VALE_PEDAGIO_ID" tabindex="483" id="CONHECIMENTO_VALE_PEDAGIO_ID" type="hidden" secao="VALE_PEDAGIO">
        <input name="CONHECIMENTO_VALE_PEDAGIO_CHAVE" tabindex="484" id="CONHECIMENTO_VALE_PEDAGIO_CHAVE" type="hidden" secao="VALE_PEDAGIO">
        <fieldset tabindex="485"><legend>Informações dos Vales Pedágios</legend>
        <table width="100%" height="100%" border="0" cellspacing="3" cellpadding="0">
            <tbody><tr>
                <td width="1%" class="texto" nowrap="">Operadora:</td>
                <td width="99%" class="texto"><input name="CNPJ_OPERADORA" tabindex="486" id="CNPJ_OPERADORA" style="width: 110px;" onkeypress="return f_formata(this, '00000000000000')" onchange="f_busca_operadora()" type="text" maxlength="14" fixo="1" display="CNPJ DA OPERADORA" obrigatorio="0" tipo="numerico" secao="VALE_PEDAGIO" manter="1">
                    <input name="OPERADORA_RAZAO_SOCIAL" tabindex="487" id="OPERADORA_RAZAO_SOCIAL" style="width: 400px;" type="text" readonly="true" fixo="1" display="OPERADORA" obrigatorio="0" secao="VALE_PEDAGIO" manter="1">
                    <input name="COD_PESSOA_OPERADORA" tabindex="488" id="COD_PESSOA_OPERADORA" type="hidden" fixo="1" display="OPERADORA" obrigatorio="0" secao="VALE_PEDAGIO" manter="1">
                    <button tabindex="489" class="botao-16x16" onclick="if(this.form.CNPJ_OPERADORA.readOnly || this.form.CNPJ_OPERADORA.disabled) { return; } NewWindow('/_consultas/localizar_pessoa.cfm?tipo_pessoa=0&amp;vale_pedagio=1&amp;operacao_id=' + fnc_get_operacao() + '&amp;field=COD_PESSOA,CNPJ_CPF,RAZAO_SOCIAL&amp;campo=COD_PESSOA_OPERADORA,CNPJ_OPERADORA,OPERADORA_RAZAO_SOCIAL&amp;funcao=f_busca_vale_pedagio_conf()', '_blank', 800, 600, 'yes')" type="button"><img width="16" height="16" title="Buscar Operadora" align="absmiddle" alt="Buscar Operadora" src="/_imagens/botoes/16x16/buscar.gif"></button></td>
            </tr>
            <tr class="texto">
               <td class="texto" nowrap="nowrap">
                  Cartão Vale Pedágio:
               </td>
               <td class="texto" colspan="9">
                  <input name="NUM_CARTAO_VALE_PEDAGIO" tabindex="490" id="NUM_CARTAO_VALE_PEDAGIO" onfocus="this.oldvalue = this.value;" onchange="f_troca_cartao()" type="text" display="CARTÃO VALE PEDÁGIO">
			      <input name="NUM_CARTAO_VALE_PEDAGIO_ANTIGO" tabindex="491" id="NUM_CARTAO_VALE_PEDAGIO_ANTIGO" type="hidden" value="">
                  &nbsp;
                  <label class="obrigatorio" id="LBL_NUM_CARTAO_VALE_PEDAGIO" name="LBL_NUM_CARTAO_VALE_PEDAGIO"></label>
                  <tr>
					<td width="1%" class="texto" nowrap="">Tag de Pedágio:</td>
					<td width="50%" class="texto">
						<select name="TAG_PAGTO_PEDAGIO" tabindex="492" id="TAG_PAGTO_PEDAGIO" onchange="f_busca_vale_pedagio_conf()" fixo="1">
						     
                            	<option value="" selected="">-- Selecione --</option>
                       	    
								<option value="-1">Nenhum</option>
							
								<option value="2">Tag Sem Parar</option>
							
								<option value="3">Tag Connect Car</option>
							
								<option value="4">Tag Movemais</option>
							
								<option value="5">Tag Veloe</option>
							
								<option value="6">Tag Visa Cargo</option>
							
								<option value="7">Tag Strada Pass</option>
							
						</select>
					</td>
                  </tr>
			   
            
            <tr>
            	<td colspan="2">
                	<fieldset tabindex="493">
                	  <legend>Responsável</legend>
                    	<table border="0" cellspacing="3" cellpadding="0">
                        	<tbody><tr>
                                <td class="texto"><input name="FORNECEDOR_VALE_PEDAGIO" tabindex="494" class="check" id="FORNECEDOR_VALE_PEDAGIO_0" style="margin-left: 3px;" onclick="f_muda_fornecedora(this.value);" type="radio" value="0">&nbsp;Remetente
                                                  <input name="FORNECEDOR_VALE_PEDAGIO" tabindex="495" class="check" id="FORNECEDOR_VALE_PEDAGIO_1" style="margin-left: 3px;" onclick="f_muda_fornecedora(this.value);" type="radio" value="1">&nbsp;Expedidor
                                                  <input name="FORNECEDOR_VALE_PEDAGIO" tabindex="496" class="check" id="FORNECEDOR_VALE_PEDAGIO_2" style="margin-left: 3px;" onclick="f_muda_fornecedora(this.value);" type="radio" value="2">&nbsp;Destinatário
                                                  <input name="FORNECEDOR_VALE_PEDAGIO" tabindex="497" class="check" id="FORNECEDOR_VALE_PEDAGIO_3" style="margin-left: 3px;" onclick="f_muda_fornecedora(this.value);" type="radio" value="3">&nbsp;Recebedor
                                                  <input name="FORNECEDOR_VALE_PEDAGIO" tabindex="498" class="check" id="FORNECEDOR_VALE_PEDAGIO_4" style="margin-left: 3px;" onclick="f_muda_fornecedora(this.value);" type="radio" value="4">&nbsp;Tomador do Serviço
                                                  <input name="FORNECEDOR_VALE_PEDAGIO" tabindex="499" class="check" id="FORNECEDOR_VALE_PEDAGIO_6" style="margin-left: 3px;" onclick="f_muda_fornecedora(this.value);" type="radio" value="6">&nbsp;Transportadora
                                                  <input name="FORNECEDOR_VALE_PEDAGIO" tabindex="500" class="check" id="FORNECEDOR_VALE_PEDAGIO_5" style="margin-left: 3px;" onclick="f_muda_fornecedora(this.value);" type="radio" value="5">&nbsp;Outro
                                </td>
                            </tr>
                            <tr>
                                <td class="texto">
                                <input name="CNPJ_FORNECEDORA" tabindex="501" id="CNPJ_FORNECEDORA" style="width: 110px;" onkeypress="return f_formata(this, '00000000000000')" onchange="f_busca_fornecedora()" type="text" maxlength="14" fixo="1" display="CNPJ Da FORNECEDORA" obrigatorio="0" tipo="numerico" secao="VALE_PEDAGIO" manter="1">
                                    <input name="FORNECEDORA_RAZAO_SOCIAL" tabindex="502" id="FORNECEDORA_RAZAO_SOCIAL" style="width: 400px;" type="text" readonly="true" fixo="1" display="FORNECEDORA" obrigatorio="0" secao="VALE_PEDAGIO" manter="1">
                                    <input name="COD_PESSOA_FORNECEDORA" tabindex="503" id="COD_PESSOA_FORNECEDORA" type="hidden" fixo="1" display="FORNECEDORA" obrigatorio="0" manter="1">
                                    <button tabindex="504" class="botao-16x16" onclick="if(this.form.CNPJ_FORNECEDORA.readOnly || this.form.CNPJ_FORNECEDORA.disabled) { return; } NewWindow('/_consultas/localizar_pessoa.cfm?tipo_pessoa=0&amp;field=COD_PESSOA,CNPJ_CPF,RAZAO_SOCIAL&amp;campo=COD_PESSOA_FORNECEDORA,CNPJ_FORNECEDORA,FORNECEDORA_RAZAO_SOCIAL&amp;funcao=f_busca_vale_pedagio_conf()', '_blank', 800, 600, 'yes')" type="button"><img width="16" height="16" title="Buscar Fornecedora" align="absmiddle" alt="Buscar Fornedora" src="/_imagens/botoes/16x16/buscar.gif"></button></td>
                            </tr>
                        </tbody></table>
                    </fieldset>
                </td>
            </tr>
            <tr>
            	<td width="1%" class="texto" nowrap="">Nº Comprovante:</td>
                <td width="50%" class="texto"><input name="NUM_COMPROVANTE" tabindex="505" id="NUM_COMPROVANTE" style="width: 150px;" onkeypress="return f_formata(this, '00000000000000000000')" type="text" maxlength="20" display="NÚMERO DO COMPROVANTE" obrigatorio="0" tipo="numerico" secao="VALE_PEDAGIO">
                Valor:
                <input name="VALOR_COMPROVANTE" tabindex="506" id="VALOR_COMPROVANTE" onkeypress="return f_formata_numero_decimal(this,event)" onchange="this.value = toCurrency(this.value)" type="text" size="15" maxlength="15" display="VALOR VALE PEDÁGIO" obrigatorio="0" tipo="numerico" secao="VALE_PEDAGIO">
                <label id="MENSAGEM_CONFIG_VALE_PEDAGIO" style="color: blue;" secao="VALE_PEDAGIO">
                </label></td>
            </tr>
            <tr>
                <td colspan="2">
                    
<script src="/_scripts/tablesort.js"></script>
<script language="javascript1.2">
var DOUBLE_QUOTES = new RegExp( '"([^"]*)"', 'g' );


function f_ordenar_VALE_PEDAGIO(campo, desc, tipo) {
//	try {
		if(!tipo) 
			tipo = 'caseinsensitivestring';
		v_tb = document.getElementById('tb_lista_VALE_PEDAGIO');
		v_rows2 = new Array();
		for(var i=0;i<v_tb.rows.length;i++) 
			v_rows2.push(v_tb.rows[i]);
		v_rows2.sort(function(a,b) {
				v_id_a = a.id.replace('tr_lista_VALE_PEDAGIO_','');
				v_id_b = b.id.replace('tr_lista_VALE_PEDAGIO_','');
				if(tipo == 'number') {
					if( Number(document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_a).value) < Number(document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_b).value)) 
						return desc ? +1 : -1;
					if( Number(document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_a).value) > Number(document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_b).value)) 
						return desc ? -1 : +1;
				} else if(tipo == 'caseinsensitivestring') {
					if(document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_a).value < document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_b).value) 
						return desc ? +1 : -1;
					if(document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_a).value > document.getElementById(campo+'_VALE_PEDAGIO_'+v_id_b).value) 
						return desc ? -1 : +1;
				}
				return 0;
			});
		for(var i=0;i<v_rows2.length;i++) {
			v_tb.appendChild(v_rows2[i]);
		}
//	} catch(e) {}
}

function f_incluir_VALE_PEDAGIO() {
	with(document.forms[0]) {
		
		f_cancelar_VALE_PEDAGIO();
	}
}

function f_excluir_VALE_PEDAGIO(v_nro, v_nao_mostra_confirmar) {
	if(v_nro == -1) {
		return;
	}
	if(!v_nao_mostra_confirmar) {
		if(!confirm('Clique OK para confirmar a exclusão do registro!')) {
			return;
		}
	}
	with (document.forms[0]) {
		
			lista_deleted_VALE_PEDAGIO.value = lista_deleted_VALE_PEDAGIO.value+','+document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+v_nro).value;
		
	}
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');		
	for(var i=0;i<tbody.rows.length;i++) {
		if(tbody.rows[i].id == 'tr_lista_VALE_PEDAGIO_'+v_nro) {
			tbody.deleteRow(i);
			f_cancelar_VALE_PEDAGIO();
			break;
		}
	}
		
	
	f_cancelar_VALE_PEDAGIO();
	f_on_salva_lista_VALE_PEDAGIO();
	f_on_excluir_VALE_PEDAGIO();
}
function f_limpar_VALE_PEDAGIO() {
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');	
	while (tbody.rows.length > 0) {
		tbody.deleteRow(0);
	}
		
	
	document.forms[0].lista_selected_VALE_PEDAGIO.value = -1;
}
var lista_count_VALE_PEDAGIO = 0;


function f_testa_existencia_VALE_PEDAGIO(chave, linha_atual, selectable) {
	var listagem = f_listagem_VALE_PEDAGIO();
	for(var i=0;i<listagem.length;i++) {
		var items = chave.split('|');
		var igual = true;
		for(var j=0;j<items.length;j++) {
			if(eval('listagem['+i+'].'+items[j]) != eval('document.forms[0].'+items[j]+'.value') || listagem[i].id == linha_atual) {
					igual = false;
			}
		}
		if (igual) {
			return true;
		}
	}
}
function f_salvar_VALE_PEDAGIO() {
	
	if (!f_before_salvar_VALE_PEDAGIO()) {
	   return;
	}	
	if(f_verifica_form(document.forms[0], 'VALE_PEDAGIO'))	{
		var padrao = true;
		var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');
		for(var i=0;i<tbody.rows.length;i++) {
			var row_id = tbody.rows[i].id.replace('tr_lista_VALE_PEDAGIO_', '');
			if(document.getElementById('lista_padrao_VALE_PEDAGIO_'+row_id).style.display == '') {
				padrao = false;
			}
		}
		with(document.forms[0]) {
			
					if(f_testa_existencia_VALE_PEDAGIO('CONHECIMENTO_VALE_PEDAGIO_CHAVE', lista_selected_VALE_PEDAGIO.value, true)) {
						alert('Os campos não podem ser repetidos!');
						return;
					}
				
			if(lista_selected_VALE_PEDAGIO.value == -1) {
				var v_tr = document.createElement('TR');
				v_tr.id = 'tr_lista_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
				var temp_count = lista_count_VALE_PEDAGIO;
				v_tr.style.cursor = 'pointer';
				v_tr.onclick = function() {
					f_seleciona_VALE_PEDAGIO(temp_count);
				}
				var v_td = document.createElement('TD');
				var v_dv1 = document.createElement('div');
				v_td.appendChild(v_dv1);
				v_td.className = 'linha_1';
				lista_inputs = '<input type="hidden" name="PADRAO_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="PADRAO_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((padrao)?1:0)+'">';
				
				if (CONHECIMENTO_VALE_PEDAGIO_CHAVE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((CONHECIMENTO_VALE_PEDAGIO_CHAVE.checked)?"1":"0")+'">';
				} else if (CONHECIMENTO_VALE_PEDAGIO_CHAVE.type == 'file') {
					v_campo_file = document.forms[0].CONHECIMENTO_VALE_PEDAGIO_CHAVE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'CONHECIMENTO_VALE_PEDAGIO_CHAVE';
					v_file_input.id = 'CONHECIMENTO_VALE_PEDAGIO_CHAVE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CONHECIMENTO_VALE_PEDAGIO_CHAVE.value;
				
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CONHECIMENTO_VALE_PEDAGIO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((CONHECIMENTO_VALE_PEDAGIO_ID.checked)?"1":"0")+'">';
				} else if (CONHECIMENTO_VALE_PEDAGIO_ID.type == 'file') {
					v_campo_file = document.forms[0].CONHECIMENTO_VALE_PEDAGIO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'CONHECIMENTO_VALE_PEDAGIO_ID';
					v_file_input.id = 'CONHECIMENTO_VALE_PEDAGIO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CONHECIMENTO_VALE_PEDAGIO_ID.value;
				
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				if (COD_PESSOA_OPERADORA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((COD_PESSOA_OPERADORA.checked)?"1":"0")+'">';
				} else if (COD_PESSOA_OPERADORA.type == 'file') {
					v_campo_file = document.forms[0].COD_PESSOA_OPERADORA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'COD_PESSOA_OPERADORA';
					v_file_input.id = 'COD_PESSOA_OPERADORA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = COD_PESSOA_OPERADORA.value;
				
					lista_inputs += '<input type="hidden" name="COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				if (COD_PESSOA_FORNECEDORA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((COD_PESSOA_FORNECEDORA.checked)?"1":"0")+'">';
				} else if (COD_PESSOA_FORNECEDORA.type == 'file') {
					v_campo_file = document.forms[0].COD_PESSOA_FORNECEDORA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'COD_PESSOA_FORNECEDORA';
					v_file_input.id = 'COD_PESSOA_FORNECEDORA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = COD_PESSOA_FORNECEDORA.value;
				
					lista_inputs += '<input type="hidden" name="COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				if (NUM_COMPROVANTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((NUM_COMPROVANTE.checked)?"1":"0")+'">';
				} else if (NUM_COMPROVANTE.type == 'file') {
					v_campo_file = document.forms[0].NUM_COMPROVANTE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'NUM_COMPROVANTE';
					v_file_input.id = 'NUM_COMPROVANTE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = NUM_COMPROVANTE.value;
				
					lista_inputs += '<input type="hidden" name="NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				if (FORNECEDORA_RAZAO_SOCIAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((FORNECEDORA_RAZAO_SOCIAL.checked)?"1":"0")+'">';
				} else if (FORNECEDORA_RAZAO_SOCIAL.type == 'file') {
					v_campo_file = document.forms[0].FORNECEDORA_RAZAO_SOCIAL;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'FORNECEDORA_RAZAO_SOCIAL';
					v_file_input.id = 'FORNECEDORA_RAZAO_SOCIAL';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = FORNECEDORA_RAZAO_SOCIAL.value;
				
					lista_inputs += '<input type="hidden" name="FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				if (OPERADORA_RAZAO_SOCIAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((OPERADORA_RAZAO_SOCIAL.checked)?"1":"0")+'">';
				} else if (OPERADORA_RAZAO_SOCIAL.type == 'file') {
					v_campo_file = document.forms[0].OPERADORA_RAZAO_SOCIAL;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'OPERADORA_RAZAO_SOCIAL';
					v_file_input.id = 'OPERADORA_RAZAO_SOCIAL';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = OPERADORA_RAZAO_SOCIAL.value;
				
					lista_inputs += '<input type="hidden" name="OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				if (VALOR_COMPROVANTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" value="'+((VALOR_COMPROVANTE.checked)?"1":"0")+'">';
				} else if (VALOR_COMPROVANTE.type == 'file') {
					v_campo_file = document.forms[0].VALOR_COMPROVANTE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_campo_file.name = 'VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO;
					v_file_input.name = 'VALOR_COMPROVANTE';
					v_file_input.id = 'VALOR_COMPROVANTE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = VALOR_COMPROVANTE.value;
				
					lista_inputs += '<input type="hidden" name="VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" id="VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'">';
				}
//				v_td.appendChild(v_input)
				
				v_dv1.innerHTML = '<img id="lista_padrao_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				v_td.width = 16;
				
				v_td.style.display = 'none';
				
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+OPERADORA_RAZAO_SOCIAL.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+FORNECEDORA_RAZAO_SOCIAL.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+NUM_COMPROVANTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+VALOR_COMPROVANTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				tbody.appendChild(v_tr);
				
				if (CONHECIMENTO_VALE_PEDAGIO_CHAVE.type != 'checkbox' && CONHECIMENTO_VALE_PEDAGIO_CHAVE.type != 'file') {
					document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = CONHECIMENTO_VALE_PEDAGIO_CHAVE.value;
				}
				
				if (CONHECIMENTO_VALE_PEDAGIO_ID.type != 'checkbox' && CONHECIMENTO_VALE_PEDAGIO_ID.type != 'file') {
					document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = CONHECIMENTO_VALE_PEDAGIO_ID.value;
				}
				
				if (COD_PESSOA_OPERADORA.type != 'checkbox' && COD_PESSOA_OPERADORA.type != 'file') {
					document.getElementById('COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = COD_PESSOA_OPERADORA.value;
				}
				
				if (COD_PESSOA_FORNECEDORA.type != 'checkbox' && COD_PESSOA_FORNECEDORA.type != 'file') {
					document.getElementById('COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = COD_PESSOA_FORNECEDORA.value;
				}
				
				if (NUM_COMPROVANTE.type != 'checkbox' && NUM_COMPROVANTE.type != 'file') {
					document.getElementById('NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = NUM_COMPROVANTE.value;
				}
				
				if (FORNECEDORA_RAZAO_SOCIAL.type != 'checkbox' && FORNECEDORA_RAZAO_SOCIAL.type != 'file') {
					document.getElementById('FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = FORNECEDORA_RAZAO_SOCIAL.value;
				}
				
				if (OPERADORA_RAZAO_SOCIAL.type != 'checkbox' && OPERADORA_RAZAO_SOCIAL.type != 'file') {
					document.getElementById('OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = OPERADORA_RAZAO_SOCIAL.value;
				}
				
				if (VALOR_COMPROVANTE.type != 'checkbox' && VALOR_COMPROVANTE.type != 'file') {
					document.getElementById('VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_count_VALE_PEDAGIO).value = VALOR_COMPROVANTE.value;
				}
				

				lista_count_VALE_PEDAGIO++;
				f_atualiza_campos_escravos_VALE_PEDAGIO();
				f_incluir_VALE_PEDAGIO();
			} else {
				var v_tr = document.getElementById('tr_lista_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value);
				padrao = (document.getElementById('PADRAO_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value == 1);
				lista_inputs = '<input type="hidden" name="PADRAO_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((padrao)?1:0)+'">';
				
				if (CONHECIMENTO_VALE_PEDAGIO_CHAVE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((CONHECIMENTO_VALE_PEDAGIO_CHAVE.checked)?"1":"0")+'">';
					document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((CONHECIMENTO_VALE_PEDAGIO_CHAVE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+CONHECIMENTO_VALE_PEDAGIO_CHAVE.value+'">';
					document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = CONHECIMENTO_VALE_PEDAGIO_CHAVE.value;
				}
				
				if (CONHECIMENTO_VALE_PEDAGIO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((CONHECIMENTO_VALE_PEDAGIO_ID.checked)?"1":"0")+'">';
					document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((CONHECIMENTO_VALE_PEDAGIO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+CONHECIMENTO_VALE_PEDAGIO_ID.value+'">';
					document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = CONHECIMENTO_VALE_PEDAGIO_ID.value;
				}
				
				if (COD_PESSOA_OPERADORA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((COD_PESSOA_OPERADORA.checked)?"1":"0")+'">';
					document.getElementById('COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((COD_PESSOA_OPERADORA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+COD_PESSOA_OPERADORA.value+'">';
					document.getElementById('COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = COD_PESSOA_OPERADORA.value;
				}
				
				if (COD_PESSOA_FORNECEDORA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((COD_PESSOA_FORNECEDORA.checked)?"1":"0")+'">';
					document.getElementById('COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((COD_PESSOA_FORNECEDORA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+COD_PESSOA_FORNECEDORA.value+'">';
					document.getElementById('COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = COD_PESSOA_FORNECEDORA.value;
				}
				
				if (NUM_COMPROVANTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((NUM_COMPROVANTE.checked)?"1":"0")+'">';
					document.getElementById('NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((NUM_COMPROVANTE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+NUM_COMPROVANTE.value+'">';
					document.getElementById('NUM_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = NUM_COMPROVANTE.value;
				}
				
				if (FORNECEDORA_RAZAO_SOCIAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((FORNECEDORA_RAZAO_SOCIAL.checked)?"1":"0")+'">';
					document.getElementById('FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((FORNECEDORA_RAZAO_SOCIAL.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+FORNECEDORA_RAZAO_SOCIAL.value+'">';
					document.getElementById('FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = FORNECEDORA_RAZAO_SOCIAL.value;
				}
				
				if (OPERADORA_RAZAO_SOCIAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((OPERADORA_RAZAO_SOCIAL.checked)?"1":"0")+'">';
					document.getElementById('OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((OPERADORA_RAZAO_SOCIAL.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+OPERADORA_RAZAO_SOCIAL.value+'">';
					document.getElementById('OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = OPERADORA_RAZAO_SOCIAL.value;
				}
				
				if (VALOR_COMPROVANTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+((VALOR_COMPROVANTE.checked)?"1":"0")+'">';
					document.getElementById('VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = ((VALOR_COMPROVANTE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" value="'+VALOR_COMPROVANTE.value+'">';
					document.getElementById('VALOR_COMPROVANTE_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value).value = VALOR_COMPROVANTE.value;
				}
				
//				v_tr.cells[0].innerHTML = '<img id="lista_padrao_VALE_PEDAGIO_'+lista_selected_VALE_PEDAGIO.value+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				
					var v_td = v_tr.cells[1];
					v_td.innerHTML = ''+OPERADORA_RAZAO_SOCIAL.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[2];
					v_td.innerHTML = ''+FORNECEDORA_RAZAO_SOCIAL.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[3];
					v_td.innerHTML = ''+NUM_COMPROVANTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[4];
					v_td.innerHTML = ''+VALOR_COMPROVANTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
								
				f_atualiza_campos_escravos_VALE_PEDAGIO();
				f_incluir_VALE_PEDAGIO();
			}
		}
			
		
		f_on_salva_lista_VALE_PEDAGIO();
	}
}
function f_cancelar_VALE_PEDAGIO() {
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');		
	for(var i=0;i<tbody.rows.length;i++) {
		for(var j=0;j<tbody.rows[i].cells.length;j++) {
			tbody.rows[i].cells[j].className = 'linha_1';
		}
	}
	with(document.forms[0]) {
	
		

		if(document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE').getAttribute('type') != 'file') {
		  if (!CONHECIMENTO_VALE_PEDAGIO_CHAVE.getAttribute('manter') || CONHECIMENTO_VALE_PEDAGIO_CHAVE.getAttribute('manter') == 0) {
				if(CONHECIMENTO_VALE_PEDAGIO_CHAVE.type == 'checkbox') {
					CONHECIMENTO_VALE_PEDAGIO_CHAVE.checked = false;
				} else if(CONHECIMENTO_VALE_PEDAGIO_CHAVE.type == 'select-one') {
					CONHECIMENTO_VALE_PEDAGIO_CHAVE.selectedIndex = 0;
				} else {
					CONHECIMENTO_VALE_PEDAGIO_CHAVE.value = '';
				}
				
				try {
					CONHECIMENTO_VALE_PEDAGIO_CHAVE.focus();
				} catch(e) {
				}
				
			}
		}
		

		if(document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID').getAttribute('type') != 'file') {
		  if (!CONHECIMENTO_VALE_PEDAGIO_ID.getAttribute('manter') || CONHECIMENTO_VALE_PEDAGIO_ID.getAttribute('manter') == 0) {
				if(CONHECIMENTO_VALE_PEDAGIO_ID.type == 'checkbox') {
					CONHECIMENTO_VALE_PEDAGIO_ID.checked = false;
				} else if(CONHECIMENTO_VALE_PEDAGIO_ID.type == 'select-one') {
					CONHECIMENTO_VALE_PEDAGIO_ID.selectedIndex = 0;
				} else {
					CONHECIMENTO_VALE_PEDAGIO_ID.value = '';
				}
				
			}
		}
		

		if(document.getElementById('COD_PESSOA_OPERADORA').getAttribute('type') != 'file') {
		  if (!COD_PESSOA_OPERADORA.getAttribute('manter') || COD_PESSOA_OPERADORA.getAttribute('manter') == 0) {
				if(COD_PESSOA_OPERADORA.type == 'checkbox') {
					COD_PESSOA_OPERADORA.checked = false;
				} else if(COD_PESSOA_OPERADORA.type == 'select-one') {
					COD_PESSOA_OPERADORA.selectedIndex = 0;
				} else {
					COD_PESSOA_OPERADORA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('COD_PESSOA_FORNECEDORA').getAttribute('type') != 'file') {
		  if (!COD_PESSOA_FORNECEDORA.getAttribute('manter') || COD_PESSOA_FORNECEDORA.getAttribute('manter') == 0) {
				if(COD_PESSOA_FORNECEDORA.type == 'checkbox') {
					COD_PESSOA_FORNECEDORA.checked = false;
				} else if(COD_PESSOA_FORNECEDORA.type == 'select-one') {
					COD_PESSOA_FORNECEDORA.selectedIndex = 0;
				} else {
					COD_PESSOA_FORNECEDORA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('NUM_COMPROVANTE').getAttribute('type') != 'file') {
		  if (!NUM_COMPROVANTE.getAttribute('manter') || NUM_COMPROVANTE.getAttribute('manter') == 0) {
				if(NUM_COMPROVANTE.type == 'checkbox') {
					NUM_COMPROVANTE.checked = false;
				} else if(NUM_COMPROVANTE.type == 'select-one') {
					NUM_COMPROVANTE.selectedIndex = 0;
				} else {
					NUM_COMPROVANTE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('FORNECEDORA_RAZAO_SOCIAL').getAttribute('type') != 'file') {
		  if (!FORNECEDORA_RAZAO_SOCIAL.getAttribute('manter') || FORNECEDORA_RAZAO_SOCIAL.getAttribute('manter') == 0) {
				if(FORNECEDORA_RAZAO_SOCIAL.type == 'checkbox') {
					FORNECEDORA_RAZAO_SOCIAL.checked = false;
				} else if(FORNECEDORA_RAZAO_SOCIAL.type == 'select-one') {
					FORNECEDORA_RAZAO_SOCIAL.selectedIndex = 0;
				} else {
					FORNECEDORA_RAZAO_SOCIAL.value = '';
				}
				
			}
		}
		

		if(document.getElementById('OPERADORA_RAZAO_SOCIAL').getAttribute('type') != 'file') {
		  if (!OPERADORA_RAZAO_SOCIAL.getAttribute('manter') || OPERADORA_RAZAO_SOCIAL.getAttribute('manter') == 0) {
				if(OPERADORA_RAZAO_SOCIAL.type == 'checkbox') {
					OPERADORA_RAZAO_SOCIAL.checked = false;
				} else if(OPERADORA_RAZAO_SOCIAL.type == 'select-one') {
					OPERADORA_RAZAO_SOCIAL.selectedIndex = 0;
				} else {
					OPERADORA_RAZAO_SOCIAL.value = '';
				}
				
			}
		}
		

		if(document.getElementById('VALOR_COMPROVANTE').getAttribute('type') != 'file') {
		  if (!VALOR_COMPROVANTE.getAttribute('manter') || VALOR_COMPROVANTE.getAttribute('manter') == 0) {
				if(VALOR_COMPROVANTE.type == 'checkbox') {
					VALOR_COMPROVANTE.checked = false;
				} else if(VALOR_COMPROVANTE.type == 'select-one') {
					VALOR_COMPROVANTE.selectedIndex = 0;
				} else {
					VALOR_COMPROVANTE.value = '';
				}
				
			}
		}
		
		lista_selected_VALE_PEDAGIO.value = -1;
	}
	f_desabilitar_botao_lista_VALE_PEDAGIO('padrao');
	f_desabilitar_botao_lista_VALE_PEDAGIO('excluir');
		
	f_on_incluir_VALE_PEDAGIO();
}
function f_habilitar_botao_lista_VALE_PEDAGIO(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_VALE_PEDAGIO');
	if(obj != null) {
		obj.disabled = false;
		img_obj = document.getElementById('img_lista_'+v_botao+'_VALE_PEDAGIO');
		img_obj.src = img_obj.src.replace('_disable.gif', '.gif');
	}
}
function f_desabilitar_botao_lista_VALE_PEDAGIO(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_VALE_PEDAGIO');
	if(obj != null) {
		obj.disabled = true;
		img_obj = document.getElementById('img_lista_'+v_botao+'_VALE_PEDAGIO');
		if(img_obj.src.indexOf('_disable') == -1) {
			img_obj.src = img_obj.src.replace('.gif', '_disable.gif');
		}
	}
}
function f_seleciona_VALE_PEDAGIO(v_nro) {
	
	if(!document.getElementById('btn_lista_incluir_VALE_PEDAGIO').disabled) {
	
		f_before_selecionar_VALE_PEDAGIO();
		f_cancelar_VALE_PEDAGIO();
		var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');		
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_VALE_PEDAGIO_'+v_nro) {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_1';
				}			
			} else {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_over';
				}
			}
		}
		with (document.forms[0]) {
			
			if(CONHECIMENTO_VALE_PEDAGIO_CHAVE.type == 'checkbox') {
				CONHECIMENTO_VALE_PEDAGIO_CHAVE.checked = (document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE').type == 'file') {
				v_campo_valor = document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CONHECIMENTO_VALE_PEDAGIO_CHAVE';
				v_campo_valor.name = 'CONHECIMENTO_VALE_PEDAGIO_CHAVE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CONHECIMENTO_VALE_PEDAGIO_CHAVE.value = document.getElementById('CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_'+v_nro).value;
			}
			
			if(CONHECIMENTO_VALE_PEDAGIO_ID.type == 'checkbox') {
				CONHECIMENTO_VALE_PEDAGIO_ID.checked = (document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID').type == 'file') {
				v_campo_valor = document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CONHECIMENTO_VALE_PEDAGIO_ID';
				v_campo_valor.name = 'CONHECIMENTO_VALE_PEDAGIO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CONHECIMENTO_VALE_PEDAGIO_ID.value = document.getElementById('CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_'+v_nro).value;
			}
			
			if(COD_PESSOA_OPERADORA.type == 'checkbox') {
				COD_PESSOA_OPERADORA.checked = (document.getElementById('COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('COD_PESSOA_OPERADORA').type == 'file') {
				v_campo_valor = document.getElementById('COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('COD_PESSOA_OPERADORA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'COD_PESSOA_OPERADORA';
				v_campo_valor.name = 'COD_PESSOA_OPERADORA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				COD_PESSOA_OPERADORA.value = document.getElementById('COD_PESSOA_OPERADORA_VALE_PEDAGIO_'+v_nro).value;
			}
			
			if(COD_PESSOA_FORNECEDORA.type == 'checkbox') {
				COD_PESSOA_FORNECEDORA.checked = (document.getElementById('COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('COD_PESSOA_FORNECEDORA').type == 'file') {
				v_campo_valor = document.getElementById('COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('COD_PESSOA_FORNECEDORA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'COD_PESSOA_FORNECEDORA';
				v_campo_valor.name = 'COD_PESSOA_FORNECEDORA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				COD_PESSOA_FORNECEDORA.value = document.getElementById('COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_'+v_nro).value;
			}
			
			if(NUM_COMPROVANTE.type == 'checkbox') {
				NUM_COMPROVANTE.checked = (document.getElementById('NUM_COMPROVANTE_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('NUM_COMPROVANTE').type == 'file') {
				v_campo_valor = document.getElementById('NUM_COMPROVANTE_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('NUM_COMPROVANTE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'NUM_COMPROVANTE';
				v_campo_valor.name = 'NUM_COMPROVANTE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				NUM_COMPROVANTE.value = document.getElementById('NUM_COMPROVANTE_VALE_PEDAGIO_'+v_nro).value;
			}
			
			if(FORNECEDORA_RAZAO_SOCIAL.type == 'checkbox') {
				FORNECEDORA_RAZAO_SOCIAL.checked = (document.getElementById('FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('FORNECEDORA_RAZAO_SOCIAL').type == 'file') {
				v_campo_valor = document.getElementById('FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('FORNECEDORA_RAZAO_SOCIAL');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'FORNECEDORA_RAZAO_SOCIAL';
				v_campo_valor.name = 'FORNECEDORA_RAZAO_SOCIAL';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				FORNECEDORA_RAZAO_SOCIAL.value = document.getElementById('FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+v_nro).value;
			}
			
			if(OPERADORA_RAZAO_SOCIAL.type == 'checkbox') {
				OPERADORA_RAZAO_SOCIAL.checked = (document.getElementById('OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('OPERADORA_RAZAO_SOCIAL').type == 'file') {
				v_campo_valor = document.getElementById('OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('OPERADORA_RAZAO_SOCIAL');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'OPERADORA_RAZAO_SOCIAL';
				v_campo_valor.name = 'OPERADORA_RAZAO_SOCIAL';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				OPERADORA_RAZAO_SOCIAL.value = document.getElementById('OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_'+v_nro).value;
			}
			
			if(VALOR_COMPROVANTE.type == 'checkbox') {
				VALOR_COMPROVANTE.checked = (document.getElementById('VALOR_COMPROVANTE_VALE_PEDAGIO_'+v_nro).value == 1)
			} else if(document.getElementById('VALOR_COMPROVANTE').type == 'file') {
				v_campo_valor = document.getElementById('VALOR_COMPROVANTE_VALE_PEDAGIO_'+v_nro);
				v_campo_atual = document.getElementById('VALOR_COMPROVANTE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'VALOR_COMPROVANTE';
				v_campo_valor.name = 'VALOR_COMPROVANTE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				VALOR_COMPROVANTE.value = document.getElementById('VALOR_COMPROVANTE_VALE_PEDAGIO_'+v_nro).value;
			}
			
			lista_selected_VALE_PEDAGIO.value = v_nro;
		}
		f_habilitar_botao_lista_VALE_PEDAGIO('padrao');
		f_habilitar_botao_lista_VALE_PEDAGIO('excluir');
		f_habilitar_botao_lista_VALE_PEDAGIO('salvar');
		f_on_seleciona_VALE_PEDAGIO();
	
	}
	
}
function f_padrao_VALE_PEDAGIO(v_nro) {
	if(v_nro == -1) {
		return;
	}
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');		
	with(document.forms[0]) {
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_VALE_PEDAGIO_'+v_nro) {
				var row_id = tbody.rows[i].id.replace('tr_lista_VALE_PEDAGIO_', '');
				document.getElementById('lista_padrao_VALE_PEDAGIO_'+row_id).style.display = 'none';
				document.getElementById('PADRAO_VALE_PEDAGIO_'+row_id).value = 0;
			}
		}
	}
	document.getElementById('lista_padrao_VALE_PEDAGIO_'+v_nro).style.display = '';
	document.getElementById('PADRAO_VALE_PEDAGIO_'+v_nro).value = 1;
}	

function f_total_campo_VALE_PEDAGIO(v_campo) {
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');
	var soma = 0;
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_VALE_PEDAGIO_', '');
		with(document.forms[0]) {
			try {
				soma += (eval("document.forms[0]."+v_campo+"_VALE_PEDAGIO_"+id_linha+".value")*1);
			} catch(e) {
			}
		}
	}
	return soma;
}
function f_atualiza_campos_escravos_VALE_PEDAGIO() {

}

function f_atualiza_campo_escravo_VALE_PEDAGIO(v_valor_mestre, v_campo_escravo, v_value) {
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_VALE_PEDAGIO_', '');
		with(document.forms[0]) {
			try {
				if (eval("document.forms[0]._VALE_PEDAGIO_"+id_linha).value == v_valor_mestre) {
					eval("document.forms[0]."+v_campo_escravo+"_VALE_PEDAGIO_"+id_linha).value = v_value;
				}				
			} catch(e) {
			}
		}
	}
}

function f_register(p_id) {
	this.id = p_id;

	this.CONHECIMENTO_VALE_PEDAGIO_CHAVE = '';

	this.CONHECIMENTO_VALE_PEDAGIO_ID = '';

	this.COD_PESSOA_OPERADORA = '';

	this.COD_PESSOA_FORNECEDORA = '';

	this.NUM_COMPROVANTE = '';

	this.FORNECEDORA_RAZAO_SOCIAL = '';

	this.OPERADORA_RAZAO_SOCIAL = '';

	this.VALOR_COMPROVANTE = '';
}
//busca todos os registros
function f_listagem_VALE_PEDAGIO() {
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');
	var result = new Array();
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_VALE_PEDAGIO_', '');
		result[result.length] = new f_register(id_linha);
	
		try {
			result[result.length-1].CONHECIMENTO_VALE_PEDAGIO_CHAVE = eval("document.forms[0].CONHECIMENTO_VALE_PEDAGIO_CHAVE_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CONHECIMENTO_VALE_PEDAGIO_ID = eval("document.forms[0].CONHECIMENTO_VALE_PEDAGIO_ID_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].COD_PESSOA_OPERADORA = eval("document.forms[0].COD_PESSOA_OPERADORA_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].COD_PESSOA_FORNECEDORA = eval("document.forms[0].COD_PESSOA_FORNECEDORA_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].NUM_COMPROVANTE = eval("document.forms[0].NUM_COMPROVANTE_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].FORNECEDORA_RAZAO_SOCIAL = eval("document.forms[0].FORNECEDORA_RAZAO_SOCIAL_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].OPERADORA_RAZAO_SOCIAL = eval("document.forms[0].OPERADORA_RAZAO_SOCIAL_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].VALOR_COMPROVANTE = eval("document.forms[0].VALOR_COMPROVANTE_VALE_PEDAGIO_"+id_linha).value;
		} catch(e) {}
	
	}
	return result;
}

function f_busca_campo_escravo_VALE_PEDAGIO(v_valor_mestre, v_campo_escravo) {
	var tbody = document.getElementById('tb_lista_VALE_PEDAGIO');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_VALE_PEDAGIO_', '');
		with(document.forms[0]) {
				if (eval("document.forms[0]._VALE_PEDAGIO_"+id_linha).value == v_valor_mestre) {
					return eval("document.forms[0]."+v_campo_escravo+"_VALE_PEDAGIO_"+id_linha).value;
				}				
		}
	}
	return '';
}
function f_set_lista_min_VALE_PEDAGIO(value) {

}

function f_before_selecionar_VALE_PEDAGIO() {}
function f_on_seleciona_VALE_PEDAGIO() {}
function f_on_salva_lista_VALE_PEDAGIO() {}
function f_before_salvar_VALE_PEDAGIO() { return true; }
function f_on_incluir_VALE_PEDAGIO() {}
function f_on_excluir_VALE_PEDAGIO() {}
</script>

<table width="100%" height="100%" align="left" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr id="tr_lista_botoes_VALE_PEDAGIO">
    <td><table border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>

		
          <td><button tabindex="507" class="botao" id="btn_lista_incluir_VALE_PEDAGIO" onclick="f_incluir_VALE_PEDAGIO()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_incluir_VALE_PEDAGIO" src="/_imagens/botoes/16x16/incluir.gif">&nbsp;Novo</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="508" class="botao" id="btn_lista_excluir_VALE_PEDAGIO" onclick="f_excluir_VALE_PEDAGIO(document.forms[0].lista_selected_VALE_PEDAGIO.value)" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_excluir_VALE_PEDAGIO" src="/_imagens/botoes/16x16/excluir.gif">&nbsp;Excluir</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="509" class="botao" id="btn_lista_salvar_VALE_PEDAGIO" onclick="f_salvar_VALE_PEDAGIO()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_salvar_VALE_PEDAGIO" src="/_imagens/botoes/16x16/confirmar.gif">&nbsp;Salvar</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="510" class="botao" id="btn_lista_cancelar_VALE_PEDAGIO" onclick="f_cancelar_VALE_PEDAGIO()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_cancelar_VALE_PEDAGIO" src="/_imagens/botoes/16x16/cancelar.gif">&nbsp;Cancelar</button></td>
          <td style="width: 4px;">&nbsp;</td>
		  
        </tr>
      </tbody></table></td>
  </tr>
  <tr><td height="4"></td></tr>
  <input name="lista_selected_VALE_PEDAGIO" tabindex="511" id="lista_selected_VALE_PEDAGIO" type="hidden" value="-1" fixo="1">
  <input name="lista_deleted_VALE_PEDAGIO" tabindex="512" id="lista_deleted_VALE_PEDAGIO" type="hidden" value="" fixo="1">
  <tr>
  
    <td height="200">
	<div class="lista" style="width: 100%; -ms-overflow-x: scroll;">
	<table width="100%" style="-ms-overflow-y: scroll;" border="0" cellspacing="1" cellpadding="3">
	<thead>
  <tr class="titulo_3" style="cursor: pointer;" onclick="sortColumn(event)">
    <td width="16" class="titulo_3" style="display: none;">&nbsp;</td>
  	
    <td width="200" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Operadora</nobr></td>
	
    <td width="200" align="left" class="titulo_3" type="caseinsensitivestring"><nobr>Fornecedora</nobr></td>
	
    <td width="100" align="right" class="titulo_3" type="caseinsensitivestring"><nobr>Nº Comprovante</nobr></td>
	
    <td width="50" align="right" class="titulo_3" type="caseinsensitivestring"><nobr>Valor</nobr></td>
	
  </tr>
  </thead>
  <tbody id="tb_lista_VALE_PEDAGIO">
  </tbody>
</table>

	</div></td>
  </tr>
</tbody></table>


                    <script type="text/javascript">
					   function f_before_salvar_VALE_PEDAGIO() {
							with(document.forms[0]) {
								//Permitir apenas números no campo número do comprovante
								if(NUM_COMPROVANTE.value != '' && NUM_COMPROVANTE.value.search(/^[0-9]+$/g) == -1){
								   alert('O valor do campo NÚMERO DO COMPROVANTE deve ser numérico.');
								   return false;
								}
								if(f_ajax_running() > 0 && v_inserida == 0) {
									alert('Aguarde o término do processamento antes de salvar.');
									return false;
								}

								CONHECIMENTO_VALE_PEDAGIO_CHAVE.value = COD_PESSOA_OPERADORA.value + '_' + COD_PESSOA_FORNECEDORA.value + '_' + NUM_COMPROVANTE.value;
								return true;
							}
						}
						
						function f_on_excluir_VALE_PEDAGIO() {
							document.getElementById('MENSAGEM_RETORNO_VALE_PEDAGIO').innerHTML = ''; 
							document.getElementById('MENSAGEM_CONFIG_VALE_PEDAGIO').innerHTML = ''; 
						}
					</script>
                </td>
            </tr>
        </tbody></table>
        </fieldset>

      </td>
   </tr>
</tbody></table>
</fieldset>

                                
                            </td>
                   </tr>
				
                   <tr style="display: none;">
                      <td class="td_aba_corpo" valign="top" colspan="10" classe="td_aba_corpo"><script type="text/javascript">
   function f_muda_obs_contrib(tags){
		document.getElementById("div_obs_contrib").innerHTML = tags;
	}

	function f_msg_obs_contrib(nome){
		if (nome == "tags"){
			document.getElementById("lblMsgOper").style.display = 'none';
			document.getElementById("lblMsgComp").style.display = 'none';
		} else if (nome == "oper"){
			document.getElementById("div_obs_contrib").innerHTML = '';
			document.getElementById("lblMsgOper").style.display = '';
			document.getElementById("lblMsgComp").style.display = 'none';
		} else if (nome == "comp"){
			//document.getElementById("div_obs_contrib").innerHTML = '';
			document.getElementById("lblMsgOper").style.display = 'none';
			document.getElementById("lblMsgComp").style.display = 'none';
		}
	}

	function limitText(limitField, limitNum) {
			if (document.getElementById(limitField).innerHTML.length > limitNum) {
				document.getElementById(limitField).innerHTML = document.getElementById(limitField).innerHTML.substring(0, limitNum);
		}
	}
</script>
<fieldset tabindex="513">
    <label class="obrigatorio" id="lblMsgOper">Esta operação logística não possui observações cadastradas</label>
	<label class="obrigatorio" id="lblMsgComp" style="display: none;">Não é necessário informar observações em CT-es de complemento</label>
	<div id="div_obs_contrib"></div>
</fieldset>
</td>
                   </tr>
               
               <tr style="display: none;">
                            <td class="td_aba_corpo" id="td_autorizacao_content" valign="top" style="display: none;" colspan="10">
                                <fieldset tabindex="514" id="fds_autorizacao" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	<fieldset tabindex="515"><legend>Informações da Autorização</legend>
<table width="100%" border="0" cellspacing="1" cellpadding="3">
    <tbody><tr><td width="1%" class="texto" nowrap="">Usuário Liberação:</td>
    <td width="1%" class="texto" nowrap=""><select name="USUARIO_LIBERACAO" tabindex="516" id="USUARIO_LIBERACAO" display="USUÁRIO DE LIBERAÇÃO" obrigatorio="0">
            <option value="">-- Selecione --</option>
            
        </select></td>
    <td width="1%" class="texto" nowrap="">Senha autorização:</td>
    <td width="1%" class="texto"><input name="SENHA_LIBERACAO" tabindex="517" id="SENHA_LIBERACAO" style="width: 81px;" type="text" maxlength="15" display="SENHA DE LIBERAÇÃO" obrigatorio="0"></td>
    <td width="96%"></td>
</tr></tbody></table>
</fieldset>

                                </fieldset>
                            </td>
               </tr>

               <tr style="display: none;">
                            <td class="td_aba_corpo" id="td_docto_anteriores_content" valign="top" style="display: none;" colspan="10">
                                <fieldset tabindex="518" id="fds_docto_anteriores" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	
<script>
	function f_busca_chave() {
		with(document.forms[0]) {
			if(XMLCTE.value) {
				var v_nome_arquivo = XMLCTE.value;
				var v_extensao = v_nome_arquivo.substr(v_nome_arquivo.lastIndexOf('.'));

				if(v_extensao != '.xml' && v_extensao != '.XML'){
					alert('O arquivo selecionado deve ser um XML.');
					return false;
				}
			}
			if(XMLCTE.value || CHAVECTE.value) {
				f_cria_carregando_ajax();
				OPERACAO.value = 15;
				target = 'consultas';
				action = 'confirma.cfm';
				submit();
			}
		}
	}

	function f_muda_tipo_documento_ant(){
		with(document.forms[0]) {
			switch (Number(ELETRONICO_PAPEL.value)){
				case 1:
					//habilita a chave
					document.getElementById('tb_doc_eletronico').style.display = '';
					document.getElementById('tb_doc_eletronico').disabled = 0;
					document.getElementById('CHAVECTE').obrigatorio = 1;

					//desabilita os outros campos de papel
					document.getElementById('tb_doc_papel').style.display = 'none';
					document.getElementById('tb_doc_papel').disabled = 1;
					document.getElementById('DOC_NUMERO').obrigatorio = 0;
					document.getElementById('DOC_DATA_EMISSAO').obrigatorio = 0;
					document.getElementById('DOC_SERIE').obrigatorio = 0;
					document.getElementById('DOC_SUB_SERIE').obrigatorio = 0;
					document.getElementById('DOC_TIPO').obrigatorio = 0;
					document.getElementById('DOC_NUMERO').value = '';
					document.getElementById('DOC_DATA_EMISSAO').value = '';
					document.getElementById('DOC_SERIE').value = '';
					document.getElementById('DOC_SUB_SERIE').value = '';
					document.getElementById('DOC_TIPO').value = '';
					break;
				case 2:
                    //desabilita a chave
					document.getElementById('tb_doc_eletronico').style.display = 'none';
					document.getElementById('tb_doc_eletronico').disabled = 1;
					document.getElementById('CHAVECTE').obrigatorio = 0;
					document.getElementById('CHAVECTE').value = '';
					
					//habilita os outros campos de papel
					document.getElementById('tb_doc_papel').style.display = '';
					document.getElementById('tb_doc_papel').disabled = 0;
					document.getElementById('DOC_NUMERO').obrigatorio = 1;
					document.getElementById('DOC_DATA_EMISSAO').obrigatorio = 1;
					document.getElementById('DOC_SERIE').obrigatorio = 1;
					document.getElementById('DOC_SUB_SERIE').obrigatorio = 1;
					document.getElementById('DOC_TIPO').obrigatorio = 1;
					break;
				default:
			}
		}
	}

	function f_busca_pessoa_emissor() {
		with(document.forms[0]) {
			if(DOC_CNPJ_EMISSOR.value != ''){
				f_query_wddx('/modulos/cte/_componentes/consulta/cfc_pessoa.cfc?method=get_pessoa_endereco_comercial'
							,'rapida=1&num_modalidade=13,5&cnpj_cpf='+DOC_CNPJ_EMISSOR.value
							,function(obj) {
								if(obj.ajax.readyState == 4 && obj.ajax.status == 200) {
									if(obj.struct.cod_pessoa.length > 0) {
										//DOC_CNPJ_EMISSOR.value = obj.struct.cnpj_cpf[0];
										DOC_COD_EMISSOR.value = obj.struct.cod_pessoa[0];
										DOC_EMITENTE.value = (obj.struct.razao_social[0] == '')?obj.struct.cliente[0]:obj.struct.razao_social[0];
									}
									else {
										DOC_EMITENTE.value = '';
										DOC_COD_EMISSOR.value = '';
										alert('Emissor não encontrado');
									}
								} else {
									DOC_EMITENTE.value = '';
									DOC_COD_EMISSOR.value = '';
									//alert('Emissor não encontrado');
								}
							});
				} else {
					DOC_EMITENTE.value = '';
					DOC_COD_EMISSOR.value = '';
				}
		}
	}
</script>

<table width="100%" border="0" cellspacing="0" cellpadding="1">
	<tbody><tr>
    	<td width="100%">
        	<fieldset tabindex="519">
               <table width="100%" border="0" cellspacing="3" cellpadding="1">
                	<tbody><tr>
                    	<td class="obrigatorio" id="classificacao_documentos_anteriores" style="font-weight: normal;" colspan="2"></td>
                    </tr>
					<tr>
						<td width="9%" class="texto">Tipo do Documento:</td>
						<td class="texto">
						<select name="ELETRONICO_PAPEL" tabindex="520" class="requerido_form" id="ELETRONICO_PAPEL" style="width: 300px;" onchange="f_muda_tipo_documento_ant();" display="DOCUMENTOS ANTERIORES / TIPO DO DOCUMENTO" obrigatorio="1" secao="DOCSANT">
							<option value="1">Eletrônico</option>
                        	<option value="2">Papel</option>
                    	</select></td>
					</tr>
					<tr>
                        <td width="9%" height="1" class="texto" nowrap="">Emissor:</td>
						<td class="texto">
                        <input name="DOC_CNPJ_EMISSOR" tabindex="521" class="requerido_form" id="DOC_CNPJ_EMISSOR" onchange="f_busca_pessoa_emissor()" type="text" size="20" maxlength="16" readonly="readonly" display="DOCUMENTOS ANTERIORES / EMISSOR" obrigatorio="1" secao="DOCSANT">
				        <input name="DOC_EMITENTE" tabindex="522" class="requerido_form" id="DOC_EMITENTE" type="text" size="60" maxlength="60" readonly="readonly" display="DOCUMENTOS ANTERIORES / EMISSOR" obrigatorio="1" secao="DOCSANT">
				        <button name="DOC_BTN_EMISSOR" tabindex="523" class="botao-16x16" id="DOC_BTN_EMISSOR" onclick="NewWindow('/_consultas/localizar_pessoa_juridica.cfm?funcao=f_busca_pessoa_emissor()&amp;campo=DOC_CNPJ_EMISSOR&amp;modalidade=-1', '_blank', 800,600, 'yes')" type="button"><img width="16" height="16" align="absmiddle" src="/_imagens/botoes/16x16/buscar.gif"></button>
				        <input name="DOC_COD_EMISSOR" tabindex="524" id="DOC_COD_EMISSOR" type="hidden" display="DOCUMENTOS ANTERIORES / EMISSOR" obrigatorio="1" secao="DOCSANT">
                        </td>
                    </tr>
			   </tbody></table>
			   <table width="100%" class="texto" id="tb_doc_eletronico" border="0" cellspacing="1" cellpadding="3">
                    <tbody><tr>
                        <td width="9%" height="1" class="texto" nowrap="">Chave de Acesso do CTe:</td>
						<td class="texto">
                        <input name="CHAVECTE" tabindex="525" class="requerido_form" id="CHAVECTE" style="width: 520px;" onchange="f_busca_chave();" type="text" maxlength="44" display="DOCUMENTOS ANTERIORES / CHAVE DE ACESSO DO CTE" obrigatorio="1" secao="DOCSANT">
                        &nbsp;&nbsp;Localizar Chave em XML:
                        <input name="XMLCTE" tabindex="526" id="XMLCTE" onchange="f_busca_chave();" type="file">
                        </td>
                    </tr>
                </tbody></table>
				<table width="100%" disabled="true" class="texto" id="tb_doc_papel" style="display: none;" border="0" cellspacing="1" cellpadding="3">
                    <tbody><tr>
                        <td width="9%" height="1" class="texto" nowrap="">Número:</td>
						<td class="texto">
                        <input name="DOC_NUMERO" tabindex="527" id="DOC_NUMERO" style="width: 200px;" type="text" maxlength="20" display="NÚMERO" obrigatorio="0" secao="DOCSANT">
                        Série:
                        <input name="DOC_SERIE" tabindex="528" id="DOC_SERIE" style="width: 50px;" type="text" maxlength="3" display="SÉRIE" obrigatorio="0" secao="DOCSANT">
                        Sub-Série:
                        <input name="DOC_SUB_SERIE" tabindex="529" id="DOC_SUB_SERIE" style="width: 50px;" type="text" maxlength="2" display="SUB-SÉRIE" obrigatorio="0" secao="DOCSANT">
                        </td>
                    </tr>
					<tr>
						<td class="texto">Tipo:</td>
						<td class="texto">
						<select name="DOC_TIPO" tabindex="530" class="requerido_form" id="DOC_TIPO" style="width: 300px;" display="DOCUMENTOS ANTERIORES / TIPO" obrigatorio="1" secao="DOCSANT">
					  	
					  		<option value="07">ATRE</option>
						
					  		<option value="08">DTA (Despacho de Transito Aduaneiro)</option>
						
					  		<option value="09">Conhecimento Aéreo Internacional</option>
						
					  		<option value="10">Conhecimento - Carta de Porte Internacional</option>
						
					  		<option value="11">Conhecimento Avulso</option>
						
					  		<option value="12">TIF (Transporte Internacional Ferroviário)</option>
						
					  		<option value="13">BL (Bill of Lading)</option>
						
                    	</select>
						<input name="DOC_TIPO_DESC" tabindex="531" id="DOC_TIPO_DESC" type="hidden" display="DOCUMENTOS ANTERIORES / TIPO" obrigatorio="0" secao="DOCSANT">
						Data de Emissão:
						<input name="DOC_DATA_EMISSAO" tabindex="532" id="DOC_DATA_EMISSAO" style="width: 85px;" onkeypress="return f_formata(this,event,'00/00/0000')" type="text" maxlength="44" display="DOCUMENTOS ANTERIORES / DATA DE EMISSAO DO DOCUMENTO" obrigatorio="0" tipo="data" secao="DOCSANT">
                        <button tabindex="533" class="botao-16x16" id="BTN_DATA_EMISSAO_DOC" type="button"><img width="16" height="16" title="Data" align="absmiddle" alt="Data" src="/_imagens/botoes/16x16/calendario.gif"></button>
	                       <script type="text/javascript">
                               Calendar.setup( {
                                   inputField  : "DOC_DATA_EMISSAO",      // ID of the input field
                                   ifFormat    : "%d/%m/%Y",              // the date format
                                   button      : "BTN_DATA_EMISSAO_DOC",  // ID of the button
                                   range       : [2001,2050]
                               } );
                           </script>
						</td>
					</tr>
                </tbody></table>
                <table width="100%" border="0" cellspacing="3" cellpadding="1">
                	<tbody><tr>
                        <td width="90%" style="padding-top: 5px;">
                            <table width="100%" border="0" cellspacing="3" cellpadding="1">
	                            <tbody><tr>
		                            <td>
			                            
<script src="/_scripts/tablesort.js"></script>
<script language="javascript1.2">
var DOUBLE_QUOTES = new RegExp( '"([^"]*)"', 'g' );


function f_ordenar_DOCSANT(campo, desc, tipo) {
//	try {
		if(!tipo) 
			tipo = 'caseinsensitivestring';
		v_tb = document.getElementById('tb_lista_DOCSANT');
		v_rows2 = new Array();
		for(var i=0;i<v_tb.rows.length;i++) 
			v_rows2.push(v_tb.rows[i]);
		v_rows2.sort(function(a,b) {
				v_id_a = a.id.replace('tr_lista_DOCSANT_','');
				v_id_b = b.id.replace('tr_lista_DOCSANT_','');
				if(tipo == 'number') {
					if( Number(document.getElementById(campo+'_DOCSANT_'+v_id_a).value) < Number(document.getElementById(campo+'_DOCSANT_'+v_id_b).value)) 
						return desc ? +1 : -1;
					if( Number(document.getElementById(campo+'_DOCSANT_'+v_id_a).value) > Number(document.getElementById(campo+'_DOCSANT_'+v_id_b).value)) 
						return desc ? -1 : +1;
				} else if(tipo == 'caseinsensitivestring') {
					if(document.getElementById(campo+'_DOCSANT_'+v_id_a).value < document.getElementById(campo+'_DOCSANT_'+v_id_b).value) 
						return desc ? +1 : -1;
					if(document.getElementById(campo+'_DOCSANT_'+v_id_a).value > document.getElementById(campo+'_DOCSANT_'+v_id_b).value) 
						return desc ? -1 : +1;
				}
				return 0;
			});
		for(var i=0;i<v_rows2.length;i++) {
			v_tb.appendChild(v_rows2[i]);
		}
//	} catch(e) {}
}

function f_incluir_DOCSANT() {
	with(document.forms[0]) {
		
		f_cancelar_DOCSANT();
	}
}

function f_excluir_DOCSANT(v_nro, v_nao_mostra_confirmar) {
	if(v_nro == -1) {
		return;
	}
	if(!v_nao_mostra_confirmar) {
		if(!confirm('Clique OK para confirmar a exclusão do registro!')) {
			return;
		}
	}
	with (document.forms[0]) {
		
			lista_deleted_DOCSANT.value = lista_deleted_DOCSANT.value+','+document.getElementById('CHAVECTE_DOCSANT_'+v_nro).value;
		
			lista_deleted_DOCSANT.value = lista_deleted_DOCSANT.value+'_'+document.getElementById('DOC_NUMERO_DOCSANT_'+v_nro).value;		
		
	}
	var tbody = document.getElementById('tb_lista_DOCSANT');		
	for(var i=0;i<tbody.rows.length;i++) {
		if(tbody.rows[i].id == 'tr_lista_DOCSANT_'+v_nro) {
			tbody.deleteRow(i);
			f_cancelar_DOCSANT();
			break;
		}
	}
		
	
	f_cancelar_DOCSANT();
	f_on_salva_lista_DOCSANT();
	f_on_excluir_DOCSANT();
}
function f_limpar_DOCSANT() {
	var tbody = document.getElementById('tb_lista_DOCSANT');	
	while (tbody.rows.length > 0) {
		tbody.deleteRow(0);
	}
		
	
	document.forms[0].lista_selected_DOCSANT.value = -1;
}
var lista_count_DOCSANT = 0;


function f_testa_existencia_DOCSANT(chave, linha_atual, selectable) {
	var listagem = f_listagem_DOCSANT();
	for(var i=0;i<listagem.length;i++) {
		var items = chave.split('|');
		var igual = true;
		for(var j=0;j<items.length;j++) {
			if(eval('listagem['+i+'].'+items[j]) != eval('document.forms[0].'+items[j]+'.value') || listagem[i].id == linha_atual) {
					igual = false;
			}
		}
		if (igual) {
			return true;
		}
	}
}
function f_salvar_DOCSANT() {
	
	if (!f_before_salvar_DOCSANT()) {
	   return;
	}	
	if(f_verifica_form(document.forms[0], 'DOCSANT'))	{
		var padrao = true;
		var tbody = document.getElementById('tb_lista_DOCSANT');
		for(var i=0;i<tbody.rows.length;i++) {
			var row_id = tbody.rows[i].id.replace('tr_lista_DOCSANT_', '');
			if(document.getElementById('lista_padrao_DOCSANT_'+row_id).style.display == '') {
				padrao = false;
			}
		}
		with(document.forms[0]) {
			
					if(f_testa_existencia_DOCSANT('CHAVECTE|DOC_NUMERO', lista_selected_DOCSANT.value, true)) {
						alert('Os campos não podem ser repetidos!');
						return;
					}
				
			if(lista_selected_DOCSANT.value == -1) {
				var v_tr = document.createElement('TR');
				v_tr.id = 'tr_lista_DOCSANT_'+lista_count_DOCSANT;
				var temp_count = lista_count_DOCSANT;
				v_tr.style.cursor = 'pointer';
				v_tr.onclick = function() {
					f_seleciona_DOCSANT(temp_count);
				}
				var v_td = document.createElement('TD');
				var v_dv1 = document.createElement('div');
				v_td.appendChild(v_dv1);
				v_td.className = 'linha_1';
				lista_inputs = '<input type="hidden" name="PADRAO_DOCSANT_'+lista_count_DOCSANT+'" id="PADRAO_DOCSANT_'+lista_count_DOCSANT+'" value="'+((padrao)?1:0)+'">';
				
				if (DOC_CNPJ_EMISSOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_CNPJ_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_CNPJ_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_CNPJ_EMISSOR.checked)?"1":"0")+'">';
				} else if (DOC_CNPJ_EMISSOR.type == 'file') {
					v_campo_file = document.forms[0].DOC_CNPJ_EMISSOR;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_CNPJ_EMISSOR_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_CNPJ_EMISSOR_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_CNPJ_EMISSOR';
					v_file_input.id = 'DOC_CNPJ_EMISSOR';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_CNPJ_EMISSOR.value;
				
					lista_inputs += '<input type="hidden" name="DOC_CNPJ_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_CNPJ_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DOC_EMITENTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_EMITENTE_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_EMITENTE_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_EMITENTE.checked)?"1":"0")+'">';
				} else if (DOC_EMITENTE.type == 'file') {
					v_campo_file = document.forms[0].DOC_EMITENTE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_EMITENTE_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_EMITENTE_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_EMITENTE';
					v_file_input.id = 'DOC_EMITENTE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_EMITENTE.value;
				
					lista_inputs += '<input type="hidden" name="DOC_EMITENTE_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_EMITENTE_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DOC_COD_EMISSOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_COD_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_COD_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_COD_EMISSOR.checked)?"1":"0")+'">';
				} else if (DOC_COD_EMISSOR.type == 'file') {
					v_campo_file = document.forms[0].DOC_COD_EMISSOR;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_COD_EMISSOR_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_COD_EMISSOR_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_COD_EMISSOR';
					v_file_input.id = 'DOC_COD_EMISSOR';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_COD_EMISSOR.value;
				
					lista_inputs += '<input type="hidden" name="DOC_COD_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_COD_EMISSOR_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CHAVECTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CHAVECTE_DOCSANT_'+lista_count_DOCSANT+'" id="CHAVECTE_DOCSANT_'+lista_count_DOCSANT+'" value="'+((CHAVECTE.checked)?"1":"0")+'">';
				} else if (CHAVECTE.type == 'file') {
					v_campo_file = document.forms[0].CHAVECTE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CHAVECTE_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'CHAVECTE_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'CHAVECTE';
					v_file_input.id = 'CHAVECTE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CHAVECTE.value;
				
					lista_inputs += '<input type="hidden" name="CHAVECTE_DOCSANT_'+lista_count_DOCSANT+'" id="CHAVECTE_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DOC_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_NUMERO_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_NUMERO_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_NUMERO.checked)?"1":"0")+'">';
				} else if (DOC_NUMERO.type == 'file') {
					v_campo_file = document.forms[0].DOC_NUMERO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_NUMERO_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_NUMERO_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_NUMERO';
					v_file_input.id = 'DOC_NUMERO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_NUMERO.value;
				
					lista_inputs += '<input type="hidden" name="DOC_NUMERO_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_NUMERO_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DOC_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_DATA_EMISSAO_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_DATA_EMISSAO_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_DATA_EMISSAO.checked)?"1":"0")+'">';
				} else if (DOC_DATA_EMISSAO.type == 'file') {
					v_campo_file = document.forms[0].DOC_DATA_EMISSAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_DATA_EMISSAO_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_DATA_EMISSAO_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_DATA_EMISSAO';
					v_file_input.id = 'DOC_DATA_EMISSAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_DATA_EMISSAO.value;
				
					lista_inputs += '<input type="hidden" name="DOC_DATA_EMISSAO_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_DATA_EMISSAO_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DOC_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_SERIE_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_SERIE_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_SERIE.checked)?"1":"0")+'">';
				} else if (DOC_SERIE.type == 'file') {
					v_campo_file = document.forms[0].DOC_SERIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_SERIE_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_SERIE_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_SERIE';
					v_file_input.id = 'DOC_SERIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_SERIE.value;
				
					lista_inputs += '<input type="hidden" name="DOC_SERIE_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_SERIE_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DOC_SUB_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_SUB_SERIE_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_SUB_SERIE_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_SUB_SERIE.checked)?"1":"0")+'">';
				} else if (DOC_SUB_SERIE.type == 'file') {
					v_campo_file = document.forms[0].DOC_SUB_SERIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_SUB_SERIE_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_SUB_SERIE_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_SUB_SERIE';
					v_file_input.id = 'DOC_SUB_SERIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_SUB_SERIE.value;
				
					lista_inputs += '<input type="hidden" name="DOC_SUB_SERIE_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_SUB_SERIE_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (DOC_TIPO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_TIPO_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_TIPO_DOCSANT_'+lista_count_DOCSANT+'" value="'+((DOC_TIPO.checked)?"1":"0")+'">';
				} else if (DOC_TIPO.type == 'file') {
					v_campo_file = document.forms[0].DOC_TIPO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'DOC_TIPO_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'DOC_TIPO_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'DOC_TIPO';
					v_file_input.id = 'DOC_TIPO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = DOC_TIPO.value;
				
					lista_inputs += '<input type="hidden" name="DOC_TIPO_DOCSANT_'+lista_count_DOCSANT+'" id="DOC_TIPO_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				if (ELETRONICO_PAPEL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ELETRONICO_PAPEL_DOCSANT_'+lista_count_DOCSANT+'" id="ELETRONICO_PAPEL_DOCSANT_'+lista_count_DOCSANT+'" value="'+((ELETRONICO_PAPEL.checked)?"1":"0")+'">';
				} else if (ELETRONICO_PAPEL.type == 'file') {
					v_campo_file = document.forms[0].ELETRONICO_PAPEL;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'ELETRONICO_PAPEL_DOCSANT_'+lista_count_DOCSANT;
					v_campo_file.name = 'ELETRONICO_PAPEL_DOCSANT_'+lista_count_DOCSANT;
					v_file_input.name = 'ELETRONICO_PAPEL';
					v_file_input.id = 'ELETRONICO_PAPEL';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = ELETRONICO_PAPEL.value;
				
					lista_inputs += '<input type="hidden" name="ELETRONICO_PAPEL_DOCSANT_'+lista_count_DOCSANT+'" id="ELETRONICO_PAPEL_DOCSANT_'+lista_count_DOCSANT+'">';
				}
//				v_td.appendChild(v_input)
				
				v_dv1.innerHTML = '<img id="lista_padrao_DOCSANT_'+lista_count_DOCSANT+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				v_td.width = 16;
				
				v_td.style.display = 'none';
				
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+DOC_EMITENTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CHAVECTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+DOC_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+DOC_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+DOC_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+DOC_SUB_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+''+DOC_TIPO_DESC.value+'';
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				tbody.appendChild(v_tr);
				
				if (DOC_CNPJ_EMISSOR.type != 'checkbox' && DOC_CNPJ_EMISSOR.type != 'file') {
					document.getElementById('DOC_CNPJ_EMISSOR_DOCSANT_'+lista_count_DOCSANT).value = DOC_CNPJ_EMISSOR.value;
				}
				
				if (DOC_EMITENTE.type != 'checkbox' && DOC_EMITENTE.type != 'file') {
					document.getElementById('DOC_EMITENTE_DOCSANT_'+lista_count_DOCSANT).value = DOC_EMITENTE.value;
				}
				
				if (DOC_COD_EMISSOR.type != 'checkbox' && DOC_COD_EMISSOR.type != 'file') {
					document.getElementById('DOC_COD_EMISSOR_DOCSANT_'+lista_count_DOCSANT).value = DOC_COD_EMISSOR.value;
				}
				
				if (CHAVECTE.type != 'checkbox' && CHAVECTE.type != 'file') {
					document.getElementById('CHAVECTE_DOCSANT_'+lista_count_DOCSANT).value = CHAVECTE.value;
				}
				
				if (DOC_NUMERO.type != 'checkbox' && DOC_NUMERO.type != 'file') {
					document.getElementById('DOC_NUMERO_DOCSANT_'+lista_count_DOCSANT).value = DOC_NUMERO.value;
				}
				
				if (DOC_DATA_EMISSAO.type != 'checkbox' && DOC_DATA_EMISSAO.type != 'file') {
					document.getElementById('DOC_DATA_EMISSAO_DOCSANT_'+lista_count_DOCSANT).value = DOC_DATA_EMISSAO.value;
				}
				
				if (DOC_SERIE.type != 'checkbox' && DOC_SERIE.type != 'file') {
					document.getElementById('DOC_SERIE_DOCSANT_'+lista_count_DOCSANT).value = DOC_SERIE.value;
				}
				
				if (DOC_SUB_SERIE.type != 'checkbox' && DOC_SUB_SERIE.type != 'file') {
					document.getElementById('DOC_SUB_SERIE_DOCSANT_'+lista_count_DOCSANT).value = DOC_SUB_SERIE.value;
				}
				
				if (DOC_TIPO.type != 'checkbox' && DOC_TIPO.type != 'file') {
					document.getElementById('DOC_TIPO_DOCSANT_'+lista_count_DOCSANT).value = DOC_TIPO.value;
				}
				
				if (ELETRONICO_PAPEL.type != 'checkbox' && ELETRONICO_PAPEL.type != 'file') {
					document.getElementById('ELETRONICO_PAPEL_DOCSANT_'+lista_count_DOCSANT).value = ELETRONICO_PAPEL.value;
				}
				

				lista_count_DOCSANT++;
				f_atualiza_campos_escravos_DOCSANT();
				f_incluir_DOCSANT();
			} else {
				var v_tr = document.getElementById('tr_lista_DOCSANT_'+lista_selected_DOCSANT.value);
				padrao = (document.getElementById('PADRAO_DOCSANT_'+lista_selected_DOCSANT.value).value == 1);
				lista_inputs = '<input type="hidden" name="PADRAO_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((padrao)?1:0)+'">';
				
				if (DOC_CNPJ_EMISSOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_CNPJ_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_CNPJ_EMISSOR.checked)?"1":"0")+'">';
					document.getElementById('DOC_CNPJ_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_CNPJ_EMISSOR.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_CNPJ_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_CNPJ_EMISSOR.value+'">';
					document.getElementById('DOC_CNPJ_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_CNPJ_EMISSOR.value;
				}
				
				if (DOC_EMITENTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_EMITENTE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_EMITENTE.checked)?"1":"0")+'">';
					document.getElementById('DOC_EMITENTE_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_EMITENTE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_EMITENTE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_EMITENTE.value+'">';
					document.getElementById('DOC_EMITENTE_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_EMITENTE.value;
				}
				
				if (DOC_COD_EMISSOR.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_COD_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_COD_EMISSOR.checked)?"1":"0")+'">';
					document.getElementById('DOC_COD_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_COD_EMISSOR.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_COD_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_COD_EMISSOR.value+'">';
					document.getElementById('DOC_COD_EMISSOR_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_COD_EMISSOR.value;
				}
				
				if (CHAVECTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CHAVECTE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((CHAVECTE.checked)?"1":"0")+'">';
					document.getElementById('CHAVECTE_DOCSANT_'+lista_selected_DOCSANT.value).value = ((CHAVECTE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CHAVECTE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+CHAVECTE.value+'">';
					document.getElementById('CHAVECTE_DOCSANT_'+lista_selected_DOCSANT.value).value = CHAVECTE.value;
				}
				
				if (DOC_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_NUMERO_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_NUMERO.checked)?"1":"0")+'">';
					document.getElementById('DOC_NUMERO_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_NUMERO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_NUMERO_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_NUMERO.value+'">';
					document.getElementById('DOC_NUMERO_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_NUMERO.value;
				}
				
				if (DOC_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_DATA_EMISSAO_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_DATA_EMISSAO.checked)?"1":"0")+'">';
					document.getElementById('DOC_DATA_EMISSAO_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_DATA_EMISSAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_DATA_EMISSAO_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_DATA_EMISSAO.value+'">';
					document.getElementById('DOC_DATA_EMISSAO_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_DATA_EMISSAO.value;
				}
				
				if (DOC_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_SERIE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_SERIE.checked)?"1":"0")+'">';
					document.getElementById('DOC_SERIE_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_SERIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_SERIE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_SERIE.value+'">';
					document.getElementById('DOC_SERIE_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_SERIE.value;
				}
				
				if (DOC_SUB_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_SUB_SERIE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_SUB_SERIE.checked)?"1":"0")+'">';
					document.getElementById('DOC_SUB_SERIE_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_SUB_SERIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_SUB_SERIE_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_SUB_SERIE.value+'">';
					document.getElementById('DOC_SUB_SERIE_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_SUB_SERIE.value;
				}
				
				if (DOC_TIPO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="DOC_TIPO_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((DOC_TIPO.checked)?"1":"0")+'">';
					document.getElementById('DOC_TIPO_DOCSANT_'+lista_selected_DOCSANT.value).value = ((DOC_TIPO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="DOC_TIPO_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+DOC_TIPO.value+'">';
					document.getElementById('DOC_TIPO_DOCSANT_'+lista_selected_DOCSANT.value).value = DOC_TIPO.value;
				}
				
				if (ELETRONICO_PAPEL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="ELETRONICO_PAPEL_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+((ELETRONICO_PAPEL.checked)?"1":"0")+'">';
					document.getElementById('ELETRONICO_PAPEL_DOCSANT_'+lista_selected_DOCSANT.value).value = ((ELETRONICO_PAPEL.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="ELETRONICO_PAPEL_DOCSANT_'+lista_selected_DOCSANT.value+'" value="'+ELETRONICO_PAPEL.value+'">';
					document.getElementById('ELETRONICO_PAPEL_DOCSANT_'+lista_selected_DOCSANT.value).value = ELETRONICO_PAPEL.value;
				}
				
//				v_tr.cells[0].innerHTML = '<img id="lista_padrao_DOCSANT_'+lista_selected_DOCSANT.value+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				
					var v_td = v_tr.cells[1];
					v_td.innerHTML = ''+DOC_EMITENTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[2];
					v_td.innerHTML = ''+CHAVECTE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[3];
					v_td.innerHTML = ''+DOC_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[4];
					v_td.innerHTML = ''+DOC_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[5];
					v_td.innerHTML = ''+DOC_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[6];
					v_td.innerHTML = ''+DOC_SUB_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[7];
					v_td.innerHTML = ''+''+DOC_TIPO_DESC.value+'';
					v_td.vAlign = 'top';
								
				f_atualiza_campos_escravos_DOCSANT();
				f_incluir_DOCSANT();
			}
		}
			
		
		f_on_salva_lista_DOCSANT();
	}
}
function f_cancelar_DOCSANT() {
	var tbody = document.getElementById('tb_lista_DOCSANT');		
	for(var i=0;i<tbody.rows.length;i++) {
		for(var j=0;j<tbody.rows[i].cells.length;j++) {
			tbody.rows[i].cells[j].className = 'linha_1';
		}
	}
	with(document.forms[0]) {
	
		

		if(document.getElementById('DOC_CNPJ_EMISSOR').getAttribute('type') != 'file') {
		  if (!DOC_CNPJ_EMISSOR.getAttribute('manter') || DOC_CNPJ_EMISSOR.getAttribute('manter') == 0) {
				if(DOC_CNPJ_EMISSOR.type == 'checkbox') {
					DOC_CNPJ_EMISSOR.checked = false;
				} else if(DOC_CNPJ_EMISSOR.type == 'select-one') {
					DOC_CNPJ_EMISSOR.selectedIndex = 0;
				} else {
					DOC_CNPJ_EMISSOR.value = '';
				}
				
				try {
					DOC_CNPJ_EMISSOR.focus();
				} catch(e) {
				}
				
			}
		}
		

		if(document.getElementById('DOC_EMITENTE').getAttribute('type') != 'file') {
		  if (!DOC_EMITENTE.getAttribute('manter') || DOC_EMITENTE.getAttribute('manter') == 0) {
				if(DOC_EMITENTE.type == 'checkbox') {
					DOC_EMITENTE.checked = false;
				} else if(DOC_EMITENTE.type == 'select-one') {
					DOC_EMITENTE.selectedIndex = 0;
				} else {
					DOC_EMITENTE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DOC_COD_EMISSOR').getAttribute('type') != 'file') {
		  if (!DOC_COD_EMISSOR.getAttribute('manter') || DOC_COD_EMISSOR.getAttribute('manter') == 0) {
				if(DOC_COD_EMISSOR.type == 'checkbox') {
					DOC_COD_EMISSOR.checked = false;
				} else if(DOC_COD_EMISSOR.type == 'select-one') {
					DOC_COD_EMISSOR.selectedIndex = 0;
				} else {
					DOC_COD_EMISSOR.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CHAVECTE').getAttribute('type') != 'file') {
		  if (!CHAVECTE.getAttribute('manter') || CHAVECTE.getAttribute('manter') == 0) {
				if(CHAVECTE.type == 'checkbox') {
					CHAVECTE.checked = false;
				} else if(CHAVECTE.type == 'select-one') {
					CHAVECTE.selectedIndex = 0;
				} else {
					CHAVECTE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DOC_NUMERO').getAttribute('type') != 'file') {
		  if (!DOC_NUMERO.getAttribute('manter') || DOC_NUMERO.getAttribute('manter') == 0) {
				if(DOC_NUMERO.type == 'checkbox') {
					DOC_NUMERO.checked = false;
				} else if(DOC_NUMERO.type == 'select-one') {
					DOC_NUMERO.selectedIndex = 0;
				} else {
					DOC_NUMERO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DOC_DATA_EMISSAO').getAttribute('type') != 'file') {
		  if (!DOC_DATA_EMISSAO.getAttribute('manter') || DOC_DATA_EMISSAO.getAttribute('manter') == 0) {
				if(DOC_DATA_EMISSAO.type == 'checkbox') {
					DOC_DATA_EMISSAO.checked = false;
				} else if(DOC_DATA_EMISSAO.type == 'select-one') {
					DOC_DATA_EMISSAO.selectedIndex = 0;
				} else {
					DOC_DATA_EMISSAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DOC_SERIE').getAttribute('type') != 'file') {
		  if (!DOC_SERIE.getAttribute('manter') || DOC_SERIE.getAttribute('manter') == 0) {
				if(DOC_SERIE.type == 'checkbox') {
					DOC_SERIE.checked = false;
				} else if(DOC_SERIE.type == 'select-one') {
					DOC_SERIE.selectedIndex = 0;
				} else {
					DOC_SERIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DOC_SUB_SERIE').getAttribute('type') != 'file') {
		  if (!DOC_SUB_SERIE.getAttribute('manter') || DOC_SUB_SERIE.getAttribute('manter') == 0) {
				if(DOC_SUB_SERIE.type == 'checkbox') {
					DOC_SUB_SERIE.checked = false;
				} else if(DOC_SUB_SERIE.type == 'select-one') {
					DOC_SUB_SERIE.selectedIndex = 0;
				} else {
					DOC_SUB_SERIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('DOC_TIPO').getAttribute('type') != 'file') {
		  if (!DOC_TIPO.getAttribute('manter') || DOC_TIPO.getAttribute('manter') == 0) {
				if(DOC_TIPO.type == 'checkbox') {
					DOC_TIPO.checked = false;
				} else if(DOC_TIPO.type == 'select-one') {
					DOC_TIPO.selectedIndex = 0;
				} else {
					DOC_TIPO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('ELETRONICO_PAPEL').getAttribute('type') != 'file') {
		  if (!ELETRONICO_PAPEL.getAttribute('manter') || ELETRONICO_PAPEL.getAttribute('manter') == 0) {
				if(ELETRONICO_PAPEL.type == 'checkbox') {
					ELETRONICO_PAPEL.checked = false;
				} else if(ELETRONICO_PAPEL.type == 'select-one') {
					ELETRONICO_PAPEL.selectedIndex = 0;
				} else {
					ELETRONICO_PAPEL.value = '';
				}
				
			}
		}
		
		lista_selected_DOCSANT.value = -1;
	}
	f_desabilitar_botao_lista_DOCSANT('padrao');
	f_desabilitar_botao_lista_DOCSANT('excluir');
		
	f_on_incluir_DOCSANT();
}
function f_habilitar_botao_lista_DOCSANT(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_DOCSANT');
	if(obj != null) {
		obj.disabled = false;
		img_obj = document.getElementById('img_lista_'+v_botao+'_DOCSANT');
		img_obj.src = img_obj.src.replace('_disable.gif', '.gif');
	}
}
function f_desabilitar_botao_lista_DOCSANT(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_DOCSANT');
	if(obj != null) {
		obj.disabled = true;
		img_obj = document.getElementById('img_lista_'+v_botao+'_DOCSANT');
		if(img_obj.src.indexOf('_disable') == -1) {
			img_obj.src = img_obj.src.replace('.gif', '_disable.gif');
		}
	}
}
function f_seleciona_DOCSANT(v_nro) {
	
	if(!document.getElementById('btn_lista_incluir_DOCSANT').disabled) {
	
		f_before_selecionar_DOCSANT();
		f_cancelar_DOCSANT();
		var tbody = document.getElementById('tb_lista_DOCSANT');		
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_DOCSANT_'+v_nro) {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_1';
				}			
			} else {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_over';
				}
			}
		}
		with (document.forms[0]) {
			
			if(DOC_CNPJ_EMISSOR.type == 'checkbox') {
				DOC_CNPJ_EMISSOR.checked = (document.getElementById('DOC_CNPJ_EMISSOR_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_CNPJ_EMISSOR').type == 'file') {
				v_campo_valor = document.getElementById('DOC_CNPJ_EMISSOR_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_CNPJ_EMISSOR');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_CNPJ_EMISSOR';
				v_campo_valor.name = 'DOC_CNPJ_EMISSOR';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_CNPJ_EMISSOR.value = document.getElementById('DOC_CNPJ_EMISSOR_DOCSANT_'+v_nro).value;
			}
			
			if(DOC_EMITENTE.type == 'checkbox') {
				DOC_EMITENTE.checked = (document.getElementById('DOC_EMITENTE_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_EMITENTE').type == 'file') {
				v_campo_valor = document.getElementById('DOC_EMITENTE_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_EMITENTE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_EMITENTE';
				v_campo_valor.name = 'DOC_EMITENTE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_EMITENTE.value = document.getElementById('DOC_EMITENTE_DOCSANT_'+v_nro).value;
			}
			
			if(DOC_COD_EMISSOR.type == 'checkbox') {
				DOC_COD_EMISSOR.checked = (document.getElementById('DOC_COD_EMISSOR_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_COD_EMISSOR').type == 'file') {
				v_campo_valor = document.getElementById('DOC_COD_EMISSOR_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_COD_EMISSOR');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_COD_EMISSOR';
				v_campo_valor.name = 'DOC_COD_EMISSOR';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_COD_EMISSOR.value = document.getElementById('DOC_COD_EMISSOR_DOCSANT_'+v_nro).value;
			}
			
			if(CHAVECTE.type == 'checkbox') {
				CHAVECTE.checked = (document.getElementById('CHAVECTE_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('CHAVECTE').type == 'file') {
				v_campo_valor = document.getElementById('CHAVECTE_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('CHAVECTE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CHAVECTE';
				v_campo_valor.name = 'CHAVECTE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CHAVECTE.value = document.getElementById('CHAVECTE_DOCSANT_'+v_nro).value;
			}
			
			if(DOC_NUMERO.type == 'checkbox') {
				DOC_NUMERO.checked = (document.getElementById('DOC_NUMERO_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_NUMERO').type == 'file') {
				v_campo_valor = document.getElementById('DOC_NUMERO_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_NUMERO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_NUMERO';
				v_campo_valor.name = 'DOC_NUMERO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_NUMERO.value = document.getElementById('DOC_NUMERO_DOCSANT_'+v_nro).value;
			}
			
			if(DOC_DATA_EMISSAO.type == 'checkbox') {
				DOC_DATA_EMISSAO.checked = (document.getElementById('DOC_DATA_EMISSAO_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_DATA_EMISSAO').type == 'file') {
				v_campo_valor = document.getElementById('DOC_DATA_EMISSAO_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_DATA_EMISSAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_DATA_EMISSAO';
				v_campo_valor.name = 'DOC_DATA_EMISSAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_DATA_EMISSAO.value = document.getElementById('DOC_DATA_EMISSAO_DOCSANT_'+v_nro).value;
			}
			
			if(DOC_SERIE.type == 'checkbox') {
				DOC_SERIE.checked = (document.getElementById('DOC_SERIE_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_SERIE').type == 'file') {
				v_campo_valor = document.getElementById('DOC_SERIE_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_SERIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_SERIE';
				v_campo_valor.name = 'DOC_SERIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_SERIE.value = document.getElementById('DOC_SERIE_DOCSANT_'+v_nro).value;
			}
			
			if(DOC_SUB_SERIE.type == 'checkbox') {
				DOC_SUB_SERIE.checked = (document.getElementById('DOC_SUB_SERIE_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_SUB_SERIE').type == 'file') {
				v_campo_valor = document.getElementById('DOC_SUB_SERIE_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_SUB_SERIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_SUB_SERIE';
				v_campo_valor.name = 'DOC_SUB_SERIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_SUB_SERIE.value = document.getElementById('DOC_SUB_SERIE_DOCSANT_'+v_nro).value;
			}
			
			if(DOC_TIPO.type == 'checkbox') {
				DOC_TIPO.checked = (document.getElementById('DOC_TIPO_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('DOC_TIPO').type == 'file') {
				v_campo_valor = document.getElementById('DOC_TIPO_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('DOC_TIPO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'DOC_TIPO';
				v_campo_valor.name = 'DOC_TIPO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				DOC_TIPO.value = document.getElementById('DOC_TIPO_DOCSANT_'+v_nro).value;
			}
			
			if(ELETRONICO_PAPEL.type == 'checkbox') {
				ELETRONICO_PAPEL.checked = (document.getElementById('ELETRONICO_PAPEL_DOCSANT_'+v_nro).value == 1)
			} else if(document.getElementById('ELETRONICO_PAPEL').type == 'file') {
				v_campo_valor = document.getElementById('ELETRONICO_PAPEL_DOCSANT_'+v_nro);
				v_campo_atual = document.getElementById('ELETRONICO_PAPEL');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'ELETRONICO_PAPEL';
				v_campo_valor.name = 'ELETRONICO_PAPEL';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				ELETRONICO_PAPEL.value = document.getElementById('ELETRONICO_PAPEL_DOCSANT_'+v_nro).value;
			}
			
			lista_selected_DOCSANT.value = v_nro;
		}
		f_habilitar_botao_lista_DOCSANT('padrao');
		f_habilitar_botao_lista_DOCSANT('excluir');
		f_habilitar_botao_lista_DOCSANT('salvar');
		f_on_seleciona_DOCSANT();
	
	}
	
}
function f_padrao_DOCSANT(v_nro) {
	if(v_nro == -1) {
		return;
	}
	var tbody = document.getElementById('tb_lista_DOCSANT');		
	with(document.forms[0]) {
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_DOCSANT_'+v_nro) {
				var row_id = tbody.rows[i].id.replace('tr_lista_DOCSANT_', '');
				document.getElementById('lista_padrao_DOCSANT_'+row_id).style.display = 'none';
				document.getElementById('PADRAO_DOCSANT_'+row_id).value = 0;
			}
		}
	}
	document.getElementById('lista_padrao_DOCSANT_'+v_nro).style.display = '';
	document.getElementById('PADRAO_DOCSANT_'+v_nro).value = 1;
}	

function f_total_campo_DOCSANT(v_campo) {
	var tbody = document.getElementById('tb_lista_DOCSANT');
	var soma = 0;
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_DOCSANT_', '');
		with(document.forms[0]) {
			try {
				soma += (eval("document.forms[0]."+v_campo+"_DOCSANT_"+id_linha+".value")*1);
			} catch(e) {
			}
		}
	}
	return soma;
}
function f_atualiza_campos_escravos_DOCSANT() {

}

function f_atualiza_campo_escravo_DOCSANT(v_valor_mestre, v_campo_escravo, v_value) {
	var tbody = document.getElementById('tb_lista_DOCSANT');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_DOCSANT_', '');
		with(document.forms[0]) {
			try {
				if (eval("document.forms[0]._DOCSANT_"+id_linha).value == v_valor_mestre) {
					eval("document.forms[0]."+v_campo_escravo+"_DOCSANT_"+id_linha).value = v_value;
				}				
			} catch(e) {
			}
		}
	}
}

function f_register(p_id) {
	this.id = p_id;

	this.DOC_CNPJ_EMISSOR = '';

	this.DOC_EMITENTE = '';

	this.DOC_COD_EMISSOR = '';

	this.CHAVECTE = '';

	this.DOC_NUMERO = '';

	this.DOC_DATA_EMISSAO = '';

	this.DOC_SERIE = '';

	this.DOC_SUB_SERIE = '';

	this.DOC_TIPO = '';

	this.ELETRONICO_PAPEL = '';
}
//busca todos os registros
function f_listagem_DOCSANT() {
	var tbody = document.getElementById('tb_lista_DOCSANT');
	var result = new Array();
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_DOCSANT_', '');
		result[result.length] = new f_register(id_linha);
	
		try {
			result[result.length-1].DOC_CNPJ_EMISSOR = eval("document.forms[0].DOC_CNPJ_EMISSOR_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DOC_EMITENTE = eval("document.forms[0].DOC_EMITENTE_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DOC_COD_EMISSOR = eval("document.forms[0].DOC_COD_EMISSOR_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CHAVECTE = eval("document.forms[0].CHAVECTE_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DOC_NUMERO = eval("document.forms[0].DOC_NUMERO_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DOC_DATA_EMISSAO = eval("document.forms[0].DOC_DATA_EMISSAO_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DOC_SERIE = eval("document.forms[0].DOC_SERIE_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DOC_SUB_SERIE = eval("document.forms[0].DOC_SUB_SERIE_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].DOC_TIPO = eval("document.forms[0].DOC_TIPO_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].ELETRONICO_PAPEL = eval("document.forms[0].ELETRONICO_PAPEL_DOCSANT_"+id_linha).value;
		} catch(e) {}
	
	}
	return result;
}

function f_busca_campo_escravo_DOCSANT(v_valor_mestre, v_campo_escravo) {
	var tbody = document.getElementById('tb_lista_DOCSANT');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_DOCSANT_', '');
		with(document.forms[0]) {
				if (eval("document.forms[0]._DOCSANT_"+id_linha).value == v_valor_mestre) {
					return eval("document.forms[0]."+v_campo_escravo+"_DOCSANT_"+id_linha).value;
				}				
		}
	}
	return '';
}
function f_set_lista_min_DOCSANT(value) {

}

function f_before_selecionar_DOCSANT() {}
function f_on_seleciona_DOCSANT() {}
function f_on_salva_lista_DOCSANT() {}
function f_before_salvar_DOCSANT() { return true; }
function f_on_incluir_DOCSANT() {}
function f_on_excluir_DOCSANT() {}
</script>

<table width="100%" height="100%" align="left" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr id="tr_lista_botoes_DOCSANT">
    <td><table border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>

		
          <td><button tabindex="534" class="botao" id="btn_lista_incluir_DOCSANT" onclick="f_incluir_DOCSANT()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_incluir_DOCSANT" src="/_imagens/botoes/16x16/incluir.gif">&nbsp;Novo</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="535" class="botao" id="btn_lista_excluir_DOCSANT" onclick="f_excluir_DOCSANT(document.forms[0].lista_selected_DOCSANT.value)" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_excluir_DOCSANT" src="/_imagens/botoes/16x16/excluir.gif">&nbsp;Excluir</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="536" class="botao" id="btn_lista_salvar_DOCSANT" onclick="f_salvar_DOCSANT()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_salvar_DOCSANT" src="/_imagens/botoes/16x16/confirmar.gif">&nbsp;Salvar</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="537" class="botao" id="btn_lista_cancelar_DOCSANT" onclick="f_cancelar_DOCSANT()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_cancelar_DOCSANT" src="/_imagens/botoes/16x16/cancelar.gif">&nbsp;Cancelar</button></td>
          <td style="width: 4px;">&nbsp;</td>
		  
        </tr>
      </tbody></table></td>
  </tr>
  <tr><td height="4"></td></tr>
  <input name="lista_selected_DOCSANT" tabindex="538" id="lista_selected_DOCSANT" type="hidden" value="-1" fixo="1">
  <input name="lista_deleted_DOCSANT" tabindex="539" id="lista_deleted_DOCSANT" type="hidden" value="" fixo="1">
  <tr>
  
    <td height="200">
	<div class="lista" style="width: 100%; -ms-overflow-x: scroll;">
	<table width="100%" style="-ms-overflow-y: scroll;" border="0" cellspacing="1" cellpadding="3">
	<thead>
  <tr class="titulo_3" style="cursor: pointer;" onclick="sortColumn(event)">
    <td width="16" class="titulo_3" style="display: none;">&nbsp;</td>
  	
    <td width="30%" align="left" class="titulo_3" type="caseinsensitivestring">Emitente</td>
	
    <td width="30%" align="left" class="titulo_3" type="caseinsensitivestring">Chave</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Número</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Data emissão</td>
	
    <td width="5%" align="left" class="titulo_3" type="caseinsensitivestring">Série</td>
	
    <td width="5%" align="left" class="titulo_3" type="caseinsensitivestring">Sub-Série</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Tipo</td>
	
  </tr>
  </thead>
  <tbody id="tb_lista_DOCSANT">
  </tbody>
</table>

	</div></td>
  </tr>
</tbody></table>


										<script type="text/javascript">
										    function f_before_salvar_DOCSANT() {
												with(document.forms[0]) {
													if(Number(ELETRONICO_PAPEL.value) == 1){
														DOC_TIPO_DESC.value = '';
													}else {
													    DOC_TIPO_DESC.value = DOC_TIPO.options[DOC_TIPO.selectedIndex].text;
													}

												    return true;
												}
											}
											
										    function f_on_salva_lista_DOCSANT() {
												f_muda_tipo_documento_ant();
											}
										</script>
		                            </td>
	                            </tr>
                            </tbody></table>
                        </td>
                    </tr>
                </tbody></table>
        	</fieldset>
    	</td>
	</tr>
</tbody></table>

                                </fieldset>
                            </td>
               </tr>

               <tr style="display: none;">
                            <td class="td_aba_corpo" id="td_cte_ref_content" valign="top" style="display: none;" colspan="10">
                                <fieldset tabindex="540" id="fds_cte_ref" style="margin: 0px; padding: 0px; border: 0px currentColor; border-image: none;">
                                	<script language="javascript1.2">
	
	function f_atualiza_peso_cte_ref(){
		with(document.forms[0]) {
			if (EMITE_MULTIMODAL.value == '1' && VINCULADO_MULTIMODAL.value == '1') { 
				var v_peso;
				var v_peso_restante;
				var v_peso_restante_tolerancia;
				v_ctes  = f_listagem_CTES_REF();
				for(i=0; i<v_ctes.length; i++){	
					
					v_peso = document.getElementById('CTE_REF_PESO_REAL_CTES_REF_' + v_ctes[i].id);
					v_peso_restante = document.getElementById('CTE_REF_PESO_RESTANTE_CTES_REF_' + v_ctes[i].id);
					v_peso_restante_tolerancia = document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_' + v_ctes[i].id);
					
					v_peso.value = PESO_REAL.value;
					
					if (v_peso.value <= v_peso_restante.value) {
					   document.getElementById('CTE_REF_PESO_REAL').style.color = 'black';
					} else if ((v_peso.value > v_peso_restante.value) && (v_peso.value <= v_peso_restante_tolerancia.value)) {
					   document.getElementById('CTE_REF_PESO_REAL').style.color = 'orange';
					} else {		     
					   document.getElementById('CTE_REF_PESO_REAL').style.color = 'red';
					}
				}
			}
		}
	}	
	
	function f_busca_dados() {
		with(document.forms[0]) {
			if(CTE_REF_ARQUIVO.value){
				var v_nome_arquivo = CTE_REF_ARQUIVO.value;
				var v_extensao = v_nome_arquivo.substr(v_nome_arquivo.lastIndexOf('.'));
				
				if(v_extensao != '.xml' && v_extensao != '.XML'){
					alert('O arquivo selecionado deve ser um XML.');
					return false;					
				}
				f_cria_carregando_ajax();
				OPERACAO.value = 18;
				target = 'consultas';
				action = 'confirma.cfm';
				submit();
			}
		}
	}
	
	function f_busca_dados_chave_cte(){
		with(document.forms[0]) {
			if(CTE_REF_CHAVE.value){
				if( isNaN(CTE_REF_CHAVE.value)){
					alert('Preencha somente os números da chave.');
					return false;
				}
				f_validar_chave_cte();
				
			    v_chave = CTE_REF_CHAVE.value.toString();
			    CTE_REF_NUMERO.value = Number(v_chave.substr(25,9));
			    CTE_REF_SERIE.value = Number(v_chave.substr(22,3));
			}
		}
	}
	parent.f_busca_dados_chave_cte = f_busca_dados_chave_cte;
	
</script>
<input name="CTE_REF_REM_IE" tabindex="541" id="CTE_REF_REM_IE" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO" tabindex="542" id="CTE_REF_REM_ENDERECO" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO_NRO" tabindex="543" id="CTE_REF_REM_ENDERECO_NRO" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO_BAIRRO" tabindex="544" id="CTE_REF_REM_ENDERECO_BAIRRO" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO_CMUN" tabindex="545" id="CTE_REF_REM_ENDERECO_CMUN" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO_XMUN" tabindex="546" id="CTE_REF_REM_ENDERECO_XMUN" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO_CEP" tabindex="547" id="CTE_REF_REM_ENDERECO_CEP" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO_UF" tabindex="548" id="CTE_REF_REM_ENDERECO_UF" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_REM_ENDERECO_PAIS" tabindex="549" id="CTE_REF_REM_ENDERECO_PAIS" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_IE" tabindex="550" id="CTE_REF_DEST_IE" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO" tabindex="551" id="CTE_REF_DEST_ENDERECO" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO_NRO" tabindex="552" id="CTE_REF_DEST_ENDERECO_NRO" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO_BAIRRO" tabindex="553" id="CTE_REF_DEST_ENDERECO_BAIRRO" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO_CMUN" tabindex="554" id="CTE_REF_DEST_ENDERECO_CMUN" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO_XMUN" tabindex="555" id="CTE_REF_DEST_ENDERECO_XMUN" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO_CEP" tabindex="556" id="CTE_REF_DEST_ENDERECO_CEP" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO_UF" tabindex="557" id="CTE_REF_DEST_ENDERECO_UF" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_DEST_ENDERECO_PAIS" tabindex="558" id="CTE_REF_DEST_ENDERECO_PAIS" type="hidden" sempre_ativo="1" secao="CTES_REF">
<input name="CTE_REF_CONHECIMENTO_ID" tabindex="559" id="CTE_REF_CONHECIMENTO_ID" type="hidden" sempre_ativo="1" secao="CTES_REF">

<fieldset tabindex="560"><legend>CT-e Referenciado</legend>
	<table width="100%" border="0" cellspacing="1" cellpadding="3">
	   <tbody><tr>
	      <td>
	       	 <fieldset tabindex="561"><legend>Dados CT-e Original</legend>
	            <table width="100%" border="0" cellspacing="3" cellpadding="0">
					<tbody><tr>
						<td width="1%" height="1" class="texto" nowrap="">Chave:</td>
						<td width="99%" class="texto">
							<input name="CTE_REF_CHAVE" tabindex="562" class="requerido_form" id="CTE_REF_CHAVE" style="width: 320px;" onchange="f_busca_dados_chave_cte();" type="text" maxlength="44" display="CTE REFERENCIADO / CHAVE" obrigatorio="1" secao="CTES_REF">
							Localizar dados em XML: 
                        <input name="CTE_REF_ARQUIVO" tabindex="563" id="CTE_REF_ARQUIVO" onchange="f_busca_dados();" type="file">
						</td>
                    
					</tr>
					<tr>
						<td width="1%" height="1" class="texto" nowrap="">Número:</td>
						<td width="99%" class="texto">
							<input name="CTE_REF_NUMERO" tabindex="564" id="CTE_REF_NUMERO" style="width: 92px;" type="text" readonly="readonly" display="CTE REFERENCIADO / NÚMERO" obrigatorio="0" secao="CTES_REF">
							Série:
							<input name="CTE_REF_SERIE" tabindex="565" id="CTE_REF_SERIE" style="width: 65px;" type="text" readonly="readonly" display="CTE REFERENCIADO / SÉRIE" obrigatorio="0" secao="CTES_REF">
							Status:
							<input name="CTE_REF_SITUACAO" tabindex="566" id="CTE_REF_SITUACAO" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / STATUS" obrigatorio="0" secao="CTES_REF">
							Data de emissão:
							<input name="CTE_REF_DATA_EMISSAO" tabindex="567" id="CTE_REF_DATA_EMISSAO" style="width: 90px;" type="text" readonly="readonly" display="CTE REFERENCIADO / DATA DE EMISSÃƒO" obrigatorio="0" secao="CTES_REF">
						</td>
					</tr>
					<tr>
						<td width="1%" height="1" class="texto" nowrap="">Emitente:</td>
						<td width="99%" class="texto">
							<input name="CTE_REF_EMIT_CNPJ_CPF" tabindex="568" id="CTE_REF_EMIT_CNPJ_CPF" style="width: 125px;" type="text" maxlength="30" readonly="readonly" display="CTE REFERENCIADO / EMITENTE" secao="CTES_REF">
							<input name="CTE_REF_EMIT_RAZAO" tabindex="569" id="CTE_REF_EMIT_RAZAO" style="width: 400px;" type="text" maxlength="30" readonly="readonly" display="CTE REFERENCIADO / EMITENTE" secao="CTES_REF">
						</td>
					</tr>
					<tr>
						<td width="1%" height="1" class="texto" nowrap="">Remetente:</td>
						<td width="99%" class="texto">
							<input name="CTE_REF_REM_CNPJ_CPF" tabindex="570" id="CTE_REF_REM_CNPJ_CPF" style="width: 125px;" type="text" maxlength="30" readonly="readonly" display="CTE REFERENCIADO / REMETENTE" secao="CTES_REF">
							<input name="CTE_REF_REM_RAZAO" tabindex="571" id="CTE_REF_REM_RAZAO" style="width: 400px;" type="text" maxlength="30" readonly="readonly" display="CTE REFERENCIADO / REMETENTE" secao="CTES_REF">
						</td>
					</tr>
					<tr>
						<td width="1%" height="1" class="texto" nowrap="">Destinatário:</td>
						<td width="99%" class="texto">
							<input name="CTE_REF_DEST_CNPJ_CPF" tabindex="572" id="CTE_REF_DEST_CNPJ_CPF" style="width: 125px;" type="text" maxlength="30" readonly="readonly" display="CTE REFERENCIADO / DESTINATÁRIO" secao="CTES_REF">
							<input name="CTE_REF_DEST_RAZAO" tabindex="573" id="CTE_REF_DEST_RAZAO" style="width: 400px;" type="text" maxlength="30" readonly="readonly" display="CTE REFERENCIADO / DESTINATÃRIO" secao="CTES_REF">
						</td>
					</tr>
				</tbody></table>				
	         </fieldset>
	      </td>
	   </tr>
	   <tr id="tr_cte_ref_pesos" style="display: none;">
	      <td>
	       	 <fieldset tabindex="574"><legend>Pesos</legend>
	            <table height="100%" border="0" cellspacing="0" cellpadding="1">
	                <tbody><tr>
						<tr>
							<td class="texto" nowrap="">Ct-e multimodal:</td>
							<td><input name="CTE_REF_PESO_MULTIMODAL" tabindex="575" id="CTE_REF_PESO_MULTIMODAL" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / PESO CTE MULTIMODAL" obrigatorio="0" secao="CTES_REF"></td>
							<td class="texto" nowrap="">Peso restante:</td>
							<td><input name="CTE_REF_PESO_RESTANTE" tabindex="576" id="CTE_REF_PESO_RESTANTE" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / PESO RESTANTE" obrigatorio="0" secao="CTES_REF"></td>
					    </tr>
						<tr>
							<td class="texto" nowrap="">Percentual da tolerância:</td>
							<td><input name="CTE_REF_PERCENTUAL_TOLERANCIA" tabindex="577" id="CTE_REF_PERCENTUAL_TOLERANCIA" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / PERCENTUAL DA TOLERÂ‚NCIA" obrigatorio="0" secao="CTES_REF"></td>
							<td class="texto" nowrap="">Peso restante considerando tolerância:</td>
							<td><input name="CTE_REF_PESO_RESTANTE_TOLERANCIA" tabindex="578" id="CTE_REF_PESO_RESTANTE_TOLERANCIA" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / PESO RESTANTE CONSIDERANDO TOLERÂNCIA" obrigatorio="0" secao="CTES_REF"></td>
					    </tr>
						<tr>
							<td class="texto" nowrap="">Valor da tolerância:</td>
							<td><input name="CTE_REF_VALOR_TOLERANCIA" tabindex="579" id="CTE_REF_VALOR_TOLERANCIA" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / VALOR DA TOLERÂ‚NCIA" obrigatorio="0" secao="CTES_REF"></td>
							<td class="texto" nowrap="">Peso do CT-e sendo emitido:</td>
							<td><input name="CTE_REF_PESO_REAL" tabindex="580" id="CTE_REF_PESO_REAL" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / PESO DO CT-E SENDO EMITIDO" obrigatorio="0" secao="CTES_REF"></td>
					    </tr>
						<tr>
							<td class="texto" nowrap="">Somatório dos CT-es vinculados:</td>
							<td><input name="CTE_REF_PESO_CTES_VINCULADOS" tabindex="581" id="CTE_REF_PESO_CTES_VINCULADOS" style="width: 85px;" type="text" readonly="readonly" display="CTE REFERENCIADO / SOMATÓ“RIO DOS CT-ES VINCULADOS" obrigatorio="0" secao="CTES_REF"></td>
						</tr>
	                
				</tbody></table>
	         </fieldset>
	      </td>
	   </tr>
	   <tr>
	      <td>
	         <table width="100%" border="0" cellspacing="3" cellpadding="1">
	            <tbody><tr>
	                <td width="90%" style="padding-top: 5px;">
	                    <table width="100%" border="0" cellspacing="3" cellpadding="1">
	                    <tbody><tr><td>
	                    
<script src="/_scripts/tablesort.js"></script>
<script language="javascript1.2">
var DOUBLE_QUOTES = new RegExp( '"([^"]*)"', 'g' );


function f_ordenar_CTES_REF(campo, desc, tipo) {
//	try {
		if(!tipo) 
			tipo = 'caseinsensitivestring';
		v_tb = document.getElementById('tb_lista_CTES_REF');
		v_rows2 = new Array();
		for(var i=0;i<v_tb.rows.length;i++) 
			v_rows2.push(v_tb.rows[i]);
		v_rows2.sort(function(a,b) {
				v_id_a = a.id.replace('tr_lista_CTES_REF_','');
				v_id_b = b.id.replace('tr_lista_CTES_REF_','');
				if(tipo == 'number') {
					if( Number(document.getElementById(campo+'_CTES_REF_'+v_id_a).value) < Number(document.getElementById(campo+'_CTES_REF_'+v_id_b).value)) 
						return desc ? +1 : -1;
					if( Number(document.getElementById(campo+'_CTES_REF_'+v_id_a).value) > Number(document.getElementById(campo+'_CTES_REF_'+v_id_b).value)) 
						return desc ? -1 : +1;
				} else if(tipo == 'caseinsensitivestring') {
					if(document.getElementById(campo+'_CTES_REF_'+v_id_a).value < document.getElementById(campo+'_CTES_REF_'+v_id_b).value) 
						return desc ? +1 : -1;
					if(document.getElementById(campo+'_CTES_REF_'+v_id_a).value > document.getElementById(campo+'_CTES_REF_'+v_id_b).value) 
						return desc ? -1 : +1;
				}
				return 0;
			});
		for(var i=0;i<v_rows2.length;i++) {
			v_tb.appendChild(v_rows2[i]);
		}
//	} catch(e) {}
}

function f_incluir_CTES_REF() {
	with(document.forms[0]) {
		
		f_cancelar_CTES_REF();
	}
}

function f_excluir_CTES_REF(v_nro, v_nao_mostra_confirmar) {
	if(v_nro == -1) {
		return;
	}
	if(!v_nao_mostra_confirmar) {
		if(!confirm('Clique OK para confirmar a exclusão do registro!')) {
			return;
		}
	}
	with (document.forms[0]) {
		
			lista_deleted_CTES_REF.value = lista_deleted_CTES_REF.value+','+document.getElementById('CTE_REF_CHAVE_CTES_REF_'+v_nro).value;
		
	}
	var tbody = document.getElementById('tb_lista_CTES_REF');		
	for(var i=0;i<tbody.rows.length;i++) {
		if(tbody.rows[i].id == 'tr_lista_CTES_REF_'+v_nro) {
			tbody.deleteRow(i);
			f_cancelar_CTES_REF();
			break;
		}
	}
		
	
	f_cancelar_CTES_REF();
	f_on_salva_lista_CTES_REF();
	f_on_excluir_CTES_REF();
}
function f_limpar_CTES_REF() {
	var tbody = document.getElementById('tb_lista_CTES_REF');	
	while (tbody.rows.length > 0) {
		tbody.deleteRow(0);
	}
		
	
	document.forms[0].lista_selected_CTES_REF.value = -1;
}
var lista_count_CTES_REF = 0;


function f_testa_existencia_CTES_REF(chave, linha_atual, selectable) {
	var listagem = f_listagem_CTES_REF();
	for(var i=0;i<listagem.length;i++) {
		var items = chave.split('|');
		var igual = true;
		for(var j=0;j<items.length;j++) {
			if(eval('listagem['+i+'].'+items[j]) != eval('document.forms[0].'+items[j]+'.value') || listagem[i].id == linha_atual) {
					igual = false;
			}
		}
		if (igual) {
			return true;
		}
	}
}
function f_salvar_CTES_REF() {
	
	if (!f_before_salvar_CTES_REF()) {
	   return;
	}	
	if(f_verifica_form(document.forms[0], 'CTES_REF'))	{
		var padrao = true;
		var tbody = document.getElementById('tb_lista_CTES_REF');
		for(var i=0;i<tbody.rows.length;i++) {
			var row_id = tbody.rows[i].id.replace('tr_lista_CTES_REF_', '');
			if(document.getElementById('lista_padrao_CTES_REF_'+row_id).style.display == '') {
				padrao = false;
			}
		}
		with(document.forms[0]) {
			
					if(f_testa_existencia_CTES_REF('CTE_REF_CHAVE', lista_selected_CTES_REF.value, true)) {
						alert('Os campos não podem ser repetidos!');
						return;
					}
				
			if(lista_selected_CTES_REF.value == -1) {
				var v_tr = document.createElement('TR');
				v_tr.id = 'tr_lista_CTES_REF_'+lista_count_CTES_REF;
				var temp_count = lista_count_CTES_REF;
				v_tr.style.cursor = 'pointer';
				v_tr.onclick = function() {
					f_seleciona_CTES_REF(temp_count);
				}
				var v_td = document.createElement('TD');
				var v_dv1 = document.createElement('div');
				v_td.appendChild(v_dv1);
				v_td.className = 'linha_1';
				lista_inputs = '<input type="hidden" name="PADRAO_CTES_REF_'+lista_count_CTES_REF+'" id="PADRAO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((padrao)?1:0)+'">';
				
				if (CTE_REF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
				} else if (CTE_REF_CONHECIMENTO_ID.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_CONHECIMENTO_ID;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_CONHECIMENTO_ID';
					v_file_input.id = 'CTE_REF_CONHECIMENTO_ID';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_CONHECIMENTO_ID.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_CHAVE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_CHAVE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_CHAVE_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_CHAVE.checked)?"1":"0")+'">';
				} else if (CTE_REF_CHAVE.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_CHAVE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_CHAVE_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_CHAVE_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_CHAVE';
					v_file_input.id = 'CTE_REF_CHAVE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_CHAVE.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_CHAVE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_CHAVE_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_NUMERO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_NUMERO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_NUMERO.checked)?"1":"0")+'">';
				} else if (CTE_REF_NUMERO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_NUMERO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_NUMERO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_NUMERO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_NUMERO';
					v_file_input.id = 'CTE_REF_NUMERO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_NUMERO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_NUMERO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_NUMERO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_SERIE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_SERIE_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_SERIE.checked)?"1":"0")+'">';
				} else if (CTE_REF_SERIE.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_SERIE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_SERIE_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_SERIE_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_SERIE';
					v_file_input.id = 'CTE_REF_SERIE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_SERIE.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_SERIE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_SERIE_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_SITUACAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_SITUACAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_SITUACAO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_SITUACAO.checked)?"1":"0")+'">';
				} else if (CTE_REF_SITUACAO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_SITUACAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_SITUACAO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_SITUACAO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_SITUACAO';
					v_file_input.id = 'CTE_REF_SITUACAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_SITUACAO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_SITUACAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_SITUACAO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DATA_EMISSAO.checked)?"1":"0")+'">';
				} else if (CTE_REF_DATA_EMISSAO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DATA_EMISSAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DATA_EMISSAO';
					v_file_input.id = 'CTE_REF_DATA_EMISSAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DATA_EMISSAO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_EMIT_CNPJ_CPF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_EMIT_CNPJ_CPF.checked)?"1":"0")+'">';
				} else if (CTE_REF_EMIT_CNPJ_CPF.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_EMIT_CNPJ_CPF;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_EMIT_CNPJ_CPF';
					v_file_input.id = 'CTE_REF_EMIT_CNPJ_CPF';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_EMIT_CNPJ_CPF.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_EMIT_RAZAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_EMIT_RAZAO.checked)?"1":"0")+'">';
				} else if (CTE_REF_EMIT_RAZAO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_EMIT_RAZAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_EMIT_RAZAO';
					v_file_input.id = 'CTE_REF_EMIT_RAZAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_EMIT_RAZAO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_CNPJ_CPF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_CNPJ_CPF.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_CNPJ_CPF.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_CNPJ_CPF;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_CNPJ_CPF';
					v_file_input.id = 'CTE_REF_REM_CNPJ_CPF';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_CNPJ_CPF.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_IE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_IE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_IE_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_IE.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_IE.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_IE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_IE_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_IE_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_IE';
					v_file_input.id = 'CTE_REF_REM_IE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_IE.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_IE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_IE_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_RAZAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_RAZAO.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_RAZAO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_RAZAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_RAZAO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_RAZAO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_RAZAO';
					v_file_input.id = 'CTE_REF_REM_RAZAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_RAZAO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_RAZAO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO';
					v_file_input.id = 'CTE_REF_REM_ENDERECO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO_NRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO_NRO.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO_NRO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO_NRO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO_NRO';
					v_file_input.id = 'CTE_REF_REM_ENDERECO_NRO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO_NRO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO_BAIRRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO_BAIRRO.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO_BAIRRO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO_BAIRRO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO_BAIRRO';
					v_file_input.id = 'CTE_REF_REM_ENDERECO_BAIRRO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO_BAIRRO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO_CMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO_CMUN.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO_CMUN.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO_CMUN;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO_CMUN';
					v_file_input.id = 'CTE_REF_REM_ENDERECO_CMUN';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO_CMUN.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO_XMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO_XMUN.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO_XMUN.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO_XMUN;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO_XMUN';
					v_file_input.id = 'CTE_REF_REM_ENDERECO_XMUN';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO_XMUN.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO_CEP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO_CEP.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO_CEP.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO_CEP;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO_CEP';
					v_file_input.id = 'CTE_REF_REM_ENDERECO_CEP';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO_CEP.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO_UF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO_UF.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO_UF.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO_UF;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO_UF';
					v_file_input.id = 'CTE_REF_REM_ENDERECO_UF';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO_UF.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_REM_ENDERECO_PAIS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_REM_ENDERECO_PAIS.checked)?"1":"0")+'">';
				} else if (CTE_REF_REM_ENDERECO_PAIS.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_REM_ENDERECO_PAIS;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_REM_ENDERECO_PAIS';
					v_file_input.id = 'CTE_REF_REM_ENDERECO_PAIS';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_REM_ENDERECO_PAIS.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_CNPJ_CPF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_CNPJ_CPF.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_CNPJ_CPF.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_CNPJ_CPF;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_CNPJ_CPF';
					v_file_input.id = 'CTE_REF_DEST_CNPJ_CPF';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_CNPJ_CPF.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_IE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_IE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_IE_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_IE.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_IE.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_IE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_IE_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_IE_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_IE';
					v_file_input.id = 'CTE_REF_DEST_IE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_IE.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_IE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_IE_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_RAZAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_RAZAO.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_RAZAO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_RAZAO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_RAZAO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_RAZAO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_RAZAO';
					v_file_input.id = 'CTE_REF_DEST_RAZAO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_RAZAO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_RAZAO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_RAZAO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO_NRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO_NRO.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO_NRO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO_NRO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO_NRO';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO_NRO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO_NRO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO_BAIRRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO_BAIRRO.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO_BAIRRO.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO_BAIRRO;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO_BAIRRO';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO_BAIRRO';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO_BAIRRO.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO_CMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO_CMUN.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO_CMUN.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO_CMUN;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO_CMUN';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO_CMUN';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO_CMUN.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO_XMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO_XMUN.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO_XMUN.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO_XMUN;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO_XMUN';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO_XMUN';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO_XMUN.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO_CEP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO_CEP.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO_CEP.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO_CEP;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO_CEP';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO_CEP';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO_CEP.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO_UF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO_UF.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO_UF.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO_UF;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO_UF';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO_UF';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO_UF.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_DEST_ENDERECO_PAIS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_DEST_ENDERECO_PAIS.checked)?"1":"0")+'">';
				} else if (CTE_REF_DEST_ENDERECO_PAIS.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_DEST_ENDERECO_PAIS;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_DEST_ENDERECO_PAIS';
					v_file_input.id = 'CTE_REF_DEST_ENDERECO_PAIS';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_DEST_ENDERECO_PAIS.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_PESO_MULTIMODAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_PESO_MULTIMODAL.checked)?"1":"0")+'">';
				} else if (CTE_REF_PESO_MULTIMODAL.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_PESO_MULTIMODAL;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_PESO_MULTIMODAL';
					v_file_input.id = 'CTE_REF_PESO_MULTIMODAL';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_PESO_MULTIMODAL.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_PERCENTUAL_TOLERANCIA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_PERCENTUAL_TOLERANCIA.checked)?"1":"0")+'">';
				} else if (CTE_REF_PERCENTUAL_TOLERANCIA.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_PERCENTUAL_TOLERANCIA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_PERCENTUAL_TOLERANCIA';
					v_file_input.id = 'CTE_REF_PERCENTUAL_TOLERANCIA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_PERCENTUAL_TOLERANCIA.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_VALOR_TOLERANCIA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_VALOR_TOLERANCIA.checked)?"1":"0")+'">';
				} else if (CTE_REF_VALOR_TOLERANCIA.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_VALOR_TOLERANCIA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_VALOR_TOLERANCIA';
					v_file_input.id = 'CTE_REF_VALOR_TOLERANCIA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_VALOR_TOLERANCIA.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_PESO_CTES_VINCULADOS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_PESO_CTES_VINCULADOS.checked)?"1":"0")+'">';
				} else if (CTE_REF_PESO_CTES_VINCULADOS.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_PESO_CTES_VINCULADOS;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_PESO_CTES_VINCULADOS';
					v_file_input.id = 'CTE_REF_PESO_CTES_VINCULADOS';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_PESO_CTES_VINCULADOS.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_PESO_RESTANTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_PESO_RESTANTE.checked)?"1":"0")+'">';
				} else if (CTE_REF_PESO_RESTANTE.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_PESO_RESTANTE;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_PESO_RESTANTE';
					v_file_input.id = 'CTE_REF_PESO_RESTANTE';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_PESO_RESTANTE.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_PESO_RESTANTE_TOLERANCIA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_PESO_RESTANTE_TOLERANCIA.checked)?"1":"0")+'">';
				} else if (CTE_REF_PESO_RESTANTE_TOLERANCIA.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_PESO_RESTANTE_TOLERANCIA;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_PESO_RESTANTE_TOLERANCIA';
					v_file_input.id = 'CTE_REF_PESO_RESTANTE_TOLERANCIA';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_PESO_RESTANTE_TOLERANCIA.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				if (CTE_REF_PESO_REAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_REAL_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_REAL_CTES_REF_'+lista_count_CTES_REF+'" value="'+((CTE_REF_PESO_REAL.checked)?"1":"0")+'">';
				} else if (CTE_REF_PESO_REAL.type == 'file') {
					v_campo_file = document.forms[0].CTE_REF_PESO_REAL;
					v_file_input = v_campo_file.cloneNode(true);
					document.forms[0].appendChild(v_file_input);
					v_campo_file.parentNode.insertBefore(v_file_input, v_campo_file);
					v_campo_file.style.display = 'none';
//					v_td.appendChild(v_campo_file);
					v_campo_file.id = 'CTE_REF_PESO_REAL_CTES_REF_'+lista_count_CTES_REF;
					v_campo_file.name = 'CTE_REF_PESO_REAL_CTES_REF_'+lista_count_CTES_REF;
					v_file_input.name = 'CTE_REF_PESO_REAL';
					v_file_input.id = 'CTE_REF_PESO_REAL';
				    v_file_input.type = 'file';
//					alert(v_file_input.form.name + ' - '+ v_file_input.name);
//					alert(v_campo_file.form.name);
				} else {
					var v_texto = CTE_REF_PESO_REAL.value;
				
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_REAL_CTES_REF_'+lista_count_CTES_REF+'" id="CTE_REF_PESO_REAL_CTES_REF_'+lista_count_CTES_REF+'">';
				}
//				v_td.appendChild(v_input)
				
				v_dv1.innerHTML = '<img id="lista_padrao_CTES_REF_'+lista_count_CTES_REF+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				v_td.width = 16;
				
				v_td.style.display = 'none';
				
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_CHAVE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+CTE_REF_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'right';
				
				v_td.innerHTML = ''+CTE_REF_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_SITUACAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_EMIT_CNPJ_CPF.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_EMIT_RAZAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_REM_CNPJ_CPF.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_REM_RAZAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_DEST_CNPJ_CPF.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				var v_td = document.createElement('TD');
				
				
					v_td.align = 'left';
				
				v_td.innerHTML = ''+CTE_REF_DEST_RAZAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
				v_td.className = 'linha_1';
				v_td.vAlign = 'top';
				v_tr.appendChild(v_td);
				
				tbody.appendChild(v_tr);
				
				if (CTE_REF_CONHECIMENTO_ID.type != 'checkbox' && CTE_REF_CONHECIMENTO_ID.type != 'file') {
					document.getElementById('CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_CONHECIMENTO_ID.value;
				}
				
				if (CTE_REF_CHAVE.type != 'checkbox' && CTE_REF_CHAVE.type != 'file') {
					document.getElementById('CTE_REF_CHAVE_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_CHAVE.value;
				}
				
				if (CTE_REF_NUMERO.type != 'checkbox' && CTE_REF_NUMERO.type != 'file') {
					document.getElementById('CTE_REF_NUMERO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_NUMERO.value;
				}
				
				if (CTE_REF_SERIE.type != 'checkbox' && CTE_REF_SERIE.type != 'file') {
					document.getElementById('CTE_REF_SERIE_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_SERIE.value;
				}
				
				if (CTE_REF_SITUACAO.type != 'checkbox' && CTE_REF_SITUACAO.type != 'file') {
					document.getElementById('CTE_REF_SITUACAO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_SITUACAO.value;
				}
				
				if (CTE_REF_DATA_EMISSAO.type != 'checkbox' && CTE_REF_DATA_EMISSAO.type != 'file') {
					document.getElementById('CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DATA_EMISSAO.value;
				}
				
				if (CTE_REF_EMIT_CNPJ_CPF.type != 'checkbox' && CTE_REF_EMIT_CNPJ_CPF.type != 'file') {
					document.getElementById('CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_EMIT_CNPJ_CPF.value;
				}
				
				if (CTE_REF_EMIT_RAZAO.type != 'checkbox' && CTE_REF_EMIT_RAZAO.type != 'file') {
					document.getElementById('CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_EMIT_RAZAO.value;
				}
				
				if (CTE_REF_REM_CNPJ_CPF.type != 'checkbox' && CTE_REF_REM_CNPJ_CPF.type != 'file') {
					document.getElementById('CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_CNPJ_CPF.value;
				}
				
				if (CTE_REF_REM_IE.type != 'checkbox' && CTE_REF_REM_IE.type != 'file') {
					document.getElementById('CTE_REF_REM_IE_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_IE.value;
				}
				
				if (CTE_REF_REM_RAZAO.type != 'checkbox' && CTE_REF_REM_RAZAO.type != 'file') {
					document.getElementById('CTE_REF_REM_RAZAO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_RAZAO.value;
				}
				
				if (CTE_REF_REM_ENDERECO.type != 'checkbox' && CTE_REF_REM_ENDERECO.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO.value;
				}
				
				if (CTE_REF_REM_ENDERECO_NRO.type != 'checkbox' && CTE_REF_REM_ENDERECO_NRO.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO_NRO.value;
				}
				
				if (CTE_REF_REM_ENDERECO_BAIRRO.type != 'checkbox' && CTE_REF_REM_ENDERECO_BAIRRO.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO_BAIRRO.value;
				}
				
				if (CTE_REF_REM_ENDERECO_CMUN.type != 'checkbox' && CTE_REF_REM_ENDERECO_CMUN.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO_CMUN.value;
				}
				
				if (CTE_REF_REM_ENDERECO_XMUN.type != 'checkbox' && CTE_REF_REM_ENDERECO_XMUN.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO_XMUN.value;
				}
				
				if (CTE_REF_REM_ENDERECO_CEP.type != 'checkbox' && CTE_REF_REM_ENDERECO_CEP.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO_CEP.value;
				}
				
				if (CTE_REF_REM_ENDERECO_UF.type != 'checkbox' && CTE_REF_REM_ENDERECO_UF.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO_UF.value;
				}
				
				if (CTE_REF_REM_ENDERECO_PAIS.type != 'checkbox' && CTE_REF_REM_ENDERECO_PAIS.type != 'file') {
					document.getElementById('CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_REM_ENDERECO_PAIS.value;
				}
				
				if (CTE_REF_DEST_CNPJ_CPF.type != 'checkbox' && CTE_REF_DEST_CNPJ_CPF.type != 'file') {
					document.getElementById('CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_CNPJ_CPF.value;
				}
				
				if (CTE_REF_DEST_IE.type != 'checkbox' && CTE_REF_DEST_IE.type != 'file') {
					document.getElementById('CTE_REF_DEST_IE_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_IE.value;
				}
				
				if (CTE_REF_DEST_RAZAO.type != 'checkbox' && CTE_REF_DEST_RAZAO.type != 'file') {
					document.getElementById('CTE_REF_DEST_RAZAO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_RAZAO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO.type != 'checkbox' && CTE_REF_DEST_ENDERECO.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_NRO.type != 'checkbox' && CTE_REF_DEST_ENDERECO_NRO.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO_NRO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_BAIRRO.type != 'checkbox' && CTE_REF_DEST_ENDERECO_BAIRRO.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO_BAIRRO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_CMUN.type != 'checkbox' && CTE_REF_DEST_ENDERECO_CMUN.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO_CMUN.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_XMUN.type != 'checkbox' && CTE_REF_DEST_ENDERECO_XMUN.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO_XMUN.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_CEP.type != 'checkbox' && CTE_REF_DEST_ENDERECO_CEP.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO_CEP.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_UF.type != 'checkbox' && CTE_REF_DEST_ENDERECO_UF.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO_UF.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_PAIS.type != 'checkbox' && CTE_REF_DEST_ENDERECO_PAIS.type != 'file') {
					document.getElementById('CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_DEST_ENDERECO_PAIS.value;
				}
				
				if (CTE_REF_PESO_MULTIMODAL.type != 'checkbox' && CTE_REF_PESO_MULTIMODAL.type != 'file') {
					document.getElementById('CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_PESO_MULTIMODAL.value;
				}
				
				if (CTE_REF_PERCENTUAL_TOLERANCIA.type != 'checkbox' && CTE_REF_PERCENTUAL_TOLERANCIA.type != 'file') {
					document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_PERCENTUAL_TOLERANCIA.value;
				}
				
				if (CTE_REF_VALOR_TOLERANCIA.type != 'checkbox' && CTE_REF_VALOR_TOLERANCIA.type != 'file') {
					document.getElementById('CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_VALOR_TOLERANCIA.value;
				}
				
				if (CTE_REF_PESO_CTES_VINCULADOS.type != 'checkbox' && CTE_REF_PESO_CTES_VINCULADOS.type != 'file') {
					document.getElementById('CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_PESO_CTES_VINCULADOS.value;
				}
				
				if (CTE_REF_PESO_RESTANTE.type != 'checkbox' && CTE_REF_PESO_RESTANTE.type != 'file') {
					document.getElementById('CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_PESO_RESTANTE.value;
				}
				
				if (CTE_REF_PESO_RESTANTE_TOLERANCIA.type != 'checkbox' && CTE_REF_PESO_RESTANTE_TOLERANCIA.type != 'file') {
					document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_PESO_RESTANTE_TOLERANCIA.value;
				}
				
				if (CTE_REF_PESO_REAL.type != 'checkbox' && CTE_REF_PESO_REAL.type != 'file') {
					document.getElementById('CTE_REF_PESO_REAL_CTES_REF_'+lista_count_CTES_REF).value = CTE_REF_PESO_REAL.value;
				}
				

				lista_count_CTES_REF++;
				f_atualiza_campos_escravos_CTES_REF();
				f_incluir_CTES_REF();
			} else {
				var v_tr = document.getElementById('tr_lista_CTES_REF_'+lista_selected_CTES_REF.value);
				padrao = (document.getElementById('PADRAO_CTES_REF_'+lista_selected_CTES_REF.value).value == 1);
				lista_inputs = '<input type="hidden" name="PADRAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((padrao)?1:0)+'">';
				
				if (CTE_REF_CONHECIMENTO_ID.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_CONHECIMENTO_ID.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_CONHECIMENTO_ID.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_CONHECIMENTO_ID.value+'">';
					document.getElementById('CTE_REF_CONHECIMENTO_ID_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_CONHECIMENTO_ID.value;
				}
				
				if (CTE_REF_CHAVE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_CHAVE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_CHAVE.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_CHAVE_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_CHAVE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_CHAVE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_CHAVE.value+'">';
					document.getElementById('CTE_REF_CHAVE_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_CHAVE.value;
				}
				
				if (CTE_REF_NUMERO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_NUMERO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_NUMERO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_NUMERO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_NUMERO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_NUMERO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_NUMERO.value+'">';
					document.getElementById('CTE_REF_NUMERO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_NUMERO.value;
				}
				
				if (CTE_REF_SERIE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_SERIE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_SERIE.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_SERIE_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_SERIE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_SERIE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_SERIE.value+'">';
					document.getElementById('CTE_REF_SERIE_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_SERIE.value;
				}
				
				if (CTE_REF_SITUACAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_SITUACAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_SITUACAO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_SITUACAO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_SITUACAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_SITUACAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_SITUACAO.value+'">';
					document.getElementById('CTE_REF_SITUACAO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_SITUACAO.value;
				}
				
				if (CTE_REF_DATA_EMISSAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DATA_EMISSAO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DATA_EMISSAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DATA_EMISSAO.value+'">';
					document.getElementById('CTE_REF_DATA_EMISSAO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DATA_EMISSAO.value;
				}
				
				if (CTE_REF_EMIT_CNPJ_CPF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_EMIT_CNPJ_CPF.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_EMIT_CNPJ_CPF.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_EMIT_CNPJ_CPF.value+'">';
					document.getElementById('CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_EMIT_CNPJ_CPF.value;
				}
				
				if (CTE_REF_EMIT_RAZAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_EMIT_RAZAO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_EMIT_RAZAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_EMIT_RAZAO.value+'">';
					document.getElementById('CTE_REF_EMIT_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_EMIT_RAZAO.value;
				}
				
				if (CTE_REF_REM_CNPJ_CPF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_CNPJ_CPF.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_CNPJ_CPF.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_CNPJ_CPF.value+'">';
					document.getElementById('CTE_REF_REM_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_CNPJ_CPF.value;
				}
				
				if (CTE_REF_REM_IE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_IE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_IE.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_IE_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_IE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_IE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_IE.value+'">';
					document.getElementById('CTE_REF_REM_IE_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_IE.value;
				}
				
				if (CTE_REF_REM_RAZAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_RAZAO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_RAZAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_RAZAO.value+'">';
					document.getElementById('CTE_REF_REM_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_RAZAO.value;
				}
				
				if (CTE_REF_REM_ENDERECO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO.value;
				}
				
				if (CTE_REF_REM_ENDERECO_NRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO_NRO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO_NRO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO_NRO.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO_NRO.value;
				}
				
				if (CTE_REF_REM_ENDERECO_BAIRRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO_BAIRRO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO_BAIRRO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO_BAIRRO.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO_BAIRRO.value;
				}
				
				if (CTE_REF_REM_ENDERECO_CMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO_CMUN.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO_CMUN.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO_CMUN.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO_CMUN.value;
				}
				
				if (CTE_REF_REM_ENDERECO_XMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO_XMUN.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO_XMUN.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO_XMUN.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO_XMUN.value;
				}
				
				if (CTE_REF_REM_ENDERECO_CEP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO_CEP.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO_CEP.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO_CEP.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO_CEP.value;
				}
				
				if (CTE_REF_REM_ENDERECO_UF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO_UF.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO_UF.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO_UF.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO_UF.value;
				}
				
				if (CTE_REF_REM_ENDERECO_PAIS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_REM_ENDERECO_PAIS.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_REM_ENDERECO_PAIS.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_REM_ENDERECO_PAIS.value+'">';
					document.getElementById('CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_REM_ENDERECO_PAIS.value;
				}
				
				if (CTE_REF_DEST_CNPJ_CPF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_CNPJ_CPF.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_CNPJ_CPF.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_CNPJ_CPF.value+'">';
					document.getElementById('CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_CNPJ_CPF.value;
				}
				
				if (CTE_REF_DEST_IE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_IE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_IE.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_IE_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_IE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_IE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_IE.value+'">';
					document.getElementById('CTE_REF_DEST_IE_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_IE.value;
				}
				
				if (CTE_REF_DEST_RAZAO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_RAZAO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_RAZAO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_RAZAO.value+'">';
					document.getElementById('CTE_REF_DEST_RAZAO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_RAZAO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_NRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO_NRO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO_NRO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO_NRO.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO_NRO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_BAIRRO.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO_BAIRRO.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO_BAIRRO.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO_BAIRRO.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO_BAIRRO.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_CMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO_CMUN.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO_CMUN.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO_CMUN.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO_CMUN.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_XMUN.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO_XMUN.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO_XMUN.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO_XMUN.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO_XMUN.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_CEP.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO_CEP.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO_CEP.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO_CEP.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO_CEP.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_UF.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO_UF.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO_UF.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO_UF.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO_UF.value;
				}
				
				if (CTE_REF_DEST_ENDERECO_PAIS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_DEST_ENDERECO_PAIS.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_DEST_ENDERECO_PAIS.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_DEST_ENDERECO_PAIS.value+'">';
					document.getElementById('CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_DEST_ENDERECO_PAIS.value;
				}
				
				if (CTE_REF_PESO_MULTIMODAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_PESO_MULTIMODAL.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_PESO_MULTIMODAL.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_PESO_MULTIMODAL.value+'">';
					document.getElementById('CTE_REF_PESO_MULTIMODAL_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_PESO_MULTIMODAL.value;
				}
				
				if (CTE_REF_PERCENTUAL_TOLERANCIA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_PERCENTUAL_TOLERANCIA.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_PERCENTUAL_TOLERANCIA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_PERCENTUAL_TOLERANCIA.value+'">';
					document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_PERCENTUAL_TOLERANCIA.value;
				}
				
				if (CTE_REF_VALOR_TOLERANCIA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_VALOR_TOLERANCIA.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_VALOR_TOLERANCIA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_VALOR_TOLERANCIA.value+'">';
					document.getElementById('CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_VALOR_TOLERANCIA.value;
				}
				
				if (CTE_REF_PESO_CTES_VINCULADOS.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_PESO_CTES_VINCULADOS.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_PESO_CTES_VINCULADOS.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_PESO_CTES_VINCULADOS.value+'">';
					document.getElementById('CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_PESO_CTES_VINCULADOS.value;
				}
				
				if (CTE_REF_PESO_RESTANTE.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_PESO_RESTANTE.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_PESO_RESTANTE.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_PESO_RESTANTE.value+'">';
					document.getElementById('CTE_REF_PESO_RESTANTE_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_PESO_RESTANTE.value;
				}
				
				if (CTE_REF_PESO_RESTANTE_TOLERANCIA.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_PESO_RESTANTE_TOLERANCIA.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_PESO_RESTANTE_TOLERANCIA.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_PESO_RESTANTE_TOLERANCIA.value+'">';
					document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_PESO_RESTANTE_TOLERANCIA.value;
				}
				
				if (CTE_REF_PESO_REAL.type == 'checkbox') {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_REAL_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+((CTE_REF_PESO_REAL.checked)?"1":"0")+'">';
					document.getElementById('CTE_REF_PESO_REAL_CTES_REF_'+lista_selected_CTES_REF.value).value = ((CTE_REF_PESO_REAL.checked)?"1":"0");
				} else {
					lista_inputs += '<input type="hidden" name="CTE_REF_PESO_REAL_CTES_REF_'+lista_selected_CTES_REF.value+'" value="'+CTE_REF_PESO_REAL.value+'">';
					document.getElementById('CTE_REF_PESO_REAL_CTES_REF_'+lista_selected_CTES_REF.value).value = CTE_REF_PESO_REAL.value;
				}
				
//				v_tr.cells[0].innerHTML = '<img id="lista_padrao_CTES_REF_'+lista_selected_CTES_REF.value+'" width=16 height=16 src="/_imagens/botoes/16x16/padrao.gif" '+(padrao?'':'style="display: none"')+'>'+lista_inputs;
				
					var v_td = v_tr.cells[1];
					v_td.innerHTML = ''+CTE_REF_CHAVE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[2];
					v_td.innerHTML = ''+CTE_REF_NUMERO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[3];
					v_td.innerHTML = ''+CTE_REF_SERIE.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[4];
					v_td.innerHTML = ''+CTE_REF_SITUACAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[5];
					v_td.innerHTML = ''+CTE_REF_DATA_EMISSAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[6];
					v_td.innerHTML = ''+CTE_REF_EMIT_CNPJ_CPF.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[7];
					v_td.innerHTML = ''+CTE_REF_EMIT_RAZAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[8];
					v_td.innerHTML = ''+CTE_REF_REM_CNPJ_CPF.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[9];
					v_td.innerHTML = ''+CTE_REF_REM_RAZAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[10];
					v_td.innerHTML = ''+CTE_REF_DEST_CNPJ_CPF.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
					
					var v_td = v_tr.cells[11];
					v_td.innerHTML = ''+CTE_REF_DEST_RAZAO.value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
					v_td.vAlign = 'top';
								
				f_atualiza_campos_escravos_CTES_REF();
				f_incluir_CTES_REF();
			}
		}
			
		
		f_on_salva_lista_CTES_REF();
	}
}
function f_cancelar_CTES_REF() {
	var tbody = document.getElementById('tb_lista_CTES_REF');		
	for(var i=0;i<tbody.rows.length;i++) {
		for(var j=0;j<tbody.rows[i].cells.length;j++) {
			tbody.rows[i].cells[j].className = 'linha_1';
		}
	}
	with(document.forms[0]) {
	
		

		if(document.getElementById('CTE_REF_CONHECIMENTO_ID').getAttribute('type') != 'file') {
		  if (!CTE_REF_CONHECIMENTO_ID.getAttribute('manter') || CTE_REF_CONHECIMENTO_ID.getAttribute('manter') == 0) {
				if(CTE_REF_CONHECIMENTO_ID.type == 'checkbox') {
					CTE_REF_CONHECIMENTO_ID.checked = false;
				} else if(CTE_REF_CONHECIMENTO_ID.type == 'select-one') {
					CTE_REF_CONHECIMENTO_ID.selectedIndex = 0;
				} else {
					CTE_REF_CONHECIMENTO_ID.value = '';
				}
				
				try {
					CTE_REF_CONHECIMENTO_ID.focus();
				} catch(e) {
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_CHAVE').getAttribute('type') != 'file') {
		  if (!CTE_REF_CHAVE.getAttribute('manter') || CTE_REF_CHAVE.getAttribute('manter') == 0) {
				if(CTE_REF_CHAVE.type == 'checkbox') {
					CTE_REF_CHAVE.checked = false;
				} else if(CTE_REF_CHAVE.type == 'select-one') {
					CTE_REF_CHAVE.selectedIndex = 0;
				} else {
					CTE_REF_CHAVE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_NUMERO').getAttribute('type') != 'file') {
		  if (!CTE_REF_NUMERO.getAttribute('manter') || CTE_REF_NUMERO.getAttribute('manter') == 0) {
				if(CTE_REF_NUMERO.type == 'checkbox') {
					CTE_REF_NUMERO.checked = false;
				} else if(CTE_REF_NUMERO.type == 'select-one') {
					CTE_REF_NUMERO.selectedIndex = 0;
				} else {
					CTE_REF_NUMERO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_SERIE').getAttribute('type') != 'file') {
		  if (!CTE_REF_SERIE.getAttribute('manter') || CTE_REF_SERIE.getAttribute('manter') == 0) {
				if(CTE_REF_SERIE.type == 'checkbox') {
					CTE_REF_SERIE.checked = false;
				} else if(CTE_REF_SERIE.type == 'select-one') {
					CTE_REF_SERIE.selectedIndex = 0;
				} else {
					CTE_REF_SERIE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_SITUACAO').getAttribute('type') != 'file') {
		  if (!CTE_REF_SITUACAO.getAttribute('manter') || CTE_REF_SITUACAO.getAttribute('manter') == 0) {
				if(CTE_REF_SITUACAO.type == 'checkbox') {
					CTE_REF_SITUACAO.checked = false;
				} else if(CTE_REF_SITUACAO.type == 'select-one') {
					CTE_REF_SITUACAO.selectedIndex = 0;
				} else {
					CTE_REF_SITUACAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DATA_EMISSAO').getAttribute('type') != 'file') {
		  if (!CTE_REF_DATA_EMISSAO.getAttribute('manter') || CTE_REF_DATA_EMISSAO.getAttribute('manter') == 0) {
				if(CTE_REF_DATA_EMISSAO.type == 'checkbox') {
					CTE_REF_DATA_EMISSAO.checked = false;
				} else if(CTE_REF_DATA_EMISSAO.type == 'select-one') {
					CTE_REF_DATA_EMISSAO.selectedIndex = 0;
				} else {
					CTE_REF_DATA_EMISSAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_EMIT_CNPJ_CPF').getAttribute('type') != 'file') {
		  if (!CTE_REF_EMIT_CNPJ_CPF.getAttribute('manter') || CTE_REF_EMIT_CNPJ_CPF.getAttribute('manter') == 0) {
				if(CTE_REF_EMIT_CNPJ_CPF.type == 'checkbox') {
					CTE_REF_EMIT_CNPJ_CPF.checked = false;
				} else if(CTE_REF_EMIT_CNPJ_CPF.type == 'select-one') {
					CTE_REF_EMIT_CNPJ_CPF.selectedIndex = 0;
				} else {
					CTE_REF_EMIT_CNPJ_CPF.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_EMIT_RAZAO').getAttribute('type') != 'file') {
		  if (!CTE_REF_EMIT_RAZAO.getAttribute('manter') || CTE_REF_EMIT_RAZAO.getAttribute('manter') == 0) {
				if(CTE_REF_EMIT_RAZAO.type == 'checkbox') {
					CTE_REF_EMIT_RAZAO.checked = false;
				} else if(CTE_REF_EMIT_RAZAO.type == 'select-one') {
					CTE_REF_EMIT_RAZAO.selectedIndex = 0;
				} else {
					CTE_REF_EMIT_RAZAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_CNPJ_CPF').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_CNPJ_CPF.getAttribute('manter') || CTE_REF_REM_CNPJ_CPF.getAttribute('manter') == 0) {
				if(CTE_REF_REM_CNPJ_CPF.type == 'checkbox') {
					CTE_REF_REM_CNPJ_CPF.checked = false;
				} else if(CTE_REF_REM_CNPJ_CPF.type == 'select-one') {
					CTE_REF_REM_CNPJ_CPF.selectedIndex = 0;
				} else {
					CTE_REF_REM_CNPJ_CPF.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_IE').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_IE.getAttribute('manter') || CTE_REF_REM_IE.getAttribute('manter') == 0) {
				if(CTE_REF_REM_IE.type == 'checkbox') {
					CTE_REF_REM_IE.checked = false;
				} else if(CTE_REF_REM_IE.type == 'select-one') {
					CTE_REF_REM_IE.selectedIndex = 0;
				} else {
					CTE_REF_REM_IE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_RAZAO').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_RAZAO.getAttribute('manter') || CTE_REF_REM_RAZAO.getAttribute('manter') == 0) {
				if(CTE_REF_REM_RAZAO.type == 'checkbox') {
					CTE_REF_REM_RAZAO.checked = false;
				} else if(CTE_REF_REM_RAZAO.type == 'select-one') {
					CTE_REF_REM_RAZAO.selectedIndex = 0;
				} else {
					CTE_REF_REM_RAZAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO.getAttribute('manter') || CTE_REF_REM_ENDERECO.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO.type == 'checkbox') {
					CTE_REF_REM_ENDERECO.checked = false;
				} else if(CTE_REF_REM_ENDERECO.type == 'select-one') {
					CTE_REF_REM_ENDERECO.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO_NRO').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO_NRO.getAttribute('manter') || CTE_REF_REM_ENDERECO_NRO.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO_NRO.type == 'checkbox') {
					CTE_REF_REM_ENDERECO_NRO.checked = false;
				} else if(CTE_REF_REM_ENDERECO_NRO.type == 'select-one') {
					CTE_REF_REM_ENDERECO_NRO.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO_NRO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO_BAIRRO.getAttribute('manter') || CTE_REF_REM_ENDERECO_BAIRRO.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO_BAIRRO.type == 'checkbox') {
					CTE_REF_REM_ENDERECO_BAIRRO.checked = false;
				} else if(CTE_REF_REM_ENDERECO_BAIRRO.type == 'select-one') {
					CTE_REF_REM_ENDERECO_BAIRRO.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO_BAIRRO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO_CMUN').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO_CMUN.getAttribute('manter') || CTE_REF_REM_ENDERECO_CMUN.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO_CMUN.type == 'checkbox') {
					CTE_REF_REM_ENDERECO_CMUN.checked = false;
				} else if(CTE_REF_REM_ENDERECO_CMUN.type == 'select-one') {
					CTE_REF_REM_ENDERECO_CMUN.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO_CMUN.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO_XMUN').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO_XMUN.getAttribute('manter') || CTE_REF_REM_ENDERECO_XMUN.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO_XMUN.type == 'checkbox') {
					CTE_REF_REM_ENDERECO_XMUN.checked = false;
				} else if(CTE_REF_REM_ENDERECO_XMUN.type == 'select-one') {
					CTE_REF_REM_ENDERECO_XMUN.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO_XMUN.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO_CEP').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO_CEP.getAttribute('manter') || CTE_REF_REM_ENDERECO_CEP.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO_CEP.type == 'checkbox') {
					CTE_REF_REM_ENDERECO_CEP.checked = false;
				} else if(CTE_REF_REM_ENDERECO_CEP.type == 'select-one') {
					CTE_REF_REM_ENDERECO_CEP.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO_CEP.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO_UF').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO_UF.getAttribute('manter') || CTE_REF_REM_ENDERECO_UF.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO_UF.type == 'checkbox') {
					CTE_REF_REM_ENDERECO_UF.checked = false;
				} else if(CTE_REF_REM_ENDERECO_UF.type == 'select-one') {
					CTE_REF_REM_ENDERECO_UF.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO_UF.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_REM_ENDERECO_PAIS').getAttribute('type') != 'file') {
		  if (!CTE_REF_REM_ENDERECO_PAIS.getAttribute('manter') || CTE_REF_REM_ENDERECO_PAIS.getAttribute('manter') == 0) {
				if(CTE_REF_REM_ENDERECO_PAIS.type == 'checkbox') {
					CTE_REF_REM_ENDERECO_PAIS.checked = false;
				} else if(CTE_REF_REM_ENDERECO_PAIS.type == 'select-one') {
					CTE_REF_REM_ENDERECO_PAIS.selectedIndex = 0;
				} else {
					CTE_REF_REM_ENDERECO_PAIS.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_CNPJ_CPF').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_CNPJ_CPF.getAttribute('manter') || CTE_REF_DEST_CNPJ_CPF.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_CNPJ_CPF.type == 'checkbox') {
					CTE_REF_DEST_CNPJ_CPF.checked = false;
				} else if(CTE_REF_DEST_CNPJ_CPF.type == 'select-one') {
					CTE_REF_DEST_CNPJ_CPF.selectedIndex = 0;
				} else {
					CTE_REF_DEST_CNPJ_CPF.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_IE').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_IE.getAttribute('manter') || CTE_REF_DEST_IE.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_IE.type == 'checkbox') {
					CTE_REF_DEST_IE.checked = false;
				} else if(CTE_REF_DEST_IE.type == 'select-one') {
					CTE_REF_DEST_IE.selectedIndex = 0;
				} else {
					CTE_REF_DEST_IE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_RAZAO').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_RAZAO.getAttribute('manter') || CTE_REF_DEST_RAZAO.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_RAZAO.type == 'checkbox') {
					CTE_REF_DEST_RAZAO.checked = false;
				} else if(CTE_REF_DEST_RAZAO.type == 'select-one') {
					CTE_REF_DEST_RAZAO.selectedIndex = 0;
				} else {
					CTE_REF_DEST_RAZAO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO.getAttribute('manter') || CTE_REF_DEST_ENDERECO.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO.checked = false;
				} else if(CTE_REF_DEST_ENDERECO.type == 'select-one') {
					CTE_REF_DEST_ENDERECO.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO_NRO').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO_NRO.getAttribute('manter') || CTE_REF_DEST_ENDERECO_NRO.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO_NRO.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO_NRO.checked = false;
				} else if(CTE_REF_DEST_ENDERECO_NRO.type == 'select-one') {
					CTE_REF_DEST_ENDERECO_NRO.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO_NRO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO_BAIRRO.getAttribute('manter') || CTE_REF_DEST_ENDERECO_BAIRRO.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO_BAIRRO.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO_BAIRRO.checked = false;
				} else if(CTE_REF_DEST_ENDERECO_BAIRRO.type == 'select-one') {
					CTE_REF_DEST_ENDERECO_BAIRRO.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO_BAIRRO.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO_CMUN').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO_CMUN.getAttribute('manter') || CTE_REF_DEST_ENDERECO_CMUN.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO_CMUN.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO_CMUN.checked = false;
				} else if(CTE_REF_DEST_ENDERECO_CMUN.type == 'select-one') {
					CTE_REF_DEST_ENDERECO_CMUN.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO_CMUN.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO_XMUN').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO_XMUN.getAttribute('manter') || CTE_REF_DEST_ENDERECO_XMUN.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO_XMUN.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO_XMUN.checked = false;
				} else if(CTE_REF_DEST_ENDERECO_XMUN.type == 'select-one') {
					CTE_REF_DEST_ENDERECO_XMUN.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO_XMUN.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO_CEP').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO_CEP.getAttribute('manter') || CTE_REF_DEST_ENDERECO_CEP.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO_CEP.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO_CEP.checked = false;
				} else if(CTE_REF_DEST_ENDERECO_CEP.type == 'select-one') {
					CTE_REF_DEST_ENDERECO_CEP.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO_CEP.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO_UF').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO_UF.getAttribute('manter') || CTE_REF_DEST_ENDERECO_UF.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO_UF.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO_UF.checked = false;
				} else if(CTE_REF_DEST_ENDERECO_UF.type == 'select-one') {
					CTE_REF_DEST_ENDERECO_UF.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO_UF.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_DEST_ENDERECO_PAIS').getAttribute('type') != 'file') {
		  if (!CTE_REF_DEST_ENDERECO_PAIS.getAttribute('manter') || CTE_REF_DEST_ENDERECO_PAIS.getAttribute('manter') == 0) {
				if(CTE_REF_DEST_ENDERECO_PAIS.type == 'checkbox') {
					CTE_REF_DEST_ENDERECO_PAIS.checked = false;
				} else if(CTE_REF_DEST_ENDERECO_PAIS.type == 'select-one') {
					CTE_REF_DEST_ENDERECO_PAIS.selectedIndex = 0;
				} else {
					CTE_REF_DEST_ENDERECO_PAIS.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_PESO_MULTIMODAL').getAttribute('type') != 'file') {
		  if (!CTE_REF_PESO_MULTIMODAL.getAttribute('manter') || CTE_REF_PESO_MULTIMODAL.getAttribute('manter') == 0) {
				if(CTE_REF_PESO_MULTIMODAL.type == 'checkbox') {
					CTE_REF_PESO_MULTIMODAL.checked = false;
				} else if(CTE_REF_PESO_MULTIMODAL.type == 'select-one') {
					CTE_REF_PESO_MULTIMODAL.selectedIndex = 0;
				} else {
					CTE_REF_PESO_MULTIMODAL.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA').getAttribute('type') != 'file') {
		  if (!CTE_REF_PERCENTUAL_TOLERANCIA.getAttribute('manter') || CTE_REF_PERCENTUAL_TOLERANCIA.getAttribute('manter') == 0) {
				if(CTE_REF_PERCENTUAL_TOLERANCIA.type == 'checkbox') {
					CTE_REF_PERCENTUAL_TOLERANCIA.checked = false;
				} else if(CTE_REF_PERCENTUAL_TOLERANCIA.type == 'select-one') {
					CTE_REF_PERCENTUAL_TOLERANCIA.selectedIndex = 0;
				} else {
					CTE_REF_PERCENTUAL_TOLERANCIA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_VALOR_TOLERANCIA').getAttribute('type') != 'file') {
		  if (!CTE_REF_VALOR_TOLERANCIA.getAttribute('manter') || CTE_REF_VALOR_TOLERANCIA.getAttribute('manter') == 0) {
				if(CTE_REF_VALOR_TOLERANCIA.type == 'checkbox') {
					CTE_REF_VALOR_TOLERANCIA.checked = false;
				} else if(CTE_REF_VALOR_TOLERANCIA.type == 'select-one') {
					CTE_REF_VALOR_TOLERANCIA.selectedIndex = 0;
				} else {
					CTE_REF_VALOR_TOLERANCIA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_PESO_CTES_VINCULADOS').getAttribute('type') != 'file') {
		  if (!CTE_REF_PESO_CTES_VINCULADOS.getAttribute('manter') || CTE_REF_PESO_CTES_VINCULADOS.getAttribute('manter') == 0) {
				if(CTE_REF_PESO_CTES_VINCULADOS.type == 'checkbox') {
					CTE_REF_PESO_CTES_VINCULADOS.checked = false;
				} else if(CTE_REF_PESO_CTES_VINCULADOS.type == 'select-one') {
					CTE_REF_PESO_CTES_VINCULADOS.selectedIndex = 0;
				} else {
					CTE_REF_PESO_CTES_VINCULADOS.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_PESO_RESTANTE').getAttribute('type') != 'file') {
		  if (!CTE_REF_PESO_RESTANTE.getAttribute('manter') || CTE_REF_PESO_RESTANTE.getAttribute('manter') == 0) {
				if(CTE_REF_PESO_RESTANTE.type == 'checkbox') {
					CTE_REF_PESO_RESTANTE.checked = false;
				} else if(CTE_REF_PESO_RESTANTE.type == 'select-one') {
					CTE_REF_PESO_RESTANTE.selectedIndex = 0;
				} else {
					CTE_REF_PESO_RESTANTE.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA').getAttribute('type') != 'file') {
		  if (!CTE_REF_PESO_RESTANTE_TOLERANCIA.getAttribute('manter') || CTE_REF_PESO_RESTANTE_TOLERANCIA.getAttribute('manter') == 0) {
				if(CTE_REF_PESO_RESTANTE_TOLERANCIA.type == 'checkbox') {
					CTE_REF_PESO_RESTANTE_TOLERANCIA.checked = false;
				} else if(CTE_REF_PESO_RESTANTE_TOLERANCIA.type == 'select-one') {
					CTE_REF_PESO_RESTANTE_TOLERANCIA.selectedIndex = 0;
				} else {
					CTE_REF_PESO_RESTANTE_TOLERANCIA.value = '';
				}
				
			}
		}
		

		if(document.getElementById('CTE_REF_PESO_REAL').getAttribute('type') != 'file') {
		  if (!CTE_REF_PESO_REAL.getAttribute('manter') || CTE_REF_PESO_REAL.getAttribute('manter') == 0) {
				if(CTE_REF_PESO_REAL.type == 'checkbox') {
					CTE_REF_PESO_REAL.checked = false;
				} else if(CTE_REF_PESO_REAL.type == 'select-one') {
					CTE_REF_PESO_REAL.selectedIndex = 0;
				} else {
					CTE_REF_PESO_REAL.value = '';
				}
				
			}
		}
		
		lista_selected_CTES_REF.value = -1;
	}
	f_desabilitar_botao_lista_CTES_REF('padrao');
	f_desabilitar_botao_lista_CTES_REF('excluir');
		
	f_on_incluir_CTES_REF();
}
function f_habilitar_botao_lista_CTES_REF(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_CTES_REF');
	if(obj != null) {
		obj.disabled = false;
		img_obj = document.getElementById('img_lista_'+v_botao+'_CTES_REF');
		img_obj.src = img_obj.src.replace('_disable.gif', '.gif');
	}
}
function f_desabilitar_botao_lista_CTES_REF(v_botao) {
	obj = document.getElementById('btn_lista_'+v_botao+'_CTES_REF');
	if(obj != null) {
		obj.disabled = true;
		img_obj = document.getElementById('img_lista_'+v_botao+'_CTES_REF');
		if(img_obj.src.indexOf('_disable') == -1) {
			img_obj.src = img_obj.src.replace('.gif', '_disable.gif');
		}
	}
}
function f_seleciona_CTES_REF(v_nro) {
	
	if(!document.getElementById('btn_lista_incluir_CTES_REF').disabled) {
	
		f_before_selecionar_CTES_REF();
		f_cancelar_CTES_REF();
		var tbody = document.getElementById('tb_lista_CTES_REF');		
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_CTES_REF_'+v_nro) {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_1';
				}			
			} else {
				for(var j=0;j<tbody.rows[i].cells.length;j++) {
					tbody.rows[i].cells[j].className = 'linha_over';
				}
			}
		}
		with (document.forms[0]) {
			
			if(CTE_REF_CONHECIMENTO_ID.type == 'checkbox') {
				CTE_REF_CONHECIMENTO_ID.checked = (document.getElementById('CTE_REF_CONHECIMENTO_ID_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_CONHECIMENTO_ID').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_CONHECIMENTO_ID_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_CONHECIMENTO_ID');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_CONHECIMENTO_ID';
				v_campo_valor.name = 'CTE_REF_CONHECIMENTO_ID';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_CONHECIMENTO_ID.value = document.getElementById('CTE_REF_CONHECIMENTO_ID_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_CHAVE.type == 'checkbox') {
				CTE_REF_CHAVE.checked = (document.getElementById('CTE_REF_CHAVE_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_CHAVE').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_CHAVE_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_CHAVE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_CHAVE';
				v_campo_valor.name = 'CTE_REF_CHAVE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_CHAVE.value = document.getElementById('CTE_REF_CHAVE_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_NUMERO.type == 'checkbox') {
				CTE_REF_NUMERO.checked = (document.getElementById('CTE_REF_NUMERO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_NUMERO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_NUMERO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_NUMERO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_NUMERO';
				v_campo_valor.name = 'CTE_REF_NUMERO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_NUMERO.value = document.getElementById('CTE_REF_NUMERO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_SERIE.type == 'checkbox') {
				CTE_REF_SERIE.checked = (document.getElementById('CTE_REF_SERIE_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_SERIE').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_SERIE_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_SERIE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_SERIE';
				v_campo_valor.name = 'CTE_REF_SERIE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_SERIE.value = document.getElementById('CTE_REF_SERIE_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_SITUACAO.type == 'checkbox') {
				CTE_REF_SITUACAO.checked = (document.getElementById('CTE_REF_SITUACAO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_SITUACAO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_SITUACAO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_SITUACAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_SITUACAO';
				v_campo_valor.name = 'CTE_REF_SITUACAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_SITUACAO.value = document.getElementById('CTE_REF_SITUACAO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DATA_EMISSAO.type == 'checkbox') {
				CTE_REF_DATA_EMISSAO.checked = (document.getElementById('CTE_REF_DATA_EMISSAO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DATA_EMISSAO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DATA_EMISSAO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DATA_EMISSAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DATA_EMISSAO';
				v_campo_valor.name = 'CTE_REF_DATA_EMISSAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DATA_EMISSAO.value = document.getElementById('CTE_REF_DATA_EMISSAO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_EMIT_CNPJ_CPF.type == 'checkbox') {
				CTE_REF_EMIT_CNPJ_CPF.checked = (document.getElementById('CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_EMIT_CNPJ_CPF').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_EMIT_CNPJ_CPF');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_EMIT_CNPJ_CPF';
				v_campo_valor.name = 'CTE_REF_EMIT_CNPJ_CPF';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_EMIT_CNPJ_CPF.value = document.getElementById('CTE_REF_EMIT_CNPJ_CPF_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_EMIT_RAZAO.type == 'checkbox') {
				CTE_REF_EMIT_RAZAO.checked = (document.getElementById('CTE_REF_EMIT_RAZAO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_EMIT_RAZAO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_EMIT_RAZAO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_EMIT_RAZAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_EMIT_RAZAO';
				v_campo_valor.name = 'CTE_REF_EMIT_RAZAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_EMIT_RAZAO.value = document.getElementById('CTE_REF_EMIT_RAZAO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_CNPJ_CPF.type == 'checkbox') {
				CTE_REF_REM_CNPJ_CPF.checked = (document.getElementById('CTE_REF_REM_CNPJ_CPF_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_CNPJ_CPF').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_CNPJ_CPF_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_CNPJ_CPF');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_CNPJ_CPF';
				v_campo_valor.name = 'CTE_REF_REM_CNPJ_CPF';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_CNPJ_CPF.value = document.getElementById('CTE_REF_REM_CNPJ_CPF_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_IE.type == 'checkbox') {
				CTE_REF_REM_IE.checked = (document.getElementById('CTE_REF_REM_IE_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_IE').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_IE_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_IE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_IE';
				v_campo_valor.name = 'CTE_REF_REM_IE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_IE.value = document.getElementById('CTE_REF_REM_IE_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_RAZAO.type == 'checkbox') {
				CTE_REF_REM_RAZAO.checked = (document.getElementById('CTE_REF_REM_RAZAO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_RAZAO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_RAZAO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_RAZAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_RAZAO';
				v_campo_valor.name = 'CTE_REF_REM_RAZAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_RAZAO.value = document.getElementById('CTE_REF_REM_RAZAO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO.type == 'checkbox') {
				CTE_REF_REM_ENDERECO.checked = (document.getElementById('CTE_REF_REM_ENDERECO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO.value = document.getElementById('CTE_REF_REM_ENDERECO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO_NRO.type == 'checkbox') {
				CTE_REF_REM_ENDERECO_NRO.checked = (document.getElementById('CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO_NRO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO_NRO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO_NRO';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO_NRO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO_NRO.value = document.getElementById('CTE_REF_REM_ENDERECO_NRO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO_BAIRRO.type == 'checkbox') {
				CTE_REF_REM_ENDERECO_BAIRRO.checked = (document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO_BAIRRO';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO_BAIRRO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO_BAIRRO.value = document.getElementById('CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO_CMUN.type == 'checkbox') {
				CTE_REF_REM_ENDERECO_CMUN.checked = (document.getElementById('CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO_CMUN').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO_CMUN');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO_CMUN';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO_CMUN';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO_CMUN.value = document.getElementById('CTE_REF_REM_ENDERECO_CMUN_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO_XMUN.type == 'checkbox') {
				CTE_REF_REM_ENDERECO_XMUN.checked = (document.getElementById('CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO_XMUN').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO_XMUN');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO_XMUN';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO_XMUN';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO_XMUN.value = document.getElementById('CTE_REF_REM_ENDERECO_XMUN_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO_CEP.type == 'checkbox') {
				CTE_REF_REM_ENDERECO_CEP.checked = (document.getElementById('CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO_CEP').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO_CEP');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO_CEP';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO_CEP';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO_CEP.value = document.getElementById('CTE_REF_REM_ENDERECO_CEP_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO_UF.type == 'checkbox') {
				CTE_REF_REM_ENDERECO_UF.checked = (document.getElementById('CTE_REF_REM_ENDERECO_UF_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO_UF').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_UF_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO_UF');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO_UF';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO_UF';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO_UF.value = document.getElementById('CTE_REF_REM_ENDERECO_UF_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_REM_ENDERECO_PAIS.type == 'checkbox') {
				CTE_REF_REM_ENDERECO_PAIS.checked = (document.getElementById('CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_REM_ENDERECO_PAIS').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_REM_ENDERECO_PAIS');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_REM_ENDERECO_PAIS';
				v_campo_valor.name = 'CTE_REF_REM_ENDERECO_PAIS';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_REM_ENDERECO_PAIS.value = document.getElementById('CTE_REF_REM_ENDERECO_PAIS_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_CNPJ_CPF.type == 'checkbox') {
				CTE_REF_DEST_CNPJ_CPF.checked = (document.getElementById('CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_CNPJ_CPF').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_CNPJ_CPF');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_CNPJ_CPF';
				v_campo_valor.name = 'CTE_REF_DEST_CNPJ_CPF';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_CNPJ_CPF.value = document.getElementById('CTE_REF_DEST_CNPJ_CPF_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_IE.type == 'checkbox') {
				CTE_REF_DEST_IE.checked = (document.getElementById('CTE_REF_DEST_IE_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_IE').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_IE_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_IE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_IE';
				v_campo_valor.name = 'CTE_REF_DEST_IE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_IE.value = document.getElementById('CTE_REF_DEST_IE_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_RAZAO.type == 'checkbox') {
				CTE_REF_DEST_RAZAO.checked = (document.getElementById('CTE_REF_DEST_RAZAO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_RAZAO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_RAZAO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_RAZAO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_RAZAO';
				v_campo_valor.name = 'CTE_REF_DEST_RAZAO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_RAZAO.value = document.getElementById('CTE_REF_DEST_RAZAO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO.value = document.getElementById('CTE_REF_DEST_ENDERECO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO_NRO.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO_NRO.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO_NRO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO_NRO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO_NRO';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO_NRO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO_NRO.value = document.getElementById('CTE_REF_DEST_ENDERECO_NRO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO_BAIRRO.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO_BAIRRO.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO_BAIRRO';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO_BAIRRO';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO_BAIRRO.value = document.getElementById('CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO_CMUN.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO_CMUN.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO_CMUN').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO_CMUN');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO_CMUN';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO_CMUN';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO_CMUN.value = document.getElementById('CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO_XMUN.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO_XMUN.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO_XMUN').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO_XMUN');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO_XMUN';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO_XMUN';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO_XMUN.value = document.getElementById('CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO_CEP.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO_CEP.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO_CEP').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO_CEP');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO_CEP';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO_CEP';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO_CEP.value = document.getElementById('CTE_REF_DEST_ENDERECO_CEP_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO_UF.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO_UF.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO_UF').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO_UF');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO_UF';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO_UF';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO_UF.value = document.getElementById('CTE_REF_DEST_ENDERECO_UF_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_DEST_ENDERECO_PAIS.type == 'checkbox') {
				CTE_REF_DEST_ENDERECO_PAIS.checked = (document.getElementById('CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_DEST_ENDERECO_PAIS').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_DEST_ENDERECO_PAIS');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_DEST_ENDERECO_PAIS';
				v_campo_valor.name = 'CTE_REF_DEST_ENDERECO_PAIS';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_DEST_ENDERECO_PAIS.value = document.getElementById('CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_PESO_MULTIMODAL.type == 'checkbox') {
				CTE_REF_PESO_MULTIMODAL.checked = (document.getElementById('CTE_REF_PESO_MULTIMODAL_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_PESO_MULTIMODAL').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_PESO_MULTIMODAL_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_PESO_MULTIMODAL');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_PESO_MULTIMODAL';
				v_campo_valor.name = 'CTE_REF_PESO_MULTIMODAL';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_PESO_MULTIMODAL.value = document.getElementById('CTE_REF_PESO_MULTIMODAL_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_PERCENTUAL_TOLERANCIA.type == 'checkbox') {
				CTE_REF_PERCENTUAL_TOLERANCIA.checked = (document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_PERCENTUAL_TOLERANCIA';
				v_campo_valor.name = 'CTE_REF_PERCENTUAL_TOLERANCIA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_PERCENTUAL_TOLERANCIA.value = document.getElementById('CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_VALOR_TOLERANCIA.type == 'checkbox') {
				CTE_REF_VALOR_TOLERANCIA.checked = (document.getElementById('CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_VALOR_TOLERANCIA').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_VALOR_TOLERANCIA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_VALOR_TOLERANCIA';
				v_campo_valor.name = 'CTE_REF_VALOR_TOLERANCIA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_VALOR_TOLERANCIA.value = document.getElementById('CTE_REF_VALOR_TOLERANCIA_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_PESO_CTES_VINCULADOS.type == 'checkbox') {
				CTE_REF_PESO_CTES_VINCULADOS.checked = (document.getElementById('CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_PESO_CTES_VINCULADOS').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_PESO_CTES_VINCULADOS');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_PESO_CTES_VINCULADOS';
				v_campo_valor.name = 'CTE_REF_PESO_CTES_VINCULADOS';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_PESO_CTES_VINCULADOS.value = document.getElementById('CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_PESO_RESTANTE.type == 'checkbox') {
				CTE_REF_PESO_RESTANTE.checked = (document.getElementById('CTE_REF_PESO_RESTANTE_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_PESO_RESTANTE').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_PESO_RESTANTE_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_PESO_RESTANTE');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_PESO_RESTANTE';
				v_campo_valor.name = 'CTE_REF_PESO_RESTANTE';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_PESO_RESTANTE.value = document.getElementById('CTE_REF_PESO_RESTANTE_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_PESO_RESTANTE_TOLERANCIA.type == 'checkbox') {
				CTE_REF_PESO_RESTANTE_TOLERANCIA.checked = (document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_PESO_RESTANTE_TOLERANCIA';
				v_campo_valor.name = 'CTE_REF_PESO_RESTANTE_TOLERANCIA';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_PESO_RESTANTE_TOLERANCIA.value = document.getElementById('CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_'+v_nro).value;
			}
			
			if(CTE_REF_PESO_REAL.type == 'checkbox') {
				CTE_REF_PESO_REAL.checked = (document.getElementById('CTE_REF_PESO_REAL_CTES_REF_'+v_nro).value == 1)
			} else if(document.getElementById('CTE_REF_PESO_REAL').type == 'file') {
				v_campo_valor = document.getElementById('CTE_REF_PESO_REAL_CTES_REF_'+v_nro);
				v_campo_atual = document.getElementById('CTE_REF_PESO_REAL');
				
				v_campo_atual.parentNode.insertBefore(v_campo_valor,v_campo_atual);
				v_campo_valor.id = 'CTE_REF_PESO_REAL';
				v_campo_valor.name = 'CTE_REF_PESO_REAL';
				v_campo_valor.style.display = '';
				v_campo_atual.removeNode(true);
				
			} else {
				CTE_REF_PESO_REAL.value = document.getElementById('CTE_REF_PESO_REAL_CTES_REF_'+v_nro).value;
			}
			
			lista_selected_CTES_REF.value = v_nro;
		}
		f_habilitar_botao_lista_CTES_REF('padrao');
		f_habilitar_botao_lista_CTES_REF('excluir');
		f_habilitar_botao_lista_CTES_REF('salvar');
		f_on_seleciona_CTES_REF();
	
	}
	
}
function f_padrao_CTES_REF(v_nro) {
	if(v_nro == -1) {
		return;
	}
	var tbody = document.getElementById('tb_lista_CTES_REF');		
	with(document.forms[0]) {
		for(var i=0;i<tbody.rows.length;i++) {
			if(tbody.rows[i].id != 'tr_lista_CTES_REF_'+v_nro) {
				var row_id = tbody.rows[i].id.replace('tr_lista_CTES_REF_', '');
				document.getElementById('lista_padrao_CTES_REF_'+row_id).style.display = 'none';
				document.getElementById('PADRAO_CTES_REF_'+row_id).value = 0;
			}
		}
	}
	document.getElementById('lista_padrao_CTES_REF_'+v_nro).style.display = '';
	document.getElementById('PADRAO_CTES_REF_'+v_nro).value = 1;
}	

function f_total_campo_CTES_REF(v_campo) {
	var tbody = document.getElementById('tb_lista_CTES_REF');
	var soma = 0;
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_CTES_REF_', '');
		with(document.forms[0]) {
			try {
				soma += (eval("document.forms[0]."+v_campo+"_CTES_REF_"+id_linha+".value")*1);
			} catch(e) {
			}
		}
	}
	return soma;
}
function f_atualiza_campos_escravos_CTES_REF() {

}

function f_atualiza_campo_escravo_CTES_REF(v_valor_mestre, v_campo_escravo, v_value) {
	var tbody = document.getElementById('tb_lista_CTES_REF');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_CTES_REF_', '');
		with(document.forms[0]) {
			try {
				if (eval("document.forms[0]._CTES_REF_"+id_linha).value == v_valor_mestre) {
					eval("document.forms[0]."+v_campo_escravo+"_CTES_REF_"+id_linha).value = v_value;
				}				
			} catch(e) {
			}
		}
	}
}

function f_register(p_id) {
	this.id = p_id;

	this.CTE_REF_CONHECIMENTO_ID = '';

	this.CTE_REF_CHAVE = '';

	this.CTE_REF_NUMERO = '';

	this.CTE_REF_SERIE = '';

	this.CTE_REF_SITUACAO = '';

	this.CTE_REF_DATA_EMISSAO = '';

	this.CTE_REF_EMIT_CNPJ_CPF = '';

	this.CTE_REF_EMIT_RAZAO = '';

	this.CTE_REF_REM_CNPJ_CPF = '';

	this.CTE_REF_REM_IE = '';

	this.CTE_REF_REM_RAZAO = '';

	this.CTE_REF_REM_ENDERECO = '';

	this.CTE_REF_REM_ENDERECO_NRO = '';

	this.CTE_REF_REM_ENDERECO_BAIRRO = '';

	this.CTE_REF_REM_ENDERECO_CMUN = '';

	this.CTE_REF_REM_ENDERECO_XMUN = '';

	this.CTE_REF_REM_ENDERECO_CEP = '';

	this.CTE_REF_REM_ENDERECO_UF = '';

	this.CTE_REF_REM_ENDERECO_PAIS = '';

	this.CTE_REF_DEST_CNPJ_CPF = '';

	this.CTE_REF_DEST_IE = '';

	this.CTE_REF_DEST_RAZAO = '';

	this.CTE_REF_DEST_ENDERECO = '';

	this.CTE_REF_DEST_ENDERECO_NRO = '';

	this.CTE_REF_DEST_ENDERECO_BAIRRO = '';

	this.CTE_REF_DEST_ENDERECO_CMUN = '';

	this.CTE_REF_DEST_ENDERECO_XMUN = '';

	this.CTE_REF_DEST_ENDERECO_CEP = '';

	this.CTE_REF_DEST_ENDERECO_UF = '';

	this.CTE_REF_DEST_ENDERECO_PAIS = '';

	this.CTE_REF_PESO_MULTIMODAL = '';

	this.CTE_REF_PERCENTUAL_TOLERANCIA = '';

	this.CTE_REF_VALOR_TOLERANCIA = '';

	this.CTE_REF_PESO_CTES_VINCULADOS = '';

	this.CTE_REF_PESO_RESTANTE = '';

	this.CTE_REF_PESO_RESTANTE_TOLERANCIA = '';

	this.CTE_REF_PESO_REAL = '';
}
//busca todos os registros
function f_listagem_CTES_REF() {
	var tbody = document.getElementById('tb_lista_CTES_REF');
	var result = new Array();
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_CTES_REF_', '');
		result[result.length] = new f_register(id_linha);
	
		try {
			result[result.length-1].CTE_REF_CONHECIMENTO_ID = eval("document.forms[0].CTE_REF_CONHECIMENTO_ID_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_CHAVE = eval("document.forms[0].CTE_REF_CHAVE_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_NUMERO = eval("document.forms[0].CTE_REF_NUMERO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_SERIE = eval("document.forms[0].CTE_REF_SERIE_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_SITUACAO = eval("document.forms[0].CTE_REF_SITUACAO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DATA_EMISSAO = eval("document.forms[0].CTE_REF_DATA_EMISSAO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_EMIT_CNPJ_CPF = eval("document.forms[0].CTE_REF_EMIT_CNPJ_CPF_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_EMIT_RAZAO = eval("document.forms[0].CTE_REF_EMIT_RAZAO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_CNPJ_CPF = eval("document.forms[0].CTE_REF_REM_CNPJ_CPF_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_IE = eval("document.forms[0].CTE_REF_REM_IE_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_RAZAO = eval("document.forms[0].CTE_REF_REM_RAZAO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO = eval("document.forms[0].CTE_REF_REM_ENDERECO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO_NRO = eval("document.forms[0].CTE_REF_REM_ENDERECO_NRO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO_BAIRRO = eval("document.forms[0].CTE_REF_REM_ENDERECO_BAIRRO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO_CMUN = eval("document.forms[0].CTE_REF_REM_ENDERECO_CMUN_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO_XMUN = eval("document.forms[0].CTE_REF_REM_ENDERECO_XMUN_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO_CEP = eval("document.forms[0].CTE_REF_REM_ENDERECO_CEP_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO_UF = eval("document.forms[0].CTE_REF_REM_ENDERECO_UF_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_REM_ENDERECO_PAIS = eval("document.forms[0].CTE_REF_REM_ENDERECO_PAIS_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_CNPJ_CPF = eval("document.forms[0].CTE_REF_DEST_CNPJ_CPF_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_IE = eval("document.forms[0].CTE_REF_DEST_IE_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_RAZAO = eval("document.forms[0].CTE_REF_DEST_RAZAO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO = eval("document.forms[0].CTE_REF_DEST_ENDERECO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO_NRO = eval("document.forms[0].CTE_REF_DEST_ENDERECO_NRO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO_BAIRRO = eval("document.forms[0].CTE_REF_DEST_ENDERECO_BAIRRO_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO_CMUN = eval("document.forms[0].CTE_REF_DEST_ENDERECO_CMUN_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO_XMUN = eval("document.forms[0].CTE_REF_DEST_ENDERECO_XMUN_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO_CEP = eval("document.forms[0].CTE_REF_DEST_ENDERECO_CEP_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO_UF = eval("document.forms[0].CTE_REF_DEST_ENDERECO_UF_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_DEST_ENDERECO_PAIS = eval("document.forms[0].CTE_REF_DEST_ENDERECO_PAIS_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_PESO_MULTIMODAL = eval("document.forms[0].CTE_REF_PESO_MULTIMODAL_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_PERCENTUAL_TOLERANCIA = eval("document.forms[0].CTE_REF_PERCENTUAL_TOLERANCIA_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_VALOR_TOLERANCIA = eval("document.forms[0].CTE_REF_VALOR_TOLERANCIA_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_PESO_CTES_VINCULADOS = eval("document.forms[0].CTE_REF_PESO_CTES_VINCULADOS_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_PESO_RESTANTE = eval("document.forms[0].CTE_REF_PESO_RESTANTE_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_PESO_RESTANTE_TOLERANCIA = eval("document.forms[0].CTE_REF_PESO_RESTANTE_TOLERANCIA_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
		try {
			result[result.length-1].CTE_REF_PESO_REAL = eval("document.forms[0].CTE_REF_PESO_REAL_CTES_REF_"+id_linha).value;
		} catch(e) {}
	
	}
	return result;
}

function f_busca_campo_escravo_CTES_REF(v_valor_mestre, v_campo_escravo) {
	var tbody = document.getElementById('tb_lista_CTES_REF');
	for(var i=0;i<tbody.rows.length;i++) {
		var id_linha = tbody.rows[i].id.replace('tr_lista_CTES_REF_', '');
		with(document.forms[0]) {
				if (eval("document.forms[0]._CTES_REF_"+id_linha).value == v_valor_mestre) {
					return eval("document.forms[0]."+v_campo_escravo+"_CTES_REF_"+id_linha).value;
				}				
		}
	}
	return '';
}
function f_set_lista_min_CTES_REF(value) {

}

function f_before_selecionar_CTES_REF() {}
function f_on_seleciona_CTES_REF() {}
function f_on_salva_lista_CTES_REF() {}
function f_before_salvar_CTES_REF() { return true; }
function f_on_incluir_CTES_REF() {}
function f_on_excluir_CTES_REF() {}
</script>

<table width="100%" height="100%" align="left" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr id="tr_lista_botoes_CTES_REF">
    <td><table border="0" cellspacing="0" cellpadding="0">
        <tbody><tr>

		
          <td><button tabindex="582" class="botao" id="btn_lista_incluir_CTES_REF" onclick="f_incluir_CTES_REF()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_incluir_CTES_REF" src="/_imagens/botoes/16x16/incluir.gif">&nbsp;Novo</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="583" class="botao" id="btn_lista_excluir_CTES_REF" onclick="f_excluir_CTES_REF(document.forms[0].lista_selected_CTES_REF.value)" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_excluir_CTES_REF" src="/_imagens/botoes/16x16/excluir.gif">&nbsp;Excluir</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="584" class="botao" id="btn_lista_salvar_CTES_REF" onclick="f_salvar_CTES_REF()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_salvar_CTES_REF" src="/_imagens/botoes/16x16/confirmar.gif">&nbsp;Salvar</button></td>
          <td style="width: 4px;">&nbsp;</td>
          <td><button tabindex="585" class="botao" id="btn_lista_cancelar_CTES_REF" onclick="f_cancelar_CTES_REF()" type="button"><img name="{text}" width="16" height="16" align="absmiddle" id="img_lista_cancelar_CTES_REF" src="/_imagens/botoes/16x16/cancelar.gif">&nbsp;Cancelar</button></td>
          <td style="width: 4px;">&nbsp;</td>
		  
        </tr>
      </tbody></table></td>
  </tr>
  <tr><td height="4"></td></tr>
  <input name="lista_selected_CTES_REF" tabindex="586" id="lista_selected_CTES_REF" type="hidden" value="-1" fixo="1">
  <input name="lista_deleted_CTES_REF" tabindex="587" id="lista_deleted_CTES_REF" type="hidden" value="" fixo="1">
  <tr>
  
    <td height="200">
	<div class="lista" style="width: 100%; -ms-overflow-x: scroll;">
	<table width="100%" style="-ms-overflow-y: scroll;" border="0" cellspacing="1" cellpadding="3">
	<thead>
  <tr class="titulo_3" style="cursor: pointer;" onclick="sortColumn(event)">
    <td width="16" class="titulo_3" style="display: none;">&nbsp;</td>
  	
    <td width="15%" align="left" class="titulo_3" type="caseinsensitivestring">Chave</td>
	
    <td width="5%" align="right" class="titulo_3" type="caseinsensitivestring">Número</td>
	
    <td width="5%" align="right" class="titulo_3" type="caseinsensitivestring">Série</td>
	
    <td width="5%" align="left" class="titulo_3" type="caseinsensitivestring">Status</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Data de Emissão</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">CNPJ/CPF Emitente</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Emitente</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">CNPJ/CPF Remetente</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Remetente</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">CNPJ/CPF Destinatário</td>
	
    <td width="10%" align="left" class="titulo_3" type="caseinsensitivestring">Destinatário</td>
	
  </tr>
  </thead>
  <tbody id="tb_lista_CTES_REF">
  </tbody>
</table>

	</div></td>
  </tr>
</tbody></table>

	                    </td>
	                    </tr>
	                    </tbody></table>
	                </td>
	            </tr>
	         </tbody></table>
		  </td>
	   </tr>    
	</tbody></table>
</fieldset>

                                </fieldset>
                            </td>
               </tr>
                    </tbody></table>

            <script language="javascript1.2">
			      initAbas('tbl_abas',0,true);
                    </script>
                </td>
      </tr>
	</tbody></table>
</form>

<div id="dv_form_erro_tabela_frete" style="display: none;">
			
            </div>
<iframe name="consultas" width="2000" height="1000" src="" frameborder="0" style="display: none;"></iframe>



<script>
	parent.f_habilitar_botao('confirmar','f_confirmar()');
</script>

	<script>
		with(document.forms[0]){
            DATA_EMISSAO.value="19/12/2025 16:18";
			
			   DATA_EMISSAO.readOnly=true;
			   document.getElementById("btn_data_emissao").style.display='none';
			
			IMPRESSO.value = 0;
			IMPRIMIR.value = 1;
			NOTA_DATA_EMISSAO.value="19/12/2025";

		}
	</script>


<script>

Calendar.setup(
    {
      inputField  : "DATA_EMISSAO",      // ID of the input field
      ifFormat    :    "%d/%m/%Y %H:%M",    // the date format
      button      : "btn_data_emissao",    // ID of the button
	  range       : [2001,2050],
	  showsTime   :  true
    }
  );
  window.onload = function() {
  		f_controla_campos(1,true);
  		
  }

 with(document.forms[0]) {

	FRETE_PROPRIO.value = 1;

	f_cancelar_NOTAS_FISCAIS();
	f_cancelar_NFE();
	f_cancelar_OUTROS();

	
	

	
	f_mensagem_contingencia();

}
</script>

<script type="text/javascript">

	with(document.forms[0]) {
		setReadOnly['complemento'](true);
		TIPO_COMPLEMENTO_ID.focus();

		setReadOnly['REM'](true);
		setReadOnly['DEST'](true);
		setReadOnly['COLETA'](true);
		setReadOnly['RED'](true);
		setReadOnly['COB'](true);
		setReadOnly['NEG'](true);

	
	}

</script>



<script type="text/javascript">
	with(document.forms[0]) {
		OUTROS_COD_UNIDADE.value = 'Kg';
		NFE_COD_UNIDADE.value = 'Kg';
		NOTA_COD_UNIDADE.value = 'Kg';

		
		    EMITIR_POR_TABELA_FRETE.value = '0';
		
	        COD_TIPO_CONHECIMENTO_DIARIA.value = '25;2'
			COEFICIENTE_CUBAGEM.value = '300'
	   ;

	}

</script>
<!-- Trecho de Execução do requestEnd -->

	<script>
				
	</script>			
<div id="div_carregando" style="left: 963px; top: 0px; width: 182px; height: 35px; display: none; position: absolute;"><img width="182" height="35" src="/_imagens/uteis/processando_1.gif"></div></body></html>